Directory structure:
â””â”€â”€ huangserva-skill-prompt-generator/
    â”œâ”€â”€ README.md
    â”œâ”€â”€ element_db.py
    â”œâ”€â”€ framework_loader.py
    â”œâ”€â”€ intelligent_generator.py
    â”œâ”€â”€ prompt_framework.yaml
    â”œâ”€â”€ README_v2.0.md
    â”œâ”€â”€ requirements.txt
    â”œâ”€â”€ UPGRADE_GUIDE_v2.0.md
    â”œâ”€â”€ core/
    â”‚   â”œâ”€â”€ cross_domain_generator.py
    â”‚   â”œâ”€â”€ cross_domain_query.py
    â”‚   â”œâ”€â”€ design_bridge.py
    â”‚   â”œâ”€â”€ schema_migration_v1.sql
    â”‚   â”œâ”€â”€ variable_sampler.py
    â”‚   â””â”€â”€ yaml_sampler.py
    â”œâ”€â”€ design-logic/
    â”‚   â”œâ”€â”€ modern-minimal/
    â”‚   â”‚   â”œâ”€â”€ constraints.md
    â”‚   â”‚   â””â”€â”€ principles.md
    â”‚   â””â”€â”€ warm-cute/
    â”‚       â”œâ”€â”€ constraints.md
    â”‚       â””â”€â”€ principles.md
    â”œâ”€â”€ knowledge_base/
    â”‚   â””â”€â”€ how_to_control_color.md
    â”œâ”€â”€ variables/
    â”‚   â”œâ”€â”€ borders.yaml
    â”‚   â”œâ”€â”€ colors.yaml
    â”‚   â””â”€â”€ decorations.yaml
    â””â”€â”€ .claude/
        â”œâ”€â”€ claude.md
        â”œâ”€â”€ SKILL_ROUTING_GUIDE.md
        â””â”€â”€ skills/
            â”œâ”€â”€ learner.md
            â”œâ”€â”€ art-master/
            â”‚   â””â”€â”€ skill.md
            â”œâ”€â”€ design-master/
            â”‚   â””â”€â”€ skill.md
            â”œâ”€â”€ domain-classifier/
            â”‚   â””â”€â”€ skill.md
            â”œâ”€â”€ intelligent-prompt-generator/
            â”‚   â””â”€â”€ SKILL.md
            â”œâ”€â”€ product-master/
            â”‚   â”œâ”€â”€ skill.md
            â”‚   â””â”€â”€ modules/
            â”‚       â”œâ”€â”€ core/
            â”‚       â”‚   â””â”€â”€ builder.md
            â”‚       â””â”€â”€ layouts/
            â”‚           â””â”€â”€ grid_collage.md
            â”œâ”€â”€ prompt-analyzer/
            â”‚   â””â”€â”€ SKILL.md
            â”œâ”€â”€ prompt-extractor/
            â”‚   â”œâ”€â”€ README.md
            â”‚   â”œâ”€â”€ example_prompts.txt
            â”‚   â”œâ”€â”€ MODULE_REFERENCE.md
            â”‚   â”œâ”€â”€ PASTE_MODE_GUIDE.md
            â”‚   â”œâ”€â”€ preprocessor.py
            â”‚   â”œâ”€â”€ QUICKSTART.md
            â”‚   â”œâ”€â”€ skill.md
            â”‚   â”œâ”€â”€ test_extractor.sh
            â”‚   â””â”€â”€ test_output.json
            â”œâ”€â”€ prompt-generator/
            â”‚   â””â”€â”€ skill.md
            â”œâ”€â”€ prompt-master/
            â”‚   â”œâ”€â”€ skill.md
            â”‚   â””â”€â”€ modules/
            â”‚       â””â”€â”€ core/
            â”‚           â”œâ”€â”€ analyzer.md
            â”‚           â”œâ”€â”€ builder.md
            â”‚           â”œâ”€â”€ extractor.md
            â”‚           â”œâ”€â”€ learner.md
            â”‚           â”œâ”€â”€ optimizer.md
            â”‚           â””â”€â”€ recommender.md
            â”œâ”€â”€ prompt-xray/
            â”‚   â”œâ”€â”€ README.md
            â”‚   â”œâ”€â”€ skill.md
            â”‚   â””â”€â”€ xray_helper.py
            â”œâ”€â”€ universal-learner/
            â”‚   â”œâ”€â”€ SKILL.md
            â”‚   â””â”€â”€ modules/
            â”‚       â”œâ”€â”€ domain_classifier.md
            â”‚       â”œâ”€â”€ element_extractor.md
            â”‚       â”œâ”€â”€ library_updater.md
            â”‚       â””â”€â”€ tagger.md
            â””â”€â”€ video-master/
                â””â”€â”€ skill.md

================================================
FILE: README.md
================================================
[Binary file]


================================================
FILE: element_db.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Universal Elements Library - Database Layer
é€šç”¨å…ƒç´ åº“ - æ•°æ®åº“å±‚

ä½¿ç”¨SQLiteæ•°æ®åº“å­˜å‚¨æ‰€æœ‰é¢†åŸŸçš„å¯å¤ç”¨å…ƒç´ 
æ”¯æŒå¯¼å‡º/å¯¼å…¥JSONç”¨äºŽç‰ˆæœ¬æŽ§åˆ¶
"""

import sqlite3
import json
from pathlib import Path
from typing import Dict, List, Optional, Tuple
from datetime import datetime
import re


class ElementDB:
    """é€šç”¨å…ƒç´ åº“æ•°æ®åº“ç®¡ç†ç±»"""

    def __init__(self, db_path: str = "extracted_results/elements.db"):
        """
        åˆå§‹åŒ–æ•°æ®åº“è¿žæŽ¥

        Args:
            db_path: æ•°æ®åº“æ–‡ä»¶è·¯å¾„
        """
        self.db_path = Path(db_path)
        self.db_path.parent.mkdir(parents=True, exist_ok=True)

        self.conn = sqlite3.connect(str(self.db_path))
        self.conn.row_factory = sqlite3.Row  # è¿”å›žå­—å…¸å½¢å¼çš„è¡Œ

        self._init_database()

    def _init_database(self):
        """åˆå§‹åŒ–æ•°æ®åº“è¡¨ç»“æž„"""
        cursor = self.conn.cursor()

        # 1. é¢†åŸŸè¡¨
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS domains (
            domain_id TEXT PRIMARY KEY,
            name TEXT NOT NULL,
            description TEXT,
            total_elements INTEGER DEFAULT 0,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
        """)

        # 2. ç±»åˆ«è¡¨
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS categories (
            category_id TEXT PRIMARY KEY,
            domain_id TEXT NOT NULL,
            name TEXT NOT NULL,
            description TEXT,
            total_elements INTEGER DEFAULT 0,
            FOREIGN KEY (domain_id) REFERENCES domains(domain_id)
        )
        """)

        # 3. å…ƒç´ è¡¨ï¼ˆæ ¸å¿ƒï¼‰
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS elements (
            element_id TEXT PRIMARY KEY,
            domain_id TEXT NOT NULL,
            category_id TEXT NOT NULL,

            -- åŸºæœ¬ä¿¡æ¯
            name TEXT NOT NULL,
            chinese_name TEXT,

            -- Promptæ¨¡æ¿
            ai_prompt_template TEXT NOT NULL,
            keywords TEXT,  -- JSON array

            -- è¯„åˆ†å’Œå…ƒæ•°æ®
            reusability_score REAL CHECK(reusability_score >= 0 AND reusability_score <= 10),
            confidence_score REAL,

            -- æº¯æº
            source_prompts TEXT,  -- JSON array: [1, 5, 10]
            learned_from TEXT,    -- 'manual' or 'auto_learner'

            -- æ‰©å±•å­—æ®µ
            metadata TEXT,        -- JSON: å…¶ä»–è‡ªå®šä¹‰å­—æ®µ

            -- æ—¶é—´æˆ³
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

            FOREIGN KEY (domain_id) REFERENCES domains(domain_id),
            FOREIGN KEY (category_id) REFERENCES categories(category_id)
        )
        """)

        # 4. æ ‡ç­¾è¡¨
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS tags (
            tag_id INTEGER PRIMARY KEY AUTOINCREMENT,
            tag_name TEXT UNIQUE NOT NULL,
            tag_type TEXT,
            usage_count INTEGER DEFAULT 0,
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
        """)

        # 5. å…ƒç´ -æ ‡ç­¾å…³è”è¡¨ï¼ˆå¤šå¯¹å¤šï¼‰
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS element_tags (
            element_id TEXT NOT NULL,
            tag_id INTEGER NOT NULL,
            PRIMARY KEY (element_id, tag_id),
            FOREIGN KEY (element_id) REFERENCES elements(element_id) ON DELETE CASCADE,
            FOREIGN KEY (tag_id) REFERENCES tags(tag_id) ON DELETE CASCADE
        )
        """)

        # 6. æ¥æºPromptè¡¨
        cursor.execute("""
        CREATE TABLE IF NOT EXISTS source_prompts (
            prompt_id INTEGER PRIMARY KEY,
            original_prompt TEXT NOT NULL,
            prompt_length INTEGER,
            theme TEXT,
            domain_classification TEXT,  -- JSON: ['portrait', 'product']
            learned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            quality_score REAL,
            complexity TEXT,
            learning_status TEXT DEFAULT 'pending',
            extracted_elements_count INTEGER DEFAULT 0
        )
        """)

        # åˆ›å»ºç´¢å¼•
        cursor.execute("CREATE INDEX IF NOT EXISTS idx_elements_domain ON elements(domain_id)")
        cursor.execute("CREATE INDEX IF NOT EXISTS idx_elements_category ON elements(category_id)")
        cursor.execute("CREATE INDEX IF NOT EXISTS idx_elements_reusability ON elements(reusability_score DESC)")
        cursor.execute("CREATE INDEX IF NOT EXISTS idx_tags_name ON tags(tag_name)")
        cursor.execute("CREATE INDEX IF NOT EXISTS idx_element_tags_tag ON element_tags(tag_id)")

        self.conn.commit()

        # åˆå§‹åŒ–7ä¸ªé¢†åŸŸ
        self._init_domains()

    def _init_domains(self):
        """åˆå§‹åŒ–7ä¸ªé¢†åŸŸ"""
        domains = [
            ("portrait", "äººåƒæ‘„å½±", "Portrait photography elements"),
            ("interior", "å®¤å†…è®¾è®¡", "Interior design elements"),
            ("product", "äº§å“æ‘„å½±", "Product photography elements"),
            ("design", "å¹³é¢è®¾è®¡", "Graphic design elements"),
            ("art", "è‰ºæœ¯é£Žæ ¼", "Art style elements"),
            ("video", "è§†é¢‘ç”Ÿæˆ", "Video generation elements"),
            ("common", "é€šç”¨æ‘„å½±", "Common photography techniques")
        ]

        cursor = self.conn.cursor()
        for domain_id, name, desc in domains:
            cursor.execute("""
                INSERT OR IGNORE INTO domains (domain_id, name, description)
                VALUES (?, ?, ?)
            """, (domain_id, name, desc))

        self.conn.commit()

    # ========== æ ¸å¿ƒæ“ä½œæ–¹æ³• ==========

    def add_element(self,
                   element_id: str,
                   domain_id: str,
                   category_id: str,
                   name: str,
                   ai_prompt_template: str,
                   chinese_name: Optional[str] = None,
                   keywords: Optional[List[str]] = None,
                   tags: Optional[List[str]] = None,
                   reusability_score: Optional[float] = None,
                   source_prompts: Optional[List[int]] = None,
                   learned_from: str = "manual",
                   metadata: Optional[Dict] = None) -> bool:
        """
        æ·»åŠ å…ƒç´ åˆ°åº“ä¸­

        Args:
            element_id: å…ƒç´ IDï¼Œå¦‚ 'portrait_facial_001'
            domain_id: é¢†åŸŸIDï¼Œå¦‚ 'portrait'
            category_id: ç±»åˆ«IDï¼Œå¦‚ 'facial_features'
            name: å…ƒç´ åç§°ï¼Œå¦‚ 'large_expressive_almond'
            ai_prompt_template: AIæç¤ºè¯æ¨¡æ¿
            chinese_name: ä¸­æ–‡åç§°
            keywords: å…³é”®è¯åˆ—è¡¨
            tags: æ ‡ç­¾åˆ—è¡¨
            reusability_score: å¤ç”¨æ€§è¯„åˆ† (0-10)
            source_prompts: æ¥æºPrompt IDåˆ—è¡¨
            learned_from: å­¦ä¹ æ–¹å¼ ('manual' or 'auto_learner')
            metadata: å…¶ä»–å…ƒæ•°æ®

        Returns:
            bool: æ˜¯å¦æ·»åŠ æˆåŠŸ
        """
        cursor = self.conn.cursor()

        try:
            # ç¡®ä¿categoryå­˜åœ¨
            cursor.execute("""
                INSERT OR IGNORE INTO categories (category_id, domain_id, name)
                VALUES (?, ?, ?)
            """, (category_id, domain_id, category_id.replace('_', ' ').title()))

            # æ’å…¥å…ƒç´ 
            cursor.execute("""
                INSERT INTO elements (
                    element_id, domain_id, category_id, name, chinese_name,
                    ai_prompt_template, keywords, reusability_score,
                    source_prompts, learned_from, metadata
                ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
            """, (
                element_id,
                domain_id,
                category_id,
                name,
                chinese_name,
                ai_prompt_template,
                json.dumps(keywords or [], ensure_ascii=False),
                reusability_score,
                json.dumps(source_prompts or [], ensure_ascii=False),
                learned_from,
                json.dumps(metadata or {}, ensure_ascii=False)
            ))

            # æ·»åŠ æ ‡ç­¾
            if tags:
                for tag_name in tags:
                    self._add_tag_to_element(element_id, tag_name)

            # æ›´æ–°ç»Ÿè®¡
            self._update_counts(domain_id, category_id)

            self.conn.commit()
            return True

        except sqlite3.IntegrityError as e:
            print(f"âŒ æ·»åŠ å…ƒç´ å¤±è´¥: {e}")
            self.conn.rollback()
            return False

    def save_source_prompt(self,
                          prompt_id: int,
                          original_prompt: str,
                          theme: Optional[str] = None,
                          domain_classification: Optional[str] = None,
                          quality_score: Optional[float] = None,
                          complexity: Optional[str] = None,
                          extracted_elements_count: int = 0) -> bool:
        """
        ä¿å­˜å­¦ä¹ çš„æºPromptè®°å½•åˆ°source_promptsè¡¨

        Args:
            prompt_id: Prompt ID
            original_prompt: åŽŸå§‹æç¤ºè¯æ–‡æœ¬
            theme: ä¸»é¢˜
            domain_classification: é¢†åŸŸåˆ†ç±»ï¼ˆJSONæ ¼å¼ï¼‰
            quality_score: è´¨é‡è¯„åˆ†
            complexity: å¤æ‚åº¦ï¼ˆ'simple', 'medium', 'complex'ï¼‰
            extracted_elements_count: æå–çš„å…ƒç´ æ•°é‡

        Returns:
            bool: æ˜¯å¦ä¿å­˜æˆåŠŸ
        """
        cursor = self.conn.cursor()

        try:
            cursor.execute("""
                INSERT INTO source_prompts (
                    prompt_id, original_prompt, prompt_length, theme,
                    domain_classification, quality_score, complexity,
                    learning_status, extracted_elements_count
                ) VALUES (?, ?, ?, ?, ?, ?, ?, 'completed', ?)
            """, (
                prompt_id,
                original_prompt,
                len(original_prompt),
                theme,
                domain_classification,
                quality_score,
                complexity,
                extracted_elements_count
            ))

            self.conn.commit()
            return True

        except sqlite3.IntegrityError as e:
            # Prompt IDå·²å­˜åœ¨ï¼Œæ›´æ–°è®°å½•
            try:
                cursor.execute("""
                    UPDATE source_prompts
                    SET extracted_elements_count = extracted_elements_count + ?,
                        learning_status = 'completed'
                    WHERE prompt_id = ?
                """, (extracted_elements_count, prompt_id))
                self.conn.commit()
                return True
            except Exception as update_error:
                print(f"âŒ æ›´æ–°å­¦ä¹ è®°å½•å¤±è´¥: {update_error}")
                self.conn.rollback()
                return False

    def _add_tag_to_element(self, element_id: str, tag_name: str):
        """ä¸ºå…ƒç´ æ·»åŠ æ ‡ç­¾"""
        cursor = self.conn.cursor()

        # ç¡®ä¿æ ‡ç­¾å­˜åœ¨
        cursor.execute("""
            INSERT OR IGNORE INTO tags (tag_name)
            VALUES (?)
        """, (tag_name,))

        # èŽ·å–tag_id
        cursor.execute("SELECT tag_id FROM tags WHERE tag_name = ?", (tag_name,))
        tag_id = cursor.fetchone()[0]

        # å…³è”å…ƒç´ å’Œæ ‡ç­¾
        cursor.execute("""
            INSERT OR IGNORE INTO element_tags (element_id, tag_id)
            VALUES (?, ?)
        """, (element_id, tag_id))

        # æ›´æ–°æ ‡ç­¾ä½¿ç”¨è®¡æ•°
        cursor.execute("""
            UPDATE tags SET usage_count = usage_count + 1
            WHERE tag_id = ?
        """, (tag_id,))

    def _update_counts(self, domain_id: str, category_id: str):
        """æ›´æ–°é¢†åŸŸå’Œç±»åˆ«çš„å…ƒç´ è®¡æ•°"""
        cursor = self.conn.cursor()

        # æ›´æ–°categoryè®¡æ•°
        cursor.execute("""
            UPDATE categories
            SET total_elements = (
                SELECT COUNT(*) FROM elements WHERE category_id = ?
            )
            WHERE category_id = ?
        """, (category_id, category_id))

        # æ›´æ–°domainè®¡æ•°
        cursor.execute("""
            UPDATE domains
            SET total_elements = (
                SELECT COUNT(*) FROM elements WHERE domain_id = ?
            )
            WHERE domain_id = ?
        """, (domain_id, domain_id))

    # ========== æŸ¥è¯¢æ–¹æ³• ==========

    def search_by_tags(self, tags: List[str], require_all: bool = False) -> List[Dict]:
        """
        æŒ‰æ ‡ç­¾æœç´¢å…ƒç´ 

        Args:
            tags: æ ‡ç­¾åˆ—è¡¨
            require_all: æ˜¯å¦è¦æ±‚åŒ…å«æ‰€æœ‰æ ‡ç­¾ï¼ˆANDé€»è¾‘ï¼‰ï¼Œå¦åˆ™ä¸ºORé€»è¾‘

        Returns:
            å…ƒç´ åˆ—è¡¨
        """
        cursor = self.conn.cursor()

        if require_all:
            # ANDé€»è¾‘ï¼šå¿…é¡»åŒ…å«æ‰€æœ‰æ ‡ç­¾
            query = """
                SELECT DISTINCT e.* FROM elements e
                WHERE element_id IN (
                    SELECT element_id FROM element_tags et
                    JOIN tags t ON et.tag_id = t.tag_id
                    WHERE t.tag_name IN ({})
                    GROUP BY element_id
                    HAVING COUNT(DISTINCT t.tag_name) = ?
                )
            """.format(','.join(['?' for _ in tags]))
            cursor.execute(query, tags + [len(tags)])
        else:
            # ORé€»è¾‘ï¼šåŒ…å«ä»»æ„æ ‡ç­¾
            query = """
                SELECT DISTINCT e.* FROM elements e
                JOIN element_tags et ON e.element_id = et.element_id
                JOIN tags t ON et.tag_id = t.tag_id
                WHERE t.tag_name IN ({})
            """.format(','.join(['?' for _ in tags]))
            cursor.execute(query, tags)

        return [self._row_to_dict(row) for row in cursor.fetchall()]

    def search_by_domain(self,
                        domain_id: str,
                        category_id: Optional[str] = None,
                        min_reusability: Optional[float] = None,
                        limit: Optional[int] = None) -> List[Dict]:
        """
        æŒ‰é¢†åŸŸæœç´¢å…ƒç´ 

        Args:
            domain_id: é¢†åŸŸID
            category_id: å¯é€‰çš„ç±»åˆ«ID
            min_reusability: æœ€å°å¤ç”¨æ€§è¯„åˆ†
            limit: é™åˆ¶è¿”å›žæ•°é‡

        Returns:
            å…ƒç´ åˆ—è¡¨
        """
        cursor = self.conn.cursor()

        query = "SELECT * FROM elements WHERE domain_id = ?"
        params = [domain_id]

        if category_id:
            query += " AND category_id = ?"
            params.append(category_id)

        if min_reusability is not None:
            query += " AND reusability_score >= ?"
            params.append(min_reusability)

        query += " ORDER BY reusability_score DESC"

        if limit:
            query += " LIMIT ?"
            params.append(limit)

        cursor.execute(query, params)
        return [self._row_to_dict(row) for row in cursor.fetchall()]

    def get_element(self, element_id: str) -> Optional[Dict]:
        """èŽ·å–å•ä¸ªå…ƒç´ """
        cursor = self.conn.cursor()
        cursor.execute("SELECT * FROM elements WHERE element_id = ?", (element_id,))
        row = cursor.fetchone()
        return self._row_to_dict(row) if row else None

    def get_element_tags(self, element_id: str) -> List[str]:
        """èŽ·å–å…ƒç´ çš„æ‰€æœ‰æ ‡ç­¾"""
        cursor = self.conn.cursor()
        cursor.execute("""
            SELECT t.tag_name FROM tags t
            JOIN element_tags et ON t.tag_id = et.tag_id
            WHERE et.element_id = ?
        """, (element_id,))
        return [row[0] for row in cursor.fetchall()]

    def _row_to_dict(self, row: sqlite3.Row) -> Dict:
        """å°†æ•°æ®åº“è¡Œè½¬æ¢ä¸ºå­—å…¸"""
        if not row:
            return {}

        result = dict(row)

        # è§£æžJSONå­—æ®µ
        if result.get('keywords'):
            result['keywords'] = json.loads(result['keywords'])
        if result.get('source_prompts'):
            result['source_prompts'] = json.loads(result['source_prompts'])
        if result.get('metadata'):
            result['metadata'] = json.loads(result['metadata'])

        # æ·»åŠ æ ‡ç­¾
        result['tags'] = self.get_element_tags(result['element_id'])

        return result

    # ========== ç»Ÿè®¡æ–¹æ³• ==========

    def get_stats(self) -> Dict:
        """èŽ·å–åº“çš„ç»Ÿè®¡ä¿¡æ¯"""
        cursor = self.conn.cursor()

        stats = {}

        # æ€»ä½“ç»Ÿè®¡
        cursor.execute("SELECT COUNT(*) FROM elements")
        stats['total_elements'] = cursor.fetchone()[0]

        cursor.execute("SELECT COUNT(*) FROM tags")
        stats['total_tags'] = cursor.fetchone()[0]

        # å„é¢†åŸŸç»Ÿè®¡
        cursor.execute("""
            SELECT d.domain_id, d.name, d.total_elements
            FROM domains d
            ORDER BY d.total_elements DESC
        """)
        stats['domains'] = [
            {'domain_id': row[0], 'name': row[1], 'total_elements': row[2]}
            for row in cursor.fetchall()
        ]

        # çƒ­é—¨æ ‡ç­¾
        cursor.execute("""
            SELECT tag_name, usage_count
            FROM tags
            ORDER BY usage_count DESC
            LIMIT 20
        """)
        stats['top_tags'] = [
            {'tag': row[0], 'count': row[1]}
            for row in cursor.fetchall()
        ]

        return stats

    # ========== å¯¼å‡º/å¯¼å…¥ JSON ==========

    def export_to_json(self, output_path: str) -> bool:
        """
        å¯¼å‡ºæ•°æ®åº“ä¸ºJSONæ ¼å¼ï¼ˆç”¨äºŽç‰ˆæœ¬æŽ§åˆ¶ï¼‰

        Args:
            output_path: è¾“å‡ºJSONæ–‡ä»¶è·¯å¾„

        Returns:
            æ˜¯å¦å¯¼å‡ºæˆåŠŸ
        """
        cursor = self.conn.cursor()

        try:
            library = {
                "library_metadata": {
                    "name": "Universal Elements Library",
                    "version": "1.0",
                    "architecture": "unified",
                    "exported_at": datetime.now().isoformat(),
                    "total_elements": 0,
                    "total_domains": 0
                },
                "domains": {},
                "tag_index": {},
                "source_prompts": []
            }

            # å¯¼å‡ºå„é¢†åŸŸ
            cursor.execute("SELECT * FROM domains WHERE total_elements > 0")
            domains_data = cursor.fetchall()

            library["library_metadata"]["total_domains"] = len(domains_data)

            for domain_row in domains_data:
                domain_id = domain_row['domain_id']

                library["domains"][domain_id] = {
                    "domain_metadata": {
                        "name": domain_row['name'],
                        "total_elements": domain_row['total_elements']
                    },
                    "categories": {}
                }

                # èŽ·å–è¯¥é¢†åŸŸçš„æ‰€æœ‰ç±»åˆ«
                cursor.execute("""
                    SELECT DISTINCT category_id FROM elements
                    WHERE domain_id = ?
                """, (domain_id,))

                for cat_row in cursor.fetchall():
                    category_id = cat_row['category_id']

                    # èŽ·å–è¯¥ç±»åˆ«çš„æ‰€æœ‰å…ƒç´ 
                    cursor.execute("""
                        SELECT * FROM elements
                        WHERE domain_id = ? AND category_id = ?
                    """, (domain_id, category_id))

                    category_elements = {}
                    for elem_row in cursor.fetchall():
                        element = self._row_to_dict(elem_row)
                        category_elements[element['name']] = element
                        library["library_metadata"]["total_elements"] += 1

                    if category_elements:
                        library["domains"][domain_id]["categories"][category_id] = category_elements

            # å¯¼å‡ºæ ‡ç­¾ç´¢å¼•
            cursor.execute("SELECT tag_name, tag_id FROM tags")
            for tag_row in cursor.fetchall():
                tag_name = tag_row['tag_name']
                tag_id = tag_row['tag_id']

                cursor.execute("""
                    SELECT element_id FROM element_tags WHERE tag_id = ?
                """, (tag_id,))

                library["tag_index"][tag_name] = [row[0] for row in cursor.fetchall()]

            # å¯¼å‡ºæ¥æºPrompts
            cursor.execute("SELECT * FROM source_prompts")
            for prompt_row in cursor.fetchall():
                library["source_prompts"].append(dict(prompt_row))

            # å†™å…¥æ–‡ä»¶
            output_path = Path(output_path)
            output_path.parent.mkdir(parents=True, exist_ok=True)

            with open(output_path, 'w', encoding='utf-8') as f:
                json.dump(library, f, indent=2, ensure_ascii=False)

            print(f"âœ… å¯¼å‡ºå®Œæˆ: {output_path}")
            print(f"   - {library['library_metadata']['total_elements']} ä¸ªå…ƒç´ ")
            print(f"   - {library['library_metadata']['total_domains']} ä¸ªé¢†åŸŸ")
            print(f"   - {len(library['tag_index'])} ä¸ªæ ‡ç­¾")

            return True

        except Exception as e:
            print(f"âŒ å¯¼å‡ºå¤±è´¥: {e}")
            return False

    def import_from_json(self, json_path: str, clear_existing: bool = False) -> bool:
        """
        ä»ŽJSONå¯¼å…¥åˆ°æ•°æ®åº“

        Args:
            json_path: JSONæ–‡ä»¶è·¯å¾„
            clear_existing: æ˜¯å¦æ¸…ç©ºçŽ°æœ‰æ•°æ®

        Returns:
            æ˜¯å¦å¯¼å…¥æˆåŠŸ
        """
        try:
            with open(json_path, 'r', encoding='utf-8') as f:
                library = json.load(f)

            if clear_existing:
                self._clear_all_data()

            imported_count = 0

            # å¯¼å…¥å„é¢†åŸŸçš„å…ƒç´ 
            for domain_id, domain_data in library.get("domains", {}).items():
                for category_id, category_elements in domain_data.get("categories", {}).items():
                    for element_name, element in category_elements.items():
                        if self.add_element(
                            element_id=element.get('element_id', f"{domain_id}_{category_id}_{imported_count:03d}"),
                            domain_id=domain_id,
                            category_id=category_id,
                            name=element.get('name', element_name),
                            chinese_name=element.get('chinese_name'),
                            ai_prompt_template=element.get('ai_prompt_template', ''),
                            keywords=element.get('keywords', []),
                            tags=element.get('tags', []),
                            reusability_score=element.get('reusability_score'),
                            source_prompts=element.get('source_prompts', []),
                            learned_from=element.get('learned_from', 'imported'),
                            metadata=element.get('metadata')
                        ):
                            imported_count += 1

            print(f"âœ… å¯¼å…¥å®Œæˆ: {imported_count} ä¸ªå…ƒç´ ")
            return True

        except Exception as e:
            print(f"âŒ å¯¼å…¥å¤±è´¥: {e}")
            return False

    def _clear_all_data(self):
        """æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼ˆä¿ç•™è¡¨ç»“æž„ï¼‰"""
        cursor = self.conn.cursor()
        cursor.execute("DELETE FROM element_tags")
        cursor.execute("DELETE FROM elements")
        cursor.execute("DELETE FROM tags")
        cursor.execute("DELETE FROM categories")
        cursor.execute("DELETE FROM source_prompts")
        cursor.execute("UPDATE domains SET total_elements = 0")
        self.conn.commit()

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.conn.close()


# ========== ä½¿ç”¨ç¤ºä¾‹ ==========
if __name__ == "__main__":
    # åˆ›å»ºæ•°æ®åº“
    db = ElementDB('extracted_results/elements.db')

    print("=" * 60)
    print("Universal Elements Library - Database Test")
    print("=" * 60)

    # æµ‹è¯•æ·»åŠ å…ƒç´ 
    print("\n1. æ·»åŠ æµ‹è¯•å…ƒç´ ...")
    db.add_element(
        element_id='product_type_001',
        domain_id='product',
        category_id='product_types',
        name='collector_edition_book',
        chinese_name='æ”¶è—ç‰ˆä¹¦ç±',
        ai_prompt_template='premium collector\'s edition book, luxury binding, Italian calfskin cover',
        keywords=['collector\'s edition', 'premium book', 'luxury binding'],
        tags=['product', 'book', 'luxury', 'collectible'],
        reusability_score=7.5,
        source_prompts=[1]
    )

    db.add_element(
        element_id='design_layout_001',
        domain_id='design',
        category_id='layout_systems',
        name='bento_grid',
        chinese_name='Bentoç½‘æ ¼å¸ƒå±€',
        ai_prompt_template='modern Bento grid layout, modular card-based design, asymmetric arrangement',
        keywords=['bento grid', 'modular', 'card-based'],
        tags=['layout', 'grid', 'modern', 'ui'],
        reusability_score=8.5,
        source_prompts=[2]
    )

    print("âœ… å…ƒç´ å·²æ·»åŠ ")

    # æµ‹è¯•æœç´¢
    print("\n2. æŒ‰æ ‡ç­¾æœç´¢ ['luxury']...")
    results = db.search_by_tags(['luxury'])
    for elem in results:
        print(f"   - {elem['element_id']}: {elem['chinese_name']}")

    print("\n3. æŒ‰é¢†åŸŸæœç´¢ [product]...")
    results = db.search_by_domain('product')
    for elem in results:
        print(f"   - {elem['element_id']}: {elem['name']} (å¤ç”¨æ€§: {elem['reusability_score']})")

    # ç»Ÿè®¡
    print("\n4. åº“ç»Ÿè®¡ä¿¡æ¯:")
    stats = db.get_stats()
    print(f"   æ€»å…ƒç´ æ•°: {stats['total_elements']}")
    print(f"   æ€»æ ‡ç­¾æ•°: {stats['total_tags']}")
    print(f"\n   å„é¢†åŸŸ:")
    for domain in stats['domains']:
        if domain['total_elements'] > 0:
            print(f"   - {domain['name']}: {domain['total_elements']} ä¸ªå…ƒç´ ")

    # å¯¼å‡º
    print("\n5. å¯¼å‡ºä¸ºJSON...")
    db.export_to_json('extracted_results/universal_elements_export.json')

    db.close()
    print("\nâœ… æ•°æ®åº“æµ‹è¯•å®Œæˆ")



================================================
FILE: framework_loader.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ¡†æž¶åŠ è½½å™¨å’Œæ¡†æž¶é©±åŠ¨çš„æç¤ºè¯ç”Ÿæˆå™¨
Framework Loader and Framework-Driven Prompt Generator
"""

import yaml
import os
from typing import Dict, List, Optional, Any


class FrameworkLoader:
    """æ¡†æž¶åŠ è½½å™¨"""

    @staticmethod
    def load(framework_path: str = "prompt_framework.yaml") -> Dict:
        """
        åŠ è½½æ¡†æž¶é…ç½®æ–‡ä»¶

        å‚æ•°:
            framework_path: æ¡†æž¶é…ç½®æ–‡ä»¶è·¯å¾„

        è¿”å›ž:
            æ¡†æž¶é…ç½®å­—å…¸
        """
        if not os.path.exists(framework_path):
            raise FileNotFoundError(f"æ¡†æž¶é…ç½®æ–‡ä»¶ä¸å­˜åœ¨: {framework_path}")

        with open(framework_path, 'r', encoding='utf-8') as f:
            framework = yaml.safe_load(f)

        print(f"âœ“ åŠ è½½æ¡†æž¶: {framework['description']}")
        print(f"  ç‰ˆæœ¬: {framework['framework_version']}")
        print(f"  ç±»åˆ«æ•°: {len(framework['categories'])}")

        return framework

    @staticmethod
    def get_all_fields(framework: Dict) -> Dict[str, Dict]:
        """
        èŽ·å–æ¡†æž¶ä¸­æ‰€æœ‰çš„å­—æ®µå®šä¹‰

        è¿”å›ž:
            {
                'subject.gender': {...},
                'styling.makeup': {...},
                ...
            }
        """
        all_fields = {}

        for category_name, category_config in framework['categories'].items():
            for field_name, field_config in category_config['fields'].items():
                full_field_name = f"{category_name}.{field_name}"
                all_fields[full_field_name] = {
                    'category': category_name,
                    'field': field_name,
                    **field_config
                }

        return all_fields

    @staticmethod
    def get_required_fields(framework: Dict) -> List[str]:
        """èŽ·å–æ‰€æœ‰å¿…é€‰å­—æ®µ"""
        required = []

        for category_name, category_config in framework['categories'].items():
            if category_config.get('required'):
                for field_name, field_config in category_config['fields'].items():
                    if field_config.get('required'):
                        required.append(f"{category_name}.{field_name}")

        return required

    @staticmethod
    def apply_dependencies(intent: Dict, framework: Dict) -> Dict:
        """
        åº”ç”¨æ¡†æž¶çš„ä¾èµ–è§„åˆ™

        å‚æ•°:
            intent: åŽŸå§‹intent
            framework: æ¡†æž¶é…ç½®

        è¿”å›ž:
            åº”ç”¨è§„åˆ™åŽçš„intent
        """
        updated_intent = intent.copy()

        dependencies = framework.get('dependencies', [])

        for rule in dependencies:
            # æ£€æŸ¥æ¡ä»¶æ˜¯å¦æ»¡è¶³
            if 'when' in rule:
                conditions_met = True

                for condition_field, condition_value in rule['when'].items():
                    category, field = condition_field.split('.')
                    actual_value = updated_intent.get(category, {}).get(field)

                    if actual_value != condition_value:
                        conditions_met = False
                        break

                # å¦‚æžœæ¡ä»¶æ»¡è¶³ï¼Œåº”ç”¨thenè§„åˆ™
                if conditions_met and 'then' in rule:
                    print(f"âœ“ åº”ç”¨ä¾èµ–è§„åˆ™: {rule.get('name', 'æœªå‘½å')}")

                    for then_field, then_value in rule['then'].items():
                        category, field = then_field.split('.')

                        if category not in updated_intent:
                            updated_intent[category] = {}

                        updated_intent[category][field] = then_value
                        print(f"  â†’ è®¾ç½® {then_field} = {then_value}")

        return updated_intent

    @staticmethod
    def validate_intent(intent: Dict, framework: Dict) -> List[Dict]:
        """
        éªŒè¯intentçš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§

        è¿”å›ž:
            é—®é¢˜åˆ—è¡¨
        """
        issues = []

        validation = framework.get('validation', {})

        # æ£€æŸ¥å¿…é€‰å­—æ®µ
        required_fields = validation.get('required_fields', [])
        for req in required_fields:
            field_path = req['field']
            category, field = field_path.split('.')

            if category not in intent or field not in intent[category]:
                issues.append({
                    'type': 'missing_required',
                    'field': field_path,
                    'severity': 'error',
                    'message': req['error_message']
                })

        # æ£€æŸ¥ä¸€è‡´æ€§
        consistency_checks = validation.get('consistency_checks', [])
        for check in consistency_checks:
            if 'when' in check:
                # æ£€æŸ¥æ¡ä»¶
                for condition_field, condition_values in check['when'].items():
                    category, field = condition_field.split('.')
                    actual_value = intent.get(category, {}).get(field)

                    # å¦‚æžœå€¼åœ¨æ¡ä»¶åˆ—è¡¨ä¸­ï¼Œè¯´æ˜Žæœ‰é—®é¢˜
                    if isinstance(condition_values, list):
                        if actual_value in condition_values:
                            issues.append({
                                'type': 'consistency_check',
                                'name': check['name'],
                                'severity': check['severity'],
                                'message': check['message'],
                                'suggestion': check.get('suggestion', '')
                            })
                    else:
                        if actual_value == condition_values:
                            # æ£€æŸ¥å…¶ä»–æ¡ä»¶å­—æ®µ
                            pass

        return issues


class FrameworkDrivenGenerator:
    """æ¡†æž¶é©±åŠ¨çš„ç”Ÿæˆå™¨"""

    def __init__(self, db_path: str = "extracted_results/elements.db",
                 framework_path: str = "prompt_framework.yaml"):
        """
        åˆå§‹åŒ–

        å‚æ•°:
            db_path: æ•°æ®åº“è·¯å¾„
            framework_path: æ¡†æž¶é…ç½®æ–‡ä»¶è·¯å¾„
        """
        # åŠ è½½æ¡†æž¶
        self.framework = FrameworkLoader.load(framework_path)

        # åŠ è½½IntelligentGeneratorï¼ˆç”¨äºŽæ•°æ®åº“æŸ¥è¯¢ï¼‰
        from intelligent_generator import IntelligentGenerator
        self.generator = IntelligentGenerator(db_path)

    def generate_by_framework(self, intent: Dict) -> Dict:
        """
        æ ¹æ®æ¡†æž¶å’Œintentç”Ÿæˆæç¤ºè¯

        å‚æ•°:
            intent: ç”¨æˆ·æ„å›¾ï¼ˆå¯èƒ½ä¸å®Œæ•´ï¼‰

        è¿”å›ž:
            {
                'intent': å®Œæ•´çš„intent,
                'elements': æŸ¥è¯¢åˆ°çš„å…ƒç´ åˆ—è¡¨,
                'prompt': æœ€ç»ˆæç¤ºè¯,
                'issues': é—®é¢˜åˆ—è¡¨,
                'fixes': ä¿®æ­£è¯´æ˜Ž
            }
        """
        print("\n" + "="*80)
        print("æ¡†æž¶é©±åŠ¨ç”Ÿæˆ")
        print("="*80)

        # æ­¥éª¤1ï¼šåº”ç”¨ä¾èµ–è§„åˆ™ï¼Œè¡¥å…¨intent
        print("\nðŸ“‹ æ­¥éª¤1ï¼šåº”ç”¨æ¡†æž¶ä¾èµ–è§„åˆ™")
        print("-"*80)

        complete_intent = FrameworkLoader.apply_dependencies(intent, self.framework)

        # æ­¥éª¤2ï¼šéªŒè¯intent
        print("\nâœ“ æ­¥éª¤2ï¼šéªŒè¯Intent")
        print("-"*80)

        validation_issues = FrameworkLoader.validate_intent(complete_intent, self.framework)

        if validation_issues:
            print(f"âš ï¸ å‘çŽ° {len(validation_issues)} ä¸ªéªŒè¯é—®é¢˜:")
            for issue in validation_issues:
                print(f"  - [{issue['severity']}] {issue['message']}")
        else:
            print("âœ“ IntentéªŒè¯é€šè¿‡")

        # æ­¥éª¤3ï¼šæ ¹æ®æ¡†æž¶æŸ¥è¯¢æ•°æ®åº“
        print("\nðŸ” æ­¥éª¤3ï¼šæ ¹æ®æ¡†æž¶æŸ¥è¯¢æ•°æ®åº“")
        print("-"*80)

        elements = self.query_by_framework(complete_intent)

        print(f"âœ“ æŸ¥è¯¢åˆ° {len(elements)} ä¸ªå…ƒç´ ")

        # æ­¥éª¤4ï¼šä¸€è‡´æ€§æ£€æŸ¥
        print("\nâœ“ æ­¥éª¤4ï¼šä¸€è‡´æ€§æ£€æŸ¥")
        print("-"*80)

        consistency_issues = self.generator.check_consistency(elements)

        fixes_applied = []
        if consistency_issues:
            print(f"âš ï¸ å‘çŽ° {len(consistency_issues)} ä¸ªä¸€è‡´æ€§é—®é¢˜")
            elements, fixes_applied = self.generator.resolve_conflicts(elements, consistency_issues)
            for fix in fixes_applied:
                print(f"  {fix}")
        else:
            print("âœ“ æ²¡æœ‰å‘çŽ°ä¸€è‡´æ€§é—®é¢˜")

        # æ­¥éª¤5ï¼šç”Ÿæˆæç¤ºè¯
        print("\nâœ¨ æ­¥éª¤5ï¼šç”Ÿæˆæœ€ç»ˆæç¤ºè¯")
        print("-"*80)

        prompt = self.generator.compose_prompt(elements, mode='auto', keywords_limit=3)

        # æ­¥éª¤6ï¼šå®Œæ•´æ€§æ£€æŸ¥
        print("\nðŸŽ¯ æ­¥éª¤6ï¼šå®Œæ•´æ€§æ£€æŸ¥")
        print("-"*80)

        completeness_issues = self.generator.check_completeness(complete_intent, prompt)

        if completeness_issues:
            print(f"âš ï¸ å‘çŽ° {len(completeness_issues)} ä¸ªç¼ºå¤±çš„éœ€æ±‚:")
            for item in completeness_issues:
                print(f"  - {item['description']}")
        else:
            print("âœ“ æç¤ºè¯æ»¡è¶³æ‰€æœ‰ç”¨æˆ·è¦æ±‚")

        return {
            'intent': complete_intent,
            'elements': elements,
            'prompt': prompt,
            'validation_issues': validation_issues,
            'consistency_issues': consistency_issues,
            'completeness_issues': completeness_issues,
            'fixes': fixes_applied
        }

    def query_all_candidates_by_framework(self, intent: Dict) -> Dict[str, List[Dict]]:
        """
        æŸ¥è¯¢æ‰€æœ‰å€™é€‰å…ƒç´ ï¼ˆä¾›SKILLåˆ†æžé€‰æ‹©ï¼‰

        è¿”å›ž:
            {
                'makeup': [æ‰€æœ‰makeupå…ƒç´ åˆ—è¡¨],
                'lighting': [æ‰€æœ‰lightingå…ƒç´ åˆ—è¡¨],
                ...
            }
        """
        candidates = {}

        # éåŽ†æ¡†æž¶çš„æ‰€æœ‰category
        for category_name, category_config in self.framework['categories'].items():

            # è·³è¿‡ä¸éœ€è¦æŸ¥è¯¢æ•°æ®åº“çš„category
            if category_name in ['subject', 'expression', 'scene', 'technical']:
                continue

            # èŽ·å–è¯¥categoryçš„intentå€¼
            category_intent = intent.get(category_name, {})

            # éåŽ†è¯¥categoryçš„æ‰€æœ‰å­—æ®µ
            for field_name, field_config in category_config['fields'].items():

                # èŽ·å–å­—æ®µå€¼
                field_value = category_intent.get(field_name, field_config.get('default'))

                # å¦‚æžœè¯¥å­—æ®µæœ‰db_categoryï¼ˆéœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼‰
                if 'db_category' in field_config:

                    db_category = field_config['db_category']
                    field_key = f"{category_name}.{field_name}"

                    # æŸ¥è¯¢è¯¥ç±»åˆ«çš„æ‰€æœ‰å…ƒç´ 
                    all_elements = self.generator.get_all_elements_by_category('portrait', db_category)

                    if all_elements:
                        candidates[field_key] = all_elements
                        print(f"âœ“ {field_key}: æŸ¥è¯¢åˆ° {len(all_elements)} ä¸ªå€™é€‰å…ƒç´ ")

        # æŸ¥è¯¢subjectç›¸å…³çš„å€™é€‰
        subject = intent.get('subject', {})

        if 'ethnicity' in subject:
            # çœ¼ç›å€™é€‰
            eye_candidates = self.generator.get_all_elements_by_category('portrait', 'eye_types')
            if eye_candidates:
                candidates['facial.eyes'] = eye_candidates
                print(f"âœ“ facial.eyes: æŸ¥è¯¢åˆ° {len(eye_candidates)} ä¸ªå€™é€‰å…ƒç´ ")

            # å‘è‰²å€™é€‰
            hair_candidates = self.generator.get_all_elements_by_category('portrait', 'hair_colors')
            if hair_candidates:
                candidates['styling.hair_color'] = hair_candidates
                print(f"âœ“ styling.hair_color: æŸ¥è¯¢åˆ° {len(hair_candidates)} ä¸ªå€™é€‰å…ƒç´ ")

        return candidates

    def query_by_framework(self, intent: Dict) -> List[Dict]:
        """
        æ ¹æ®æ¡†æž¶éåŽ†æŸ¥è¯¢æ‰€æœ‰å­—æ®µ

        è¿™æ˜¯æ ¸å¿ƒæ–¹æ³•ï¼šä»£ç ä¸éœ€è¦çŸ¥é“æœ‰å“ªäº›å­—æ®µï¼ŒåªéåŽ†æ¡†æž¶
        """
        elements = []

        # 1. å¤„ç†ä¸»ä½“å±žæ€§ï¼ˆç‰¹æ®Šå¤„ç†ï¼‰
        subject = intent.get('subject', {})

        if 'gender' in subject:
            elem = self.generator.get_element_by_category('portrait', 'gender', subject['gender'])
            if elem:
                elements.append(elem)

        if 'ethnicity' in subject:
            elem = self.generator.get_element_by_category('portrait', 'ethnicity', subject['ethnicity'])
            if elem:
                elements.append(elem)

                # è‡ªåŠ¨é€‰æ‹©åŒ¹é…äººç§çš„çœ¼ç›å’Œå¤´å‘
                ethnicity_name = subject['ethnicity']

                if ethnicity_name == 'East_Asian':
                    eye_elem = self.generator.get_element_by_category('portrait', 'eye_types', 'almond')
                else:
                    eye_elem = self.generator.get_element_by_category('portrait', 'eye_types')

                if eye_elem:
                    elements.append(eye_elem)

                typical_hair = self.generator.knowledge['ethnicity_typical_hair'].get(ethnicity_name, ['black'])
                hair_color_elem = self.generator.get_element_by_category('portrait', 'hair_colors', typical_hair[0])
                if hair_color_elem:
                    elements.append(hair_color_elem)

        if 'age_range' in subject:
            elem = self.generator.get_element_by_category('portrait', 'age_range')
            if elem:
                elements.append(elem)

        # 2. éåŽ†æ¡†æž¶çš„æ‰€æœ‰categoryï¼ˆé™¤äº†subjectå’Œexpressionï¼‰
        for category_name, category_config in self.framework['categories'].items():

            # è·³è¿‡å·²å¤„ç†çš„
            if category_name in ['subject', 'expression', 'scene', 'technical']:
                continue

            # èŽ·å–è¯¥categoryçš„intentå€¼
            category_intent = intent.get(category_name, {})

            # éåŽ†è¯¥categoryçš„æ‰€æœ‰å­—æ®µ
            for field_name, field_config in category_config['fields'].items():

                # èŽ·å–å­—æ®µå€¼
                field_value = category_intent.get(field_name, field_config.get('default'))

                # å¦‚æžœè¯¥å­—æ®µæœ‰db_categoryï¼ˆéœ€è¦æŸ¥è¯¢æ•°æ®åº“ï¼‰
                if 'db_category' in field_config and field_value:

                    # è·³è¿‡é»˜è®¤å€¼æˆ–auto
                    if field_value in ['modern', 'natural', 'auto', 'none']:
                        continue

                    db_category = field_config['db_category']

                    # èŽ·å–æœç´¢å…³é”®è¯
                    keywords_map = field_config.get('search_keywords', {})
                    keywords = keywords_map.get(field_value, [field_value])

                    # æŸ¥è¯¢æ•°æ®åº“
                    elem = None
                    for kw in keywords:
                        elem = self.generator.get_element_by_category('portrait', db_category, kw)
                        if elem:
                            print(f"âœ“ {category_name}.{field_name} = '{field_value}' â†’ æ‰¾åˆ°: '{elem['chinese_name']}'ï¼ˆå…³é”®è¯: {kw}ï¼‰")
                            elements.append(elem)
                            break

                    if not elem:
                        print(f"âš ï¸ {category_name}.{field_name} = '{field_value}' â†’ æœªæ‰¾åˆ°å…ƒç´ ")

        # 3. å¤„ç†å…¶ä»–å›ºå®šç±»åˆ«
        for attr in ['skin_tones', 'skin_textures', 'face_shapes', 'expressions', 'poses']:
            elem = self.generator.get_element_by_category('portrait', attr)
            if elem:
                elements.append(elem)

        # 4. å¤„ç†é£Žæ ¼å…³é”®è¯
        style_keywords = []

        # ä»Žsceneæ”¶é›†å…³é”®è¯
        scene = intent.get('scene', {})
        if 'atmosphere' in scene and scene['atmosphere']:
            style_keywords.append(scene['atmosphere'])

        if 'director_style' in scene and scene['director_style']:
            style_keywords.append(scene['director_style'])

            # åº”ç”¨å¯¼æ¼”é£Žæ ¼çš„å…³é”®è¯æ‰©å±•
            director_keywords = {
                'tsui_hark': ['wuxia', 'martial arts', 'flowing', 'dynamic'],
                'zhang_yimou': ['traditional', 'red', 'gold', 'period drama'],
                'wong_kar_wai': ['nostalgic', 'atmospheric', 'saturated colors']
            }
            if scene['director_style'] in director_keywords:
                style_keywords.extend(director_keywords[scene['director_style']])

        # ä»Žeraæ”¶é›†å…³é”®è¯
        if 'era' in scene and scene['era'] != 'modern':
            style_keywords.append(scene['era'])
            if scene['era'] == 'ancient':
                style_keywords.extend(['traditional', 'period', 'classical'])

        if style_keywords:
            style_elements = self.generator.search_style_elements(style_keywords)
            elements.extend(style_elements)

        return elements

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.generator.close()


class ElementSelector:
    """
    å…ƒç´ é€‰æ‹©å™¨ - å®žçŽ°å…¨å±€æœ€ä¼˜é€‰æ‹©ç­–ç•¥

    åŠŸèƒ½ï¼š
    - ä»Žå€™é€‰å…ƒç´ åˆ—è¡¨ä¸­é€‰æ‹©æœ€åŒ¹é…ç”¨æˆ·éœ€æ±‚çš„å…ƒç´ 
    - ä½¿ç”¨å¤šç»´åº¦è¯„åˆ†æœºåˆ¶ï¼ˆå…³é”®è¯åŒ¹é… + è´¨é‡è¯„åˆ† + è¯­ä¹‰ä¸€è‡´æ€§ï¼‰
    - æ›¿ä»£ç®€å•çš„è´ªå¿ƒç­–ç•¥ï¼ˆç¬¬ä¸€ä¸ªåŒ¹é…å°±é€‰ï¼‰
    """

    @staticmethod
    def calculate_match_score(
        element: Dict,
        user_keywords: List[str],
        user_intent: Dict,
        field_name: str = ""
    ) -> float:
        """
        è®¡ç®—å…ƒç´ ä¸Žç”¨æˆ·éœ€æ±‚çš„åŒ¹é…åº¦

        å‚æ•°:
            element: å€™é€‰å…ƒç´ 
            user_keywords: ç”¨æˆ·éœ€æ±‚å…³é”®è¯åˆ—è¡¨ï¼ˆå¦‚ ['round', 'plump', 'full']ï¼‰
            user_intent: ç”¨æˆ·å®Œæ•´æ„å›¾ï¼ˆç”¨äºŽè¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥ï¼‰
            field_name: å­—æ®µåï¼ˆå¦‚ 'facial.face_shape'ï¼‰

        è¿”å›ž:
            åŒ¹é…åº¦è¯„åˆ†ï¼ˆ0-100ï¼‰

        è¯„åˆ†ç»´åº¦ï¼š
            1. å…³é”®è¯åŒ¹é…åº¦ï¼ˆ60%ï¼‰- ç”¨æˆ·å…³é”®è¯åœ¨å…ƒç´ ä¸­å‡ºçŽ°çš„æ¯”ä¾‹
            2. å…ƒç´ è´¨é‡è¯„åˆ†ï¼ˆ30%ï¼‰- å…ƒç´ çš„reusability_score
            3. è¯­ä¹‰ä¸€è‡´æ€§ï¼ˆ10%ï¼‰- æ£€æµ‹æ˜¯å¦æœ‰è¯­ä¹‰å†²çª
        """
        score = 0.0

        # èŽ·å–å…ƒç´ çš„å…³é”®è¯å’Œæ¨¡æ¿
        elem_keywords_raw = element.get('keywords', '')
        elem_template = element.get('ai_prompt_template', '')
        elem_name = element.get('name', '')

        # å¤„ç†keywordså­—æ®µï¼ˆå¯èƒ½æ˜¯å­—ç¬¦ä¸²æˆ–åˆ—è¡¨ï¼‰
        if isinstance(elem_keywords_raw, list):
            elem_keywords_str = ' '.join(elem_keywords_raw)
        elif isinstance(elem_keywords_raw, str):
            try:
                import json
                keywords_list = json.loads(elem_keywords_raw)
                elem_keywords_str = ' '.join(keywords_list)
            except:
                elem_keywords_str = elem_keywords_raw
        else:
            elem_keywords_str = str(elem_keywords_raw)

        # è½¬ä¸ºå°å†™ä¾¿äºŽåŒ¹é…
        elem_keywords_lower = elem_keywords_str.lower()
        elem_template_lower = elem_template.lower() if elem_template else ''
        elem_name_lower = elem_name.lower() if elem_name else ''

        # ç»´åº¦1ï¼šå…³é”®è¯åŒ¹é…åº¦ï¼ˆ60åˆ†ï¼‰
        if user_keywords:
            matched_count = 0
            total_keywords = len(user_keywords)

            for user_kw in user_keywords:
                user_kw_lower = user_kw.lower()

                # æ£€æŸ¥æ˜¯å¦åœ¨å…³é”®è¯ã€æ¨¡æ¿æˆ–åç§°ä¸­å‡ºçŽ°
                if (user_kw_lower in elem_keywords_lower or
                    user_kw_lower in elem_template_lower or
                    user_kw_lower in elem_name_lower):
                    matched_count += 1

            keyword_match_rate = matched_count / total_keywords
            score += keyword_match_rate * 60

        # ç»´åº¦2ï¼šå…ƒç´ è´¨é‡è¯„åˆ†ï¼ˆ30åˆ†ï¼‰
        reusability = element.get('reusability_score', 0.0)
        if reusability > 0:
            score += (reusability / 10.0) * 30

        # ç»´åº¦3ï¼šè¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆÂ±10åˆ†ï¼‰
        # æ£€æµ‹è¯­ä¹‰å†²çªå¹¶æ‰£åˆ†
        consistency_penalty = ElementSelector._check_semantic_consistency(
            element, user_keywords, user_intent, field_name
        )
        score += consistency_penalty

        return max(0.0, min(100.0, score))  # é™åˆ¶åœ¨0-100èŒƒå›´

    @staticmethod
    def _check_semantic_consistency(
        element: Dict,
        user_keywords: List[str],
        user_intent: Dict,
        field_name: str
    ) -> float:
        """
        æ£€æŸ¥è¯­ä¹‰ä¸€è‡´æ€§ï¼Œè¿”å›žåŠ åˆ†æˆ–æ‰£åˆ†

        è¿”å›ž:
            åˆ†æ•°è°ƒæ•´å€¼ï¼ˆ-20 åˆ° +10ï¼‰
        """
        penalty = 0.0

        # å¤„ç†keywordså­—æ®µ
        elem_keywords_raw = element.get('keywords', '')
        if isinstance(elem_keywords_raw, list):
            elem_keywords_str = ' '.join(elem_keywords_raw)
        elif isinstance(elem_keywords_raw, str):
            try:
                import json
                keywords_list = json.loads(elem_keywords_raw)
                elem_keywords_str = ' '.join(keywords_list)
            except:
                elem_keywords_str = elem_keywords_raw
        else:
            elem_keywords_str = str(elem_keywords_raw)

        elem_keywords_lower = elem_keywords_str.lower()
        elem_template = element.get('ai_prompt_template', '')
        elem_template_lower = elem_template.lower() if elem_template else ''

        # è§„åˆ™1ï¼šå©´å„¿è‚¥ vs ç²¾è‡´
        # å¦‚æžœç”¨æˆ·è¦æ±‚å©´å„¿è‚¥ï¼ˆplump/chubby/fullï¼‰ï¼Œä½†å…ƒç´ æ˜¯ç²¾è‡´çš„ï¼ˆrefined/delicateï¼‰â†’ æ‰£åˆ†
        baby_fat_keywords = ['plump', 'chubby', 'full', 'baby fat', 'rounded']
        refined_keywords = ['refined', 'delicate', 'classical', 'sculpted', 'elegant']

        user_wants_baby_fat = any(kw in ' '.join(user_keywords).lower() for kw in baby_fat_keywords)
        elem_is_refined = any(kw in elem_keywords_lower or kw in elem_template_lower for kw in refined_keywords)

        if user_wants_baby_fat and elem_is_refined:
            penalty -= 20  # ä¸¥é‡å†²çªï¼Œå¤§å¹…æ‰£åˆ†

        # è§„åˆ™2ï¼šå¥–åŠ±å®Œç¾ŽåŒ¹é…
        # å¦‚æžœç”¨æˆ·å…³é”®è¯éƒ½åœ¨å…ƒç´ ä¸­å‡ºçŽ° â†’ åŠ åˆ†
        if user_keywords:
            all_matched = all(
                kw.lower() in elem_keywords_lower or kw.lower() in elem_template_lower
                for kw in user_keywords
            )
            if all_matched:
                penalty += 10  # å®Œç¾ŽåŒ¹é…ï¼ŒåŠ åˆ†

        return penalty

    @staticmethod
    def select_best_element(
        candidates: List[Dict],
        user_keywords: List[str],
        user_intent: Dict = None,
        field_name: str = "",
        debug: bool = False
    ) -> tuple:
        """
        ä»Žå€™é€‰åˆ—è¡¨ä¸­é€‰æ‹©æœ€ä½³å…ƒç´ ï¼ˆå…¨å±€æœ€ä¼˜ç­–ç•¥ï¼‰

        å‚æ•°:
            candidates: å€™é€‰å…ƒç´ åˆ—è¡¨
            user_keywords: ç”¨æˆ·éœ€æ±‚å…³é”®è¯
            user_intent: ç”¨æˆ·å®Œæ•´æ„å›¾ï¼ˆå¯é€‰ï¼‰
            field_name: å­—æ®µåï¼ˆå¯é€‰ï¼Œç”¨äºŽè°ƒè¯•ï¼‰
            debug: æ˜¯å¦è¾“å‡ºè°ƒè¯•ä¿¡æ¯

        è¿”å›ž:
            (æœ€ä½³å…ƒç´ , æœ€ä½³å¾—åˆ†)
        """
        if not candidates:
            return None, 0.0

        if user_intent is None:
            user_intent = {}

        best_element = None
        best_score = 0.0

        if debug:
            print(f"\n{'='*80}")
            print(f"ðŸŽ¯ å…¨å±€æœ€ä¼˜é€‰æ‹©ï¼š{field_name}")
            print(f"{'='*80}")
            print(f"å€™é€‰æ•°é‡ï¼š{len(candidates)}")
            print(f"ç”¨æˆ·å…³é”®è¯ï¼š{user_keywords}")
            print()

        # éåŽ†æ‰€æœ‰å€™é€‰ï¼Œè®¡ç®—æ¯ä¸ªçš„åŒ¹é…åº¦
        scores = []
        for i, elem in enumerate(candidates):
            score = ElementSelector.calculate_match_score(
                elem, user_keywords, user_intent, field_name
            )
            scores.append((elem, score))

            if debug:
                print(f"{i+1}. {elem.get('chinese_name', elem.get('name'))}")
                print(f"   å¾—åˆ†ï¼š{score:.1f}")
                print(f"   å…³é”®è¯ï¼š{elem.get('keywords', 'N/A')[:60]}...")
                print()

            # æ›´æ–°æœ€ä½³
            if score > best_score:
                best_score = score
                best_element = elem

        if debug and best_element:
            print(f"âœ… æœ€ä½³é€‰æ‹©ï¼š{best_element.get('chinese_name', best_element.get('name'))}")
            print(f"   å¾—åˆ†ï¼š{best_score:.1f}")
            print(f"{'='*80}\n")

        return best_element, best_score

    @staticmethod
    def select_from_candidates_dict(
        candidates_dict: Dict[str, List[Dict]],
        intent: Dict,
        keywords_map: Dict[str, List[str]],
        debug: bool = False
    ) -> Dict[str, Dict]:
        """
        ä»Žå¤šä¸ªå­—æ®µçš„å€™é€‰ä¸­æ‰¹é‡é€‰æ‹©æœ€ä½³å…ƒç´ 

        å‚æ•°:
            candidates_dict: {field_name: [å€™é€‰åˆ—è¡¨]}
            intent: ç”¨æˆ·å®Œæ•´æ„å›¾
            keywords_map: {field_name: [å…³é”®è¯åˆ—è¡¨]}
            debug: æ˜¯å¦è¾“å‡ºè°ƒè¯•ä¿¡æ¯

        è¿”å›ž:
            {field_name: æœ€ä½³å…ƒç´ }
        """
        selected = {}

        for field_name, candidates in candidates_dict.items():
            keywords = keywords_map.get(field_name, [])

            best_elem, score = ElementSelector.select_best_element(
                candidates, keywords, intent, field_name, debug
            )

            if best_elem:
                selected[field_name] = best_elem

        return selected



================================================
FILE: intelligent_generator.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨ - é…åˆClaude Skillä½¿ç”¨
å…·å¤‡è¯­ä¹‰ç†è§£ã€å¸¸è¯†æŽ¨ç†ã€ä¸€è‡´æ€§æ£€æŸ¥èƒ½åŠ›
"""

import sqlite3
import json
from typing import Dict, List, Optional, Tuple


class IntelligentGenerator:
    """æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨ - ç†è§£æ„å›¾ï¼Œæ£€æŸ¥ä¸€è‡´æ€§"""

    def __init__(self, db_path: str = "extracted_results/elements.db"):
        self.conn = sqlite3.connect(db_path)
        self.cursor = self.conn.cursor()

        # åŠ è½½å¸¸è¯†çŸ¥è¯†åº“
        self.knowledge = self.load_knowledge()

    def load_knowledge(self) -> Dict:
        """åŠ è½½å…ƒç´ å…³ç³»å’Œå¸¸è¯†çº¦æŸ"""
        return {
            # äººç§ â†’ å…¸åž‹çœ¼ç›é¢œè‰²
            'ethnicity_typical_eyes': {
                'East_Asian': ['black', 'dark brown', 'brown'],
                'Southeast_Asian': ['dark brown', 'brown', 'black'],
                'South_Asian': ['dark brown', 'brown', 'black'],
                'European': ['blue', 'green', 'brown', 'hazel', 'grey'],
                'African': ['dark brown', 'black', 'brown'],
                'Middle_Eastern': ['brown', 'dark brown', 'hazel', 'black'],
                'Latin_American': ['brown', 'dark brown', 'hazel', 'green'],
            },

            # äººç§ â†’ å…¸åž‹å‘è‰²
            'ethnicity_typical_hair': {
                'East_Asian': ['black', 'dark brown'],
                'Southeast_Asian': ['black', 'dark brown'],
                'South_Asian': ['black', 'dark brown'],
                'European': ['blonde', 'brown', 'black', 'red', 'auburn'],
                'African': ['black', 'dark brown'],
                'Middle_Eastern': ['black', 'dark brown', 'brown'],
                'Latin_American': ['black', 'dark brown', 'brown'],
            },

            # é£Žæ ¼ç±»åž‹å®šä¹‰
            'style_types': {
                'anime': {'type': 'art_style', 'affects': 'rendering', 'description': 'åŠ¨æ¼«ç»˜ç”»é£Žæ ¼'},
                'manga': {'type': 'art_style', 'affects': 'rendering', 'description': 'æ¼«ç”»ç»˜ç”»é£Žæ ¼'},
                'realistic': {'type': 'art_style', 'affects': 'rendering', 'description': 'å†™å®žç»˜ç”»é£Žæ ¼'},
                'illustration': {'type': 'art_style', 'affects': 'rendering', 'description': 'æ’ç”»ç»˜ç”»é£Žæ ¼'},

                'cyberpunk': {'type': 'atmosphere', 'affects': 'scene', 'description': 'èµ›åšæœ‹å…‹åœºæ™¯æ°›å›´'},
                'fantasy': {'type': 'atmosphere', 'affects': 'scene', 'description': 'å¥‡å¹»åœºæ™¯æ°›å›´'},
                'vintage': {'type': 'atmosphere', 'affects': 'scene', 'description': 'å¤å¤åœºæ™¯æ°›å›´'},

                'neon': {'type': 'lighting', 'affects': 'lighting', 'description': 'éœ“è™¹ç¯å…‰'},
                'dramatic': {'type': 'lighting', 'affects': 'lighting', 'description': 'æˆå‰§æ€§ç¯å…‰'},
            },

            # å¯¼æ¼”/é£Žæ ¼ â†’ å…‰å½±éœ€æ±‚æ˜ å°„
            'director_lighting_styles': {
                'zhang_yimou': {
                    'description': 'å¼ è‰ºè°‹ç”µå½±é£Žæ ¼',
                    'lighting_keywords': ['dramatic', 'shadow', 'rim', 'contrast', 'chiaroscuro', 'volumetric'],
                    'required_elements': ['dramatic shadows', 'rim lighting'],
                },
                'cinematic': {
                    'description': 'ç”µå½±çº§',
                    'lighting_keywords': ['dramatic', 'cinematic', 'rim', 'contrast'],
                    'required_elements': ['dramatic lighting', 'rim lighting'],
                },
                'film_noir': {
                    'description': 'é»‘è‰²ç”µå½±',
                    'lighting_keywords': ['shadow', 'contrast', 'chiaroscuro', 'low key'],
                    'required_elements': ['dramatic shadows', 'high contrast'],
                },
            },

            # äººç‰©å±žæ€§ç±»åˆ«ï¼ˆä¸åº”è¯¥è¢«styleå…³é”®è¯è¦†ç›–ï¼‰
            'subject_attribute_categories': {
                'gender', 'age_range', 'ethnicity', 'skin_tones',
                'eye_types', 'hair_colors', 'hair_styles',
                'face_shapes', 'nose_types', 'lip_types'
            }
        }

    def get_element_by_category(self, domain: str, category: str,
                                value_filter: Optional[str] = None) -> Optional[Dict]:
        """ä»Žæ•°æ®åº“èŽ·å–å…ƒç´ """
        query = """
            SELECT element_id, name, chinese_name, ai_prompt_template,
                   keywords, reusability_score, category_id
            FROM elements
            WHERE domain_id = ? AND category_id = ?
        """
        params = [domain, category]

        if value_filter:
            query += " AND (ai_prompt_template LIKE ? OR keywords LIKE ?)"
            params.extend([f"%{value_filter}%", f"%{value_filter}%"])

        query += " ORDER BY reusability_score DESC LIMIT 1"

        self.cursor.execute(query, params)
        row = self.cursor.fetchone()

        if not row:
            return None

        # éªŒè¯nameæ˜¯å¦åŒ¹é…value_filterï¼ˆé¿å…å­ä¸²è¯¯åŒ¹é…ï¼Œå¦‚femaleè¢«maleåŒ¹é…ï¼‰
        if value_filter and row[1].lower() != value_filter.lower():
            # å¦‚æžœä¸åŒ¹é…ï¼Œå°è¯•ç›´æŽ¥ç”¨nameç²¾ç¡®åŒ¹é…
            query_exact = """
                SELECT element_id, name, chinese_name, ai_prompt_template,
                       keywords, reusability_score, category_id
                FROM elements
                WHERE domain_id = ? AND category_id = ? AND name = ?
                ORDER BY reusability_score DESC LIMIT 1
            """
            self.cursor.execute(query_exact, [domain, category, value_filter])
            row = self.cursor.fetchone()
            if not row:
                return None

        keywords = None
        if row[4]:
            try:
                keywords = json.loads(row[4])
            except:
                pass

        return {
            'element_id': row[0],
            'name': row[1],
            'chinese_name': row[2],
            'template': row[3],
            'keywords': keywords,
            'reusability': row[5],
            'category': row[6]
        }

    def get_all_elements_by_category(self, domain: str, category: str,
                                     value_filter: Optional[str] = None) -> List[Dict]:
        """ä»Žæ•°æ®åº“èŽ·å–è¯¥ç±»åˆ«çš„æ‰€æœ‰å…ƒç´ ï¼ˆç”¨äºŽSKILLåˆ†æžï¼‰"""
        query = """
            SELECT element_id, name, chinese_name, ai_prompt_template,
                   keywords, reusability_score, category_id
            FROM elements
            WHERE domain_id = ? AND category_id = ?
        """
        params = [domain, category]

        if value_filter:
            query += " AND (ai_prompt_template LIKE ? OR keywords LIKE ?)"
            params.extend([f"%{value_filter}%", f"%{value_filter}%"])

        query += " ORDER BY reusability_score DESC"

        self.cursor.execute(query, params)
        rows = self.cursor.fetchall()

        elements = []
        for row in rows:
            keywords = None
            if row[4]:
                try:
                    keywords = json.loads(row[4])
                except:
                    pass

            elements.append({
                'element_id': row[0],
                'name': row[1],
                'chinese_name': row[2],
                'template': row[3],
                'keywords': keywords,
                'reusability': row[5],
                'category': row[6]
            })

        return elements

    def select_elements_by_intent(self, intent: Dict) -> List[Dict]:
        """
        åŸºäºŽè§£æžçš„æ„å›¾ä»Žæ•°æ®åº“é€‰æ‹©å…ƒç´ 

        intentæ ¼å¼:
        {
            'subject': {
                'gender': 'female',
                'ethnicity': 'East_Asian',
                'age_range': 'young_adult'
            },
            'visual_style': {
                'art_style': 'anime'
            },
            'atmosphere': {
                'theme': 'cyberpunk'
            }
        }
        """
        elements = []

        # 1. é€‰æ‹©äººç‰©å±žæ€§
        subject = intent.get('subject', {})

        if 'gender' in subject:
            elem = self.get_element_by_category('portrait', 'gender', subject['gender'])
            if elem:
                elements.append(elem)

        if 'age_range' in subject:
            elem = self.get_element_by_category('portrait', 'age_range')
            if elem:
                elements.append(elem)

        if 'ethnicity' in subject:
            ethnicity_name = subject['ethnicity']
            elem = self.get_element_by_category('portrait', 'ethnicity', ethnicity_name)
            if elem:
                elements.append(elem)

            # è‡ªåŠ¨é€‰æ‹©åŒ¹é…äººç§çš„çœ¼ç›
            # å¯¹äºŽä¸œäºšäººï¼Œé€‰æ‹©almond/large expressiveç±»åž‹ï¼ˆé¿å…green/blueï¼‰
            if ethnicity_name == 'East_Asian':
                eye_elem = self.get_element_by_category('portrait', 'eye_types', 'almond')
            else:
                eye_elem = self.get_element_by_category('portrait', 'eye_types')

            if eye_elem:
                elements.append(eye_elem)

            # è‡ªåŠ¨é€‰æ‹©åŒ¹é…äººç§çš„å‘è‰²
            typical_hair = self.knowledge['ethnicity_typical_hair'].get(ethnicity_name, ['black'])
            hair_color_elem = self.get_element_by_category('portrait', 'hair_colors', typical_hair[0])
            if hair_color_elem:
                elements.append(hair_color_elem)

        # 2. æ ¹æ®intenté€‰æ‹©æœè£…å’Œå‘åž‹ï¼ˆä¼˜å…ˆä½¿ç”¨intentæŒ‡å®šçš„ï¼‰
        clothing = intent.get('clothing', 'modern')
        hairstyle = intent.get('hairstyle', 'modern')

        # æœè£…å…³é”®è¯æ˜ å°„ï¼ˆçµæ´»æœç´¢ï¼‰
        clothing_keywords_map = {
            'traditional_chinese': ['traditional', 'chinese', 'hanfu', 'period'],
            'kimono': ['kimono', 'japanese'],
            'business': ['business', 'suit', 'formal'],
            'casual': ['casual'],
            'formal': ['formal', 'evening']
        }

        # æœç´¢æœè£…å…ƒç´ 
        if clothing != 'modern':  # å¦‚æžœéžé»˜è®¤ï¼Œæœç´¢ç‰¹å®šæœè£…
            search_keywords = clothing_keywords_map.get(clothing, [clothing])
            clothing_elem = None
            # å°è¯•ç”¨æ¯ä¸ªå…³é”®è¯æœç´¢
            for kw in search_keywords:
                clothing_elem = self.get_element_by_category('portrait', 'clothing_styles', kw)
                if clothing_elem:
                    print(f"âœ“ æ‰¾åˆ°æœè£…å…ƒç´ : '{clothing_elem['chinese_name']}'ï¼ˆæœç´¢å…³é”®è¯: {kw}ï¼‰")
                    elements.append(clothing_elem)
                    break

            # å¦‚æžœæ²¡æ‰¾åˆ°ï¼Œè®°å½•ä¿¡æ¯
            if not clothing_elem:
                print(f"âš ï¸ æœªæ‰¾åˆ°'{clothing}'æœè£…å…ƒç´ ï¼Œå°†é€šè¿‡é£Žæ ¼å…³é”®è¯æœç´¢")
        else:
            # é»˜è®¤é€‰æ‹©ä¸€ä¸ªçŽ°ä»£æœè£…
            elem = self.get_element_by_category('portrait', 'clothing_styles')
            if elem:
                elements.append(elem)

        # å‘åž‹å…³é”®è¯æ˜ å°„ï¼ˆçµæ´»æœç´¢ï¼‰
        hairstyle_keywords_map = {
            'ancient_chinese': ['traditional', 'classical', 'bun', 'updo'],
            'traditional_japanese': ['traditional', 'japanese'],
        }

        # æœç´¢å‘åž‹å…ƒç´ ï¼ˆå¦‚æžœæŒ‡å®šäº†ç‰¹æ®Šå‘åž‹ï¼‰
        if hairstyle != 'modern':
            search_keywords = hairstyle_keywords_map.get(hairstyle, [hairstyle])
            hair_style_elem = None
            # å°è¯•ç”¨æ¯ä¸ªå…³é”®è¯æœç´¢
            for kw in search_keywords:
                hair_style_elem = self.get_element_by_category('portrait', 'hair_styles', kw)
                if hair_style_elem:
                    print(f"âœ“ æ‰¾åˆ°å‘åž‹å…ƒç´ : '{hair_style_elem['chinese_name']}'ï¼ˆæœç´¢å…³é”®è¯: {kw}ï¼‰")
                    elements.append(hair_style_elem)
                    break

            # å¦‚æžœæ²¡æ‰¾åˆ°ï¼Œè®°å½•ä¿¡æ¯
            if not hair_style_elem:
                print(f"âš ï¸ æœªæ‰¾åˆ°'{hairstyle}'å‘åž‹å…ƒç´ ï¼Œå°†é€šè¿‡é£Žæ ¼å…³é”®è¯æœç´¢")
        else:
            # é»˜è®¤é€‰æ‹©ä¸€ä¸ªçŽ°ä»£å‘åž‹
            elem = self.get_element_by_category('portrait', 'hair_styles')
            if elem:
                elements.append(elem)

        # 3. é€‰æ‹©å…¶ä»–äººç‰©å±žæ€§
        for attr in ['skin_tones', 'skin_textures', 'face_shapes',
                     'makeup_styles', 'expressions', 'poses']:
            elem = self.get_element_by_category('portrait', attr)
            if elem:
                elements.append(elem)

        # 4. æ·»åŠ é£Žæ ¼å…ƒç´ ï¼ˆlighting, era, director_styleç­‰ï¼‰
        visual_style = intent.get('visual_style', {})
        atmosphere = intent.get('atmosphere', {})
        era = intent.get('era', 'modern')
        lighting = intent.get('lighting', 'natural')

        # æ”¶é›†æ‰€æœ‰é£Žæ ¼å…³é”®è¯
        style_keywords = []

        # æ·»åŠ æœè£…å…³é”®è¯ï¼ˆè¡¥å……æœç´¢ï¼‰
        if clothing != 'modern':
            clothing_search_kws = clothing_keywords_map.get(clothing, [])
            style_keywords.extend(clothing_search_kws)
            print(f"âœ“ æ·»åŠ æœè£…æœç´¢å…³é”®è¯: {', '.join(clothing_search_kws)}")

        # æ·»åŠ å‘åž‹å…³é”®è¯ï¼ˆè¡¥å……æœç´¢ï¼‰
        if hairstyle != 'modern':
            hairstyle_search_kws = hairstyle_keywords_map.get(hairstyle, [])
            style_keywords.extend(hairstyle_search_kws)
            print(f"âœ“ æ·»åŠ å‘åž‹æœç´¢å…³é”®è¯: {', '.join(hairstyle_search_kws)}")

        # æ·»åŠ è‰ºæœ¯é£Žæ ¼
        if 'art_style' in visual_style:
            style_keywords.append(visual_style['art_style'])

        # æ·»åŠ æ°›å›´ä¸»é¢˜
        if 'theme' in atmosphere:
            style_keywords.append(atmosphere['theme'])

        # æ·»åŠ å…‰å½±å…³é”®è¯
        if lighting:
            style_keywords.append(lighting)

        # æ·»åŠ æ—¶ä»£èƒŒæ™¯å…³é”®è¯
        if era != 'modern':
            style_keywords.append(era)
            # å¤ä»£æ—¶æœŸæ·»åŠ ç›¸å…³è¯
            if era == 'ancient':
                style_keywords.extend(['traditional', 'period', 'classical'])

        # æ£€æŸ¥å¯¼æ¼”é£Žæ ¼ï¼Œæ·»åŠ ç‰¹å®šå…³é”®è¯
        director_style = atmosphere.get('director_style')
        if director_style:
            # æ£€æŸ¥æ˜¯å¦åœ¨çŸ¥è¯†åº“ä¸­ï¼ˆç”¨äºŽå…‰å½±æ‰©å±•ï¼‰
            if director_style in self.knowledge.get('director_lighting_styles', {}):
                lighting_config = self.knowledge['director_lighting_styles'][director_style]
                style_keywords.extend(lighting_config['lighting_keywords'])
                print(f"âœ“ è¯†åˆ«åˆ°'{lighting_config['description']}'ï¼Œè‡ªåŠ¨æ·»åŠ å…‰å½±å…³é”®è¯: {', '.join(lighting_config['lighting_keywords'])}")

            # æ·»åŠ å¯¼æ¼”é£Žæ ¼çš„ç‰¹å®šå…³é”®è¯
            director_keywords = {
                'tsui_hark': ['wuxia', 'martial arts', 'flowing', 'dynamic'],
                'zhang_yimou': ['traditional', 'red', 'gold', 'period drama'],
                'wong_kar_wai': ['nostalgic', 'atmospheric', 'saturated colors']
            }
            if director_style in director_keywords:
                style_keywords.extend(director_keywords[director_style])
                print(f"âœ“ è¯†åˆ«åˆ°å¯¼æ¼”é£Žæ ¼'{director_style}'ï¼Œæ·»åŠ ç‰¹å¾å…³é”®è¯: {', '.join(director_keywords[director_style])}")

        if style_keywords:
            style_elements = self.search_style_elements(style_keywords)
            elements.extend(style_elements)

        return elements

    def calculate_relevance(self, element: Dict, required_keywords: List[str]) -> float:
        """
        è®¡ç®—å…ƒç´ ä¸Žéœ€æ±‚çš„ç›¸å…³æ€§å¾—åˆ†ï¼ˆ0-1ï¼‰

        å‚æ•°:
            element: å…ƒç´ å­—å…¸
            required_keywords: ç”¨æˆ·éœ€æ±‚çš„å…³é”®è¯åˆ—è¡¨

        è¿”å›ž:
            ç›¸å…³æ€§å¾—åˆ† (0.0 - 1.0)
        """
        if not required_keywords:
            return 0.5  # æ— å…³é”®è¯ï¼Œé»˜è®¤ä¸­ç­‰ç›¸å…³æ€§

        template = element.get('template', '').lower()
        keywords = element.get('keywords', [])

        # æž„å»ºå…ƒç´ çš„æ‰€æœ‰æ–‡æœ¬
        element_text = template
        if keywords:
            element_text += ' ' + ' '.join(keywords).lower()

        # è®¡ç®—åŒ¹é…çš„å…³é”®è¯æ•°é‡
        matched = 0
        for kw in required_keywords:
            if kw.lower() in element_text:
                matched += 1

        # ç›¸å…³æ€§ = åŒ¹é…æ•° / æ€»å…³é”®è¯æ•°
        relevance = matched / len(required_keywords)

        return relevance

    def search_style_elements(self, keywords: List[str]) -> List[Dict]:
        """æœç´¢é£Žæ ¼å…ƒç´ ï¼ŒæŽ’é™¤äººç‰©å±žæ€§ç±»åˆ«ï¼ŒæŒ‰ç›¸å…³æ€§Ã—è´¨é‡æŽ’åº"""
        excluded_categories = self.knowledge['subject_attribute_categories']

        keyword_conditions = " OR ".join(["ai_prompt_template LIKE ?" for _ in keywords])
        query = f"""
            SELECT element_id, name, chinese_name, ai_prompt_template,
                   keywords, reusability_score, category_id
            FROM elements
            WHERE ({keyword_conditions})
              AND ai_prompt_template != ''
            ORDER BY reusability_score DESC
            LIMIT 30
        """

        params = [f"%{kw}%" for kw in keywords]
        self.cursor.execute(query, params)

        elements = []
        for row in self.cursor.fetchall():
            # è¿‡æ»¤æŽ‰äººç‰©å±žæ€§ç±»åˆ«
            if row[6] in excluded_categories:
                continue

            keywords_data = None
            if row[4]:
                try:
                    keywords_data = json.loads(row[4])
                except:
                    pass

            elem = {
                'element_id': row[0],
                'name': row[1],
                'chinese_name': row[2],
                'template': row[3],
                'keywords': keywords_data,
                'reusability': row[5],
                'category': row[6]
            }

            # è®¡ç®—ç›¸å…³æ€§å¾—åˆ†
            relevance = self.calculate_relevance(elem, keywords)

            # ç»¼åˆå¾—åˆ† = ç›¸å…³æ€§ Ã— è´¨é‡åˆ†
            elem['relevance'] = relevance
            elem['final_score'] = relevance * row[5]  # reusability_score

            elements.append(elem)

        # æŒ‰ç»¼åˆå¾—åˆ†æŽ’åº
        elements.sort(key=lambda x: x['final_score'], reverse=True)

        # è¿”å›žå‰10ä¸ªæœ€ç›¸å…³çš„
        return elements[:10]

    def check_consistency(self, elements: List[Dict]) -> List[Dict]:
        """
        æ£€æŸ¥å…ƒç´ ä¹‹é—´çš„ä¸€è‡´æ€§

        è¿”å›žé—®é¢˜åˆ—è¡¨ï¼Œæ¯ä¸ªé—®é¢˜åŒ…å«ï¼š
        - type: é—®é¢˜ç±»åž‹
        - severity: ä¸¥é‡ç¨‹åº¦ (low/medium/high)
        - description: é—®é¢˜æè¿°
        - suggestion: ä¿®æ­£å»ºè®®
        """
        issues = []

        # æå–å…³é”®å…ƒç´ 
        ethnicity_elem = self.find_element_by_category(elements, 'ethnicity')
        eye_elem = self.find_element_by_category(elements, 'eye_types')
        hair_elem = self.find_element_by_category(elements, 'hair_colors')

        # æ£€æŸ¥1ï¼šäººç§ vs çœ¼ç›é¢œè‰²ï¼ˆæ£€æµ‹ä¸åˆç†çš„é¢œè‰²å¦‚green/blue for ä¸œäºšäººï¼‰
        if ethnicity_elem and eye_elem:
            ethnicity_name = self.extract_ethnicity_name(ethnicity_elem['name'])
            eye_template = eye_elem['template'].lower()

            # æ£€æµ‹ä¸åˆç†çš„é¢œè‰²
            incompatible_colors = []
            if ethnicity_name == 'East_Asian':
                # ä¸œäºšäººä¸åº”è¯¥æœ‰è¿™äº›çœ¼ç›é¢œè‰²
                if 'green' in eye_template or 'blue' in eye_template or 'violet' in eye_template:
                    incompatible_colors = ['green', 'blue', 'violet']
            elif ethnicity_name == 'African':
                if 'blue' in eye_template or 'green' in eye_template:
                    incompatible_colors = ['blue', 'green']

            if incompatible_colors:
                typical_eyes = self.knowledge['ethnicity_typical_eyes'].get(ethnicity_name, ['brown'])
                issues.append({
                    'type': 'ethnicity_eye_mismatch',
                    'severity': 'medium',
                    'current_ethnicity': ethnicity_elem['chinese_name'],
                    'current_eye': eye_elem['template'],
                    'incompatible_colors': incompatible_colors,
                    'typical_eyes': typical_eyes,
                    'description': f"{ethnicity_elem['chinese_name']}é€šå¸¸ä¸ä¼šæœ‰åŒ…å«'{', '.join(incompatible_colors)}'çš„çœ¼ç›",
                    'suggestion': f"å»ºè®®é€‰æ‹©åŒ…å«è¿™äº›é¢œè‰²çš„çœ¼åž‹: {', '.join(typical_eyes)}"
                })

        # æ£€æŸ¥2ï¼šäººç§ vs å‘è‰²
        if ethnicity_elem and hair_elem:
            ethnicity_name = self.extract_ethnicity_name(ethnicity_elem['name'])
            typical_hair = self.knowledge['ethnicity_typical_hair'].get(ethnicity_name, [])

            hair_template = hair_elem['template'].lower()
            is_typical = any(color in hair_template for color in typical_hair)

            if not is_typical:
                issues.append({
                    'type': 'ethnicity_hair_mismatch',
                    'severity': 'low',
                    'current_ethnicity': ethnicity_elem['chinese_name'],
                    'current_hair': hair_elem['template'],
                    'typical_hair': typical_hair,
                    'description': f"{ethnicity_elem['chinese_name']}é€šå¸¸ä¸ä¼šæœ‰'{hair_elem['template']}'",
                    'suggestion': f"å»ºè®®æ”¹ä¸º: {', '.join(typical_hair)}"
                })

        # æ£€æŸ¥3ï¼šé‡å¤ç±»åˆ«ï¼ˆä½†lighting_techniqueså…è®¸å¤šä¸ªï¼‰
        category_counts = {}
        for elem in elements:
            cat = elem['category']
            category_counts[cat] = category_counts.get(cat, 0) + 1

        # å…è®¸å¤šä¸ªå…ƒç´ çš„ç±»åˆ«
        multi_element_categories = {'lighting_techniques', 'photography_techniques'}

        for cat, count in category_counts.items():
            # lighting_techniquesç­‰ç±»åˆ«å…è®¸å¤šä¸ªå…ƒç´ ç»„åˆ
            if count > 1 and cat not in multi_element_categories:
                issues.append({
                    'type': 'duplicate_category',
                    'severity': 'high',
                    'category': cat,
                    'count': count,
                    'description': f"ç±»åˆ«'{cat}'å‡ºçŽ°äº†{count}æ¬¡ï¼ˆåº”è¯¥åªæœ‰1æ¬¡ï¼‰",
                    'suggestion': "ä¿ç•™æœ€ç›¸å…³çš„ä¸€ä¸ªå…ƒç´ "
                })

        return issues

    def check_completeness(self, intent: Dict, prompt: str) -> List[Dict]:
        """
        æ£€æŸ¥ç”Ÿæˆçš„æç¤ºè¯æ˜¯å¦æ»¡è¶³æ‰€æœ‰ç”¨æˆ·è¦æ±‚

        å‚æ•°:
            intent: åŽŸå§‹æ„å›¾å­—å…¸
            prompt: ç”Ÿæˆçš„æç¤ºè¯å­—ç¬¦ä¸²

        è¿”å›ž:
            ç¼ºå¤±éœ€æ±‚åˆ—è¡¨ï¼Œæ¯ä¸ªåŒ…å«ï¼š
            - requirement: éœ€æ±‚ç±»åž‹
            - expected: æœŸæœ›çš„å…³é”®è¯
            - description: ç¼ºå¤±æè¿°
        """
        missing = []
        prompt_lower = prompt.lower()

        # æ£€æŸ¥1ï¼šæœè£…è¦æ±‚
        clothing = intent.get('clothing')
        if clothing and clothing != 'modern':
            clothing_keywords = {
                'traditional_chinese': ['traditional', 'costume', 'hanfu', 'chinese dress', 'period dress'],
                'kimono': ['kimono', 'traditional japanese'],
                'business': ['business', 'suit', 'professional'],
                'casual': ['casual'],
                'formal': ['formal', 'evening gown', 'dress']
            }
            expected_kws = clothing_keywords.get(clothing, [])
            if expected_kws and not any(kw in prompt_lower for kw in expected_kws):
                missing.append({
                    'requirement': 'clothing',
                    'expected': expected_kws,
                    'description': f"ç”¨æˆ·è¦æ±‚'{clothing}'æœè£…ï¼Œä½†æç¤ºè¯ä¸­æœªæ‰¾åˆ°ç›¸å…³æè¿°",
                    'suggestion': f"åº”åŒ…å«: {', '.join(expected_kws[:3])}"
                })

        # æ£€æŸ¥2ï¼šå‘åž‹è¦æ±‚
        hairstyle = intent.get('hairstyle')
        if hairstyle and hairstyle != 'modern':
            hairstyle_keywords = {
                'ancient_chinese': ['traditional hairstyle', 'classical hair', 'hair ornament', 'hairpin', 'bun'],
                'traditional_japanese': ['traditional japanese hair', 'kanzashi']
            }
            expected_kws = hairstyle_keywords.get(hairstyle, [])
            if expected_kws and not any(kw in prompt_lower for kw in expected_kws):
                missing.append({
                    'requirement': 'hairstyle',
                    'expected': expected_kws,
                    'description': f"ç”¨æˆ·è¦æ±‚'{hairstyle}'å‘åž‹ï¼Œä½†æç¤ºè¯ä¸­æœªæ‰¾åˆ°ç›¸å…³æè¿°",
                    'suggestion': f"åº”åŒ…å«: {', '.join(expected_kws[:3])}"
                })

        # æ£€æŸ¥3ï¼šæ—¶ä»£èƒŒæ™¯
        era = intent.get('era')
        if era and era != 'modern':
            era_keywords = {
                'ancient': ['traditional', 'period', 'classical', 'ancient'],
                'republic_of_china': ['republic era', '1920s', '1930s', 'vintage']
            }
            expected_kws = era_keywords.get(era, [])
            if expected_kws and not any(kw in prompt_lower for kw in expected_kws):
                missing.append({
                    'requirement': 'era',
                    'expected': expected_kws,
                    'description': f"ç”¨æˆ·è¦æ±‚'{era}'æ—¶ä»£èƒŒæ™¯ï¼Œä½†æç¤ºè¯ä¸­æœªæ‰¾åˆ°ç›¸å…³æè¿°",
                    'suggestion': f"åº”åŒ…å«: {', '.join(expected_kws[:3])}"
                })

        # æ£€æŸ¥4ï¼šå¯¼æ¼”é£Žæ ¼ç‰¹å¾
        atmosphere = intent.get('atmosphere', {})
        director_style = atmosphere.get('director_style')
        if director_style:
            director_keywords = {
                'tsui_hark': ['wuxia', 'martial arts', 'flowing', 'dynamic'],
                'zhang_yimou': ['traditional', 'red', 'gold', 'dramatic'],
                'wong_kar_wai': ['nostalgic', 'atmospheric', 'saturated']
            }
            expected_kws = director_keywords.get(director_style, [])
            if expected_kws and not any(kw in prompt_lower for kw in expected_kws):
                missing.append({
                    'requirement': 'director_style',
                    'expected': expected_kws,
                    'description': f"ç”¨æˆ·è¦æ±‚'{director_style}'å¯¼æ¼”é£Žæ ¼ï¼Œä½†æç¤ºè¯ä¸­æœªæ‰¾åˆ°ç‰¹å¾å…³é”®è¯",
                    'suggestion': f"åº”åŒ…å«: {', '.join(expected_kws[:3])}"
                })

        # æ£€æŸ¥5ï¼šå…‰å½±è¦æ±‚ï¼ˆå¿…é€‰ï¼‰
        # æ”¯æŒä¸¤ç§æ ¼å¼ï¼šå­—ç¬¦ä¸²ï¼ˆæ—§æ ¼å¼ï¼‰å’Œdictï¼ˆæ¡†æž¶æ ¼å¼ï¼‰
        lighting = intent.get('lighting', 'natural')
        if isinstance(lighting, dict):
            lighting = lighting.get('lighting_type', 'natural')

        lighting_keywords = {
            'natural': ['natural', 'window light', 'daylight', 'soft light'],
            'cinematic': ['cinematic', 'dramatic', 'rim light'],
            'zhang_yimou': ['dramatic', 'shadow', 'rim', 'chiaroscuro'],
            'film_noir': ['shadow', 'contrast', 'chiaroscuro', 'low key'],
            'neon': ['neon', 'colorful', 'glow'],
            'soft': ['soft', 'gentle', 'diffused'],
            'dramatic': ['dramatic', 'shadow', 'contrast']
        }
        expected_kws = lighting_keywords.get(lighting, [])
        if expected_kws and not any(kw in prompt_lower for kw in expected_kws):
            missing.append({
                'requirement': 'lighting',
                'expected': expected_kws,
                'description': f"ç”¨æˆ·è¦æ±‚'{lighting}'å…‰å½±ï¼Œä½†æç¤ºè¯ä¸­æœªæ‰¾åˆ°ç›¸å…³æè¿°",
                'suggestion': f"åº”åŒ…å«: {', '.join(expected_kws[:3])}"
            })

        return missing

    def resolve_conflicts(self, elements: List[Dict], issues: List[Dict]) -> Tuple[List[Dict], List[str]]:
        """
        è§£å†³æ£€æµ‹åˆ°çš„å†²çª

        è¿”å›žï¼š(ä¿®æ­£åŽçš„å…ƒç´ åˆ—è¡¨, ä¿®æ­£è¯´æ˜Žåˆ—è¡¨)
        """
        fixed_elements = elements.copy()
        fixes_applied = []

        for issue in issues:
            if issue['type'] == 'ethnicity_eye_mismatch':
                # æ›¿æ¢ä¸ºç¬¦åˆäººç§çš„çœ¼ç›ï¼ˆé€‰æ‹©almond/brownç­‰åˆé€‚çš„ï¼‰
                ethnicity_elem = self.find_element_by_category(fixed_elements, 'ethnicity')
                ethnicity_name = self.extract_ethnicity_name(ethnicity_elem['name']) if ethnicity_elem else 'East_Asian'

                # ä¸ºä¸åŒäººç§é€‰æ‹©åˆé€‚çš„çœ¼åž‹
                if ethnicity_name == 'East_Asian':
                    new_eye_elem = self.get_element_by_category('portrait', 'eye_types', 'almond brown')
                    if not new_eye_elem:
                        new_eye_elem = self.get_element_by_category('portrait', 'eye_types', 'almond')
                else:
                    new_eye_elem = self.get_element_by_category('portrait', 'eye_types')

                if new_eye_elem:
                    # ç§»é™¤æ—§çš„eyeå…ƒç´ 
                    fixed_elements = [e for e in fixed_elements if e['category'] != 'eye_types']
                    # æ·»åŠ æ–°çš„
                    fixed_elements.append(new_eye_elem)

                    fixes_applied.append(
                        f"âœ“ ä¿®æ­£çœ¼ç›: '{issue['current_eye']}' â†’ '{new_eye_elem['template']}' "
                        f"(ç¬¦åˆ{issue['current_ethnicity']}ç‰¹å¾)"
                    )

            elif issue['type'] == 'ethnicity_hair_mismatch':
                # æ›¿æ¢å‘è‰²
                suggested_color = issue['typical_hair'][0]
                new_hair_elem = self.get_element_by_category('portrait', 'hair_colors', suggested_color)

                if new_hair_elem:
                    fixed_elements = [e for e in fixed_elements if e['category'] != 'hair_colors']
                    fixed_elements.append(new_hair_elem)

                    fixes_applied.append(
                        f"âœ“ ä¿®æ­£å‘è‰²: '{issue['current_hair']}' â†’ '{new_hair_elem['template']}' "
                        f"(ç¬¦åˆ{issue['current_ethnicity']}ç‰¹å¾)"
                    )

            elif issue['type'] == 'duplicate_category':
                # ä¿ç•™ç¬¬ä¸€ä¸ªï¼Œåˆ é™¤å…¶ä»–
                cat = issue['category']
                kept = False
                new_list = []
                for elem in fixed_elements:
                    if elem['category'] == cat:
                        if not kept:
                            new_list.append(elem)
                            kept = True
                    else:
                        new_list.append(elem)

                fixed_elements = new_list
                fixes_applied.append(f"âœ“ ç§»é™¤é‡å¤çš„'{cat}'ç±»åˆ«å…ƒç´ ")

        return fixed_elements, fixes_applied

    def find_element_by_category(self, elements: List[Dict], category: str) -> Optional[Dict]:
        """ä»Žå…ƒç´ åˆ—è¡¨ä¸­æŸ¥æ‰¾æŒ‡å®šç±»åˆ«çš„å…ƒç´ """
        for elem in elements:
            if elem['category'] == category:
                return elem
        return None

    def extract_ethnicity_name(self, name: str) -> str:
        """ä»Žå…ƒç´ åç§°æå–äººç§æ ‡å‡†åç§°"""
        mapping = {
            'east_asian': 'East_Asian',
            'southeast_asian': 'Southeast_Asian',
            'south_asian': 'South_Asian',
            'european': 'European',
            'african': 'African',
            'middle_eastern': 'Middle_Eastern',
            'latin_american': 'Latin_American',
        }
        return mapping.get(name.lower(), name)

    def compose_prompt(self, elements: List[Dict], mode: str = 'auto',
                      keywords_limit: int = 3) -> str:
        """
        ç»„åˆå…ƒç´ ç”Ÿæˆæœ€ç»ˆæç¤ºè¯ï¼ˆå¸¦åŽ»é‡å’Œè¿‡æ»¤ï¼‰

        mode: 'simple', 'auto', 'detailed'
        """
        all_keywords = []
        seen_concepts = set()  # ç”¨äºŽåŽ»é‡

        # åŒä¹‰è¯ç»„ï¼ˆç”¨äºŽåŽ»é‡ï¼‰
        synonym_groups = {
            'woman': ['woman', 'female', 'lady', 'girl'],
            'man': ['man', 'male', 'gentleman', 'boy'],
            'young': ['young', 'youthful', 'young adult'],
            'fair': ['fair', 'pale', 'light'],
            'East Asian': ['East Asian', 'Chinese', 'Japanese', 'Korean'],
            'eyes': ['eyes', 'eye', 'large expressive eyes', 'almond eyes'],
            'hair': ['hair', 'hairs', 'black hair'],
            'skin': ['skin', 'fair skin', 'pale skin', 'realistic skin texture'],
            'face': ['face', 'oval face'],
            'ponytail': ['ponytail with bangs', 'straight bangs ponytail', 'ponytail and fringe', 'ponytail'],
            'bokeh': ['creamy bokeh', 'cinematic bokeh', 'smooth bokeh', 'bokeh'],
            'dramatic': ['dramatic shadows', 'dramatic lighting', 'dramatic'],
            'rim light': ['rim light', 'edge lighting', 'backlight', 'rim lighting'],
            'gaze': ['innocent gaze', 'gentle smile', 'soft introspective', 'gaze'],
            'pose': ['relaxed', 'casual stance', 'natural pose', 'pose'],
        }

        # æ— å…³/é”™è¯¯çš„å…³é”®è¯é»‘åå•ï¼ˆæ˜Žæ˜¾ä¸å±žäºŽäººåƒï¼‰
        blacklist = {
            'bottle', 'highlighting', 'condensa', 'elements', 'surroundings',
            'practical', 'string', 'lanterns', 'vintage lamps', 'accent lights'
        }

        # åå‘æ˜ å°„ï¼šå…³é”®è¯ â†’ ä»£è¡¨è¯
        concept_map = {}
        for representative, synonyms in synonym_groups.items():
            for syn in synonyms:
                concept_map[syn.lower()] = representative

        for elem in elements:
            template = elem.get('template', '')
            keywords = elem.get('keywords')

            # é€‰æ‹©æ–‡æœ¬
            if mode == 'simple':
                text = template
            elif mode == 'detailed' and keywords and len(keywords) > 0:
                text_list = keywords[:keywords_limit]
            elif mode == 'auto' and keywords and len(keywords) > 2:
                text_list = keywords[:keywords_limit]
            else:
                text = template
                text_list = None

            # å¦‚æžœæœ‰keywordsåˆ—è¡¨ï¼Œé€ä¸ªå¤„ç†
            if text_list:
                for kw in text_list:
                    # è¿‡æ»¤æ— æ•ˆå…³é”®è¯
                    if not kw or len(kw.strip()) == 0:
                        continue

                    kw_stripped = kw.strip()
                    kw_lower = kw_stripped.lower()

                    # é»‘åå•è¿‡æ»¤
                    if any(blackword in kw_lower for blackword in blacklist):
                        continue

                    words = kw_stripped.split()

                    # è¿‡æ»¤å•ä¸ªè¯ç¢Žç‰‡ï¼ˆ<4å­—ç¬¦æˆ–æ˜Žæ˜¾æ— å…³ï¼‰
                    if len(words) == 1:
                        # å•è¯è¿‡æ»¤ï¼šçŸ­äºŽ4å­—ç¬¦ï¼Œæˆ–åœ¨é»‘åå•
                        if len(kw_stripped) < 4 or kw_lower in blacklist:
                            continue

                    # åŽ»é‡æ£€æŸ¥ - æ£€æŸ¥å®Œæ•´çŸ­è¯­
                    concept = concept_map.get(kw_lower, None)

                    # å¦‚æžœæ²¡æœ‰ç²¾ç¡®åŒ¹é…ï¼Œæ£€æŸ¥æ˜¯å¦å®Œå…¨åŒ¹é…å·²çŸ¥æ¦‚å¿µ
                    # æ³¨æ„ï¼šåªå¯¹å®Œæ•´çŸ­è¯­è¿›è¡ŒåŒä¹‰è¯åŒ¹é…ï¼Œä¸åšå­ä¸²åŒ¹é…
                    if not concept:
                        # å…ˆå°è¯•ç²¾ç¡®åŒ¹é…æ•´ä¸ªçŸ­è¯­
                        for rep, syns in synonym_groups.items():
                            if kw_lower in [s.lower() for s in syns]:
                                concept = rep
                                break

                    # å¦‚æžœè¿˜æ˜¯æ²¡æ‰¾åˆ°æ¦‚å¿µï¼Œç”¨å®Œæ•´çŸ­è¯­ä½œä¸ºå”¯ä¸€æ ‡è¯†
                    if not concept:
                        concept = kw_lower

                    if concept not in seen_concepts:
                        all_keywords.append(kw_stripped)
                        seen_concepts.add(concept)
            else:
                # ä½¿ç”¨template
                if text and text.strip():
                    text_stripped = text.strip()
                    text_lower = text_stripped.lower()

                    # é»‘åå•è¿‡æ»¤
                    if any(blackword in text_lower for blackword in blacklist):
                        continue

                    # åŽ»é‡æ£€æŸ¥
                    concept = concept_map.get(text_lower, None)

                    # æ£€æŸ¥æ˜¯å¦å®Œå…¨åŒ¹é…å·²çŸ¥æ¦‚å¿µï¼ˆä¸åšå­ä¸²åŒ¹é…ï¼‰
                    if not concept:
                        for rep, syns in synonym_groups.items():
                            if text_lower in [s.lower() for s in syns]:
                                concept = rep
                                break

                    if not concept:
                        concept = text_lower

                    if concept not in seen_concepts:
                        all_keywords.append(text_stripped)
                        seen_concepts.add(concept)

        return ', '.join(all_keywords)

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.conn.close()


def test_intelligent_generator():
    """æµ‹è¯•æ™ºèƒ½ç”Ÿæˆå™¨"""
    gen = IntelligentGenerator()

    print("="*80)
    print("æµ‹è¯•æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨")
    print("="*80)

    # æµ‹è¯•intent
    intent = {
        'subject': {
            'gender': 'female',
            'ethnicity': 'East_Asian',
            'age_range': 'young_adult'
        },
        'visual_style': {
            'art_style': 'anime'
        },
        'atmosphere': {
            'theme': 'cyberpunk'
        }
    }

    print("\n1. åŸºäºŽintenté€‰æ‹©å…ƒç´ ...")
    elements = gen.select_elements_by_intent(intent)
    print(f"   é€‰æ‹©äº† {len(elements)} ä¸ªå…ƒç´ ")

    print("\n2. æ£€æŸ¥ä¸€è‡´æ€§...")
    issues = gen.check_consistency(elements)

    if issues:
        print(f"   å‘çŽ° {len(issues)} ä¸ªé—®é¢˜:")
        for issue in issues:
            print(f"   - [{issue['severity']}] {issue['description']}")
            print(f"     {issue['suggestion']}")

        print("\n3. ä¿®æ­£å†²çª...")
        fixed_elements, fixes = gen.resolve_conflicts(elements, issues)
        for fix in fixes:
            print(f"   {fix}")
    else:
        print("   âœ“ æ²¡æœ‰å‘çŽ°é—®é¢˜")
        fixed_elements = elements

    print("\n4. ç”Ÿæˆæœ€ç»ˆæç¤ºè¯...")
    prompt = gen.compose_prompt(fixed_elements, mode='auto')
    print(f"\n{prompt}")

    print("\n5. æ£€æŸ¥å®Œæ•´æ€§...")
    missing = gen.check_completeness(intent, prompt)
    if missing:
        print(f"   âš ï¸ å‘çŽ° {len(missing)} ä¸ªç¼ºå¤±çš„éœ€æ±‚:")
        for item in missing:
            print(f"   - {item['description']}")
            print(f"     {item['suggestion']}")
    else:
        print("   âœ“ æç¤ºè¯æ»¡è¶³æ‰€æœ‰ç”¨æˆ·è¦æ±‚")

    gen.close()


def query_candidates_by_intent(intent: dict, db_path: str = 'extracted_results/elements.db') -> dict:
    """
    ã€æ‰§è¡Œå±‚ã€‘æ ¹æ®IntentæŸ¥è¯¢æ‰€æœ‰å€™é€‰å…ƒç´ 

    è¾“å…¥ï¼šIntentå­—å…¸ï¼ˆç”±SKILLæž„é€ ï¼‰
    è¾“å‡ºï¼šå€™é€‰å­—å…¸ {field: [elements]}
    """
    from framework_loader import FrameworkDrivenGenerator

    gen = FrameworkDrivenGenerator(db_path)
    candidates = gen.query_all_candidates_by_framework(intent)

    return candidates


def assemble_prompt_from_elements(elements: list, subject_desc: str = '') -> str:
    """
    ã€æ‰§è¡Œå±‚ã€‘ä»Žå…ƒç´ åˆ—è¡¨æ‹¼æŽ¥æç¤ºè¯

    è¾“å…¥ï¼š
    - elements: å…ƒç´ åˆ—è¡¨ï¼ˆç”±SKILLé€‰æ‹©ï¼‰
    - subject_desc: ä¸»ä½“æè¿°ï¼ˆå¯é€‰ï¼Œå¦‚"A young woman"ï¼‰

    è¾“å‡ºï¼šå®Œæ•´æç¤ºè¯å­—ç¬¦ä¸²
    """
    parts = []

    if subject_desc:
        parts.append(subject_desc)

    for element in elements:
        template = element.get('template', '')
        if template:
            parts.append(template)

    return ', '.join(parts)


def save_generated_prompt(prompt_text: str, user_intent: str,
                         elements_used: list, style_tag: str = None,
                         quality_score: float = 9.0,
                         db_path: str = 'extracted_results/elements.db') -> int:
    """
    ã€æ‰§è¡Œå±‚ã€‘ä¿å­˜ç”Ÿæˆçš„Promptåˆ°æ•°æ®åº“

    è¿™æ˜¯prompt-analyzerå·¥ä½œçš„æ•°æ®æ¥æºï¼

    å‚æ•°ï¼š
    - prompt_text: å®Œæ•´çš„æç¤ºè¯æ–‡æœ¬
    - user_intent: ç”¨æˆ·çš„åŽŸå§‹éœ€æ±‚æè¿°
    - elements_used: ä½¿ç”¨çš„å…ƒç´ åˆ—è¡¨ï¼ˆæ¯ä¸ªå…ƒç´ åº”åŒ…å«element_id, category, field_nameï¼‰
    - style_tag: é£Žæ ¼æ ‡ç­¾ï¼ˆå¦‚ancient_chinese, modern_sci_fiç­‰ï¼‰
    - quality_score: è´¨é‡è¯„åˆ†ï¼ˆç”±SKILLè¯„ä¼°ï¼Œé»˜è®¤9.0ï¼‰
    - db_path: æ•°æ®åº“è·¯å¾„

    è¿”å›žï¼š
    - prompt_id: ä¿å­˜åŽçš„Prompt ID
    """
    import sqlite3
    from datetime import datetime

    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()

    try:
        # 1. ä¿å­˜åˆ°generated_promptsè¡¨
        cursor.execute('''
            INSERT INTO generated_prompts
            (prompt_text, user_intent, quality_score, style_tag, generation_date)
            VALUES (?, ?, ?, ?, ?)
        ''', (prompt_text, user_intent, quality_score, style_tag, datetime.now()))

        prompt_id = cursor.lastrowid

        # 2. ä¿å­˜å…ƒç´ å…³è”åˆ°prompt_elementsè¡¨
        for element in elements_used:
            element_id = element.get('element_id')
            category = element.get('category')
            field_name = element.get('field_name', '')

            if element_id:  # åªä¿å­˜æœ‰æ•ˆçš„element_id
                cursor.execute('''
                    INSERT INTO prompt_elements
                    (prompt_id, element_id, category, field_name)
                    VALUES (?, ?, ?, ?)
                ''', (prompt_id, element_id, category, field_name))

        # 3. æ›´æ–°å…ƒç´ ä½¿ç”¨ç»Ÿè®¡
        for element in elements_used:
            element_id = element.get('element_id')
            if element_id:
                # æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ç»Ÿè®¡è®°å½•
                cursor.execute('''
                    SELECT usage_count, avg_quality
                    FROM element_usage_stats
                    WHERE element_id = ?
                ''', (element_id,))

                existing = cursor.fetchone()

                if existing:
                    # æ›´æ–°ç»Ÿè®¡
                    old_count = existing[0]
                    old_avg = existing[1]
                    new_count = old_count + 1
                    new_avg = (old_avg * old_count + quality_score) / new_count

                    cursor.execute('''
                        UPDATE element_usage_stats
                        SET usage_count = ?, avg_quality = ?, last_used = ?
                        WHERE element_id = ?
                    ''', (new_count, new_avg, datetime.now(), element_id))
                else:
                    # åˆ›å»ºæ–°ç»Ÿè®¡è®°å½•
                    cursor.execute('''
                        INSERT INTO element_usage_stats
                        (element_id, usage_count, avg_quality, last_used)
                        VALUES (?, 1, ?, ?)
                    ''', (element_id, quality_score, datetime.now()))

        conn.commit()
        print(f"âœ… Promptå·²ä¿å­˜åˆ°æ•°æ®åº“ï¼ŒID: #{prompt_id}")
        return prompt_id

    except Exception as e:
        conn.rollback()
        print(f"âŒ ä¿å­˜Promptå¤±è´¥: {e}")
        raise
    finally:
        conn.close()


if __name__ == '__main__':
    # æµ‹è¯•ï¼šæ—§çš„Intent-basedæµç¨‹
    test_intelligent_generator()



================================================
FILE: prompt_framework.yaml
================================================
# ============================================================
# äººåƒæç¤ºè¯ç”Ÿæˆæ¡†æž¶ - 7å¤§ç±»æ¨¡æ¿
# Portrait Prompt Generation Framework - 7 Categories
# ============================================================

framework_version: "1.0"
description: "å®šä¹‰äººåƒæç¤ºè¯ç”Ÿæˆçš„å®Œæ•´è§„åˆ™å’Œç»“æž„"
last_updated: "2026-01-02"

# ============================================================
# ä¸ƒå¤§ç±» (7 Categories)
# ============================================================

categories:

  # ==================== 1. ä¸»ä½“ (Subject) ====================
  subject:
    priority: 1
    required: true
    description: "äººç‰©ä¸»ä½“çš„åŸºç¡€èº«ä»½å±žæ€§"
    fields:

      gender:
        type: "enum"
        required: true
        default: "female"
        values: ["female", "male", "non-binary"]
        db_category: "gender"

      ethnicity:
        type: "enum"
        required: true
        default: "East_Asian"
        values:
          - "East_Asian"
          - "Southeast_Asian"
          - "South_Asian"
          - "European"
          - "African"
          - "Middle_Eastern"
          - "Latin_American"
        db_category: "ethnicity"

      age_range:
        type: "enum"
        required: true
        default: "young_adult"
        values:
          - "child"
          - "teen"
          - "young_adult"
          - "adult"
          - "middle_aged"
          - "elderly"
        db_category: "age_range"

  # ==================== 2. é¢éƒ¨ (Facial) ====================
  facial:
    priority: 2
    required: true
    description: "é¢éƒ¨è¯¦ç»†ç‰¹å¾"
    fields:

      eyes:
        type: "string"
        required: false
        default: "auto"
        db_category: "eye_types"
        search_keywords:
          almond: ["almond", "almond-shaped"]
          large_expressive: ["large expressive", "big eyes", "expressive eyes"]
          round: ["round eyes"]
          auto: []

      skin_tone:
        type: "string"
        required: false
        default: "auto"
        db_category: "skin_tones"
        search_keywords:
          fair: ["fair", "pale", "porcelain"]
          medium: ["medium", "olive"]
          tan: ["tan", "bronze"]
          deep: ["deep", "dark"]
          auto: []

      skin_texture:
        type: "string"
        required: false
        db_category: "skin_textures"
        search_keywords:
          realistic: ["realistic", "pores", "natural imperfections"]
          smooth: ["smooth", "flawless"]
          dewy: ["dewy", "luminous"]

      face_shape:
        type: "string"
        required: false
        db_category: "face_shapes"
        search_keywords:
          oval: ["oval"]
          round: ["round"]
          heart: ["heart-shaped"]
          square: ["square"]

      nose:
        type: "string"
        required: false
        db_category: "nose_types"

      lips:
        type: "string"
        required: false
        db_category: "lip_types"

  # ==================== 3. é€ åž‹ (Styling) ====================
  styling:
    priority: 3
    required: true
    description: "æ•´ä½“é€ åž‹ï¼ˆæœè£…ã€å‘åž‹ã€å¦†å®¹ã€é…é¥°ï¼‰"
    fields:

      clothing:
        type: "string"
        required: false
        default: "modern"
        db_category: "clothing_styles"
        search_keywords:
          traditional_chinese: ["traditional", "chinese", "hanfu", "period"]
          kimono: ["kimono", "japanese"]
          modern: ["modern", "casual"]
          business: ["business", "suit", "formal"]
          casual: ["casual"]
          formal: ["formal", "evening gown"]

      hairstyle:
        type: "string"
        required: false
        default: "modern"
        db_category: "hair_styles"
        search_keywords:
          ancient_chinese: ["traditional", "classical", "bun", "updo"]
          traditional_japanese: ["traditional", "japanese"]
          modern: ["modern", "contemporary"]
          ponytail: ["ponytail"]
          long_flowing: ["long", "flowing"]

      hair_color:
        type: "string"
        required: false
        default: "auto"
        db_category: "hair_colors"
        search_keywords:
          black: ["black"]
          brown: ["brown", "dark brown"]
          blonde: ["blonde"]
          red: ["red", "auburn"]
          auto: []

      makeup:
        type: "string"
        required: true
        default: "natural"
        db_category: "makeup_styles"
        search_keywords:
          traditional_chinese: ["traditional", "chinese", "ancient"]
          traditional_japanese: ["traditional", "japanese"]
          k_beauty: ["k-beauty", "korean"]
          c_beauty: ["c-beauty", "chinese"]
          natural: ["natural"]
          western_glam: ["western", "glam"]
          french_elegant: ["french", "elegant"]

      accessories:
        type: "string"
        required: false
        db_category: "accessories"
        search_keywords:
          hairpin: ["hairpin", "ornament", "traditional"]
          jewelry: ["jewelry", "necklace", "earring"]
          none: []

  # ==================== 4. è¡¨çŽ° (Expression) ====================
  expression:
    priority: 4
    required: false
    description: "è¡¨æƒ…ã€å§¿æ€å’ŒåŠ¨ä½œ"
    fields:

      facial_expression:
        type: "string"
        required: false
        db_category: "expressions"
        search_keywords:
          serene: ["serene", "calm", "peaceful"]
          gentle_smile: ["gentle smile", "soft smile"]
          innocent: ["innocent gaze", "pure"]
          mysterious: ["mysterious", "enigmatic"]
          confident: ["confident", "strong"]

      pose:
        type: "string"
        required: false
        db_category: "poses"
        search_keywords:
          relaxed: ["relaxed", "casual"]
          dynamic: ["dynamic", "flowing", "movement"]
          elegant: ["elegant", "graceful"]
          powerful: ["powerful", "strong"]
          seated: ["seated", "sitting"]

  # ==================== 5. å…‰å½± (Lighting) ====================
  lighting:
    priority: 5
    required: true
    description: "å…‰å½±è®¾ç½®ï¼ˆå¿…é€‰ï¼‰"
    fields:

      lighting_type:
        type: "string"
        required: true
        default: "natural"
        db_category: "lighting_techniques"
        search_keywords:
          natural: ["natural", "window light", "daylight", "soft light"]
          cinematic: ["cinematic", "dramatic", "rim light", "film lighting"]
          zhang_yimou: ["dramatic", "shadow", "rim", "chiaroscuro", "volumetric"]
          neon: ["neon", "colorful", "glow"]
          soft: ["soft", "gentle", "diffused"]
          dramatic: ["dramatic", "shadow", "contrast"]
          golden_hour: ["golden hour", "warm", "sunset"]

  # ==================== 6. åœºæ™¯ (Scene) ====================
  scene:
    priority: 6
    required: false
    description: "åœºæ™¯çŽ¯å¢ƒå’Œæ—¶ä»£æ°›å›´"
    fields:

      era:
        type: "string"
        required: true
        default: "modern"
        values:
          - "ancient"
          - "republic_of_china"
          - "modern"
          - "future"
          - "timeless"

      background:
        type: "string"
        required: false
        db_category: "backgrounds"
        search_keywords:
          traditional_chinese: ["traditional chinese architecture", "pavilion", "classical"]
          indoor: ["indoor", "interior"]
          outdoor: ["outdoor", "nature"]
          urban: ["urban", "city"]
          minimal: ["minimal", "simple", "bokeh"]

      atmosphere:
        type: "string"
        required: false
        values:
          - "natural"
          - "cyberpunk"
          - "fantasy"
          - "wuxia"
          - "period_drama"
          - "romantic"
          - "mysterious"
          - "ethereal"

      director_style:
        type: "string"
        required: false
        values:
          - "tsui_hark"
          - "zhang_yimou"
          - "wong_kar_wai"

  # ==================== 7. æŠ€æœ¯ (Technical) ====================
  technical:
    priority: 7
    required: false
    description: "æŠ€æœ¯å‚æ•°å’Œæ¸²æŸ“é£Žæ ¼"
    fields:

      art_style:
        type: "string"
        required: false
        values:
          - "realistic"
          - "cinematic"
          - "anime"
          - "illustration"
          - "oil_painting"
          - "watercolor"
          - "3d_render"

      camera:
        type: "string"
        required: false
        db_category: "camera_equipment"
        search_keywords:
          35mm: ["35mm", "film"]
          digital: ["digital", "DSLR"]

      bokeh:
        type: "string"
        required: false
        db_category: "bokeh_styles"
        search_keywords:
          creamy: ["creamy bokeh", "smooth"]
          cinematic: ["cinematic bokeh"]

      quality:
        type: "string"
        required: false
        values:
          - "8K"
          - "4K"
          - "ultra_detailed"
          - "photorealistic"
          - "high_resolution"

# ============================================================
# ä¾èµ–å…³ç³»è§„åˆ™ (Dependency Rules)
# ============================================================

dependencies:

  # è§„åˆ™1ï¼šå¤è£…è‡ªåŠ¨æŽ¨å¯¼
  - name: "å¤è£…è‡ªåŠ¨æŽ¨å¯¼"
    when:
      scene.era: "ancient"
    then:
      styling.clothing: "traditional_chinese"
      styling.hairstyle: "ancient_chinese"
      styling.makeup: "traditional_chinese"

  # è§„åˆ™2ï¼šä¸œäºšäººç§è‡ªåŠ¨æŽ¨å¯¼å‘è‰²
  - name: "ä¸œäºšäººç§é»˜è®¤å‘è‰²"
    when:
      subject.ethnicity: "East_Asian"
      styling.hair_color: "auto"
    then:
      styling.hair_color: "black"

  # è§„åˆ™3ï¼šä¸œäºšäººç§è‡ªåŠ¨æŽ¨å¯¼çœ¼åž‹
  - name: "ä¸œäºšäººç§é»˜è®¤çœ¼åž‹"
    when:
      subject.ethnicity: "East_Asian"
      facial.eyes: "auto"
    then:
      facial.eyes: "almond"

# ============================================================
# éªŒè¯è§„åˆ™ (Validation Rules)
# ============================================================

validation:

  # å¿…é€‰å­—æ®µæ£€æŸ¥
  required_fields:
    - field: "lighting.lighting_type"
      error_message: "æ¯ä¸ªäººåƒå¿…é¡»æœ‰å…‰å½±è®¾ç½®"
    - field: "styling.makeup"
      error_message: "æ¯ä¸ªäººåƒå¿…é¡»æœ‰å¦†å®¹è®¾ç½®"

  # é€»è¾‘ä¸€è‡´æ€§æ£€æŸ¥
  consistency_checks:

    - name: "å¦†å®¹ä¸Žæ—¶ä»£åŒ¹é…"
      when:
        scene.era: "ancient"
        styling.makeup: ["k_beauty", "natural", "western_glam"]
      severity: "error"
      message: "å¤è£…åœºæ™¯ä¸åº”è¯¥ä½¿ç”¨çŽ°ä»£å¦†å®¹"
      suggestion: "åº”è¯¥ä½¿ç”¨ traditional_chinese æˆ– traditional_japanese"

    - name: "äººç§ä¸Žçœ¼ç›é¢œè‰²åŒ¹é…"
      when:
        subject.ethnicity: "East_Asian"
        facial.eyes: ["green", "blue"]
      severity: "warning"
      message: "ä¸œäºšäººé€šå¸¸ä¸ä¼šæœ‰ç»¿è‰²/è“è‰²çœ¼ç›"
      suggestion: "å»ºè®®ä½¿ç”¨ almond æˆ– dark brown eyes"



================================================
FILE: README_v2.0.md
================================================
[Binary file]


================================================
FILE: requirements.txt
================================================
# Core dependencies
anthropic>=0.7.0
pyyaml>=6.0

# Database
sqlite3  # Built-in with Python

# Optional: For advanced features
# requests>=2.28.0  # If you add web fetching
# pandas>=1.5.0     # For data analysis



================================================
FILE: UPGRADE_GUIDE_v2.0.md
================================================
[Binary file]


================================================
FILE: core/cross_domain_generator.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è·¨Domainç”Ÿæˆå™¨ - ç»Ÿä¸€çš„æç¤ºè¯ç”Ÿæˆå…¥å£
è‡ªåŠ¨è¯†åˆ«éœ€æ±‚ç±»åž‹ï¼Œæ™ºèƒ½è·¯ç”±åˆ°å¯¹åº”ç”Ÿæˆå™¨
"""

import sys
import os
import re
from typing import Dict, List, Optional

# æ·»åŠ ä¸Šçº§ç›®å½•åˆ°è·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from core.cross_domain_query import CrossDomainQueryEngine
from core.design_bridge import DesignVariableBridge
from intelligent_generator import IntelligentGenerator


class CrossDomainGenerator:
    """ç»Ÿä¸€çš„è·¨Domainç”Ÿæˆå™¨"""

    def __init__(self, db_path: str = "extracted_results/elements.db",
                 yaml_dir: str = "variables"):
        """
        åˆå§‹åŒ–è·¨domainç”Ÿæˆå™¨

        Args:
            db_path: SQLiteæ•°æ®åº“è·¯å¾„
            yaml_dir: YAMLå˜é‡æ–‡ä»¶ç›®å½•
        """
        self.query_engine = CrossDomainQueryEngine(db_path)
        self.design_bridge = DesignVariableBridge(db_path, yaml_dir)
        self.portrait_generator = IntelligentGenerator(db_path)

    def generate(self, user_input: str, generation_type: str = 'auto') -> Dict:
        """
        ç»Ÿä¸€ç”Ÿæˆå…¥å£

        Args:
            user_input: ç”¨æˆ·è¾“å…¥ï¼ˆè‡ªç„¶è¯­è¨€ï¼‰
            generation_type: ç”Ÿæˆç±»åž‹
                - 'portrait': äººåƒï¼ˆä»…SQLite portrait domainï¼‰
                - 'design': è®¾è®¡ï¼ˆSQLite + YAMLï¼‰
                - 'cross_domain': è·¨domainï¼ˆSQLiteå¤šdomainï¼‰
                - 'auto': è‡ªåŠ¨è¯†åˆ«

        Returns:
            ç”Ÿæˆç»“æžœå­—å…¸
            {
                'prompt': 'å®Œæ•´æç¤ºè¯',
                'type': 'ç”Ÿæˆç±»åž‹',
                'metadata': {...}
            }
        """
        # 1. è§£æžç”¨æˆ·è¾“å…¥ä¸ºIntent
        intent = self.parse_user_input(user_input)

        # 2. è‡ªåŠ¨è¯†åˆ«ç”Ÿæˆç±»åž‹
        if generation_type == 'auto':
            generation_type = self.classify_generation_type(intent)

        print(f"ðŸ“Œ ç”Ÿæˆç±»åž‹: {generation_type}")

        # 3. è·¯ç”±åˆ°å¯¹åº”ç”Ÿæˆå™¨
        if generation_type == 'portrait':
            # çº¯äººåƒ â†’ åªç”¨portrait domainï¼ˆå‘åŽå…¼å®¹ï¼‰
            return self.generate_portrait(intent)

        elif generation_type == 'design':
            # è®¾è®¡æµ·æŠ¥/å¡ç‰‡ â†’ SQLiteåŸºç¡€ + YAMLè®¾è®¡
            return self.generate_design(intent)

        elif generation_type == 'cross_domain':
            # å¤æ‚åœºæ™¯ â†’ SQLiteè·¨domain
            return self.generate_cross_domain(intent)

        else:
            raise ValueError(f"Unknown generation type: {generation_type}")

    def parse_user_input(self, user_input: str) -> Dict:
        """
        è§£æžç”¨æˆ·è¾“å…¥ä¸ºç»“æž„åŒ–Intent

        Args:
            user_input: ç”¨æˆ·è¾“å…¥å­—ç¬¦ä¸²

        Returns:
            Intentå­—å…¸
        """
        intent = {
            'raw_input': user_input,
            'subject': {},
            'action': None,
            'visual_style': {},
            'atmosphere': {},
            'design_style': None,
            'lighting': 'natural'
        }

        user_lower = user_input.lower()

        # è¯†åˆ«äººç‰©
        if any(kw in user_lower for kw in ['å¥³', 'woman', 'female', 'å¥³æ€§', 'å°‘å¥³']):
            intent['subject']['gender'] = 'female'
        elif any(kw in user_lower for kw in ['ç”·', 'man', 'male', 'ç”·æ€§', 'æ‚Ÿç©º', 'goku']):
            intent['subject']['gender'] = 'male'

        # è¯†åˆ«äººç§
        if any(kw in user_input for kw in ['ä¸œäºš', 'East_Asian', 'ä¸­å›½', 'æ—¥æœ¬', 'éŸ©å›½']):
            intent['subject']['ethnicity'] = 'East_Asian'

        # è¯†åˆ«å¹´é¾„
        if any(kw in user_input for kw in ['å¹´è½»', 'young', 'å°‘å¥³']):
            intent['subject']['age_range'] = 'young_adult'
        elif any(kw in user_input for kw in ['å„¿ç«¥', 'child', 'å­©å­']):
            intent['subject']['age_range'] = 'child'

        # è¯†åˆ«åŠ¨ä½œï¼ˆç‰¹æ®Šè¯†åˆ«é¾Ÿæ´¾æ°”åŠŸï¼‰
        if any(kw in user_input for kw in ['é¾Ÿæ´¾æ°”åŠŸ', 'kamehameha', 'èƒ½é‡æ³¢']):
            intent['action'] = 'kamehameha'
            intent['energy'] = 'blue_energy_blast'

        # è¯†åˆ«è‰ºæœ¯é£Žæ ¼
        if any(kw in user_input for kw in ['3d', '3D', 'èœ¡åƒ', 'wax']):
            intent['visual_style']['art_style'] = 'wax_figure_3d'
        elif any(kw in user_input for kw in ['åŠ¨æ¼«', 'anime']):
            intent['visual_style']['art_style'] = 'anime'

        # è¯†åˆ«è®¾è®¡é£Žæ ¼
        if any(kw in user_input for kw in ['æ¸©é¦¨å¯çˆ±', 'å¯çˆ±', 'cute', 'warm']):
            intent['design_style'] = 'æ¸©é¦¨å¯çˆ±'
        elif any(kw in user_input for kw in ['çŽ°ä»£ç®€çº¦', 'ç®€çº¦', 'minimal', 'modern']):
            intent['design_style'] = 'çŽ°ä»£ç®€çº¦'

        # è¯†åˆ«è®¾è®¡éœ€æ±‚
        if any(kw in user_input for kw in ['æµ·æŠ¥', 'poster', 'å¡ç‰‡', 'card']):
            intent['design_requirement'] = True

        # è¯†åˆ«å…‰å½±
        if any(kw in user_input for kw in ['ç”µå½±', 'cinematic', 'ç”µå½±çº§']):
            intent['lighting'] = 'cinematic'
        elif any(kw in user_input for kw in ['è‡ªç„¶', 'natural']):
            intent['lighting'] = 'natural'

        return intent

    def classify_generation_type(self, intent: Dict) -> str:
        """
        è‡ªåŠ¨åˆ†ç±»ç”Ÿæˆç±»åž‹

        Args:
            intent: è§£æžçš„Intent

        Returns:
            ç”Ÿæˆç±»åž‹å­—ç¬¦ä¸²
        """
        # æ£€æŸ¥æ˜¯å¦æ˜¯è®¾è®¡éœ€æ±‚
        if intent.get('design_style') or intent.get('design_requirement'):
            return 'design'

        # æ£€æŸ¥æ˜¯å¦éœ€è¦å¤šä¸ªdomain
        need_multiple_domains = False

        # æœ‰åŠ¨ä½œ/èƒ½é‡/ç‰¹æ•ˆ â†’ éœ€è¦video/art domain
        if intent.get('action') or intent.get('energy'):
            need_multiple_domains = True

        # æœ‰ç‰¹æ®Šè‰ºæœ¯é£Žæ ¼ï¼ˆ3Dã€èœ¡åƒï¼‰ â†’ éœ€è¦art domain
        visual_style = intent.get('visual_style', {})
        art_style = visual_style.get('art_style', '')
        if any(kw in art_style for kw in ['3d', 'wax', 'holographic']):
            need_multiple_domains = True

        if need_multiple_domains:
            return 'cross_domain'

        # é»˜è®¤ï¼šå¦‚æžœæœ‰äººç‰©ï¼Œå°±æ˜¯portrait
        if intent.get('subject'):
            return 'portrait'

        # æ²¡æœ‰äººç‰©ï¼Œä¹Ÿä¸æ˜¯è®¾è®¡ï¼Œé»˜è®¤cross_domain
        return 'cross_domain'

    def generate_portrait(self, intent: Dict) -> Dict:
        """
        ç”Ÿæˆçº¯äººåƒæç¤ºè¯ï¼ˆå‘åŽå…¼å®¹ï¼‰

        Args:
            intent: ç”¨æˆ·æ„å›¾

        Returns:
            ç”Ÿæˆç»“æžœ
        """
        print("  â†’ ä½¿ç”¨ portrait ç”Ÿæˆå™¨ï¼ˆå‘åŽå…¼å®¹ï¼‰")

        # ä½¿ç”¨åŽŸæœ‰çš„intelligent_generator
        elements = self.portrait_generator.select_elements_by_intent(intent)

        # æ£€æŸ¥ä¸€è‡´æ€§
        issues = self.portrait_generator.check_consistency(elements)
        if issues:
            elements, fixes = self.portrait_generator.resolve_conflicts(elements, issues)

        # ç”Ÿæˆæç¤ºè¯
        prompt = self.portrait_generator.compose_prompt(elements, mode='auto')

        return {
            'prompt': prompt,
            'type': 'portrait',
            'metadata': {
                'element_count': len(elements),
                'issues_fixed': len(issues)
            }
        }

    def generate_design(self, intent: Dict) -> Dict:
        """
        ç”Ÿæˆè®¾è®¡æç¤ºè¯ï¼ˆSQLite + YAMLï¼‰

        Args:
            intent: ç”¨æˆ·æ„å›¾

        Returns:
            ç”Ÿæˆç»“æžœ
        """
        print("  â†’ ä½¿ç”¨ design ç”Ÿæˆå™¨ï¼ˆSQLite + YAMLï¼‰")

        result = self.design_bridge.generate_design_prompt(intent)

        return {
            'prompt': result['prompt'],
            'type': 'design',
            'metadata': result['metadata'],
            'yaml_variables': result['yaml_variables']
        }

    def generate_cross_domain(self, intent: Dict) -> Dict:
        """
        ç”Ÿæˆè·¨domainæç¤ºè¯ï¼ˆSQLiteå¤šdomain + intelligent_generatorå®Œæ•´æµç¨‹ï¼‰

        ä¿®å¤ç‰ˆï¼šè·¨åŸŸæŸ¥è¯¢åŽï¼Œå¤ç”¨intelligent_generatorçš„æ ¸å¿ƒèƒ½åŠ›
        - ä¸€è‡´æ€§æ£€æŸ¥
        - å†²çªè§£å†³
        - æ™ºèƒ½ç»„è£…

        Args:
            intent: ç”¨æˆ·æ„å›¾

        Returns:
            ç”Ÿæˆç»“æžœ
        """
        print("  â†’ ä½¿ç”¨ cross_domain ç”Ÿæˆå™¨ï¼ˆSQLiteå¤šdomain + æ™ºèƒ½ç»„è£…ï¼‰")

        # 1. è·¨domainæŸ¥è¯¢èŽ·å–å€™é€‰å…ƒç´ 
        elements_by_domain = self.query_engine.query_by_intent(intent)

        # 2. åˆå¹¶æ‰€æœ‰domainçš„å…ƒç´ ä¸ºç»Ÿä¸€åˆ—è¡¨
        all_elements = []
        for domain, elements in elements_by_domain.items():
            for elem in elements:
                # ç¡®ä¿å…ƒç´ æœ‰å¿…è¦çš„å­—æ®µ
                if 'template' not in elem:
                    elem['template'] = elem.get('ai_prompt_template', '')
                if 'category' not in elem:
                    elem['category'] = elem.get('category_id', 'unknown')
                # æ ‡è®°æ¥æºdomain
                elem['source_domain'] = domain
                all_elements.append(elem)

        print(f"  ðŸ“Š åˆå¹¶äº† {len(all_elements)} ä¸ªå…ƒç´ æ¥è‡ª {len(elements_by_domain)} ä¸ªdomain")

        # 3. å¦‚æžœå…ƒç´ å¤ªå°‘ï¼Œè¡¥å……åŸºäºŽintentçš„æ™ºèƒ½é€‰æ‹©
        if len(all_elements) < 5:
            print("  âš ï¸  å…ƒç´ è¾ƒå°‘ï¼Œä½¿ç”¨intelligent_generatorè¡¥å……...")
            extra_elements = self.portrait_generator.select_elements_by_intent(intent)
            # åˆå¹¶ï¼Œé¿å…é‡å¤
            existing_ids = {e.get('element_id') for e in all_elements}
            for elem in extra_elements:
                if elem.get('element_id') not in existing_ids:
                    elem['source_domain'] = 'portrait_supplement'
                    all_elements.append(elem)
            print(f"  ðŸ“Š è¡¥å……åŽå…± {len(all_elements)} ä¸ªå…ƒç´ ")

        # 4. ä½¿ç”¨intelligent_generatoræ£€æŸ¥ä¸€è‡´æ€§
        issues = self.portrait_generator.check_consistency(all_elements)
        if issues:
            print(f"  ðŸ” å‘çŽ° {len(issues)} ä¸ªä¸€è‡´æ€§é—®é¢˜ï¼Œæ­£åœ¨ä¿®å¤...")
            all_elements, fixes = self.portrait_generator.resolve_conflicts(all_elements, issues)
            for fix in fixes:
                print(f"     {fix}")

        # 5. åŸºäºŽraw_inputå¢žå¼ºpromptï¼ˆæå–ç”¨æˆ·åŽŸå§‹æè¿°ä¸­çš„å…³é”®ä¿¡æ¯ï¼‰
        enhanced_parts = self._extract_scene_description(intent)
        
        # 6. ä½¿ç”¨intelligent_generatorçš„æ™ºèƒ½ç»„è£…
        base_prompt = self.portrait_generator.compose_prompt(all_elements, mode='auto')
        
        # 7. ç»„åˆæœ€ç»ˆæç¤ºè¯ï¼šå¢žå¼ºæè¿° + æ•°æ®åº“å…ƒç´ 
        if enhanced_parts:
            final_prompt = f"{enhanced_parts}, {base_prompt}"
        else:
            final_prompt = base_prompt

        return {
            'prompt': final_prompt,
            'type': 'cross_domain',
            'metadata': {
                'domains_used': list(elements_by_domain.keys()),
                'element_count': len(all_elements),
                'issues_fixed': len(issues) if issues else 0,
                'enhanced': bool(enhanced_parts)
            }
        }

    def _extract_scene_description(self, intent: Dict) -> str:
        """
        ä»Žç”¨æˆ·åŽŸå§‹è¾“å…¥æå–åœºæ™¯æè¿°ï¼Œç”Ÿæˆå¢žå¼ºçš„è‹±æ–‡æè¿°
        
        è¿™æ˜¯cross_domainçš„å…³é”®å¢žå¼ºï¼šå°†ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æè¿°è½¬æ¢ä¸ºç»“æž„åŒ–çš„è‹±æ–‡prompt
        """
        raw_input = intent.get('raw_input', '')
        if not raw_input:
            return ''
        
        parts = []
        raw_lower = raw_input.lower()
        
        # åœºæ™¯ç±»åž‹è¯†åˆ«
        scene_mappings = {
            # å¤ä»£/åŽ†å²åœºæ™¯
            ('ç§¦', 'å®«æ®¿', 'å¤§æ®¿'): 'ancient Chinese Qin Dynasty palace hall, grand imperial architecture',
            ('æˆ˜å›½', 'ç§¦å›½'): 'Warring States period, ancient Chinese military setting',
            ('å¤ä»£', 'å¤è£…'): 'ancient Chinese historical setting',
            ('å®«å»·', 'çš‡å®«'): 'Chinese imperial palace, ornate traditional architecture',
            ('æˆ˜åœº', 'æˆ˜äº‰'): 'epic battlefield, war scene',
            
            # åŠ¨ä½œåœºæ™¯
            ('æ¯”æ­¦', 'å¯¹å†³', 'å†³æ–—'): 'intense combat duel, martial arts battle',
            ('å‰‘æœ¯', 'å‰‘', 'åˆ€'): 'sword fighting, blade combat, weapon clash',
            ('æ­¦æœ¯', 'åŠŸå¤«'): 'martial arts, kung fu action',
            ('æ‰“æ–—', 'æ ¼æ–—'): 'fighting scene, combat action',
            
            # äººç‰©ç±»åž‹
            ('æ­¦å°†', 'å°†å†›', 'å°†é¢†'): 'powerful military general, armored warrior',
            ('æ­¦å£«', 'å‰‘å®¢'): 'skilled swordsman, warrior',
            ('çŽ‹', 'çš‡å¸', 'å›ä¸»'): 'noble king, imperial ruler',
            
            # æ°›å›´
            ('å²è¯—', 'å£®è§‚'): 'epic cinematic scene, grand scale',
            ('ç”µå½±çº§', 'å¤§ç‰‡'): 'blockbuster movie quality, cinematic composition',
            ('æ¿€çƒˆ', 'ç´§å¼ '): 'intense dramatic action, high tension',
        }
        
        for keywords, english_desc in scene_mappings.items():
            if any(kw in raw_input for kw in keywords):
                parts.append(english_desc)
        
        # ç‰¹å®šäººç‰©è¯†åˆ«
        character_mappings = {
            'èµ¢ç¨·': 'King Yingji of Qin',
            'ç§¦çŽ‹': 'King of Qin',
            'ç™½èµ·': 'General Baiqi, legendary military commander',
            'é¡¹ç¾½': 'Xiang Yu, mighty warrior king',
            'åˆ˜é‚¦': 'Liu Bang, founder of Han Dynasty',
            'éŸ©ä¿¡': 'Han Xin, brilliant military strategist',
            'æ‚Ÿç©º': 'Son Goku, powerful martial artist',
        }
        
        for cn_name, en_name in character_mappings.items():
            if cn_name in raw_input:
                parts.append(en_name)
        
        # è§†è§‰é£Žæ ¼å¢žå¼º
        if any(kw in raw_lower for kw in ['ç”µå½±', 'cinematic', 'å²è¯—']):
            parts.append('dramatic lighting, dust particles in the air')
        
        if any(kw in raw_lower for kw in ['å¤ä»£', 'æˆ˜å›½', 'ç§¦']):
            parts.append('elaborate period costume with intricate bronze patterns')
        
        # åŽ»é‡å¹¶è¿”å›ž
        seen = set()
        unique_parts = []
        for part in parts:
            if part not in seen:
                seen.add(part)
                unique_parts.append(part)
        
        return ', '.join(unique_parts)

    def close(self):
        """å…³é—­èµ„æº"""
        self.query_engine.close()
        self.design_bridge.close()
        self.portrait_generator.close()


def test_cross_domain_generator():
    """æµ‹è¯•CrossDomainGenerator"""
    print("=" * 80)
    print("æµ‹è¯•CrossDomainGeneratorç»Ÿä¸€æŽ¥å£")
    print("=" * 80)

    generator = CrossDomainGenerator()

    # æµ‹è¯•1ï¼šçº¯äººåƒï¼ˆå‘åŽå…¼å®¹ï¼‰
    print("\nã€æµ‹è¯•1ã€‘çº¯äººåƒï¼šç”Ÿæˆä¸€ä¸ªå¹´è½»å¥³æ€§è‚–åƒ\n")
    result1 = generator.generate("ç”Ÿæˆä¸€ä¸ªå¹´è½»å¥³æ€§è‚–åƒ")
    print(f"\nç±»åž‹: {result1['type']}")
    print(f"å…ƒç´ æ•°: {result1['metadata']['element_count']}")
    print(f"æç¤ºè¯é•¿åº¦: {len(result1['prompt'])} å­—ç¬¦")

    # æµ‹è¯•2ï¼šè·¨domainå¤æ‚åœºæ™¯
    print("\n\nã€æµ‹è¯•2ã€‘è·¨domainï¼šé¾™ç æ‚Ÿç©ºæ‰“é¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ\n")
    result2 = generator.generate("é¾™ç åŠ¨æ¼«çš„èœ¡åƒ3Dæ„Ÿæ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸ")
    print(f"\nç±»åž‹: {result2['type']}")
    print(f"ä½¿ç”¨domain: {', '.join(result2['metadata']['domains_used'])}")
    print(f"å…ƒç´ æ•°: {result2['metadata']['element_count']}")
    print(f"\næç¤ºè¯é¢„è§ˆ: {result2['prompt'][:200]}...")

    # æµ‹è¯•3ï¼šè®¾è®¡æµ·æŠ¥ï¼ˆSQLite + YAMLï¼‰
    print("\n\nã€æµ‹è¯•3ã€‘è®¾è®¡ï¼šæ¸©é¦¨å¯çˆ±çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥\n")
    result3 = generator.generate("æ¸©é¦¨å¯çˆ±é£Žæ ¼çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥")
    print(f"\nç±»åž‹: {result3['type']}")
    print(f"é£Žæ ¼: {result3['metadata']['design_style']}")
    if 'yaml_variables' in result3:
        print(f"é…è‰²: {result3['yaml_variables'].get('colors', {}).get('scheme_name')}")
    print(f"\næç¤ºè¯: {result3['prompt']}")

    generator.close()
    print("\n\nâœ… æ‰€æœ‰æµ‹è¯•å®Œæˆ")


if __name__ == '__main__':
    test_cross_domain_generator()



================================================
FILE: core/cross_domain_query.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è·¨DomainæŸ¥è¯¢å¼•æ“Ž - æ™ºèƒ½æŸ¥è¯¢å¤šä¸ªdomainå¹¶ç»„åˆå…ƒç´ 
æ ¸å¿ƒåŠŸèƒ½ï¼šæ ¹æ®ç”¨æˆ·æ„å›¾è‡ªåŠ¨è¯†åˆ«éœ€è¦çš„domainsï¼Œæ™ºèƒ½æŸ¥è¯¢å’Œç»„åˆ
"""

import sqlite3
import json
import sys
import os
from typing import Dict, List, Optional, Set, Any

# æ·»åŠ ä¸Šçº§ç›®å½•åˆ°è·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from core.variable_sampler import SQLiteVariableSampler
from intelligent_generator import IntelligentGenerator


class CrossDomainQueryEngine:
    """è·¨Domainæ™ºèƒ½æŸ¥è¯¢å¼•æ“Ž"""

    def __init__(self, db_path: str = "extracted_results/elements.db"):
        """
        åˆå§‹åŒ–è·¨domainæŸ¥è¯¢å¼•æ“Ž

        Args:
            db_path: æ•°æ®åº“è·¯å¾„
        """
        self.db = sqlite3.connect(db_path)
        self.cursor = self.db.cursor()
        self.sampler = SQLiteVariableSampler(db_path)
        self.generator = IntelligentGenerator(db_path)

    def query_by_intent(self, intent: Dict) -> Dict[str, List[Dict]]:
        """
        æ ¹æ®ç”¨æˆ·æ„å›¾è·¨domainæŸ¥è¯¢å…ƒç´ 

        Args:
            intent: ç”¨æˆ·æ„å›¾å­—å…¸

        Returns:
            æŒ‰domainåˆ†ç»„çš„å…ƒç´ å­—å…¸
            {
                'portrait': [element1, element2, ...],
                'video': [element3, ...],
                'art': [element4, ...],
                'common': [element5, ...]
            }
        """
        # 1. åˆ†æžéœ€è¦å“ªäº›domains
        required_domains = self.analyze_required_domains(intent)
        print(f"ðŸ“Š åˆ†æžç»“æžœï¼šéœ€è¦ {len(required_domains)} ä¸ªdomain: {', '.join(required_domains)}")

        # 2. æž„å»ºè·¨domain SQLæŸ¥è¯¢è®¡åˆ’
        query_plan = self.build_query_plan(intent, required_domains)

        # 3. æ‰§è¡ŒæŸ¥è¯¢ï¼Œä»Žå¤šä¸ªdomainsèŽ·å–å…ƒç´ 
        elements = {}
        for domain, categories in query_plan.items():
            print(f"  ðŸ” æŸ¥è¯¢ {domain} domain: {', '.join(categories)}")
            elements[domain] = self.query_domain(domain, categories, intent)

        # 4. åº”ç”¨å˜é‡é‡‡æ ·ï¼ˆå¦‚æžœå…ƒç´ æœ‰å˜é‡ï¼‰
        sampled_elements = {}
        for domain, domain_elements in elements.items():
            sampled_elements[domain] = []
            for elem in domain_elements:
                # æ£€æŸ¥æ˜¯å¦æœ‰å˜é‡
                try:
                    result = self.sampler.sample_element_with_variables(
                        elem['element_id'],
                        style_context=intent.get('visual_style')
                    )
                    # å¦‚æžœæœ‰å˜é‡ï¼Œä½¿ç”¨é‡‡æ ·åŽçš„ç»“æžœ
                    if result['variables']:
                        elem_copy = elem.copy()
                        elem_copy['template'] = result['result']
                        elem_copy['sampled_variables'] = result['variables']
                        sampled_elements[domain].append(elem_copy)
                    else:
                        sampled_elements[domain].append(elem)
                except:
                    # æ²¡æœ‰å˜é‡æˆ–é‡‡æ ·å¤±è´¥ï¼Œä½¿ç”¨åŽŸå§‹å…ƒç´ 
                    sampled_elements[domain].append(elem)

        return sampled_elements

    def analyze_required_domains(self, intent: Dict) -> List[str]:
        """
        åˆ†æžæ„å›¾éœ€è¦å“ªäº›domains

        Args:
            intent: ç”¨æˆ·æ„å›¾å­—å…¸

        Returns:
            éœ€è¦çš„domainåˆ—è¡¨
        """
        domains = set()

        # æœ‰äººç‰© â†’ portrait
        if 'subject' in intent:
            domains.add('portrait')

        # æœ‰åŠ¨ä½œ/èƒ½é‡/è¿åŠ¨ â†’ video
        video_keywords = ['action', 'pose', 'energy', 'movement', 'motion', 'dynamic']
        if any(k in intent for k in video_keywords):
            domains.add('video')

        # æ£€æŸ¥ç‰¹æ®ŠåŠ¨ä½œå…³é”®è¯
        raw_input = intent.get('raw_input', '').lower()
        if any(kw in raw_input for kw in ['kamehameha', 'é¾Ÿæ´¾æ°”åŠŸ', 'èƒ½é‡', 'energy', 'æ°”æ¯']):
            domains.add('video')

        # æœ‰è‰ºæœ¯é£Žæ ¼ â†’ art
        if 'art_style' in intent or 'visual_style' in intent:
            visual_style = intent.get('visual_style', {})
            if isinstance(visual_style, dict):
                art_style = visual_style.get('art_style', '')
            else:
                art_style = str(visual_style)

            # ç‰¹æ®Šè‰ºæœ¯é£Žæ ¼éœ€è¦art domain
            art_keywords = ['3d', 'wax', 'èœ¡åƒ', 'holographic', 'sculpture', 'rendering']
            if any(kw in art_style.lower() for kw in art_keywords):
                domains.add('art')

        # æœ‰è®¾è®¡éœ€æ±‚ â†’ design
        design_keywords = ['layout', 'composition', 'typography', 'poster', 'card']
        if any(k in intent for k in design_keywords):
            domains.add('design')

        # æœ‰äº§å“ â†’ product
        if 'product' in intent:
            domains.add('product')

        # å§‹ç»ˆåŒ…å«commonï¼ˆå…‰å½±ã€æŠ€æœ¯å‚æ•°ï¼‰
        domains.add('common')

        return list(domains)

    def build_query_plan(self, intent: Dict, domains: List[str]) -> Dict[str, List[str]]:
        """
        æž„å»ºæŸ¥è¯¢è®¡åˆ’

        Args:
            intent: ç”¨æˆ·æ„å›¾
            domains: éœ€è¦æŸ¥è¯¢çš„domainåˆ—è¡¨

        Returns:
            æŸ¥è¯¢è®¡åˆ’å­—å…¸ {domain: [categories]}
        """
        query_plan = {}

        for domain in domains:
            if domain == 'portrait':
                query_plan['portrait'] = [
                    'gender', 'age_range', 'ethnicity',
                    'eye_types', 'face_shapes', 'skin_tones',
                    'makeup_styles', 'hair_styles', 'hair_colors',
                    'expressions', 'poses'
                ]

            elif domain == 'video':
                query_plan['video'] = [
                    'scene_types',      # èƒ½é‡æ°”æ¯ã€åŠ¨æ€åœºæ™¯
                    'motion_effects',   # åŠ¨æ€æ•ˆæžœ
                    'camera_movements'  # é•œå¤´è¿åŠ¨
                ]

            elif domain == 'art':
                query_plan['art'] = [
                    'art_styles',        # 3Dæ¸²æŸ“ã€èœ¡åƒè´¨æ„Ÿ
                    'special_effects'    # å…¨æ¯ã€ç²’å­æ•ˆæžœ
                ]

            elif domain == 'design':
                query_plan['design'] = [
                    'layout_types',
                    'visual_styles',
                    'composition_techniques'
                ]

            elif domain == 'product':
                query_plan['product'] = [
                    'photography_styles',
                    'lighting_setups'
                ]

            elif domain == 'common':
                query_plan['common'] = [
                    'lighting_techniques',
                    'photography_techniques',
                    'poses',
                    'technical_quality'
                ]

        return query_plan

    def query_domain(self, domain: str, categories: List[str], intent: Dict) -> List[Dict]:
        """
        æŸ¥è¯¢å•ä¸ªdomainçš„å…ƒç´ 

        Args:
            domain: domain ID
            categories: è¦æŸ¥è¯¢çš„categoryåˆ—è¡¨
            intent: ç”¨æˆ·æ„å›¾ï¼ˆç”¨äºŽå…³é”®è¯æå–ï¼‰

        Returns:
            å…ƒç´ åˆ—è¡¨
        """
        elements = []

        for category in categories:
            # ä»Žintentæå–è¯¥categoryçš„å…³é”®è¯
            keywords = self.extract_keywords_from_intent(intent, category)

            # èŽ·å–å€™é€‰å…ƒç´ 
            candidates = self.get_all_elements_by_category(domain, category)

            if not candidates:
                continue

            # ä½¿ç”¨ElementSelectoré€‰æ‹©æœ€ä½³å…ƒç´ 
            from framework_loader import ElementSelector

            best_elem, score = ElementSelector.select_best_element(
                candidates=candidates,
                user_keywords=keywords,
                user_intent=intent,
                field_name=f"{domain}.{category}",
                debug=False
            )

            if best_elem and score > 20:  # åˆ†æ•°é˜ˆå€¼
                elements.append(best_elem)

        return elements

    def extract_keywords_from_intent(self, intent: Dict, category: str) -> List[str]:
        """
        ä»Žintentä¸­æå–ç‰¹å®šcategoryçš„å…³é”®è¯

        Args:
            intent: ç”¨æˆ·æ„å›¾
            category: category ID

        Returns:
            å…³é”®è¯åˆ—è¡¨
        """
        keywords = []
        raw_input = intent.get('raw_input', '')

        # æ ¹æ®categoryæå–ä¸åŒçš„å…³é”®è¯
        if category == 'scene_types':
            # åœºæ™¯ç±»åž‹ï¼šèƒ½é‡ã€æ°”æ¯ã€æ°›å›´
            scene_keywords = ['energy', 'aura', 'atmosphere', 'power', 'èƒ½é‡', 'æ°”æ¯', 'æ°›å›´']
            keywords.extend([kw for kw in scene_keywords if kw in raw_input.lower()])

        elif category == 'motion_effects':
            # åŠ¨æ€æ•ˆæžœï¼šåŠ¨ä½œã€è¿åŠ¨
            motion_keywords = ['motion', 'movement', 'action', 'dynamic', 'åŠ¨ä½œ', 'è¿åŠ¨', 'åŠ¨æ€']
            keywords.extend([kw for kw in motion_keywords if kw in raw_input.lower()])

        elif category == 'art_styles':
            # è‰ºæœ¯é£Žæ ¼
            visual_style = intent.get('visual_style', {})
            if isinstance(visual_style, dict):
                art_style = visual_style.get('art_style', '')
                if art_style:
                    keywords.append(art_style)
            # ä»Žraw_inputæå–
            art_keywords = ['3d', 'wax', 'èœ¡åƒ', 'holographic', 'realistic', 'rendering']
            keywords.extend([kw for kw in art_keywords if kw in raw_input.lower()])

        elif category == 'special_effects':
            # ç‰¹æ•ˆ
            effect_keywords = ['glow', 'particle', 'holographic', 'energy', 'å‘å…‰', 'ç²’å­', 'å…¨æ¯']
            keywords.extend([kw for kw in effect_keywords if kw in raw_input.lower()])

        elif category == 'lighting_techniques':
            # å…‰å½±æŠ€æœ¯
            lighting = intent.get('lighting', 'natural')
            if lighting:
                keywords.append(lighting)

        # å¦‚æžœæ²¡æœ‰å…³é”®è¯ï¼Œä½¿ç”¨ç©ºåˆ—è¡¨ï¼ˆä¼šé€‰æ‹©è¯„åˆ†æœ€é«˜çš„ï¼‰
        return keywords if keywords else []

    def get_all_elements_by_category(self, domain: str, category: str) -> List[Dict]:
        """
        ä»Žæ•°æ®åº“èŽ·å–è¯¥categoryçš„æ‰€æœ‰å…ƒç´ 

        Args:
            domain: domain ID
            category: category ID

        Returns:
            å…ƒç´ åˆ—è¡¨
        """
        return self.generator.get_all_elements_by_category(domain, category)

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.sampler.close()
        self.generator.close()
        self.db.close()


def test_cross_domain_query():
    """æµ‹è¯•è·¨domainæŸ¥è¯¢"""
    print("=" * 80)
    print("æµ‹è¯•è·¨DomainæŸ¥è¯¢å¼•æ“Ž")
    print("=" * 80)

    engine = CrossDomainQueryEngine()

    # æµ‹è¯•æ¡ˆä¾‹ï¼šé¾™ç æ‚Ÿç©ºæ‰“é¾Ÿæ´¾æ°”åŠŸ
    print("\nã€æµ‹è¯•æ¡ˆä¾‹ã€‘é¾™ç æ‚Ÿç©ºæ‰“é¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ\n")

    intent = {
        'raw_input': 'é¾™ç åŠ¨æ¼«çš„èœ¡åƒ3Dæ„Ÿæ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸ',
        'subject': {
            'gender': 'male',
            'ethnicity': 'East_Asian',
            'character': 'Son Goku'
        },
        'action': 'kamehameha',
        'energy': 'blue_energy_blast',
        'visual_style': {
            'art_style': 'wax_figure_3d'
        },
        'render': '3d_realistic'
    }

    # æ‰§è¡Œè·¨domainæŸ¥è¯¢
    results = engine.query_by_intent(intent)

    # æ˜¾ç¤ºç»“æžœ
    print("\nðŸ“‹ æŸ¥è¯¢ç»“æžœï¼š")
    total_elements = 0
    for domain, elements in results.items():
        if elements:
            print(f"\n  ã€{domain} domainã€‘({len(elements)}ä¸ªå…ƒç´ )")
            for elem in elements[:3]:  # åªæ˜¾ç¤ºå‰3ä¸ª
                print(f"    - {elem['chinese_name']} ({elem['category']})")
            total_elements += len(elements)

    print(f"\nâœ… å…±èŽ·å– {total_elements} ä¸ªå…ƒç´ ï¼Œæ¥è‡ª {len(results)} ä¸ªdomain")

    engine.close()


if __name__ == '__main__':
    test_cross_domain_query()



================================================
FILE: core/design_bridge.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
è®¾è®¡å˜é‡æ¡¥æŽ¥å™¨ - è¿žæŽ¥SQLiteå…ƒç´ å’ŒYAMLè®¾è®¡å˜é‡
æ™ºèƒ½èžåˆä¸¤è€…ç”Ÿæˆå®Œæ•´çš„è®¾è®¡æç¤ºè¯
"""

import sys
import os
from typing import Dict, List, Optional

# æ·»åŠ ä¸Šçº§ç›®å½•åˆ°è·¯å¾„
sys.path.insert(0, os.path.dirname(os.path.dirname(os.path.abspath(__file__))))

from core.cross_domain_query import CrossDomainQueryEngine
from core.yaml_sampler import YAMLVariableSampler


class DesignVariableBridge:
    """è¿žæŽ¥ SQLiteå…ƒç´  å’Œ YAMLè®¾è®¡å˜é‡çš„æ¡¥æŽ¥å™¨"""

    def __init__(self, db_path: str = "extracted_results/elements.db",
                 yaml_dir: str = "variables"):
        """
        åˆå§‹åŒ–è®¾è®¡å˜é‡æ¡¥æŽ¥å™¨

        Args:
            db_path: SQLiteæ•°æ®åº“è·¯å¾„
            yaml_dir: YAMLå˜é‡æ–‡ä»¶ç›®å½•
        """
        self.sqlite_engine = CrossDomainQueryEngine(db_path)
        self.yaml_sampler = YAMLVariableSampler(yaml_dir)

    def generate_design_prompt(self, intent: Dict) -> Dict:
        """
        ç”Ÿæˆå®Œæ•´è®¾è®¡æç¤ºè¯ï¼ˆSQLite + YAMLï¼‰

        Args:
            intent: ç”¨æˆ·æ„å›¾å­—å…¸

        Returns:
            åŒ…å«å®Œæ•´æç¤ºè¯å’Œå…ƒæ•°æ®çš„å­—å…¸
            {
                'prompt': 'å®Œæ•´æç¤ºè¯',
                'sqlite_elements': {...},
                'yaml_variables': {...},
                'metadata': {...}
            }
        """
        # 1. ä»ŽSQLiteèŽ·å–åŸºç¡€å…ƒç´ ï¼ˆäººç‰©ã€åœºæ™¯ã€å…‰å½±ï¼‰
        sqlite_elements = self.sqlite_engine.query_by_intent(intent)
        print(f"ðŸ“Š SQLiteå…ƒç´ : {sum(len(elems) for elems in sqlite_elements.values())} ä¸ª")

        # 2. ä»ŽYAMLèŽ·å–è®¾è®¡å˜é‡ï¼ˆé…è‰²ã€è¾¹æ¡†ã€è£…é¥°ï¼‰
        design_style = intent.get('design_style', 'æ¸©é¦¨å¯çˆ±')
        yaml_variables = self.yaml_sampler.sample_variables(style=design_style)
        print(f"ðŸŽ¨ YAMLå˜é‡: é£Žæ ¼={design_style}")

        # 3. èžåˆä¸¤è€…
        merged = self.merge_elements_and_variables(
            sqlite_elements,
            yaml_variables,
            intent
        )

        # 4. åº”ç”¨è®¾è®¡é€»è¾‘ï¼ˆå¯é€‰ï¼‰
        # design_logic = self.load_design_logic(design_style)

        # 5. ç”Ÿæˆæœ€ç»ˆæç¤ºè¯
        prompt = self.build_final_prompt(merged)

        return {
            'prompt': prompt,
            'sqlite_elements': sqlite_elements,
            'yaml_variables': yaml_variables,
            'metadata': {
                'design_style': design_style,
                'element_count': sum(len(elems) for elems in sqlite_elements.values()),
                'domains_used': list(sqlite_elements.keys())
            }
        }

    def merge_elements_and_variables(self, sqlite_elements: Dict[str, List[Dict]],
                                    yaml_variables: Dict,
                                    intent: Dict) -> Dict:
        """
        æ™ºèƒ½èžåˆSQLiteå…ƒç´ å’ŒYAMLå˜é‡

        Args:
            sqlite_elements: SQLiteæŸ¥è¯¢çš„å…ƒç´ ï¼ˆæŒ‰domainåˆ†ç»„ï¼‰
            yaml_variables: YAMLé‡‡æ ·çš„å˜é‡
            intent: ç”¨æˆ·æ„å›¾

        Returns:
            èžåˆåŽçš„ç»“æž„åŒ–æ•°æ®
        """
        merged = {
            'content': [],       # SQLiteå…ƒç´ ï¼ˆä¸»ä½“å†…å®¹ï¼‰
            'design': [],        # YAMLå˜é‡ï¼ˆè®¾è®¡è§„èŒƒï¼‰
            'technical': []      # æŠ€æœ¯å‚æ•°
        }

        # å¤„ç†SQLiteå…ƒç´ 
        for domain, elements in sqlite_elements.items():
            for elem in elements:
                category = elem.get('category', '')

                # åˆ†ç±»å…ƒç´ 
                if domain in ['portrait', 'video', 'art']:
                    # ä¸»ä½“å†…å®¹
                    merged['content'].append({
                        'domain': domain,
                        'category': category,
                        'template': elem.get('template', ''),
                        'chinese_name': elem.get('chinese_name', '')
                    })
                elif domain == 'common':
                    # æŠ€æœ¯å‚æ•°ï¼ˆå…‰å½±ã€æ‘„å½±æŠ€æœ¯ï¼‰
                    if 'lighting' in category or 'photography' in category:
                        merged['technical'].append({
                            'domain': domain,
                            'category': category,
                            'template': elem.get('template', ''),
                            'chinese_name': elem.get('chinese_name', '')
                        })

        # å¤„ç†YAMLå˜é‡ï¼ˆè®¾è®¡è§„èŒƒï¼‰
        if 'colors' in yaml_variables:
            colors_data = yaml_variables['colors']
            scheme_name = colors_data.get('scheme_name', '')
            variant = colors_data.get('selected_variant')
            if variant:
                merged['design'].append({
                    'type': 'color',
                    'description': f"Color scheme: {scheme_name}, primary color {variant['name']} ({variant['hex']})"
                })

        if 'borders' in yaml_variables:
            borders_data = yaml_variables['borders']
            border_name = borders_data.get('border_name', '')
            border_config = borders_data.get('border_config', {})
            radius = border_config.get('radius', '')
            if radius:
                merged['design'].append({
                    'type': 'border',
                    'description': f"Border style: {border_name}, border-radius: {radius}"
                })

        if 'decorations' in yaml_variables:
            deco_data = yaml_variables['decorations']
            deco_name = deco_data.get('decoration_name', '')
            merged['design'].append({
                'type': 'decoration',
                'description': f"Decorative elements: {deco_name}"
            })

        return merged

    def build_final_prompt(self, merged: Dict) -> str:
        """
        æž„å»ºæœ€ç»ˆæç¤ºè¯

        Args:
            merged: èžåˆåŽçš„ç»“æž„åŒ–æ•°æ®

        Returns:
            å®Œæ•´æç¤ºè¯å­—ç¬¦ä¸²
        """
        parts = []

        # 1. ä¸»ä½“å†…å®¹ï¼ˆSQLiteå…ƒç´ ï¼‰
        for item in merged['content']:
            template = item['template']
            if template:
                parts.append(template)

        # 2. è®¾è®¡è§„èŒƒï¼ˆYAMLå˜é‡ï¼‰
        for item in merged['design']:
            description = item['description']
            if description:
                parts.append(description)

        # 3. æŠ€æœ¯å‚æ•°ï¼ˆå…‰å½±ã€æ‘„å½±ï¼‰
        for item in merged['technical']:
            template = item['template']
            if template:
                parts.append(template)

        return ', '.join(parts)

    def load_design_logic(self, design_style: str) -> Optional[Dict]:
        """
        åŠ è½½è®¾è®¡é€»è¾‘ï¼ˆå¯é€‰ï¼‰

        Args:
            design_style: è®¾è®¡é£Žæ ¼åç§°

        Returns:
            è®¾è®¡é€»è¾‘é…ç½®å­—å…¸
        """
        # ä»Ždesign-logicç›®å½•åŠ è½½å¯¹åº”é£Žæ ¼çš„è§„åˆ™
        # è¿™éƒ¨åˆ†å¯ä»¥åŽç»­æ‰©å±•
        return None

    def close(self):
        """å…³é—­èµ„æº"""
        self.sqlite_engine.close()


def test_design_bridge():
    """æµ‹è¯•è®¾è®¡å˜é‡æ¡¥æŽ¥å™¨"""
    print("=" * 80)
    print("æµ‹è¯•è®¾è®¡å˜é‡æ¡¥æŽ¥å™¨")
    print("=" * 80)

    bridge = DesignVariableBridge()

    # æµ‹è¯•æ¡ˆä¾‹ï¼šæ¸©é¦¨å¯çˆ±çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥
    print("\nã€æµ‹è¯•æ¡ˆä¾‹ã€‘æ¸©é¦¨å¯çˆ±çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥\n")

    intent = {
        'raw_input': 'æ¸©é¦¨å¯çˆ±é£Žæ ¼çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥',
        'design_style': 'æ¸©é¦¨å¯çˆ±',
        'subject': {
            'age_range': 'child',
            'gender': 'female'
        },
        'atmosphere': {
            'theme': 'educational',
            'mood': 'warm'
        },
        'lighting': 'soft'
    }

    # ç”Ÿæˆè®¾è®¡æç¤ºè¯
    result = bridge.generate_design_prompt(intent)

    # æ˜¾ç¤ºç»“æžœ
    print("\nðŸ“‹ ç”Ÿæˆç»“æžœï¼š")
    print(f"\né£Žæ ¼: {result['metadata']['design_style']}")
    print(f"å…ƒç´ æ•°: {result['metadata']['element_count']}")
    print(f"ä½¿ç”¨domain: {', '.join(result['metadata']['domains_used'])}")

    print(f"\nâœ¨ å®Œæ•´æç¤ºè¯ï¼š")
    print("â”€" * 80)
    print(result['prompt'])
    print("â”€" * 80)

    # æ˜¾ç¤ºYAMLå˜é‡
    if result['yaml_variables']:
        print(f"\nðŸŽ¨ è®¾è®¡å˜é‡ï¼š")
        for var_type, var_data in result['yaml_variables'].items():
            if var_type == 'colors':
                print(f"  é…è‰²: {var_data.get('scheme_name')}")
            elif var_type == 'borders':
                print(f"  è¾¹æ¡†: {var_data.get('border_name')}")
            elif var_type == 'decorations':
                print(f"  è£…é¥°: {var_data.get('decoration_name')}")

    bridge.close()
    print("\nâœ… æµ‹è¯•å®Œæˆ")


if __name__ == '__main__':
    test_design_bridge()



================================================
FILE: core/schema_migration_v1.sql
================================================
-- Schema Migration v1: Add Variable Support
-- æ·»åŠ å…ƒç´ å˜é‡åŒ–æ”¯æŒ

-- 1. åˆ›å»º element_variables è¡¨
CREATE TABLE IF NOT EXISTS element_variables (
    variable_id TEXT PRIMARY KEY,
    element_id TEXT NOT NULL,
    parameter_name TEXT NOT NULL,  -- å‚æ•°åï¼ˆå¦‚ï¼šcolor, intensity, styleï¼‰
    parameter_type TEXT NOT NULL CHECK(parameter_type IN ('enum', 'range', 'boolean')),
    possible_values TEXT,  -- JSONæ•°ç»„ï¼ˆenumç±»åž‹çš„å¯é€‰å€¼ï¼Œæˆ–rangeç±»åž‹çš„[min, max]ï¼‰
    default_value TEXT,
    description TEXT,  -- å‚æ•°æè¿°
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (element_id) REFERENCES elements(element_id) ON DELETE CASCADE
);

-- 2. åˆ›å»ºç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_element_variables_element ON element_variables(element_id);
CREATE INDEX IF NOT EXISTS idx_element_variables_param ON element_variables(parameter_name);

-- 3. åˆ›å»º design_variables è¡¨ï¼ˆä»ŽYAMLå¯¼å…¥çš„è®¾è®¡å˜é‡ï¼‰
CREATE TABLE IF NOT EXISTS design_variables (
    variable_id TEXT PRIMARY KEY,
    style_name TEXT NOT NULL,        -- æ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦
    variable_type TEXT NOT NULL,     -- colorsã€bordersã€decorations
    variable_name TEXT NOT NULL,     -- çŠç‘šç²‰è‰²ç³»ã€åœ†è§’è¾¹æ¡†
    variable_data TEXT NOT NULL,     -- JSONæ•°æ®
    priority INTEGER DEFAULT 5,
    description TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 4. åˆ›å»ºç´¢å¼•
CREATE INDEX IF NOT EXISTS idx_design_variables_style ON design_variables(style_name);
CREATE INDEX IF NOT EXISTS idx_design_variables_type ON design_variables(variable_type);

-- 5. æ’å…¥ç¤ºä¾‹æ•°æ®ï¼ˆelement_variablesï¼‰
INSERT OR IGNORE INTO element_variables VALUES
  ('var_001', 'common_lighting_001', 'intensity', 'enum',
   '["soft", "medium", "dramatic", "harsh"]', 'medium',
   'Light intensity level', CURRENT_TIMESTAMP),

  ('var_002', 'common_lighting_001', 'color_temp', 'range',
   '[2700, 6500]', '5000',
   'Color temperature in Kelvin', CURRENT_TIMESTAMP),

  ('var_003', 'portrait_makeup_003', 'style', 'enum',
   '["natural", "glamorous", "editorial", "avant-garde"]', 'natural',
   'Makeup style variation', CURRENT_TIMESTAMP),

  ('var_004', 'art_special_effects_001', 'opacity', 'range',
   '[0.0, 1.0]', '0.7',
   'Effect opacity level', CURRENT_TIMESTAMP),

  ('var_005', 'video_motion_effects_001', 'speed', 'enum',
   '["slow", "normal", "fast", "very_fast"]', 'normal',
   'Motion speed variation', CURRENT_TIMESTAMP);

-- 6. æ’å…¥ç¤ºä¾‹æ•°æ®ï¼ˆdesign_variables - ä»Žprompt-crafterå¯¼å…¥ç¤ºä¾‹ï¼‰
INSERT OR IGNORE INTO design_variables VALUES
  ('design_001', 'æ¸©é¦¨å¯çˆ±', 'colors', 'çŠç‘šç²‰è‰²ç³»',
   '{"base_hue": 355, "variants": [{"hex": "#FF9AA2", "name": "èœœæ¡ƒç²‰"}]}',
   1, 'æ¸©æš–çš„çŠç‘šç²‰è‰²ç³»', CURRENT_TIMESTAMP),

  ('design_002', 'æ¸©é¦¨å¯çˆ±', 'borders', 'å¤§åœ†è§’',
   '{"radius": "24px", "shadow": "soft"}',
   1, 'æŸ”å’Œçš„å¤§åœ†è§’è¾¹æ¡†', CURRENT_TIMESTAMP),

  ('design_003', 'çŽ°ä»£ç®€çº¦', 'colors', 'æ·±è“è‰²ç³»',
   '{"base_hue": 215, "variants": [{"hex": "#1F2937", "name": "æ·±ç‚­è“"}]}',
   1, 'çŽ°ä»£æ„Ÿçš„æ·±è“è‰²ç³»', CURRENT_TIMESTAMP),

  ('design_004', 'çŽ°ä»£ç®€çº¦', 'borders', 'ç›´è§’è¾¹æ¡†',
   '{"radius": "0px", "shadow": "none"}',
   1, 'ç®€æ´çš„ç›´è§’è¾¹æ¡†', CURRENT_TIMESTAMP);



================================================
FILE: core/variable_sampler.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å˜é‡é‡‡æ ·ç³»ç»Ÿ - æ™ºèƒ½é‡‡æ ·å…ƒç´ å˜é‡
æ”¯æŒå‚æ•°åŒ–å…ƒç´ ï¼Œé¿å…é‡å¤é‡‡æ ·ï¼Œä¸Šä¸‹æ–‡æ„ŸçŸ¥
"""

import sqlite3
import json
import random
import time
from typing import Dict, List, Optional, Any


class SQLiteVariableSampler:
    """SQLiteå…ƒç´ å˜é‡é‡‡æ ·å™¨"""

    def __init__(self, db_path: str):
        """
        åˆå§‹åŒ–å˜é‡é‡‡æ ·å™¨

        Args:
            db_path: æ•°æ®åº“è·¯å¾„
        """
        self.db = sqlite3.connect(db_path)
        self.cursor = self.db.cursor()
        self.history = []  # é‡‡æ ·åŽ†å²ï¼Œé¿å…é‡å¤
        self.max_history = 100  # ä¿ç•™æœ€è¿‘100æ¬¡é‡‡æ ·åŽ†å²

    def get_element(self, element_id: str) -> Optional[Dict]:
        """èŽ·å–å…ƒç´ åŸºç¡€ä¿¡æ¯"""
        query = """
            SELECT element_id, name, chinese_name, ai_prompt_template,
                   keywords, reusability_score, category_id, domain_id
            FROM elements
            WHERE element_id = ?
        """
        self.cursor.execute(query, (element_id,))
        row = self.cursor.fetchone()

        if not row:
            return None

        keywords = None
        if row[4]:
            try:
                keywords = json.loads(row[4])
            except:
                pass

        return {
            'element_id': row[0],
            'name': row[1],
            'chinese_name': row[2],
            'template': row[3],
            'keywords': keywords,
            'reusability': row[5],
            'category': row[6],
            'domain': row[7]
        }

    def get_element_variables(self, element_id: str) -> List[Dict]:
        """èŽ·å–å…ƒç´ çš„æ‰€æœ‰å˜é‡é…ç½®"""
        query = """
            SELECT variable_id, parameter_name, parameter_type,
                   possible_values, default_value, description
            FROM element_variables
            WHERE element_id = ?
        """
        self.cursor.execute(query, (element_id,))
        rows = self.cursor.fetchall()

        variables = []
        for row in rows:
            possible_values = None
            if row[3]:
                try:
                    possible_values = json.loads(row[3])
                except:
                    pass

            variables.append({
                'variable_id': row[0],
                'parameter_name': row[1],
                'parameter_type': row[2],
                'possible_values': possible_values,
                'default_value': row[4],
                'description': row[5]
            })

        return variables

    def sample_element_with_variables(self, element_id: str,
                                     style_context: Optional[Dict] = None) -> Dict:
        """
        é‡‡æ ·å…ƒç´ å¹¶åº”ç”¨å˜é‡

        Args:
            element_id: å…ƒç´ ID
            style_context: é£Žæ ¼ä¸Šä¸‹æ–‡ï¼ˆå¯é€‰ï¼‰

        Returns:
            åŒ…å«åŽŸå§‹å…ƒç´ å’Œå˜é‡å€¼çš„å­—å…¸
        """
        # 1. èŽ·å–å…ƒç´ åŸºç¡€æ¨¡æ¿
        element = self.get_element(element_id)
        if not element:
            raise ValueError(f"Element not found: {element_id}")

        # 2. èŽ·å–è¯¥å…ƒç´ çš„æ‰€æœ‰å˜é‡
        variables = self.get_element_variables(element_id)

        if not variables:
            # æ²¡æœ‰å˜é‡ï¼Œç›´æŽ¥è¿”å›žåŽŸå§‹å…ƒç´ 
            return {
                'element': element,
                'variables': {},
                'result': element['template']
            }

        # 3. é‡‡æ ·å˜é‡å€¼ï¼ˆåŸºäºŽé£Žæ ¼ä¸Šä¸‹æ–‡ï¼‰
        sampled_vars = {}
        for var in variables:
            sampled_vars[var['parameter_name']] = self.sample_variable(
                var, style_context, avoid_history=True
            )

        # 4. åº”ç”¨å˜é‡åˆ°æ¨¡æ¿
        result = self.apply_variables(element['template'], sampled_vars)

        # 5. è®°å½•åŽ†å²
        self.history.append({
            'element_id': element_id,
            'variables': sampled_vars,
            'timestamp': time.time()
        })

        # é™åˆ¶åŽ†å²é•¿åº¦
        if len(self.history) > self.max_history:
            self.history = self.history[-self.max_history:]

        return {
            'element': element,
            'variables': sampled_vars,
            'result': result
        }

    def sample_variable(self, var_config: Dict, style_context: Optional[Dict],
                       avoid_history: bool) -> Any:
        """
        æ™ºèƒ½é‡‡æ ·å•ä¸ªå˜é‡

        Args:
            var_config: å˜é‡é…ç½®
            style_context: é£Žæ ¼ä¸Šä¸‹æ–‡
            avoid_history: æ˜¯å¦é¿å…æœ€è¿‘ä½¿ç”¨è¿‡çš„å€¼

        Returns:
            é‡‡æ ·çš„å˜é‡å€¼
        """
        param_type = var_config['parameter_type']

        if param_type == 'enum':
            # æžšä¸¾ç±»åž‹ï¼šéšæœºé€‰æ‹©ï¼Œé¿å…é‡å¤
            values = var_config['possible_values']
            if not values:
                return var_config['default_value']

            # æ ¹æ®é£Žæ ¼ä¸Šä¸‹æ–‡è¿‡æ»¤
            if style_context:
                values = self.filter_by_style(values, style_context)

            # é¿å…æœ€è¿‘ä½¿ç”¨è¿‡çš„
            if avoid_history and len(values) > 1:
                recent = self.get_recent_values(var_config['variable_id'])
                filtered = [v for v in values if v not in recent]
                if filtered:
                    values = filtered

            return random.choice(values) if values else var_config['default_value']

        elif param_type == 'range':
            # èŒƒå›´ç±»åž‹ï¼šåœ¨èŒƒå›´å†…éšæœº
            range_vals = var_config['possible_values']
            if not range_vals or len(range_vals) != 2:
                return var_config['default_value']

            min_val, max_val = range_vals

            # æ ¹æ®é£Žæ ¼ä¸Šä¸‹æ–‡è°ƒæ•´èŒƒå›´
            if style_context:
                min_val, max_val = self.adjust_range_by_style(
                    min_val, max_val, style_context
                )

            # åˆ¤æ–­æ˜¯æ•´æ•°è¿˜æ˜¯æµ®ç‚¹æ•°
            if isinstance(min_val, int) and isinstance(max_val, int):
                return random.randint(min_val, max_val)
            else:
                return round(random.uniform(min_val, max_val), 2)

        elif param_type == 'boolean':
            # å¸ƒå°”ç±»åž‹
            if style_context and 'prefer_' + var_config['parameter_name'] in style_context:
                return style_context['prefer_' + var_config['parameter_name']]
            return random.choice([True, False])

        else:
            return var_config['default_value']

    def filter_by_style(self, values: List[str], style_context: Dict) -> List[str]:
        """æ ¹æ®é£Žæ ¼ä¸Šä¸‹æ–‡è¿‡æ»¤å€¼"""
        # ç®€å•å®žçŽ°ï¼šå¦‚æžœä¸Šä¸‹æ–‡æŒ‡å®šäº†åå¥½ï¼Œä¼˜å…ˆé€‰æ‹©
        preferred = style_context.get('preferred_values', [])
        if preferred:
            filtered = [v for v in values if v in preferred]
            if filtered:
                return filtered
        return values

    def adjust_range_by_style(self, min_val: float, max_val: float,
                              style_context: Dict) -> tuple:
        """æ ¹æ®é£Žæ ¼ä¸Šä¸‹æ–‡è°ƒæ•´èŒƒå›´"""
        # ç®€å•å®žçŽ°ï¼šå¦‚æžœä¸Šä¸‹æ–‡æŒ‡å®šäº†åå¥½èŒƒå›´ï¼Œç¼©å°èŒƒå›´
        if 'range_preference' in style_context:
            pref = style_context['range_preference']
            if pref == 'low':
                # åå‘ä½Žå€¼
                max_val = min_val + (max_val - min_val) * 0.5
            elif pref == 'high':
                # åå‘é«˜å€¼
                min_val = min_val + (max_val - min_val) * 0.5
        return min_val, max_val

    def get_recent_values(self, variable_id: str, n: int = 3) -> List[Any]:
        """èŽ·å–æœ€è¿‘næ¬¡ä½¿ç”¨è¿‡çš„å€¼"""
        recent = []
        for record in reversed(self.history):
            for var_name, var_value in record['variables'].items():
                # ç®€åŒ–ï¼šé€šè¿‡å‚æ•°ååŒ¹é…ï¼ˆå®žé™…åº”è¯¥ç”¨variable_idï¼‰
                if len(recent) < n:
                    recent.append(var_value)
        return recent

    def apply_variables(self, template: str, variables: Dict[str, Any]) -> str:
        """
        åº”ç”¨å˜é‡åˆ°æ¨¡æ¿

        æ”¯æŒæ ¼å¼ï¼š{variable_name}
        ä¾‹å¦‚ï¼š"{intensity} lighting" -> "dramatic lighting"
        """
        result = template
        for var_name, var_value in variables.items():
            placeholder = '{' + var_name + '}'
            if placeholder in result:
                result = result.replace(placeholder, str(var_value))
        return result

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.db.close()


class DesignVariableSampler:
    """è®¾è®¡å˜é‡é‡‡æ ·å™¨ï¼ˆä»Ždesign_variablesè¡¨é‡‡æ ·ï¼‰"""

    def __init__(self, db_path: str):
        """
        åˆå§‹åŒ–è®¾è®¡å˜é‡é‡‡æ ·å™¨

        Args:
            db_path: æ•°æ®åº“è·¯å¾„
        """
        self.db = sqlite3.connect(db_path)
        self.cursor = self.db.cursor()
        self.history = []
        self.max_history = 100

    def sample_design_variables(self, style_name: str,
                                variable_types: Optional[List[str]] = None) -> Dict:
        """
        é‡‡æ ·è®¾è®¡å˜é‡

        Args:
            style_name: é£Žæ ¼åç§°ï¼ˆå¦‚ï¼šæ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦ï¼‰
            variable_types: å˜é‡ç±»åž‹åˆ—è¡¨ï¼ˆå¦‚ï¼š['colors', 'borders']ï¼‰ï¼ŒNoneè¡¨ç¤ºå…¨éƒ¨

        Returns:
            é‡‡æ ·çš„è®¾è®¡å˜é‡å­—å…¸
        """
        query = """
            SELECT variable_id, variable_type, variable_name, variable_data
            FROM design_variables
            WHERE style_name = ?
        """
        params = [style_name]

        if variable_types:
            placeholders = ','.join(['?' for _ in variable_types])
            query += f" AND variable_type IN ({placeholders})"
            params.extend(variable_types)

        query += " ORDER BY priority DESC"

        self.cursor.execute(query, params)
        rows = self.cursor.fetchall()

        if not rows:
            return {}

        # æŒ‰ç±»åž‹åˆ†ç»„
        variables_by_type = {}
        for row in rows:
            var_type = row[1]
            if var_type not in variables_by_type:
                variables_by_type[var_type] = []

            var_data = None
            if row[3]:
                try:
                    var_data = json.loads(row[3])
                except:
                    pass

            variables_by_type[var_type].append({
                'variable_id': row[0],
                'variable_name': row[2],
                'variable_data': var_data
            })

        # ä»Žæ¯ä¸ªç±»åž‹ä¸­éšæœºé€‰æ‹©ä¸€ä¸ª
        sampled = {}
        for var_type, candidates in variables_by_type.items():
            # é¿å…é‡å¤
            recent = self.get_recent_variables(var_type)
            filtered = [c for c in candidates if c['variable_id'] not in recent]
            if not filtered:
                filtered = candidates

            selected = random.choice(filtered)
            sampled[var_type] = selected

            # è®°å½•åŽ†å²
            self.history.append({
                'style_name': style_name,
                'variable_type': var_type,
                'variable_id': selected['variable_id'],
                'timestamp': time.time()
            })

        # é™åˆ¶åŽ†å²é•¿åº¦
        if len(self.history) > self.max_history:
            self.history = self.history[-self.max_history:]

        return sampled

    def get_recent_variables(self, variable_type: str, n: int = 3) -> List[str]:
        """èŽ·å–æœ€è¿‘ä½¿ç”¨è¿‡çš„å˜é‡ID"""
        recent = []
        for record in reversed(self.history):
            if record['variable_type'] == variable_type:
                recent.append(record['variable_id'])
                if len(recent) >= n:
                    break
        return recent

    def close(self):
        """å…³é—­æ•°æ®åº“è¿žæŽ¥"""
        self.db.close()


def test_variable_sampler():
    """æµ‹è¯•å˜é‡é‡‡æ ·å™¨"""
    print("=" * 80)
    print("æµ‹è¯•å˜é‡é‡‡æ ·ç³»ç»Ÿ")
    print("=" * 80)

    # æµ‹è¯•SQLiteVariableSampler
    print("\nã€æµ‹è¯•1ã€‘SQLiteå…ƒç´ å˜é‡é‡‡æ ·")
    sampler = SQLiteVariableSampler("extracted_results/elements.db")

    # æµ‹è¯•é‡‡æ ·lightingå…ƒç´ ï¼ˆå‡è®¾æœ‰å˜é‡ï¼‰
    try:
        result = sampler.sample_element_with_variables(
            'common_lighting_001',
            style_context={'preferred_values': ['dramatic']}
        )
        print(f"  å…ƒç´ : {result['element']['chinese_name']}")
        print(f"  å˜é‡: {result['variables']}")
        print(f"  ç»“æžœ: {result['result']}")
    except Exception as e:
        print(f"  è·³è¿‡ï¼ˆå…ƒç´ å¯èƒ½ä¸å­˜åœ¨ï¼‰: {e}")

    sampler.close()

    # æµ‹è¯•DesignVariableSampler
    print("\nã€æµ‹è¯•2ã€‘è®¾è®¡å˜é‡é‡‡æ ·")
    design_sampler = DesignVariableSampler("extracted_results/elements.db")

    # é‡‡æ ·æ¸©é¦¨å¯çˆ±é£Žæ ¼
    sampled = design_sampler.sample_design_variables('æ¸©é¦¨å¯çˆ±')
    print(f"  é£Žæ ¼: æ¸©é¦¨å¯çˆ±")
    for var_type, var_data in sampled.items():
        print(f"  {var_type}: {var_data['variable_name']}")

    # å†æ¬¡é‡‡æ ·ï¼ˆåº”è¯¥é¿å…é‡å¤ï¼‰
    print("\n  ç¬¬äºŒæ¬¡é‡‡æ ·ï¼ˆåº”é¿å…é‡å¤ï¼‰:")
    sampled2 = design_sampler.sample_design_variables('æ¸©é¦¨å¯çˆ±')
    for var_type, var_data in sampled2.items():
        print(f"  {var_type}: {var_data['variable_name']}")

    design_sampler.close()

    print("\nâœ… æµ‹è¯•å®Œæˆ")


if __name__ == '__main__':
    test_variable_sampler()



================================================
FILE: core/yaml_sampler.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
YAMLå˜é‡é‡‡æ ·å™¨ - ä»Žprompt-crafterçš„YAMLé…ç½®ä¸­é‡‡æ ·è®¾è®¡å˜é‡
æ”¯æŒæ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦ç­‰é£Žæ ¼çš„é…è‰²ã€è¾¹æ¡†ã€è£…é¥°é‡‡æ ·
"""

import yaml
import random
import time
from typing import Dict, List, Optional, Any
from pathlib import Path


class YAMLVariableSampler:
    """YAMLå˜é‡é‡‡æ ·å™¨ï¼ˆè¯»å–prompt-crafterçš„YAMLé…ç½®ï¼‰"""

    def __init__(self, yaml_dir: str = "variables"):
        """
        åˆå§‹åŒ–YAMLå˜é‡é‡‡æ ·å™¨

        Args:
            yaml_dir: YAMLæ–‡ä»¶ç›®å½•è·¯å¾„
        """
        self.yaml_dir = Path(yaml_dir)
        self.history = []
        self.max_history = 100

        # åŠ è½½YAMLé…ç½®
        self.colors = self._load_yaml('colors.yaml')
        self.borders = self._load_yaml('borders.yaml')
        self.decorations = self._load_yaml('decorations.yaml')

    def _load_yaml(self, filename: str) -> Dict:
        """åŠ è½½YAMLæ–‡ä»¶"""
        filepath = self.yaml_dir / filename
        if not filepath.exists():
            print(f"âš ï¸ YAMLæ–‡ä»¶ä¸å­˜åœ¨: {filepath}")
            return {}

        with open(filepath, 'r', encoding='utf-8') as f:
            return yaml.safe_load(f) or {}

    def sample_variables(self, style: str = 'æ¸©é¦¨å¯çˆ±',
                        variable_types: Optional[List[str]] = None) -> Dict:
        """
        é‡‡æ ·è®¾è®¡å˜é‡

        Args:
            style: é£Žæ ¼åç§°ï¼ˆæ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦ï¼‰
            variable_types: è¦é‡‡æ ·çš„å˜é‡ç±»åž‹åˆ—è¡¨ï¼ˆå¦‚ï¼š['colors', 'borders']ï¼‰ï¼ŒNoneè¡¨ç¤ºå…¨éƒ¨

        Returns:
            é‡‡æ ·çš„è®¾è®¡å˜é‡å­—å…¸
            {
                'colors': {'scheme_name': 'çŠç‘šç²‰è‰²ç³»', 'variants': [...]},
                'borders': {'style': 'å¤§åœ†è§’', 'config': {...}},
                'decorations': {'type': 'æ˜Ÿæ˜Ÿ', 'config': {...}}
            }
        """
        if variable_types is None:
            variable_types = ['colors', 'borders', 'decorations']

        sampled = {}

        if 'colors' in variable_types and self.colors:
            sampled['colors'] = self._sample_colors(style)

        if 'borders' in variable_types and self.borders:
            sampled['borders'] = self._sample_borders(style)

        if 'decorations' in variable_types and self.decorations:
            sampled['decorations'] = self._sample_decorations(style)

        # è®°å½•åŽ†å²
        self.history.append({
            'style': style,
            'sampled': sampled,
            'timestamp': time.time()
        })

        # é™åˆ¶åŽ†å²é•¿åº¦
        if len(self.history) > self.max_history:
            self.history = self.history[-self.max_history:]

        return sampled

    def _sample_colors(self, style: str) -> Dict:
        """é‡‡æ ·é…è‰²æ–¹æ¡ˆ"""
        if style not in self.colors:
            # é£Žæ ¼ä¸å­˜åœ¨ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨é£Žæ ¼
            style = list(self.colors.keys())[0] if self.colors else None
            if not style:
                return {}

        color_schemes = self.colors[style]

        # è¿‡æ»¤å‡ºéžæ–‡å­—è‰²/èƒŒæ™¯è‰²çš„ä¸»è‰²ç³»
        main_schemes = {
            name: data for name, data in color_schemes.items()
            if 'æ–‡å­—' not in name and 'èƒŒæ™¯' not in name and isinstance(data, dict)
        }

        if not main_schemes:
            return {}

        # é¿å…æœ€è¿‘ä½¿ç”¨çš„
        recent_schemes = self._get_recent_values('colors', n=2)
        available = [name for name in main_schemes.keys() if name not in recent_schemes]

        if not available:
            available = list(main_schemes.keys())

        # éšæœºé€‰æ‹©ä¸€ä¸ªè‰²ç³»
        scheme_name = random.choice(available)
        scheme_data = main_schemes[scheme_name]

        # ä»Žvariantsä¸­éšæœºé€‰æ‹©ä¸€ä¸ªé¢œè‰²
        variants = scheme_data.get('variants', [])
        selected_variant = random.choice(variants) if variants else None

        return {
            'scheme_name': scheme_name,
            'scheme_data': scheme_data,
            'selected_variant': selected_variant,
            'style': style
        }

    def _sample_borders(self, style: str) -> Dict:
        """é‡‡æ ·è¾¹æ¡†æ ·å¼"""
        if style not in self.borders:
            # é£Žæ ¼ä¸å­˜åœ¨ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨é£Žæ ¼
            style = list(self.borders.keys())[0] if self.borders else None
            if not style:
                return {}

        border_styles = self.borders[style]

        if not border_styles:
            return {}

        # é¿å…æœ€è¿‘ä½¿ç”¨çš„
        recent_borders = self._get_recent_values('borders', n=2)
        available = [name for name in border_styles.keys() if name not in recent_borders]

        if not available:
            available = list(border_styles.keys())

        # éšæœºé€‰æ‹©ä¸€ä¸ªè¾¹æ¡†æ ·å¼
        border_name = random.choice(available)
        border_config = border_styles[border_name]

        return {
            'border_name': border_name,
            'border_config': border_config,
            'style': style
        }

    def _sample_decorations(self, style: str) -> Dict:
        """é‡‡æ ·è£…é¥°å…ƒç´ """
        if style not in self.decorations:
            # é£Žæ ¼ä¸å­˜åœ¨ï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªå¯ç”¨é£Žæ ¼
            style = list(self.decorations.keys())[0] if self.decorations else None
            if not style:
                return {}

        decoration_options = self.decorations[style]

        if not decoration_options:
            return {}

        # é¿å…æœ€è¿‘ä½¿ç”¨çš„
        recent_decorations = self._get_recent_values('decorations', n=2)
        available = [name for name in decoration_options.keys() if name not in recent_decorations]

        if not available:
            available = list(decoration_options.keys())

        # éšæœºé€‰æ‹©ä¸€ä¸ªè£…é¥°å…ƒç´ 
        decoration_name = random.choice(available)
        decoration_config = decoration_options[decoration_name]

        return {
            'decoration_name': decoration_name,
            'decoration_config': decoration_config,
            'style': style
        }

    def _get_recent_values(self, variable_type: str, n: int = 2) -> List[str]:
        """èŽ·å–æœ€è¿‘ä½¿ç”¨è¿‡çš„å€¼"""
        recent = []
        for record in reversed(self.history):
            if variable_type in record['sampled']:
                sampled_data = record['sampled'][variable_type]
                # æå–åç§°
                if variable_type == 'colors':
                    name = sampled_data.get('scheme_name')
                elif variable_type == 'borders':
                    name = sampled_data.get('border_name')
                elif variable_type == 'decorations':
                    name = sampled_data.get('decoration_name')
                else:
                    continue

                if name and name not in recent:
                    recent.append(name)

                if len(recent) >= n:
                    break

        return recent

    def get_prompt_description(self, sampled: Dict) -> str:
        """
        å°†é‡‡æ ·çš„å˜é‡è½¬æ¢ä¸ºæç¤ºè¯æè¿°

        Args:
            sampled: é‡‡æ ·çš„å˜é‡å­—å…¸

        Returns:
            æç¤ºè¯æè¿°å­—ç¬¦ä¸²
        """
        parts = []

        # é…è‰²æè¿°
        if 'colors' in sampled:
            colors_data = sampled['colors']
            scheme_name = colors_data.get('scheme_name', '')
            variant = colors_data.get('selected_variant')
            if variant:
                parts.append(f"Color palette: {scheme_name}, primary color {variant['name']} ({variant['hex']})")

        # è¾¹æ¡†æè¿°
        if 'borders' in sampled:
            borders_data = sampled['borders']
            border_name = borders_data.get('border_name', '')
            border_config = borders_data.get('border_config', {})
            radius = border_config.get('radius', '')
            if radius:
                parts.append(f"Border style: {border_name}, radius {radius}")

        # è£…é¥°æè¿°
        if 'decorations' in sampled:
            deco_data = sampled['decorations']
            deco_name = deco_data.get('decoration_name', '')
            parts.append(f"Decorative elements: {deco_name}")

        return ', '.join(parts)


def test_yaml_sampler():
    """æµ‹è¯•YAMLå˜é‡é‡‡æ ·å™¨"""
    print("=" * 80)
    print("æµ‹è¯•YAMLå˜é‡é‡‡æ ·å™¨")
    print("=" * 80)

    sampler = YAMLVariableSampler()

    # æµ‹è¯•1ï¼šé‡‡æ ·æ¸©é¦¨å¯çˆ±é£Žæ ¼
    print("\nã€æµ‹è¯•1ã€‘é‡‡æ ·æ¸©é¦¨å¯çˆ±é£Žæ ¼")
    sampled1 = sampler.sample_variables(style='æ¸©é¦¨å¯çˆ±')

    print(f"  é…è‰²: {sampled1.get('colors', {}).get('scheme_name')}")
    if 'colors' in sampled1:
        variant = sampled1['colors'].get('selected_variant')
        if variant:
            print(f"    ä¸»è‰²: {variant['name']} ({variant['hex']})")

    print(f"  è¾¹æ¡†: {sampled1.get('borders', {}).get('border_name')}")
    print(f"  è£…é¥°: {sampled1.get('decorations', {}).get('decoration_name')}")

    # æµ‹è¯•2ï¼šå†æ¬¡é‡‡æ ·ï¼ˆåº”é¿å…é‡å¤ï¼‰
    print("\nã€æµ‹è¯•2ã€‘å†æ¬¡é‡‡æ ·æ¸©é¦¨å¯çˆ±ï¼ˆåº”é¿å…é‡å¤ï¼‰")
    sampled2 = sampler.sample_variables(style='æ¸©é¦¨å¯çˆ±')

    print(f"  é…è‰²: {sampled2.get('colors', {}).get('scheme_name')}")
    print(f"  è¾¹æ¡†: {sampled2.get('borders', {}).get('border_name')}")
    print(f"  è£…é¥°: {sampled2.get('decorations', {}).get('decoration_name')}")

    # æµ‹è¯•3ï¼šé‡‡æ ·çŽ°ä»£ç®€çº¦é£Žæ ¼
    print("\nã€æµ‹è¯•3ã€‘é‡‡æ ·çŽ°ä»£ç®€çº¦é£Žæ ¼")
    sampled3 = sampler.sample_variables(style='çŽ°ä»£ç®€çº¦')

    print(f"  é…è‰²: {sampled3.get('colors', {}).get('scheme_name')}")
    print(f"  è¾¹æ¡†: {sampled3.get('borders', {}).get('border_name')}")
    print(f"  è£…é¥°: {sampled3.get('decorations', {}).get('decoration_name')}")

    # æµ‹è¯•4ï¼šç”Ÿæˆæç¤ºè¯æè¿°
    print("\nã€æµ‹è¯•4ã€‘ç”Ÿæˆæç¤ºè¯æè¿°")
    prompt_desc = sampler.get_prompt_description(sampled1)
    print(f"  {prompt_desc}")

    print("\nâœ… æµ‹è¯•å®Œæˆ")


if __name__ == '__main__':
    test_yaml_sampler()



================================================
FILE: design-logic/modern-minimal/constraints.md
================================================
[Binary file]


================================================
FILE: design-logic/modern-minimal/principles.md
================================================
[Binary file]


================================================
FILE: design-logic/warm-cute/constraints.md
================================================
[Binary file]


================================================
FILE: design-logic/warm-cute/principles.md
================================================
[Binary file]


================================================
FILE: knowledge_base/how_to_control_color.md
================================================
# å¦‚ä½•æŽ§åˆ¶é¢œè‰²ï¼Ÿ

**ç”Ÿæˆæ—¶é—´**: 2026-01-04 14:56:41
**åˆ†æžæ ·æœ¬**: 5 ä¸ªæç¤ºè¯
**æ•°æ®æ¥æº**: moss_terrariumç³»åˆ—, ethereal_deity, pencil_sketch_idol

---

## ðŸŽ¨ æ ¸å¿ƒé…è‰²å…¬å¼

### å…¬å¼ 1: å†·æš–å¹³è¡¡ï¼ˆ7:3é»„é‡‘æ¯”ä¾‹ï¼‰

**å…¬å¼**: `70% cool base (forest greens) + 30% warm accent (amber wood)`

**æ¥æº**: moss_terrarium_001

**æ•ˆæžœ**: è‡ªç„¶å’Œè°ï¼Œæ¸…æ™°è§†è§‰å±‚æ¬¡

### å…¬å¼ 2: å†·æš–å¹³è¡¡ï¼ˆ7:3é»„é‡‘æ¯”ä¾‹ï¼‰

**å…¬å¼**: `70% cool base (forest greens) + 30% warm accent (amber wood)`

**æ¥æº**: moss_terrarium_002

**æ•ˆæžœ**: è‡ªç„¶å’Œè°ï¼Œæ¸…æ™°è§†è§‰å±‚æ¬¡

### å…¬å¼ 3: Cold Shell, Warm Heart (å¤–å†·å†…æš–)

**å…¬å¼**: `å†·è‰²ä¸»ä½“ (Cyan/Blue/White 80%) + æš–è‰²ç„¦ç‚¹ (Pink/Amber 20%)`

**æ¥æº**: ethereal_cyber_deity_001

**æ•ˆæžœ**: æˆå‰§æ€§å¯¹æ¯”ï¼Œå¼ºçƒˆè§†è§‰å†²å‡»

---

## ðŸ“š é¢œè‰²å…³é”®è¯åº“

### Cool Colors

- `bioluminescent cyan`
- `deep teal`
- `ice blue`
- `rich forest greens`

### Warm Colors

- `electric purple`
- `neon gold`
- `sunset amber`
- `vaporwave pink`
- `warm amber wood tones`

### Neutral Colors

- `ghostly white`
- `grayscale (graphite tones)`
- `weathered gray`

### Effects

- `dew sparkle`
- `glass transparency`
- `screen glow / SSS glow`

---

## ðŸ› ï¸ é…è‰²æŠ€å·§

1. **æ¸©åº¦å¯¹æ¯”** - å†·è‰²çŽ¯å¢ƒ + æš–è‰²ç„¦ç‚¹ = è§†è§‰å±‚æ¬¡æ„Ÿ
2. **7:3æ¯”ä¾‹** - ä¸»è‰²70%ï¼Œç„¦ç‚¹è‰²30%ï¼ˆé»„é‡‘æ¯”ä¾‹ï¼‰
3. **å•è‰²è°ƒ+å¼ºçƒˆç„¦ç‚¹** - å†·è‰²è°ƒä¸»ä½“ + é«˜é¥±å’Œåº¦æš–è‰²ç„¦ç‚¹
4. **å¯¹æ¯”åº¦åˆ†å±‚** - ä½Žå¯¹æ¯”ä¸»ä½“ + é«˜å¯¹æ¯”ç„¦ç‚¹
5. **ç‰¹æ®Šæ•ˆæžœ** - é€æ˜Žåº¦ã€å…‰æ™•ã€æ¬¡è¡¨é¢æ•£å°„å¢žå¼ºè§†è§‰æ·±åº¦

---

## ðŸ’¡ åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹ 1: moss_terrarium_001

**é…è‰²æ–¹æ¡ˆ**: rich forest greens (70%) + warm amber wood (30%)

**æ•ˆæžœ**: Natural harmony, clear focal point

**é€‚ç”¨åœºæ™¯**: è‡ªç„¶åœºæ™¯ã€æ¤ç‰©æ‘„å½±ã€å¾®ç¼©æ™¯è§‚

### æ¡ˆä¾‹ 2: ethereal_cyber_deity_001

**é…è‰²æ–¹æ¡ˆ**: Bioluminescent Cyan/Ice Blue (80%) + Vaporwave Pink/Sunset Amber (20%)

**æ•ˆæžœ**: Dramatic tension, cyberpunk aesthetic

**é€‚ç”¨åœºæ™¯**: ç§‘å¹»è‚–åƒã€èµ›åšæœ‹å…‹ã€3Dæ¸²æŸ“

### æ¡ˆä¾‹ 3: pencil_sketch_idol_001

**é…è‰²æ–¹æ¡ˆ**: Grayscale (ä¸»ä½“) + Vibrant accents (çŸ›ç›¾ç¤ºä¾‹)

**æ•ˆæžœ**: âŒ é€»è¾‘å†²çªï¼šç´ æåº”é¿å…å½©è‰²

**é€‚ç”¨åœºæ™¯**: å†™å®žç´ æ - åé¢æ¡ˆä¾‹




================================================
FILE: variables/borders.yaml
================================================
# è¾¹æ¡†å’Œé˜´å½±å˜é‡åº“

æ¸©é¦¨å¯çˆ±:
  corner_radius:
    values: [16, 18, 20, 22, 24]
    unit: "px"
    default: 18
    description: "å¤§åœ†è§’ï¼Œè¥é€ æŸ”å’Œæ„Ÿ"

  box_shadow:
    values:
      - {value: "0 4px 12px rgba(0,0,0,0.08)", name: "è½»å¾®æ‰©æ•£"}
      - {value: "0 6px 16px rgba(0,0,0,0.10)", name: "æ ‡å‡†æ‰©æ•£"}
      - {value: "0 8px 20px rgba(0,0,0,0.12)", name: "å¼ºæ‰©æ•£"}
    default: "0 6px 16px rgba(0,0,0,0.10)"
    description: "æ‰©æ•£å¼é˜´å½±ï¼Œæ— ç¡¬è¾¹"

  border:
    values:
      - {value: "none", name: "æ— è¾¹æ¡†"}
      - {value: "1px solid rgba(0,0,0,0.05)", name: "æžç»†è¾¹æ¡†"}
    default: "none"

çŽ°ä»£ç®€çº¦:
  corner_radius:
    values: [4, 6, 8, 10, 12]
    unit: "px"
    default: 8
    description: "å°åœ†è§’ï¼Œå…‹åˆ¶ä¸“ä¸š"

  box_shadow:
    values:
      - {value: "0 2px 4px rgba(0,0,0,0.04)", name: "æžç»†å¾®"}
      - {value: "0 2px 8px rgba(0,0,0,0.06)", name: "æ ‡å‡†ç»†å¾®"}
      - {value: "0 4px 8px rgba(0,0,0,0.05)", name: "ä¸­ç­‰ç»†å¾®"}
    default: "0 2px 8px rgba(0,0,0,0.06)"
    description: "ç»†å¾®é˜´å½±ï¼Œå¾®å¦™å±‚æ¬¡"

  border:
    values:
      - {value: "none", name: "æ— è¾¹æ¡†"}
      - {value: "1px solid rgba(0,0,0,0.08)", name: "ç»†è¾¹æ¡†"}
    default: "none"



================================================
FILE: variables/colors.yaml
================================================
[Binary file]


================================================
FILE: variables/decorations.yaml
================================================
# è£…é¥°å…ƒç´ å˜é‡åº“

æ¸©é¦¨å¯çˆ±:
  elements:
    æ˜Ÿæ˜Ÿ:
      emoji: "âœ¨"
      opacity_range: [0.15, 0.25]
      rotation_range: [-15, 15]
      size_range: [16, 32]
      count_range: [3, 8]

    çˆ±å¿ƒ:
      emoji: "ðŸ’•"
      opacity_range: [0.15, 0.25]
      rotation_range: [-10, 10]
      size_range: [20, 36]
      count_range: [2, 6]

    äº‘æœµ:
      emoji: "â˜ï¸"
      opacity_range: [0.12, 0.20]
      rotation_range: [-5, 5]
      size_range: [32, 64]
      count_range: [1, 3]

    èŠ±æœµ:
      emoji: "ðŸŒ¸"
      opacity_range: [0.15, 0.25]
      rotation_range: [-20, 20]
      size_range: [24, 40]
      count_range: [2, 5]

    æ°”çƒ:
      emoji: "ðŸŽˆ"
      opacity_range: [0.18, 0.28]
      rotation_range: [-12, 12]
      size_range: [28, 44]
      count_range: [2, 4]

  combinations:
    - combo: ["âœ¨", "ðŸ’•"]
      name: "æ˜Ÿæ˜Ÿçˆ±å¿ƒ"
      description: "ç»å…¸å¯çˆ±ç»„åˆ"

    - combo: ["â˜ï¸", "âœ¨"]
      name: "äº‘æœµæ˜Ÿæ˜Ÿ"
      description: "æ¢¦å¹»ç»„åˆ"

    - combo: ["ðŸŒ¸", "âœ¨", "ðŸ’•"]
      name: "èŠ±æœµçˆ±å¿ƒ"
      description: "æµªæ¼«ç»„åˆ"

    - combo: ["ðŸŽˆ", "âœ¨"]
      name: "æ°”çƒæ˜Ÿæ˜Ÿ"
      description: "æ´»æ³¼ç»„åˆ"

    - combo: ["â˜ï¸", "ðŸŒ¸"]
      name: "äº‘æœµèŠ±æœµ"
      description: "æŸ”å’Œç»„åˆ"

çŽ°ä»£ç®€çº¦:
  elements:
    å‡ ä½•çº¿æ¡:
      type: "line"
      opacity_range: [0.05, 0.10]
      rotation_options: [0, 45, 90]
      stroke_width: [1, 2]
      count_range: [3, 6]

    ç‚¹é˜µ:
      type: "dot_grid"
      opacity_range: [0.05, 0.10]
      spacing: [8, 16, 24]
      coverage: [10, 30]  # percentage

    æ¸å˜å—:
      type: "gradient"
      opacity_range: [0.03, 0.08]
      directions: [45, 135, "to bottom", "to right"]
      count_range: [1, 2]

    å›¾æ ‡:
      type: "icon"
      style: "outline"
      opacity_range: [0.08, 0.15]
      size_range: [16, 32]
      count_range: [2, 4]

  combinations:
    - combo: ["line", "dot_grid"]
      name: "çº¿æ¡ç‚¹é˜µ"
      description: "ç»å…¸å‡ ä½•"

    - combo: ["gradient"]
      name: "æ¸å˜"
      description: "å¾®å¦™æ¸å˜"

    - combo: ["icon"]
      name: "å›¾æ ‡"
      description: "çº¿æ€§å›¾æ ‡"



================================================
FILE: .claude/claude.md
================================================
# Claude Code é¡¹ç›®è§„åˆ™

## âš ï¸ SKILLè°ƒç”¨è§„åˆ™ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰

### å½“ç”¨æˆ·è¯·æ±‚ç”Ÿæˆæç¤ºè¯æ—¶

---

### ðŸ“Š æž¶æž„åŽŸç†ï¼ˆé‡è¦ï¼ï¼‰

**ç»Ÿä¸€æ•°æ®æºï¼Œåˆ†å±‚è®¿é—®**ï¼š

æ‰€æœ‰å­¦ä¹ æˆæžœéƒ½å­˜å‚¨åœ¨ `elements.db`ï¼ˆ1103å…ƒç´ ï¼Œ12é¢†åŸŸï¼‰ï¼Œä½†æ¯ä¸ªskillè®¿é—®ä¸åŒçš„é¢†åŸŸï¼š

| Skill | è®¿é—®Domain | å…ƒç´ æ•° | æ¡†æž¶/æ–¹æ³• | ä¸“é•¿ |
|-------|-----------|--------|----------|------|
| intelligent-prompt-generator | portrait | 491 | äººåƒæ¡†æž¶(7å¤§ç±») | äº”å®˜ã€å¦†å®¹ã€è¡¨æƒ…ã€äººåƒå…‰å½± |
| art-master | art | 51 | ç›´æŽ¥æŸ¥è¯¢ | è‰ºæœ¯æŠ€æ³•ã€ç¬”è§¦ã€ç•™ç™½ |
| design-master | design | 59 | ç›´æŽ¥æŸ¥è¯¢ | Bento Gridã€çŽ»ç’ƒæ€ã€å¸ƒå±€ |
| product-master | product | 77 | ç›´æŽ¥æŸ¥è¯¢ | å•†ä¸šæ‘„å½±ã€äº§å“å¸ƒå…‰ |
| video-master | video | 49 | ç›´æŽ¥æŸ¥è¯¢ | é•œå¤´è¿åŠ¨ã€è½¬åœºã€ç‰¹æ•ˆ |
| **prompt-crafter** â­ | design (å˜é‡åº“) | 20ä¸‡+ç»„åˆ | ä¸“ä¸šè®¾è®¡ç³»ç»Ÿ | é…è‰²æ–¹æ¡ˆã€è£…é¥°å…ƒç´ ã€é£Žæ ¼æŽ¨è |

**å…³é”®**ï¼š
- intelligent-prompt-generator ä½¿ç”¨ `prompt_framework.yaml`ï¼ˆäººåƒä¸“ç”¨æ¡†æž¶ï¼‰
- æ¡†æž¶åŒ…å«ï¼šsubjectï¼ˆä¸»ä½“ï¼‰ã€facialï¼ˆé¢éƒ¨ï¼‰ã€stylingï¼ˆé€ åž‹ï¼‰ã€expressionï¼ˆè¡¨æƒ…ï¼‰ã€lightingï¼ˆå…‰å½±ï¼‰ã€sceneï¼ˆåœºæ™¯ï¼‰ã€technicalï¼ˆæŠ€æœ¯ï¼‰
- **æ‰€æœ‰å­—æ®µéƒ½æ˜¯äººåƒä¸“ç”¨**ï¼šeyes, nose, lips, makeup, hairstyle, pose ç­‰
- é£Žæ™¯ç”»ã€äº§å“ã€æµ·æŠ¥ä¸éœ€è¦è¿™äº›å­—æ®µ â†’ å¿…é¡»ç”¨domain expert skills

---

### âš¡ å¿«é€Ÿå†³ç­–æ ‘

```
ç”¨æˆ·è¯·æ±‚
    â†“
ã€æœ‰äººç‰©å—ï¼Ÿã€‘
    â†“
  YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ intelligent-prompt-generator
    â”‚               ï¼ˆportrait domain, 491å…ƒç´ ï¼‰
    â”‚               é™¤éžå¼ºè°ƒè‰ºæœ¯æŠ€æ³•æœ¯è¯­
    â”‚
  NO
    â†“
ã€ä¸»ä½“æ˜¯ä»€ä¹ˆï¼Ÿã€‘
    â†“
    â”œâ”€ é£Žæ™¯/é™ç‰©/è‰ºæœ¯ç»˜ç”» â†’ art-master (art domain, 51å…ƒç´ )
    â”œâ”€ äº§å“/å•†å“ â†’ product-master (product domain, 77å…ƒç´ )
    â”œâ”€ æµ·æŠ¥/UI/å¸ƒå±€ï¼ˆéœ€è¦è®¾è®¡æœ¯è¯­ï¼‰ â†’ design-master (design domain, 59å…ƒç´ )
    â”œâ”€ æµ·æŠ¥/å¡ç‰‡ï¼ˆéœ€è¦é…è‰²+é£Žæ ¼ç³»ç»Ÿï¼‰ â†’ prompt-crafter â­ (20ä¸‡+ç»„åˆ)
    â””â”€ è§†é¢‘/é•œå¤´è¿åŠ¨ â†’ video-master (video domain, 49å…ƒç´ )
```

---

**STEP 1: åˆ¤æ–­ä¸»ä½“ï¼ˆæœ€é‡è¦ï¼‰**

é¦–å…ˆåˆ¤æ–­ï¼š**è¯·æ±‚ä¸­æ˜¯å¦åŒ…å«äººç‰©ï¼Ÿ**

**YES - æœ‰äººç‰©**ï¼š
- é»˜è®¤å€¾å‘ â†’ `intelligent-prompt-generator`ï¼ˆäººåƒä¸“å®¶ï¼‰
- é™¤éžç”¨æˆ·æ˜Žç¡®å¼ºè°ƒè‰ºæœ¯æŠ€æ³•/è®¾è®¡å¸ƒå±€

**NO - æ— äººç‰©**ï¼š
- æ ¹æ®ä¸»ä½“ç±»åž‹é€‰æ‹©ä¸“å®¶ï¼ˆè§ä¸‹æ–¹ï¼‰

---

**STEP 2: æ ¹æ®ä¸»ä½“ç±»åž‹é€‰æ‹©ä¸“å®¶**

**ðŸŽ¨ è‰ºæœ¯ä½œå“ï¼ˆæ— äººç‰©ï¼‰** â†’ `art-master`
- å…³é”®è¯ï¼šæ°´å¢¨ç”»å±±æ°´ã€æ²¹ç”»é£Žæ™¯ã€æŠ½è±¡è‰ºæœ¯ã€é™ç‰©ç»˜ç”»
- ç¤ºä¾‹ï¼š"ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»å±±æ°´" "æ²¹ç”»é£Žæ ¼çš„é™ç‰©"

**ðŸŽ¯ å¹³é¢è®¾è®¡ï¼ˆæ— äººç‰©ï¼‰** â†’ ä¸¤ç§é€‰æ‹©ï¼š

**A. design-master** - è®¾è®¡æœ¯è¯­å’Œå¸ƒå±€æè¿°
- å…³é”®è¯ï¼šBento Gridã€çŽ»ç’ƒæ€ã€UIã€æŽ’ç‰ˆæŠ€æœ¯æœ¯è¯­
- ç¤ºä¾‹ï¼š"ç”ŸæˆBento Gridæµ·æŠ¥" "çŽ»ç’ƒæ€UIè®¾è®¡"
- è¾“å‡ºï¼šè®¾è®¡æœ¯è¯­æè¿°

**B. prompt-crafter** â­ - ä¸“ä¸šè®¾è®¡è§„èŒƒå’Œé…è‰²ç³»ç»Ÿ
- å…³é”®è¯ï¼šæ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦ã€é…è‰²æ–¹æ¡ˆã€å„¿ç«¥æ•™è‚²ã€å¡ç‰‡è®¾è®¡
- ç¤ºä¾‹ï¼š"ç”Ÿæˆæ¸©é¦¨å¯çˆ±çš„å„¿ç«¥æµ·æŠ¥" "çŽ°ä»£ç®€çº¦ç§‘æŠ€å®£ä¼ å›¾"
- è¾“å‡ºï¼šå®Œæ•´è®¾è®¡è§„èŒƒï¼ˆé…è‰²+åœ†è§’+é˜´å½±+è£…é¥°+æŠ€æœ¯å‚æ•°ï¼‰

**å¦‚ä½•é€‰æ‹©**ï¼š
- éœ€è¦è®¾è®¡æœ¯è¯­ â†’ design-master
- éœ€è¦å®Œæ•´è®¾è®¡ç³»ç»Ÿï¼ˆé…è‰²+è£…é¥°+é£Žæ ¼ï¼‰ â†’ prompt-crafter

**ðŸ“¦ äº§å“æ‘„å½±ï¼ˆæ— äººç‰©ï¼‰** â†’ `product-master`
- å…³é”®è¯ï¼šäº§å“ã€å•†å“ã€å•†ä¸šæ‘„å½±ã€åŒ…è£…ã€é™ç‰©
- ç¤ºä¾‹ï¼š"ç”Ÿæˆå¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±" "ä¹¦ç±äº§å“å±•ç¤º"

**ðŸŽ¬ è§†é¢‘åœºæ™¯ï¼ˆæ— äººç‰©ï¼‰** â†’ `video-master`
- å…³é”®è¯ï¼šè§†é¢‘ã€é•œå¤´è¿åŠ¨ã€è¿é•œã€è½¬åœºã€åŠ¨æ€åœºæ™¯
- ç¤ºä¾‹ï¼š"ç”Ÿæˆæ­¦ä¾ åœºæ™¯è¿é•œ" "é£Žæ™¯å»¶æ—¶æ‘„å½±"

**ðŸ‘¤ äººåƒæ‘„å½±ï¼ˆæœ‰äººç‰©ï¼‰** â†’ `intelligent-prompt-generator`
- å…³é”®è¯ï¼šäººç‰©ã€è‚–åƒã€é¢éƒ¨ã€äº”å®˜ã€è¡¨æƒ…ã€å§¿åŠ¿ã€å¦†å®¹
- ç¤ºä¾‹ï¼š"ç”Ÿæˆç”µå½±çº§äºšæ´²å¥³æ€§" "ç¾Žå°‘å¥³è‚–åƒ"

---

**STEP 3: å†²çªåœºæ™¯å¤„ç†**

**å½“è¯·æ±‚åŒæ—¶æ¶‰åŠäººç‰© + ç‰¹æ®Šé£Žæ ¼æ—¶**ï¼ˆå¦‚ï¼š"æ°´å¢¨ç”»é£Žæ ¼çš„äººç‰©"ï¼‰

**é»˜è®¤ç­–ç•¥**ï¼ˆ80%çš„æƒ…å†µé€‚ç”¨ï¼‰ï¼š
- æœ‰äººç‰© â†’ ä¼˜å…ˆ `intelligent-prompt-generator`
- åŽŸå› ï¼šäººåƒæ¡†æž¶èƒ½å¤„ç†äººç‰©å±žæ€§ï¼ˆäº”å®˜ã€è¡¨æƒ…ã€å¦†å®¹ï¼‰ï¼Œé£Žæ ¼é€šè¿‡ art_style å‚æ•°å®žçŽ°

**ä½•æ—¶ä½¿ç”¨ art-master**ï¼ˆ20%çš„æƒ…å†µï¼‰ï¼š
ç”¨æˆ·æ˜Žç¡®å¼ºè°ƒè‰ºæœ¯æŠ€æ³•ä¸“ä¸šæœ¯è¯­æ—¶ï¼š
- "æ°´å¢¨ç”»çš„**ç¬”è§¦å’Œç•™ç™½æŠ€æ³•**"
- "æ²¹ç”»çš„**åŽšæ¶‚å’Œç¬”è§¦è‚Œç†**"
- "è¶…çŽ°å®žä¸»ä¹‰çš„**è‰ºæœ¯æ‰‹æ³•**"
- å…³é”®è¯ï¼šç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ã€åŽšæ¶‚ã€è‚Œç†ã€æŠ€æ³•

**ä½•æ—¶è¯¢é—®ç”¨æˆ·**ï¼š
å½“åŒæ—¶å¼ºè°ƒäººç‰©ç»†èŠ‚å’Œè‰ºæœ¯æŠ€æ³•æ—¶ï¼š
```
æˆ‘æ³¨æ„åˆ°ä½ çš„è¯·æ±‚æ¶‰åŠï¼š
- äººç‰©è‚–åƒï¼ˆintelligent-prompt-generator ä¸“é•¿ï¼šæ·±åº¦äº”å®˜ç†è§£ï¼‰
- æ°´å¢¨ç”»æŠ€æ³•ï¼ˆart-master ä¸“é•¿ï¼šç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ï¼‰

ä½ æ›´å…³æ³¨ï¼š
A. äººç‰©ç»†èŠ‚ï¼ˆäº”å®˜ã€è¡¨æƒ…ã€å¦†å®¹ï¼‰
B. è‰ºæœ¯æŠ€æ³•ï¼ˆç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ï¼‰

è¯·é€‰æ‹©ï¼Ÿ
```

---

### ðŸ“ ç¤ºä¾‹å¯¹æ¯”è¡¨

**å…¸åž‹åœºæ™¯è·¯ç”±ç¤ºä¾‹**ï¼š

| ç”¨æˆ·è¯·æ±‚ | æœ‰äººç‰©ï¼Ÿ | è·¯ç”±é€‰æ‹© | ç†ç”± |
|---------|---------|---------|------|
| "ç”Ÿæˆç”µå½±çº§äºšæ´²å¥³æ€§" | âœ… | intelligent-prompt-generator | äººç‰©è‚–åƒï¼Œéœ€è¦äº”å®˜å¦†å®¹ |
| "ç”Ÿæˆæ°´å¢¨ç”»é£Žæ ¼çš„å¥³æ€§" | âœ… | intelligent-prompt-generator | ä¸»ä½“æ˜¯äººç‰©ï¼Œæ°´å¢¨ç”»ä½œä¸ºart_style |
| "ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»å±±æ°´" | âŒ | art-master | æ— äººç‰©ï¼Œçº¯è‰ºæœ¯é£Žæ ¼ |
| "ç”ŸæˆBento Gridæµ·æŠ¥" | âŒ | design-master | æ— äººç‰©ï¼Œè®¾è®¡å¸ƒå±€æœ¯è¯­ |
| "ç”Ÿæˆæ¸©é¦¨å¯çˆ±çš„å„¿ç«¥æµ·æŠ¥" | âŒ | **prompt-crafter** â­ | éœ€è¦é…è‰²+è£…é¥°+é£Žæ ¼ç³»ç»Ÿ |
| "ç”ŸæˆçŽ°ä»£ç®€çº¦ç§‘æŠ€å®£ä¼ å›¾" | âŒ | **prompt-crafter** â­ | éœ€è¦ä¸“ä¸šè®¾è®¡è§„èŒƒ |
| "ç”Ÿæˆå¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±" | âŒ | product-master | äº§å“æ‘„å½± |
| "ç”Ÿæˆæ­¦ä¾ åœºæ™¯è¿é•œ" | âŒ | video-master | é•œå¤´è¿åŠ¨ |
| "ç”Ÿæˆå¥³æ€§è‚–åƒï¼Œè¦æ±‚æ°´å¢¨ç”»çš„ç¬”è§¦ç•™ç™½" | âœ… | è¯¢é—®ç”¨æˆ· | åŒæ—¶å¼ºè°ƒäººç‰©å’Œè‰ºæœ¯æŠ€æ³• |
| "ç”ŸæˆBento Gridæµ·æŠ¥ï¼ŒåŒ…å«äººç‰©å¤´åƒ" | âŒ | design-master | ä¸»ä½“æ˜¯æµ·æŠ¥ï¼Œäººç‰©åªæ˜¯å…ƒç´  |

**è¾¹ç•Œæ¡ˆä¾‹ç¤ºä¾‹**ï¼š

| ç”¨æˆ·è¯·æ±‚ | åˆ†æž | è·¯ç”±é€‰æ‹© |
|---------|------|---------|
| "æ¢µé«˜é£Žæ ¼çš„å¥³æ€§è‚–åƒ" | ä¸»ä½“ï¼šå¥³æ€§è‚–åƒ / é£Žæ ¼ï¼šæ¢µé«˜ | intelligent-prompt-generator (art_style='van_gogh') |
| "æ²¹ç”»æŠ€æ³•çš„åŽšæ¶‚è‚Œç†æ•ˆæžœ" | æ— äººç‰©ï¼Œå¼ºè°ƒæŠ€æ³• | art-master |
| "å¥³æ¨¡ç‰¹å±•ç¤ºé¦™æ°´ç“¶" | ç„¦ç‚¹ä¸æ˜Žç¡®ï¼ˆäººç‰© vs äº§å“ï¼‰ | è¯¢é—®ç”¨æˆ·ç„¦ç‚¹ |
| "æ­¦ä¾ äººç‰©é£žèº«è·ƒèµ·" | äººç‰©åŠ¨ä½œ vs é•œå¤´è¿åŠ¨ | intelligent-prompt-generator (poseå­—æ®µ) |

---

**STEP 4: è°ƒç”¨å¯¹åº”çš„ä¸“å®¶ Skill**

ä½¿ç”¨ `Skill` tool è°ƒç”¨é€‰å®šçš„ä¸“å®¶ï¼š
- `Skill(command="art-master")`
- `Skill(command="design-master")`
- `Skill(command="product-master")`
- `Skill(command="video-master")`
- `Skill(command="intelligent-prompt-generator")`
- `Skill(command="prompt-crafter")` â­ **æ–°å¢ž**

**ä½ ç»å¯¹ä¸èƒ½**ï¼š
- âŒ åœ¨conversationé‡Œç›´æŽ¥ç”¨Bashè°ƒç”¨Python
- âŒ åœ¨conversationé‡Œç›´æŽ¥ç”Ÿæˆæç¤ºè¯
- âŒ ç»•è¿‡skillè‡ªå·±åšæ‰€æœ‰äº‹æƒ…
- âŒ æ‰€æœ‰è¯·æ±‚éƒ½é»˜è®¤è°ƒç”¨ intelligent-prompt-generatorï¼ˆè¦å…ˆè¯†åˆ«é¢†åŸŸï¼‰

### ä¸ºä»€ä¹ˆè¦æ™ºèƒ½è·¯ç”±ï¼Ÿ

**æˆ‘ä»¬çš„ç›®æ ‡**ï¼šè®©æ¯ä¸ªé¢†åŸŸä¸“å®¶å‘æŒ¥ä¸“é•¿ï¼Œä¸æ˜¯æŠŠæ‰€æœ‰ä»»åŠ¡éƒ½æ‰”ç»™ä¸€ä¸ªskill

**æ¯ä¸ªä¸“å®¶çš„ç‹¬ç‰¹ä»·å€¼**ï¼š
- art-master: è‰ºæœ¯æµæ´¾ä¸“ä¸šæœ¯è¯­ï¼ˆç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ï¼‰
- design-master: çŽ°ä»£è®¾è®¡ç³»ç»Ÿï¼ˆBento Gridã€Glassmorphismï¼‰
- product-master: å•†ä¸šæ‘„å½±å™¨æï¼ˆPhase Oneç›¸æœºã€softboxï¼‰
- video-master: é•œå¤´è¯­è¨€ï¼ˆè¿é•œã€è½¬åœºã€ç‰¹æ•ˆï¼‰
- intelligent-prompt-generator: æ·±åº¦äººåƒç†è§£ï¼ˆäº”å®˜ã€äººç§æŽ¨ç†ï¼‰
- **prompt-crafter** â­: ä¸“ä¸šè®¾è®¡è§„èŒƒï¼ˆé…è‰²æ–¹æ¡ˆã€è£…é¥°å…ƒç´ ã€é£Žæ ¼ç³»ç»Ÿã€20ä¸‡+ç»„åˆï¼‰

---

## ðŸŽ¯ å…¶ä»–Skillè°ƒç”¨è§„åˆ™

### å½“ç”¨æˆ·è¯·æ±‚ä¸“ä¸šè®¾è®¡æç¤ºè¯æ—¶ â­ **æ–°å¢ž**

**ç”¨æˆ·è¯´**ï¼š
- "ç”Ÿæˆæ¸©é¦¨å¯çˆ±/çŽ°ä»£ç®€çº¦çš„æµ·æŠ¥"
- "æˆ‘è¦åšå„¿ç«¥æ•™è‚²/ç§‘æŠ€å®£ä¼ çš„è®¾è®¡"
- "éœ€è¦é…è‰²æ–¹æ¡ˆ"
- "å¸®æˆ‘è®¾è®¡XXé£Žæ ¼çš„å¡ç‰‡"

**ä½ å¿…é¡»**ï¼š
âœ… è°ƒç”¨ `prompt-crafter` skill

**prompt-crafter çš„ç‰¹ç‚¹**ï¼š
- ä»Ž20ä¸‡+å˜é‡ç»„åˆä¸­é‡‡æ ·
- è¾“å‡ºå®Œæ•´è®¾è®¡è§„èŒƒï¼ˆé…è‰²+åœ†è§’+é˜´å½±+è£…é¥°+æŠ€æœ¯å‚æ•°ï¼‰
- æ”¯æŒé£Žæ ¼ï¼šæ¸©é¦¨å¯çˆ±ã€çŽ°ä»£ç®€çº¦
- é€‚ç”¨åœºæ™¯ï¼šå„¿ç«¥æ•™è‚²ã€ç§‘æŠ€å•†åŠ¡ã€æµ·æŠ¥å¡ç‰‡è®¾è®¡

### å½“ç”¨æˆ·è¯·æ±‚NotebookLMç›¸å…³åŠŸèƒ½æ—¶

**ç”¨æˆ·è¯´**ï¼š
- "æŸ¥è¯¢NotebookLM"
- "ç”Ÿæˆæ’­å®¢/è§†é¢‘/æ€ç»´å¯¼å›¾"
- NotebookLMç›¸å…³ä»»åŠ¡

**ä½ å¿…é¡»**ï¼š
âœ… è°ƒç”¨ `notebooklm` skill

### å½“ç”¨æˆ·è¯·æ±‚æŽ¨ç‰¹å†™ä½œæ—¶

**ç”¨æˆ·è¯´**ï¼š
- "ç”ŸæˆæŽ¨ç‰¹å†…å®¹"
- "åŸºäºŽçŸ¥è¯†åº“å†™æŽ¨æ–‡"

**ä½ å¿…é¡»**ï¼š
âœ… è°ƒç”¨ `twitter-writer` skill

### å½“ç”¨æˆ·è¯·æ±‚å¥èº«è®¡åˆ’æ—¶

**ç”¨æˆ·è¯´**ï¼š
- "åˆ¶å®šå¥èº«è®¡åˆ’"
- "è§„åˆ’è¿åŠ¨å®‰æŽ’"

**ä½ å¿…é¡»**ï¼š
âœ… è°ƒç”¨ `workout-planner` skill

### å½“ç”¨æˆ·è¯·æ±‚å†™ä½œè§„åˆ’æ—¶

**ç”¨æˆ·è¯´**ï¼š
- "å¸®æˆ‘è§„åˆ’æ–‡ç« "
- "æž„æ€åšå®¢ç»“æž„"

**ä½ å¿…é¡»**ï¼š
âœ… è°ƒç”¨ `writing-planner` skill

---

## ðŸ¤” å¦‚æžœä¸ç¡®å®š

**å½“ä½ ä¸ç¡®å®šåº”è¯¥è°ƒç”¨å“ªä¸ªskillæ—¶**ï¼š

1. âœ… **æé—®ç”¨æˆ·**
2. âŒ **ä¸è¦è‡ªå·±çŒœ**
3. âŒ **ä¸è¦åœ¨conversationé‡Œç›´æŽ¥åš**

**é—®æ³•ç¤ºä¾‹**ï¼š
```
æˆ‘æ³¨æ„åˆ°ä½ çš„è¯·æ±‚å¯èƒ½æ¶‰åŠXXXã€‚

æˆ‘åº”è¯¥ï¼š
A. è°ƒç”¨ XXX skill
B. è°ƒç”¨ YYY skill
C. ç›´æŽ¥åœ¨è¿™é‡Œå¤„ç†

è¯·é€‰æ‹©ï¼Ÿ
```

---

## ðŸ“‹ é¡¹ç›®æž¶æž„

### æ ¸å¿ƒç³»ç»Ÿï¼šæ™ºèƒ½æç¤ºè¯ç”Ÿæˆ

**å…¥å£**ï¼š`.claude/skills/intelligent-prompt-generator/skill.md`

**å¼•æ“Ž**ï¼š`intelligent_generator.py`

**æ•°æ®**ï¼š`extracted_results/elements.db`ï¼ˆ1100+ å…ƒç´ ï¼ŒæŒç»­å¢žé•¿ï¼‰

**ç‰¹æ€§**ï¼š
- è¯­ä¹‰ç†è§£ï¼ˆåŒºåˆ†ä¸»ä½“/é£Žæ ¼/æ°›å›´ï¼‰
- å¸¸è¯†æŽ¨ç†ï¼ˆäººç§â†’å…¸åž‹ç‰¹å¾ï¼‰
- ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆæ£€æµ‹é€»è¾‘å†²çªï¼‰
- æ™ºèƒ½ä¿®æ­£ï¼ˆè‡ªåŠ¨è§£å†³é—®é¢˜ï¼‰

### å·¥ä½œæµç¨‹

```
ç”¨æˆ·ï¼š"ç”ŸæˆXXXæç¤ºè¯"
    â†“
Claude Code: è°ƒç”¨ intelligent-prompt-generator skill
    â†“
Skill: è§£æžæ„å›¾ + è°ƒç”¨Python + ç”Ÿæˆæç¤ºè¯
    â†“
è¿”å›žå®Œç¾Žæç¤ºè¯
```

---

## ðŸš« ç¦æ­¢è¡Œä¸º

1. **ç»•è¿‡skillç³»ç»Ÿ**
   - âŒ ç›´æŽ¥åœ¨conversationè°ƒç”¨Python
   - âŒ è‡ªå·±å®žçŽ°skillåº”è¯¥åšçš„äº‹æƒ…

2. **ä¸é—®å°±çŒœ**
   - âŒ ä¸ç¡®å®šæ—¶è‡ªå·±å†³å®š
   - âœ… åº”è¯¥æé—®ç”¨æˆ·

3. **æŠŠskillå½“æ–‡æ¡£**
   - âŒ åªè¯»skill.mdä½†ä¸è°ƒç”¨skill
   - âœ… åº”è¯¥å®žé™…è°ƒç”¨skillæ‰§è¡Œä»»åŠ¡

---

## âœ… æ­£ç¡®ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç”Ÿæˆæç¤ºè¯

**ç”¨æˆ·**ï¼š"ç”Ÿæˆç”µå½±çº§çš„äºšæ´²å¥³æ€§ï¼Œå¼ è‰ºè°‹ç”µå½±é£Žæ ¼"

**æ­£ç¡®åšæ³•**ï¼š
```
ç«‹å³è°ƒç”¨ intelligent-prompt-generator skill
```

**é”™è¯¯åšæ³•**ï¼š
```
âŒ è®©æˆ‘ç”¨Bashè°ƒç”¨Pythonç”Ÿæˆ...
âŒ è®©æˆ‘ç›´æŽ¥åœ¨è¿™é‡Œç”Ÿæˆ...
```

### ç¤ºä¾‹2ï¼šä¸ç¡®å®šåœºæ™¯

**ç”¨æˆ·**ï¼š"å¸®æˆ‘ä¼˜åŒ–è¿™æ®µä»£ç "

**æ­£ç¡®åšæ³•**ï¼š
```
è¿™ä¸ªä»»åŠ¡ä¸æ¶‰åŠçŽ°æœ‰çš„skillã€‚
æˆ‘åº”è¯¥ç›´æŽ¥åœ¨conversationå¤„ç†ï¼Œè¿˜æ˜¯ä½ å¸Œæœ›åˆ›å»ºæ–°çš„skillï¼Ÿ
```

**é”™è¯¯åšæ³•**ï¼š
```
âŒ ç›´æŽ¥å¼€å§‹ä¼˜åŒ–ï¼ˆåº”è¯¥å…ˆç¡®è®¤ï¼‰
```

---

## ðŸŽ¯ æ ¸å¿ƒåŽŸåˆ™

1. **Skillä¼˜å…ˆ** - èƒ½ç”¨skillçš„å¿…é¡»ç”¨skill
2. **æé—®ä¸ºå…ˆ** - ä¸ç¡®å®šæ—¶é—®ç”¨æˆ·ï¼Œä¸è¦çŒœ
3. **ç³»ç»Ÿå®Œæ•´æ€§** - è¯æ˜Žskillç³»ç»Ÿå¯ä»¥å·¥ä½œï¼Œä¸æ˜¯æ‘†è®¾

---

## ðŸ’¡ è®¾è®¡åŽŸåˆ™ï¼ˆé‡è¦ï¼ï¼‰

### åŽŸåˆ™1ï¼šè§£å†³æ ¹æœ¬é—®é¢˜ï¼Œä¸æ˜¯å½“å‰é—®é¢˜

**âŒ é”™è¯¯æ€ç»´**ï¼š
- "æå–çŽ‡31.4%å¤ªä½Žï¼Œè¡¥å……æå–é€»è¾‘"
- "æ–°é¢†åŸŸæ— æ³•è¯†åˆ«ï¼Œæ·»åŠ æ›´å¤šå…³é”®è¯"
- "å‡†ç¡®çŽ‡ä¸å¤Ÿï¼Œè°ƒæ•´é˜ˆå€¼"
- å¤´ç—›åŒ»å¤´ï¼Œè„šç—›åŒ»è„š

**âœ… æ­£ç¡®æ€ç»´**ï¼š
- "ä¸ºä»€ä¹ˆè¦ç”¨å…³é”®è¯åŒ¹é…ï¼Ÿæˆ‘ä»¬æœ‰AIèƒ½åŠ›"
- "ä¸ºä»€ä¹ˆè¦ç¡¬ç¼–ç ï¼Ÿåº”è¯¥AIé©±åŠ¨"
- "æž¶æž„æ˜¯å¦åˆç†ï¼Ÿæ˜¯å¦å¯æ‰©å±•ï¼Ÿ"
- ä»Žæ ¹æœ¬ä¸Šé‡æ–°è®¾è®¡

**æ•™è®­**ï¼š
- æˆ‘ä»¬æ˜¯ **Skill ç³»ç»Ÿ**ï¼Œæœ‰ Claude AI èƒ½åŠ›
- ä¸è¦ç”¨ 2010 å¹´çš„æ–¹æ³•ï¼ˆå…³é”®è¯åŒ¹é…ã€ç¡¬ç¼–ç è§„åˆ™ï¼‰
- åº”è¯¥ç”¨ 2024 å¹´çš„æ–¹æ³•ï¼ˆAI ç†è§£ã€æ™ºèƒ½æå–ï¼‰
- **ä¸´æ—¶è¡¥ä¸åªä¼šç§¯ç´¯æŠ€æœ¯å€ºï¼Œæ°¸è¿œè§£å†³ä¸äº†æ ¹æœ¬é—®é¢˜**

### åŽŸåˆ™2ï¼šè¯´åˆ°åšåˆ°ï¼Œä¸è¦ç”»å¤§é¥¼

**âŒ å¸¸è§é”™è¯¯**ï¼š
- æ‰¿è¯º"95%å‡†ç¡®çŽ‡"ä½†æ²¡éªŒè¯
- è¯´è¦"é…ç½®åŒ–"ä½†ç»§ç»­ç¡¬ç¼–ç 
- æè®®"AIé©±åŠ¨"ä½†åˆå»ºè®®ä¸´æ—¶æ–¹æ¡ˆ
- è¯´ä¸€å¥—ï¼Œåšå¦ä¸€å¥—

**âœ… æ­£ç¡®åšæ³•**ï¼š
- åªæ‰¿è¯ºå·²éªŒè¯çš„æ•ˆæžœ
- åªæä¾›çœŸæ­£æ‰“ç®—å®žæ–½çš„æ–¹æ¡ˆ
- è¯šå®žæ‰¿è®¤"ä¸çŸ¥é“"
- å…ˆåšå°è§„æ¨¡æµ‹è¯•ï¼Œå†ä¸‹ç»“è®º

### åŽŸåˆ™3ï¼šæž¶æž„ä¼˜å…ˆäºŽåŠŸèƒ½

**è®¾è®¡ç³»ç»Ÿæ—¶è¦é—®**ï¼š
1. è¿™ä¸ªè®¾è®¡æ˜¯å¦å¯æ‰©å±•ï¼Ÿ
2. æ–°éœ€æ±‚æ¥äº†æ˜¯å¦è¦æ”¹ä»£ç ï¼Ÿ
3. æ˜¯å¦å……åˆ†åˆ©ç”¨äº† AI èƒ½åŠ›ï¼Ÿ
4. æ˜¯å¦æ–¹ä¾¿ç»´æŠ¤å’Œæµ‹è¯•ï¼Ÿ

**ä¸è¦é—®**ï¼š
1. èƒ½ä¸èƒ½å¿«é€Ÿä¿®å¤å½“å‰é—®é¢˜ï¼Ÿ
2. èƒ½ä¸èƒ½å°‘æ”¹ç‚¹ä»£ç ï¼Ÿ
3. èƒ½ä¸èƒ½ä¸é‡æž„ï¼Ÿ

---

**è®°ä½**ï¼š
- æˆ‘ä»¬åœ¨å»ºç«‹ skill ç³»ç»Ÿï¼Œä¸æ˜¯å±•ç¤º Claude Code æœ‰å¤šå¼ºï¼
- **è§£å†³æ ¹æœ¬é—®é¢˜ï¼Œä¸æ˜¯å½“å‰é—®é¢˜**
- **è¯´åˆ°åšåˆ°ï¼Œä¸è¦ç”»å¤§é¥¼**



================================================
FILE: .claude/SKILL_ROUTING_GUIDE.md
================================================
# æç¤ºè¯ç”Ÿæˆ Skill è·¯ç”±ä½¿ç”¨æŒ‡å—

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜Žå¦‚ä½•æ ¹æ®ç”¨æˆ·è¯·æ±‚è‡ªåŠ¨è·¯ç”±åˆ°æ­£ç¡®çš„ Skillï¼ŒåŒ…å«æ¯ä¸ªæ­¥éª¤çš„è¯¦ç»†è§£é‡Šå’Œå®žé™…ç¤ºä¾‹ã€‚

---

## ðŸ“š ç›®å½•

1. [æž¶æž„æ¦‚è§ˆ](#æž¶æž„æ¦‚è§ˆ)
2. [è·¯ç”±æµç¨‹ 4 æ­¥éª¤](#è·¯ç”±æµç¨‹-4-æ­¥éª¤)
3. [æ¯ä¸ª Skill çš„è¯¦ç»†ç¤ºä¾‹](#æ¯ä¸ª-skill-çš„è¯¦ç»†ç¤ºä¾‹)
4. [å¸¸è§é—®é¢˜å¤„ç†](#å¸¸è§é—®é¢˜å¤„ç†)

---

## æž¶æž„æ¦‚è§ˆ

### æ•°æ®å­˜å‚¨ç»“æž„

```
elements.db (ç»Ÿä¸€æ•°æ®åº“)
    â”œâ”€ portrait domain (491 å…ƒç´ ) â†’ intelligent-prompt-generator
    â”œâ”€ art domain (51 å…ƒç´ ) â†’ art-master
    â”œâ”€ design domain (59 å…ƒç´ ) â†’ design-master
    â”œâ”€ product domain (77 å…ƒç´ ) â†’ product-master
    â”œâ”€ video domain (49 å…ƒç´ ) â†’ video-master
    â””â”€ å…¶ä»– 7 ä¸ª domain (common, interior, creative ç­‰)
```

### ä¸ºä»€ä¹ˆéœ€è¦ä¸åŒçš„ Skillï¼Ÿ

è™½ç„¶æ‰€æœ‰æ•°æ®åœ¨åŒä¸€ä¸ªæ•°æ®åº“ï¼Œä½†è®¿é—®æ–¹å¼ä¸åŒï¼š

- **intelligent-prompt-generator**: ä½¿ç”¨ `prompt_framework.yaml`ï¼ˆäººåƒä¸“ç”¨æ¡†æž¶ï¼‰ï¼ŒåŒ…å« eyes, nose, lips, makeup, hairstyle, pose ç­‰äººåƒä¸“ç”¨å­—æ®µ
- **domain expert skills**: ç›´æŽ¥æŸ¥è¯¢å¯¹åº”é¢†åŸŸï¼Œæ— éœ€äººåƒæ¡†æž¶

**å…³é”®**ï¼šé£Žæ™¯ç”»ã€äº§å“ã€æµ·æŠ¥ä¸éœ€è¦ "çœ¼ç›"ã€"å¦†å®¹"ã€"å§¿åŠ¿" è¿™äº›å­—æ®µ â†’ å¿…é¡»ç”¨ä¸“é—¨çš„ domain expert skills

---

## è·¯ç”±æµç¨‹ 4 æ­¥éª¤

### STEP 1: åˆ¤æ–­ä¸»ä½“ï¼ˆæœ€é‡è¦ï¼‰

**é—®é¢˜**ï¼šè¯·æ±‚ä¸­æ˜¯å¦åŒ…å«äººç‰©ï¼Ÿ

#### åˆ¤æ–­æ–¹æ³•

**æœ‰äººç‰©** çš„å…³é”®è¯ï¼š
- æ˜Žç¡®çš„äººç‰©ï¼šå¥³æ€§ã€ç”·æ€§ã€å¥³å­©ã€ç”·å­©ã€äººç‰©ã€è§’è‰²ã€è‚–åƒ
- èŒä¸š/èº«ä»½ï¼šæ¨¡ç‰¹ã€å¥³æ¼”å‘˜ã€æ­¦ä¾ äººç‰©ã€å•†åŠ¡äººå£«
- äººä½“éƒ¨ä½ï¼šé¢éƒ¨ã€äº”å®˜ã€è¡¨æƒ…ã€å§¿åŠ¿ã€å¦†å®¹

**æ— äººç‰©** çš„å…³é”®è¯ï¼š
- é£Žæ™¯ï¼šå±±æ°´ã€é£Žæ™¯ã€è‡ªç„¶ã€æ ‘æž—ã€æµ·æ´‹
- é™ç‰©ï¼šèŠ±å‰ã€é™ç‰©ã€æ¡Œé¢
- æŠ½è±¡ï¼šæŠ½è±¡è‰ºæœ¯ã€å‡ ä½•å›¾å½¢
- äº§å“ï¼šæ‰‹è¡¨ã€é¦™æ°´ã€ä¹¦ç±ã€å•†å“
- ç•Œé¢ï¼šæµ·æŠ¥ã€UIã€å¸ƒå±€ã€ç½‘é¡µ

#### ç¤ºä¾‹

| ç”¨æˆ·è¯·æ±‚ | æœ‰äººç‰©ï¼Ÿ | ä¸‹ä¸€æ­¥ |
|---------|---------|--------|
| "ç”Ÿæˆç”µå½±çº§äºšæ´²å¥³æ€§" | âœ… YES | é»˜è®¤ â†’ intelligent-prompt-generator |
| "ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»å±±æ°´" | âŒ NO | ç»§ç»­ STEP 2 |
| "ç”Ÿæˆæ­¦ä¾ äººç‰©é£žèº«è·ƒèµ·" | âœ… YES | é»˜è®¤ â†’ intelligent-prompt-generator |
| "ç”Ÿæˆå¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±" | âŒ NO | ç»§ç»­ STEP 2 |

---

### STEP 2: æ ¹æ®ä¸»ä½“ç±»åž‹é€‰æ‹©ä¸“å®¶

**å‰æ**ï¼šSTEP 1 åˆ¤æ–­ä¸º "æ— äººç‰©"

#### åˆ†ç±»è§„åˆ™

**ðŸŽ¨ è‰ºæœ¯ä½œå“** â†’ `art-master`
- å…³é”®è¯ï¼šæ°´å¢¨ç”»ã€æ²¹ç”»ã€æ°´å½©ç”»ã€æŠ½è±¡è‰ºæœ¯ã€æ’ç”»ã€ç»˜ç”»
- ç‰¹å¾ï¼šè‰ºæœ¯é£Žæ ¼ã€ç»˜ç”»æŠ€æ³•ã€è‰ºæœ¯æµæ´¾
- Domain: art (51 å…ƒç´ )
- ä¸“é•¿ï¼šç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ã€åŽšæ¶‚ã€è‚Œç†

**ðŸŽ¯ å¹³é¢è®¾è®¡** â†’ `design-master`
- å…³é”®è¯ï¼šæµ·æŠ¥ã€UIã€å¸ƒå±€ã€Bento Gridã€çŽ»ç’ƒæ€ã€æŽ’ç‰ˆ
- ç‰¹å¾ï¼šè®¾è®¡å¸ƒå±€ã€è§†è§‰æ•ˆæžœã€çŽ°ä»£è®¾è®¡ç³»ç»Ÿ
- Domain: design (59 å…ƒç´ )
- ä¸“é•¿ï¼šBento Gridã€Glassmorphismã€ç½‘æ ¼ç³»ç»Ÿ

**ðŸ“¦ äº§å“æ‘„å½±** â†’ `product-master`
- å…³é”®è¯ï¼šäº§å“ã€å•†å“ã€å•†ä¸šæ‘„å½±ã€åŒ…è£…ã€å±•ç¤º
- ç‰¹å¾ï¼šäº§å“ã€å•†å“ã€é™ç‰©æ‹æ‘„
- Domain: product (77 å…ƒç´ )
- ä¸“é•¿ï¼šPhase One ç›¸æœºã€å•†ä¸šå¸ƒå…‰ã€äº§å“æž„å›¾

**ðŸŽ¬ è§†é¢‘åœºæ™¯** â†’ `video-master`
- å…³é”®è¯ï¼šè§†é¢‘ã€é•œå¤´è¿åŠ¨ã€è¿é•œã€è½¬åœºã€åŠ¨æ€åœºæ™¯ã€å»¶æ—¶æ‘„å½±
- ç‰¹å¾ï¼šåŠ¨æ€ã€é•œå¤´è¯­è¨€ã€è§†é¢‘æ•ˆæžœ
- Domain: video (49 å…ƒç´ )
- ä¸“é•¿ï¼šæŽ¨æ‹‰æ‘‡ç§»ã€è½¬åœºã€ç‰¹æ•ˆã€é•œå¤´è¿åŠ¨

**ðŸ‘¤ äººåƒæ‘„å½±** â†’ `intelligent-prompt-generator`
- å…³é”®è¯ï¼šäººç‰©ã€è‚–åƒã€é¢éƒ¨ã€äº”å®˜ã€è¡¨æƒ…ã€å§¿åŠ¿ã€å¦†å®¹
- ç‰¹å¾ï¼šäººç‰©å±žæ€§ã€é¢éƒ¨ç‰¹å¾
- Domain: portrait (491 å…ƒç´ )
- ä¸“é•¿ï¼šäº”å®˜ã€å¦†å®¹ã€è¡¨æƒ…ã€äººç§æŽ¨ç†ã€ä¸€è‡´æ€§æ£€æŸ¥

#### ç¤ºä¾‹

| ç”¨æˆ·è¯·æ±‚ | ä¸»ä½“ç±»åž‹ | è·¯ç”±é€‰æ‹© |
|---------|---------|---------|
| "ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»å±±æ°´ï¼Œé£žç™½æŠ€æ³•" | è‰ºæœ¯ä½œå“ | art-master |
| "ç”Ÿæˆ Bento Grid å¸ƒå±€æµ·æŠ¥" | å¹³é¢è®¾è®¡ | design-master |
| "ç”Ÿæˆå¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±ï¼ŒæŸ”å…‰ç®±å¸ƒå…‰" | äº§å“æ‘„å½± | product-master |
| "ç”Ÿæˆæ­¦ä¾ åœºæ™¯æŽ¨é•œå¤´è¿åŠ¨" | è§†é¢‘åœºæ™¯ | video-master |

---

### STEP 3: å†²çªåœºæ™¯å¤„ç†

**åœºæ™¯**ï¼šè¯·æ±‚åŒæ—¶æ¶‰åŠ **äººç‰© + ç‰¹æ®Šé£Žæ ¼**

#### é»˜è®¤ç­–ç•¥ï¼ˆ80% æƒ…å†µï¼‰

**è§„åˆ™**ï¼šæœ‰äººç‰© â†’ ä¼˜å…ˆ `intelligent-prompt-generator`

**åŽŸå› **ï¼š
- äººåƒæ¡†æž¶èƒ½å¤„ç†äººç‰©å±žæ€§ï¼ˆäº”å®˜ã€è¡¨æƒ…ã€å¦†å®¹ï¼‰
- é£Žæ ¼é€šè¿‡ `art_style` å‚æ•°å®žçŽ°ï¼ˆå¦‚ art_style='watercolor'ï¼‰

#### ä¾‹å¤–æƒ…å†µï¼ˆ20% æƒ…å†µï¼‰

**è§„åˆ™**ï¼šç”¨æˆ·æ˜Žç¡®å¼ºè°ƒè‰ºæœ¯æŠ€æ³•ä¸“ä¸šæœ¯è¯­ â†’ ä½¿ç”¨ `art-master`

**è‰ºæœ¯æŠ€æ³•å…³é”®è¯**ï¼š
- ç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ï¼ˆæ°´å¢¨ç”»ï¼‰
- åŽšæ¶‚ã€è‚Œç†ã€ç¬”è§¦ï¼ˆæ²¹ç”»ï¼‰
- å¹²æ¹¿æµ“æ·¡ã€é£žç™½ï¼ˆå›½ç”»ï¼‰
- æ™•æŸ“ã€æ¸å˜ï¼ˆæ°´å½©ï¼‰

#### è¯¢é—®ç”¨æˆ·åœºæ™¯

**è§„åˆ™**ï¼šåŒæ—¶å¼ºè°ƒäººç‰©ç»†èŠ‚å’Œè‰ºæœ¯æŠ€æ³• â†’ è¯¢é—®ç”¨æˆ·åå¥½

#### ç¤ºä¾‹

| ç”¨æˆ·è¯·æ±‚ | åˆ†æž | è·¯ç”±é€‰æ‹© | ç†ç”± |
|---------|------|---------|------|
| "ç”Ÿæˆæ°´å¢¨ç”»é£Žæ ¼çš„å¥³æ€§" | äººç‰© + é£Žæ ¼ | intelligent-prompt-generator | é»˜è®¤ç­–ç•¥ï¼Œæ°´å¢¨ç”»ä½œä¸º art_style |
| "ç”Ÿæˆæ¢µé«˜é£Žæ ¼çš„å¥³æ€§è‚–åƒ" | äººç‰© + é£Žæ ¼ | intelligent-prompt-generator | é»˜è®¤ç­–ç•¥ï¼Œæ¢µé«˜é£Žæ ¼ä½œä¸º art_style |
| "ç”Ÿæˆå¥³æ€§è‚–åƒï¼Œè¦æ±‚æ°´å¢¨ç”»çš„ç¬”è§¦å’Œç•™ç™½æŠ€æ³•" | äººç‰© + è‰ºæœ¯æŠ€æ³•æœ¯è¯­ | è¯¢é—®ç”¨æˆ· | åŒæ—¶å¼ºè°ƒäººç‰©å’ŒæŠ€æ³• |
| "ç”Ÿæˆæ²¹ç”»æ•ˆæžœï¼Œè¦æ±‚åŽšæ¶‚å’Œè‚Œç†" | æ— äººç‰© + è‰ºæœ¯æŠ€æ³• | art-master | å¼ºè°ƒè‰ºæœ¯æŠ€æ³• |

---

### STEP 4: è°ƒç”¨å¯¹åº”çš„ Skill

æ ¹æ® STEP 1-3 çš„åˆ¤æ–­ç»“æžœï¼Œè°ƒç”¨ç›¸åº”çš„ Skillï¼š

```python
# è°ƒç”¨ç¤ºä¾‹
Skill(command="intelligent-prompt-generator")  # äººåƒ
Skill(command="art-master")                    # è‰ºæœ¯
Skill(command="design-master")                 # è®¾è®¡
Skill(command="product-master")                # äº§å“
Skill(command="video-master")                  # è§†é¢‘
```

---

## æ¯ä¸ª Skill çš„è¯¦ç»†ç¤ºä¾‹

### 1. intelligent-prompt-generatorï¼ˆäººåƒä¸“å®¶ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ‰€æœ‰åŒ…å«äººç‰©çš„è¯·æ±‚

#### ç¤ºä¾‹ 1: ç”µå½±çº§äºšæ´²å¥³æ€§

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆç”µå½±çº§çš„äºšæ´²å¥³æ€§ï¼Œå¼ è‰ºè°‹ç”µå½±é£Žæ ¼
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: åŒ…å« "äºšæ´²å¥³æ€§" â†’ æœ‰äººç‰© âœ…
2. **ç»“è®º**: intelligent-prompt-generator
3. **è°ƒç”¨**: `Skill(command="intelligent-prompt-generator")`

**Skill å·¥ä½œ**ï¼š
- è§£æž intent:
  ```json
  {
    "subject": {"gender": "female", "ethnicity": "East_Asian"},
    "lighting": "zhang_yimou",
    "visual_style": {"art_style": "cinematic"}
  }
  ```
- æŸ¥è¯¢ portrait domain (491 å…ƒç´ )
- åº”ç”¨äººåƒæ¡†æž¶ï¼ˆfacial, styling, expression ç­‰å­—æ®µï¼‰
- ç”ŸæˆåŒ…å«æˆå‰§æ€§å…‰å½±çš„å®Œæ•´äººåƒæç¤ºè¯

#### ç¤ºä¾‹ 2: æ°´å¢¨ç”»é£Žæ ¼çš„å¥³æ€§

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆæ°´å¢¨ç”»é£Žæ ¼çš„å¥³æ€§
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: åŒ…å« "å¥³æ€§" â†’ æœ‰äººç‰© âœ…
2. **STEP 3**: äººç‰© + é£Žæ ¼ï¼Œä½†æœªå¼ºè°ƒæŠ€æ³•æœ¯è¯­ â†’ é»˜è®¤ç­–ç•¥
3. **ç»“è®º**: intelligent-prompt-generator
4. **è°ƒç”¨**: `Skill(command="intelligent-prompt-generator")`

**Skill å·¥ä½œ**ï¼š
- è§£æž intent:
  ```json
  {
    "subject": {"gender": "female", "ethnicity": "East_Asian"},
    "visual_style": {"art_style": "watercolor"}
  }
  ```
- é€šè¿‡ art_style å‚æ•°å®žçŽ°æ°´å¢¨ç”»é£Žæ ¼
- äººåƒæ¡†æž¶å¤„ç†äº”å®˜ã€è¡¨æƒ…ã€å¦†å®¹

#### ç¤ºä¾‹ 3: å¤è£…å¥³å­

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆä»™å‰‘å¥‡ä¾ ä¼ çœŸäººç”µå½±é£Žæ ¼çš„å¹´è½»å¤è£…å¥³å­
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: åŒ…å« "å¤è£…å¥³å­" â†’ æœ‰äººç‰© âœ…
2. **ç»“è®º**: intelligent-prompt-generator
3. **è°ƒç”¨**: `Skill(command="intelligent-prompt-generator")`

**Skill å·¥ä½œ**ï¼š
- è§£æž intent:
  ```json
  {
    "subject": {"gender": "female", "age_range": "young_adult"},
    "styling": {
      "clothing": "traditional_chinese",
      "makeup": "traditional_chinese",
      "hairstyle": "ancient_chinese"
    },
    "lighting": {"lighting_type": "cinematic"},
    "scene": {"era": "ancient", "atmosphere": "fantasy"}
  }
  ```
- æ¡†æž¶è‡ªåŠ¨æŽ¨å¯¼ï¼šera=ancient â†’ makeup/clothing/hairstyle è‡ªåŠ¨åŒ¹é…

---

### 2. art-masterï¼ˆè‰ºæœ¯ä¸“å®¶ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ— äººç‰©çš„è‰ºæœ¯ä½œå“ï¼Œæˆ–å¼ºè°ƒè‰ºæœ¯æŠ€æ³•æœ¯è¯­

#### ç¤ºä¾‹ 1: ä¸­å›½æ°´å¢¨ç”»å±±æ°´

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»å±±æ°´
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: å±±æ°´ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯è‰ºæœ¯ä½œå“ï¼ˆæ°´å¢¨ç”»ï¼‰ â†’ art-master
3. **è°ƒç”¨**: `Skill(command="art-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ art domain (51 å…ƒç´ )
- é€‰æ‹©ä¸­å›½æ°´å¢¨ç”»ç›¸å…³å…ƒç´ ï¼š
  - è‰ºæœ¯é£Žæ ¼ï¼šTraditional Chinese ink painting
  - æŠ€æ³•ï¼šflowing brush strokes, varying ink density
  - æž„å›¾ï¼šminimalist composition, negative space
  - ç‰¹å¾ï¼šmonochromatic, grey washes, calligraphic elements
- ç”ŸæˆåŒ…å«ä¸“ä¸šè‰ºæœ¯æœ¯è¯­çš„æç¤ºè¯

#### ç¤ºä¾‹ 2: æ²¹ç”»æŠ€æ³•çš„åŽšæ¶‚æ•ˆæžœ

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆæ²¹ç”»æ•ˆæžœï¼Œå¼ºè°ƒåŽšæ¶‚å’Œç¬”è§¦è‚Œç†
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æ— äººç‰©æ˜Žç¡®æåŠ â†’ æ— äººç‰© âŒ
2. **STEP 2**: å¼ºè°ƒè‰ºæœ¯æŠ€æ³•ï¼ˆåŽšæ¶‚ã€è‚Œç†ï¼‰ â†’ art-master
3. **è°ƒç”¨**: `Skill(command="art-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ art domain
- é€‰æ‹©æ²¹ç”»æŠ€æ³•å…ƒç´ ï¼š
  - æŠ€æ³•ï¼šimpasto technique, thick paint application
  - ç¬”è§¦ï¼švisible brush strokes, textured surface
  - æ•ˆæžœï¼špalette knife marks, layered paint
- ç”Ÿæˆå¼ºè°ƒæŠ€æ³•çš„è‰ºæœ¯æç¤ºè¯

#### ç¤ºä¾‹ 3: è¶…çŽ°å®žä¸»ä¹‰é£Žæ ¼

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆè¶…çŽ°å®žä¸»ä¹‰è‰ºæœ¯ä½œå“ï¼Œæ¢¦å¢ƒæ°›å›´
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯è‰ºæœ¯ä½œå“ï¼ˆè¶…çŽ°å®žä¸»ä¹‰ï¼‰ â†’ art-master
3. **è°ƒç”¨**: `Skill(command="art-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ art domain
- é€‰æ‹©è¶…çŽ°å®žä¸»ä¹‰å…ƒç´ ï¼š
  - è‰ºæœ¯é£Žæ ¼ï¼šsurrealism, dreamlike atmosphere
  - ç‰¹å¾ï¼šimpossible scenarios, symbolic imagery
  - æ•ˆæžœï¼šethereal, mysterious, subconscious themes
- ç”Ÿæˆè¶…çŽ°å®žä¸»ä¹‰é£Žæ ¼æç¤ºè¯

---

### 3. design-masterï¼ˆè®¾è®¡ä¸“å®¶ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ— äººç‰©çš„å¹³é¢è®¾è®¡ã€UIã€æµ·æŠ¥ã€å¸ƒå±€

#### ç¤ºä¾‹ 1: Bento Grid æµ·æŠ¥

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆ Bento Grid å¸ƒå±€æµ·æŠ¥
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æµ·æŠ¥ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯å¹³é¢è®¾è®¡ï¼ˆBento Gridï¼‰ â†’ design-master
3. **è°ƒç”¨**: `Skill(command="design-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ design domain (59 å…ƒç´ )
- é€‰æ‹© Bento Grid ç›¸å…³å…ƒç´ ï¼š
  - å¸ƒå±€ç³»ç»Ÿï¼šBento grid layout, 8 asymmetric modular cards
  - è§†è§‰æ•ˆæžœï¼šmodern minimalist aesthetics
  - æŠ€æœ¯å‚æ•°ï¼š4K resolution, clean typography
- ç”ŸæˆåŒ…å«ä¸“ä¸šè®¾è®¡æœ¯è¯­çš„æç¤ºè¯

#### ç¤ºä¾‹ 2: çŽ»ç’ƒæ€ UI è®¾è®¡

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”ŸæˆçŽ»ç’ƒæ€ UI è®¾è®¡ï¼ŒçŽ°ä»£æžç®€é£Žæ ¼
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: UI â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯å¹³é¢è®¾è®¡ï¼ˆçŽ»ç’ƒæ€ï¼‰ â†’ design-master
3. **è°ƒç”¨**: `Skill(command="design-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ design domain
- é€‰æ‹©çŽ»ç’ƒæ€å…ƒç´ ï¼š
  - è§†è§‰æ•ˆæžœï¼šGlassmorphism, frosted glass effect
  - æŠ€æœ¯ï¼š80% translucency, backdrop blur filter
  - é£Žæ ¼ï¼šminimalist, modern aesthetics
  - è‰²å½©ï¼š90% neutral colors with 10% vibrant accents
- ç”ŸæˆçŽ°ä»£è®¾è®¡ç³»ç»Ÿæç¤ºè¯

#### ç¤ºä¾‹ 3: åŒ…å«äººç‰©å¤´åƒçš„æµ·æŠ¥

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆ Bento Grid æµ·æŠ¥ï¼ŒåŒ…å«äººç‰©å¤´åƒ
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: è™½ç„¶æåˆ°"äººç‰©å¤´åƒ"ï¼Œä½†ä¸»ä½“æ˜¯"æµ·æŠ¥" â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯å¹³é¢è®¾è®¡ â†’ design-master
3. **è°ƒç”¨**: `Skill(command="design-master")`

**è§£é‡Š**ï¼šäººç‰©å¤´åƒåªæ˜¯æµ·æŠ¥çš„ä¸€ä¸ªå…ƒç´ ï¼Œä¸æ˜¯ä¸»ä½“

---

### 4. product-masterï¼ˆäº§å“ä¸“å®¶ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ— äººç‰©çš„äº§å“æ‘„å½±ã€å•†å“å±•ç¤º

#### ç¤ºä¾‹ 1: å¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆå¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æ‰‹è¡¨ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯äº§å“ â†’ product-master
3. **è°ƒç”¨**: `Skill(command="product-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ product domain (77 å…ƒç´ )
- é€‰æ‹©å¥¢åŽäº§å“æ‘„å½±å…ƒç´ ï¼š
  - ç›¸æœºï¼šPhase One camera, macro lens
  - ç¯å…‰ï¼šsoftbox lighting, rim light
  - æž„å›¾ï¼šluxury product composition
  - èƒŒæ™¯ï¼špremium backdrop
- ç”Ÿæˆå•†ä¸šæ‘„å½±çº§æç¤ºè¯

#### ç¤ºä¾‹ 2: é¦™æ°´ç“¶æŸ”å…‰å¸ƒå…‰

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆé¦™æ°´ç“¶äº§å“æ‘„å½±ï¼ŒæŸ”å…‰ç®±å¸ƒå…‰
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: é¦™æ°´ç“¶ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯äº§å“ â†’ product-master
3. **è°ƒç”¨**: `Skill(command="product-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ product domain
- é€‰æ‹©æŸ”å…‰å¸ƒå…‰å…ƒç´ ï¼š
  - ç¯å…‰ï¼šsoftbox lighting, diffused light
  - ç›¸æœºï¼šDSLR, shallow depth of field
  - æ•ˆæžœï¼šelegant, premium, glass reflections
- ç”ŸæˆåŒ…å«ä¸“ä¸šæ‘„å½±æœ¯è¯­çš„æç¤ºè¯

#### ç¤ºä¾‹ 3: å¥³æ¨¡ç‰¹å±•ç¤ºé¦™æ°´ï¼ˆè¾¹ç•Œæ¡ˆä¾‹ï¼‰

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
å¥³æ¨¡ç‰¹å±•ç¤ºé¦™æ°´ç“¶
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æœ‰ "å¥³æ¨¡ç‰¹" â†’ æœ‰äººç‰© âœ…
2. **STEP 3**: ç„¦ç‚¹ä¸æ˜Žç¡®ï¼ˆäººç‰© vs äº§å“ï¼‰
3. **è¯¢é—®ç”¨æˆ·**:
   ```
   æˆ‘æ³¨æ„åˆ°ä½ çš„è¯·æ±‚æ¶‰åŠï¼š
   - å¥³æ¨¡ç‰¹ï¼ˆintelligent-prompt-generatorï¼‰
   - é¦™æ°´ç“¶äº§å“ï¼ˆproduct-masterï¼‰

   ä½ çš„ç„¦ç‚¹æ˜¯ï¼š
   A. å¥³æ¨¡ç‰¹ï¼ˆäººç‰©ä¸ºä¸»ï¼Œé¦™æ°´ä¸ºé“å…·ï¼‰
   B. é¦™æ°´ç“¶ï¼ˆäº§å“ä¸ºä¸»ï¼Œæ¨¡ç‰¹ä¸ºé™ªè¡¬ï¼‰

   è¯·é€‰æ‹©ï¼Ÿ
   ```

#### ç¤ºä¾‹ 4: 9å®«æ ¼äº§å“æ‘„å½±ï¼ˆGrid Collage æ¨¡å¼ï¼‰

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆ9å®«æ ¼å¥¢åŽæ‰‹è¡¨äº§å“æ‘„å½±ï¼Œä¸­é—´3Dçªå‡º
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: æ‰‹è¡¨ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯äº§å“ â†’ product-master
3. **è°ƒç”¨**: `Skill(command="product-master")`

**Skill å·¥ä½œ**ï¼š
- è¯†åˆ«å…³é”®è¯ï¼š"9å®«æ ¼" â†’ è‡ªåŠ¨åˆ‡æ¢åˆ° **Grid Collage æ¨¡å¼**
- åŠ è½½ä¸“ä¸šæ¨¡æ¿ï¼š`modules/layouts/grid_collage.md`
- æŸ¥è¯¢ product domain (77 å…ƒç´ )
- ç”ŸæˆåŒ…å«ä»¥ä¸‹ç‰¹æ€§çš„ä¸“ä¸šæç¤ºè¯ï¼š
  - **3Ã—3ä¸¥æ ¼ç­‰åˆ†ç½‘æ ¼** + THICK WHITE LINES åˆ†éš”
  - **8ä¸ªä¸åŒè§’åº¦äº§å“æ‘„å½±**ï¼ˆèƒŒæ™¯å±‚ï¼Œå…¨éƒ¨æ¸…æ™°ï¼‰
    - [1,1] è¡¨ç›˜ä¿¯è§†
    - [1,2] è¡¨å† ä¾§é¢
    - [1,3] è¡¨æ‰£ç»†èŠ‚
    - [2,1] ç»å…¸45åº¦è§’
    - [2,3] åº•ç›–æœºèŠ¯
    - [3,1] ä¸Šæ‰‹æ•ˆæžœ
    - [3,2] è¡¨å¸¦é“¾èŠ‚
    - [3,3] åŒ…è£…ç›’
  - **1ä¸ªè¶…å¤§3Dæ¸²æŸ“æ‰‹è¡¨**ï¼ˆå‰æ™¯å±‚ï¼‰
    - è¡¨å† è§¦é¡¶è¾¹ï¼Œè¡¨å¸¦è§¦åº•è¾¹
    - å æ®æœ€å¤§åž‚ç›´ç©ºé—´
    - å®Œå…¨é®æŒ¡ä¸­é—´æ ¼å­[2,2]
    - éƒ¨åˆ†é®æŒ¡å‘¨å›´4æ ¼ï¼ˆ10-20%ï¼‰
  - **æ·±æ™¯æ·±f/16** - æ‰€æœ‰æ ¼å­éƒ½æ¸…æ™°
  - **ä¸“ä¸šæ·±åº¦æ•ˆæžœ**ï¼š
    - Drop shadow (12px blur)
    - Contact shadow (8px blur)
    - å‰æ™¯+10%äº®åº¦ï¼Œ+20%é¥±å’Œåº¦
  - **å®Œæ•´è´¨é‡æ£€æŸ¥æ¸…å•**
  - **ä¸€è‡´æ€§è§„åˆ™**ï¼ˆ9ä¸ªä½ç½®åŒä¸€äº§å“ï¼‰

**è¾“å‡ºæ•ˆæžœ**ï¼š
- è¶…çŽ°å®žæ‹¼è´´è‰ºæœ¯é£Žæ ¼
- é€‚åˆç”µå•†è¯¦æƒ…é¡µã€ç¤¾äº¤åª’ä½“ã€äº§å“å®£ä¼ æµ·æŠ¥
- åŒæ—¶å±•ç¤ºå¤šä¸ªè§’åº¦ + 3Dç«‹ä½“çªå‡º

**è§¦å‘å…³é”®è¯**ï¼š
- "9å®«æ ¼"ã€"3Ã—3å¸ƒå±€"ã€"grid"
- "å¤šè§’åº¦å±•ç¤º"ã€"å¤šè§†è§’"
- "ä¸­é—´3Dçªå‡º"ã€"3D pop-out"

---

### 5. video-masterï¼ˆè§†é¢‘ä¸“å®¶ï¼‰

**é€‚ç”¨åœºæ™¯**ï¼šæ— äººç‰©çš„è§†é¢‘åœºæ™¯ã€é•œå¤´è¿åŠ¨ã€åŠ¨æ€æ•ˆæžœ

#### ç¤ºä¾‹ 1: æ­¦ä¾ åœºæ™¯è¿é•œ

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆæ­¦ä¾ åœºæ™¯æŽ¨é•œå¤´è¿åŠ¨
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: åœºæ™¯ + æŽ¨é•œå¤´ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯è§†é¢‘ï¼ˆé•œå¤´è¿åŠ¨ï¼‰ â†’ video-master
3. **è°ƒç”¨**: `Skill(command="video-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ video domain (49 å…ƒç´ )
- é€‰æ‹©é•œå¤´è¿åŠ¨å…ƒç´ ï¼š
  - è¿é•œï¼šdolly in (æŽ¨é•œå¤´), slow camera movement
  - åœºæ™¯ï¼šwuxia atmosphere, ancient Chinese architecture
  - æ•ˆæžœï¼šcinematic movement, dramatic reveal
- ç”ŸæˆåŒ…å«é•œå¤´è¯­è¨€çš„æç¤ºè¯

#### ç¤ºä¾‹ 2: é£Žæ™¯å»¶æ—¶æ‘„å½±

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
ç”Ÿæˆé£Žæ™¯å»¶æ—¶æ‘„å½±ï¼Œäº‘é›¾æµåŠ¨æ•ˆæžœ
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: é£Žæ™¯ â†’ æ— äººç‰© âŒ
2. **STEP 2**: ä¸»ä½“æ˜¯è§†é¢‘ï¼ˆå»¶æ—¶æ‘„å½±ï¼‰ â†’ video-master
3. **è°ƒç”¨**: `Skill(command="video-master")`

**Skill å·¥ä½œ**ï¼š
- æŸ¥è¯¢ video domain
- é€‰æ‹©å»¶æ—¶æ‘„å½±å…ƒç´ ï¼š
  - æŠ€æœ¯ï¼štime-lapse photography
  - æ•ˆæžœï¼šflowing clouds, dynamic motion
  - è¿é•œï¼šstatic camera, long exposure effect
- ç”Ÿæˆå»¶æ—¶æ‘„å½±æç¤ºè¯

#### ç¤ºä¾‹ 3: æ­¦ä¾ äººç‰©é£žèº«è·ƒèµ·ï¼ˆè¾¹ç•Œæ¡ˆä¾‹ï¼‰

**ç”¨æˆ·è¯·æ±‚**ï¼š
```
æ­¦ä¾ äººç‰©é£žèº«è·ƒèµ·çš„åŠ¨æ€é•œå¤´
```

**è·¯ç”±æµç¨‹**ï¼š
1. **STEP 1**: åŒ…å« "æ­¦ä¾ äººç‰©" â†’ æœ‰äººç‰© âœ…
2. **åˆ†æž**: ä¸»ä½“æ˜¯äººç‰©åŠ¨ä½œ vs é•œå¤´è¿åŠ¨ï¼Ÿ
3. **é»˜è®¤ç­–ç•¥**: ä¸»ä½“æ˜¯äººç‰© â†’ intelligent-prompt-generator
4. **è°ƒç”¨**: `Skill(command="intelligent-prompt-generator")`

**è§£é‡Š**ï¼š
- äººç‰©åŠ¨ä½œé€šè¿‡ `expression.pose` å­—æ®µå¤„ç†ï¼ˆäººåƒæ¡†æž¶æ”¯æŒï¼‰
- å¦‚æžœç”¨æˆ·æ˜Žç¡®å¼ºè°ƒé•œå¤´è¿åŠ¨ï¼ˆ"è·Ÿéšé•œå¤´"ã€"è¿é•œ"ï¼‰ï¼Œåˆ™è¯¢é—®ç”¨æˆ·

---

## å¸¸è§é—®é¢˜å¤„ç†

### Q1: å¦‚ä½•åˆ¤æ–­æ˜¯ "äººç‰©è‚–åƒ" è¿˜æ˜¯ "äººç‰©åœ¨åœºæ™¯ä¸­"ï¼Ÿ

**ç­”æ¡ˆ**ï¼šçœ‹ä¸»ä½“æ˜¯ä»€ä¹ˆ

| æè¿° | ä¸»ä½“ | è·¯ç”± |
|------|------|------|
| "å¥³æ€§è‚–åƒ" | äººç‰© | intelligent-prompt-generator |
| "å¥³æ€§åœ¨èŠ±å›­é‡Œ" | äººç‰© | intelligent-prompt-generator |
| "èŠ±å›­åœºæ™¯ï¼Œè¿œå¤„æœ‰äºº" | åœºæ™¯ | æ ¹æ®åœºæ™¯ç±»åž‹è·¯ç”± |
| "Bento Grid æµ·æŠ¥ï¼ŒåŒ…å«äººç‰©å¤´åƒ" | æµ·æŠ¥ | design-master |

### Q2: ç”¨æˆ·è¯´ "æ°´å¢¨ç”»é£Žæ ¼çš„äººç‰©"ï¼Œä¸ºä»€ä¹ˆä¸ç”¨ art-masterï¼Ÿ

**ç­”æ¡ˆ**ï¼šé»˜è®¤ç­–ç•¥

- ä¸»ä½“æ˜¯ "äººç‰©" â†’ éœ€è¦äººåƒæ¡†æž¶ï¼ˆfacial, styling, expressionï¼‰
- "æ°´å¢¨ç”»é£Žæ ¼" ä½œä¸º `art_style` å‚æ•°å®žçŽ°
- art-master ä¸“æ³¨äºŽè‰ºæœ¯æŠ€æ³•æœ¯è¯­ï¼ˆç¬”è§¦ã€ç•™ç™½ã€æ³¼å¢¨ï¼‰
- é™¤éžç”¨æˆ·æ˜Žç¡®è¯´ "æ°´å¢¨ç”»çš„ç¬”è§¦å’Œç•™ç™½æŠ€æ³•"

### Q3: ä»€ä¹ˆæ—¶å€™éœ€è¦è¯¢é—®ç”¨æˆ·ï¼Ÿ

**ç­”æ¡ˆ**ï¼šä¸¤ç§æƒ…å†µ

1. **ç„¦ç‚¹ä¸æ˜Žç¡®**ï¼š
   - "å¥³æ¨¡ç‰¹å±•ç¤ºé¦™æ°´ç“¶" â†’ äººç‰© vs äº§å“ï¼Ÿ
   - "äº§å“æµ·æŠ¥è®¾è®¡" â†’ äº§å“ vs è®¾è®¡ï¼Ÿ

2. **åŒæ—¶å¼ºè°ƒäººç‰©å’ŒæŠ€æ³•**ï¼š
   - "å¥³æ€§è‚–åƒï¼Œè¦æ±‚æ°´å¢¨ç”»çš„ç¬”è§¦ç•™ç™½æŠ€æ³•" â†’ äººç‰©ç»†èŠ‚ vs è‰ºæœ¯æŠ€æ³•ï¼Ÿ

### Q4: å¦‚æžœç”¨æˆ·è¯·æ±‚ä¸å±žäºŽä»»ä½• domain æ€Žä¹ˆåŠžï¼Ÿ

**ç­”æ¡ˆ**ï¼šè¯¢é—®ç”¨æˆ·æˆ–ç›´æŽ¥å¤„ç†

ç¤ºä¾‹ï¼š
```
ç”¨æˆ·ï¼š"å¸®æˆ‘ä¼˜åŒ–è¿™æ®µä»£ç "
â†’ ä¸æ¶‰åŠæç¤ºè¯ç”Ÿæˆ
â†’ ç›´æŽ¥åœ¨ conversation å¤„ç†ï¼Œä¸è°ƒç”¨ skill
```

### Q5: å¤šä¸ª domain çš„ç»„åˆè¯·æ±‚æ€Žä¹ˆå¤„ç†ï¼Ÿ

**ç­”æ¡ˆ**ï¼šç¡®å®šä¸» domain

| è¯·æ±‚ | ä¸» domain | è·¯ç”± |
|------|----------|------|
| "äº§å“æµ·æŠ¥è®¾è®¡" | è®¾è®¡ï¼ˆæµ·æŠ¥ï¼‰ | design-master |
| "äº§å“æ‘„å½±å¸ƒå…‰" | äº§å“ï¼ˆæ‘„å½±ï¼‰ | product-master |
| "äººç‰©äº§å“å¹¿å‘Š" | è¯¢é—®ç„¦ç‚¹ | è¯¢é—®ç”¨æˆ· |

---

## æ€»ç»“

### è·¯ç”±å†³ç­–æ ‘ï¼ˆå®Œæ•´ç‰ˆï¼‰

```
ç”¨æˆ·è¯·æ±‚
    â†“
ã€STEP 1: æœ‰äººç‰©å—ï¼Ÿã€‘
    â†“
  YES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â†“
    â”‚    ã€STEP 3: æœ‰è‰ºæœ¯æŠ€æ³•æœ¯è¯­å—ï¼Ÿã€‘
    â”‚         â†“
    â”‚       NO â”€â”€â†’ intelligent-prompt-generator (é»˜è®¤)
    â”‚         â†“
    â”‚      YES â”€â”€â†’ è¯¢é—®ç”¨æˆ·åå¥½
    â”‚
  NO
    â†“
ã€STEP 2: ä¸»ä½“æ˜¯ä»€ä¹ˆï¼Ÿã€‘
    â†“
    â”œâ”€ è‰ºæœ¯ä½œå“ â†’ art-master
    â”œâ”€ å¹³é¢è®¾è®¡ â†’ design-master
    â”œâ”€ äº§å“ â†’ product-master
    â”œâ”€ è§†é¢‘ â†’ video-master
    â””â”€ äººç‰© â†’ intelligent-prompt-generator
```

### æ ¸å¿ƒåŽŸåˆ™

1. **äººç‰©ä¼˜å…ˆ**ï¼šæœ‰äººç‰© â†’ ä¼˜å…ˆ intelligent-prompt-generator
2. **æŠ€æ³•ä¾‹å¤–**ï¼šæ˜Žç¡®è‰ºæœ¯æŠ€æ³•æœ¯è¯­ â†’ art-master
3. **ä¸»ä½“åˆ¤æ–­**ï¼šæ— äººç‰© â†’ æ ¹æ®ä¸»ä½“ç±»åž‹è·¯ç”±
4. **ç„¦ç‚¹è¯¢é—®**ï¼šç„¦ç‚¹ä¸æ˜Žç¡® â†’ è¯¢é—®ç”¨æˆ·

---

**æœ€åŽæ›´æ–°**: 2026-01-04
**ç‰ˆæœ¬**: 1.0



================================================
FILE: .claude/skills/learner.md
================================================
# Learner Skill - è‡ªå­¦ä¹ æŠ€èƒ½

**åŠŸèƒ½**: è‡ªåŠ¨å­¦ä¹ æ–°Promptä¸­çš„æœªå®šä¹‰ç‰¹å¾ï¼Œæ‰©å±•ç‰¹å¾åº“
**ç±»åž‹**: ç‹¬ç«‹Skill
**å®žçŽ°**: æ··åˆå­¦ä¹ ç³»ç»Ÿï¼ˆè§„åˆ™+AI+äººå·¥å®¡æ ¸ï¼‰

---

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

æœ¬Skillæä¾›ä»¥ä¸‹èƒ½åŠ›ï¼š

1. **æ‰«æå•ä¸ªPrompt** - åˆ†æžæ–°Promptï¼Œè¯†åˆ«æœªå®šä¹‰çš„ç‰¹å¾
2. **æ‰¹é‡æ‰«æ** - æ‰«ææ‰€æœ‰18ä¸ªPromptsï¼Œå‘çŽ°ç¼ºå¤±ç»´åº¦
3. **ç”Ÿæˆå®¡æ ¸æŠ¥å‘Š** - è‡ªåŠ¨ç”Ÿæˆå¾…å®¡æ ¸çš„æ–°ç‰¹å¾åˆ—è¡¨
4. **è‡ªåŠ¨æ›´æ–°åº“** - å®¡æ ¸é€šè¿‡åŽè‡ªåŠ¨æ›´æ–° facial_features_library.json

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1: è‡ªç„¶è¯­è¨€è°ƒç”¨ï¼ˆæŽ¨èï¼‰

ç›´æŽ¥æè¿°ä½ çš„éœ€æ±‚ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç†è§£ï¼š

```
ç¤ºä¾‹1: "å­¦ä¹ è¿™ä¸ªPromptçš„æ–°ç‰¹å¾: A woman with long flowing red hair, fair skin..."
ç¤ºä¾‹2: "æ‰«ææ‰€æœ‰Promptsï¼Œå‘çŽ°ç¼ºå¤±çš„ç‰¹å¾ç»´åº¦"
ç¤ºä¾‹3: "åˆ†æžè¿™ä¸ªPromptæœ‰ä»€ä¹ˆæ–°çš„å‘åž‹æˆ–è‚¤è‰²"
```

### æ–¹å¼2: ç›´æŽ¥è°ƒç”¨CLI

å¦‚æžœéœ€è¦ç²¾ç¡®æŽ§åˆ¶ï¼Œå¯ç›´æŽ¥ä½¿ç”¨å‘½ä»¤è¡Œï¼š

```bash
# æ‰«æå•ä¸ªPrompt
python3 learner.py scan "A woman with long red hair, fair skin, wearing qipao"

# æ‰¹é‡æ‰«ææ‰€æœ‰Prompts
python3 learner.py batch
```

---

## ðŸ”§ å·¥ä½œåŽŸç†

### æ··åˆå­¦ä¹ æµç¨‹

```
æ–°Promptè¾“å…¥
    â†“
è§„åˆ™æå–ï¼ˆRule-Basedï¼‰
  - ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å¸¸è§æ¨¡å¼
  - å¿«é€Ÿè¯†åˆ«ï¼šå‘åž‹ã€å‘è‰²ã€è‚¤è‰²ã€æœè£…ã€é…é¥°ç­‰
    â†“
AIå¢žå¼ºï¼ˆAI-Assistedï¼‰
  - è°ƒç”¨LLMéªŒè¯è§„åˆ™æå–çš„å‡†ç¡®æ€§
  - å‘çŽ°è§„åˆ™æœªè¦†ç›–çš„æ–°ç»´åº¦
    â†“
ç‰¹å¾åˆå¹¶ä¸ŽåŽ»é‡
  - åˆå¹¶ä¸¤ç§æ–¹æ³•çš„ç»“æžœ
  - è®¡ç®—ç½®ä¿¡åº¦
    â†“
åŒ¹é…çŽ°æœ‰åº“
  - æ£€æŸ¥æ˜¯å¦å·²åœ¨ facial_features_library.json ä¸­
  - è®¡ç®—å…³é”®è¯é‡å åº¦ï¼ˆ>70%è§†ä¸ºå·²å­˜åœ¨ï¼‰
    â†“
ç”Ÿæˆå®¡æ ¸æŠ¥å‘Š
  - åˆ—å‡ºæ‰€æœ‰æ–°å‘çŽ°çš„ç‰¹å¾
  - æä¾›å»ºè®®åˆ†ç±»ç 
  - è¯„ä¼°å¤ç”¨æ€§
    â†“
äººå·¥å®¡æ ¸
  - ç”¨æˆ·å†³å®šï¼šæ‰¹å‡†/ä¿®æ”¹/æ‹’ç»
    â†“
è‡ªåŠ¨æ›´æ–°åº“
  - æ‰¹å‡†åŽè‡ªåŠ¨æ·»åŠ åˆ° facial_features_library.json
  - æ›´æ–°ç‰ˆæœ¬å·
  - ç”Ÿæˆchangelog
```

---

## ðŸŽ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å‘çŽ°æ–°Promptçš„ç‰¹æ®Šç‰¹å¾

**ç”¨æˆ·è¯·æ±‚**:
```
"è¿™ä¸ªPromptæœ‰ä»€ä¹ˆæ–°ç‰¹å¾ï¼Ÿ
'A woman with long flowing red hair, fair porcelain skin, wearing elegant red silk qipao dress, delicate silver earrings'"
```

**ç³»ç»Ÿæ‰§è¡Œ**:
1. è°ƒç”¨ `python3 learner.py scan "<prompt>"`
2. è§„åˆ™æå–è¯†åˆ«åˆ°ï¼š
   - hair_style: "long flowing" (é•¿å‘é£˜é€¸)
   - hair_color: "red" (çº¢è‰²)
   - skin_tone: "fair porcelain" (ç™½çš™ç“·è‚Œ)
   - clothing: "elegant red silk qipao dress" (ä¼˜é›…çº¢è‰²ä¸ç»¸æ——è¢)
   - accessories: "delicate silver earrings" (ç²¾è‡´é“¶è‰²è€³çŽ¯)
3. åŒ¹é…çŽ°æœ‰åº“ï¼šå‘çŽ° hair_style, hair_color, clothing, accessories éƒ½æ˜¯æ–°ç±»åˆ«
4. ç”Ÿæˆå®¡æ ¸æŠ¥å‘Š

**è¾“å‡º**:
```
ðŸ” æ‰«æPromptä¸­...
   æ–‡æœ¬é•¿åº¦: 150 å­—ç¬¦

âœ… æ‰«æå®Œæˆï¼
   å‘çŽ°ç‰¹å¾: 5 ä¸ª
   æ–°ç‰¹å¾: 5 ä¸ª
   å·²å­˜åœ¨: 0 ä¸ª

ðŸ“‹ æ–°å‘çŽ°çš„ç‰¹å¾ç±»åˆ«:
   - hair_style: 1 ä¸ª
   - hair_color: 1 ä¸ª
   - skin_tone: 1 ä¸ª
   - clothing: 1 ä¸ª
   - accessories: 1 ä¸ª

ðŸ“„ å®¡æ ¸æŠ¥å‘Šå·²ç”Ÿæˆ: extracted_results/new_features_review_20260101_120000.md
```

---

### åœºæ™¯2: æ‰¹é‡æ‰«ææ‰€æœ‰Prompts

**ç”¨æˆ·è¯·æ±‚**:
```
"æ‰«ææ‰€æœ‰18ä¸ªPromptsï¼Œå‘çŽ°ç¼ºå¤±çš„ç‰¹å¾ç»´åº¦"
```

**ç³»ç»Ÿæ‰§è¡Œ**:
1. è°ƒç”¨ `python3 learner.py batch`
2. é€ä¸ªæ‰«æ extracted_modules.json ä¸­çš„æ‰€æœ‰Prompts
3. ç»Ÿè®¡æ‰€æœ‰æ–°ç‰¹å¾
4. ç”Ÿæˆæ±‡æ€»æŠ¥å‘Š

**è¾“å‡º**:
```
ðŸ“š æ‰¹é‡æ‰«ææ¨¡å¼
   è¯»å–æ–‡ä»¶: extracted_results/extracted_modules.json
   å…± 18 ä¸ªPrompts

[1/18] æ‰«æ Prompt #1...
[2/18] æ‰«æ Prompt #2...
...
[18/18] æ‰«æ Prompt #18...

============================================================
ðŸ“Š æ‰¹é‡æ‰«æå®Œæˆï¼
============================================================

å‘çŽ°æ–°ç±»åˆ«:

hair_style: 8 ä¸ªæ–°åˆ†ç±»
   - long straight black (Prompt #5)
   - twin tails blue (Prompt #18)
   - short spiky (Prompt #17)
   ... è¿˜æœ‰ 5 ä¸ª

hair_color: 6 ä¸ªæ–°åˆ†ç±»
   - natural black (Prompt #5, #18)
   - vibrant blue (Prompt #18)
   - purple pink gradient (Prompt #17)
   ... è¿˜æœ‰ 3 ä¸ª

skin_tone: 3 ä¸ªæ–°åˆ†ç±»
   - fair pale (Prompt #5, #18)
   - porcelain (Prompt #10)
   - medium tan (Prompt #8)

clothing: 5 ä¸ªæ–°åˆ†ç±»
   - traditional chinese qipao (Prompt #18)
   - punk street style (Prompt #17)
   ... è¿˜æœ‰ 3 ä¸ª

ðŸ“„ æ±‡æ€»æŠ¥å‘Š: extracted_results/batch_scan_summary_20260101_120000.md
```

---

### åœºæ™¯3: å®¡æ ¸æ–°ç‰¹å¾

ç”Ÿæˆçš„å®¡æ ¸æŠ¥å‘Šç¤ºä¾‹ï¼š

```markdown
# æ–°ç‰¹å¾å‘çŽ°æŠ¥å‘Š

**æ‰«ææ—¶é—´**: 2026-01-01 12:00:00
**æ‰«ææ¥æº**: ç”¨æˆ·è¾“å…¥

## æºPrompt
A woman with long flowing red hair, fair porcelain skin, wearing elegant red silk qipao dress

## æ–°å‘çŽ°çš„ç‰¹å¾ (4ä¸ª)

### 1. hair_style - NEW_CATEGORY
**å…³é”®è¯**: "long flowing red hair"
**ç½®ä¿¡åº¦**: 80%
**æå–æ–¹æ³•**: rule-based
**å»ºè®®åˆ†ç±»ç **: `long_flowing_red_hair`
**å¤ç”¨æ€§è¯„ä¼°**: é«˜ï¼ˆè¿™æ˜¯äººåƒçš„é‡è¦åŸºç¡€å…ƒç´ ï¼‰

**å®¡æ ¸é€‰é¡¹**:
- [ ] æ‰¹å‡†æ·»åŠ 
- [ ] éœ€è¦ä¿®æ”¹ï¼ˆè¯·è¯´æ˜Žï¼‰
- [ ] æ‹’ç»ï¼ˆè¯´æ˜ŽåŽŸå› ï¼‰

### 2. hair_color - NEW_CATEGORY
**å…³é”®è¯**: "red hair"
**ç½®ä¿¡åº¦**: 80%
**æå–æ–¹æ³•**: rule-based
**å»ºè®®åˆ†ç±»ç **: `red_hair`
**å¤ç”¨æ€§è¯„ä¼°**: é«˜ï¼ˆè¿™æ˜¯äººåƒçš„é‡è¦åŸºç¡€å…ƒç´ ï¼‰

**å®¡æ ¸é€‰é¡¹**:
- [ ] æ‰¹å‡†æ·»åŠ 
- [ ] éœ€è¦ä¿®æ”¹ï¼ˆè¯·è¯´æ˜Žï¼‰
- [ ] æ‹’ç»ï¼ˆè¯´æ˜ŽåŽŸå› ï¼‰

...
```

---

## ðŸ“Š å¯æ£€æµ‹çš„ç‰¹å¾ç»´åº¦

### é«˜ä¼˜å…ˆçº§ï¼ˆå·²å®žçŽ°ï¼‰

| ç»´åº¦ | ç¤ºä¾‹ | æ­£åˆ™è¡¨è¾¾å¼ |
|------|------|-----------|
| **hair_style** | long flowing, short curly, twin tails | `(long\|short)?\s*(straight\|curly)?\s*hair` |
| **hair_color** | black, blonde, red, blue | `(black\|blonde\|red)?\s+hair` |
| **skin_tone** | fair, tan, olive, dark | `(fair\|tan\|olive)\s+skin` |
| **body_type** | slim, athletic, curvy | `(slim\|athletic)\s+body` |
| **clothing** | qipao dress, punk outfit | `wearing\s+(elegant)?\s*(qipao\|dress)` |
| **accessories** | silver earrings, necklace | `(silver\|gold)\s+(earrings\|necklace)` |
| **pose** | confident pose, standing | `(confident)?\s+pose` |

### ä¸­ä¼˜å…ˆçº§ï¼ˆå¾…æ‰©å±•ï¼‰

- **makeup**: å¦†å®¹é£Žæ ¼ï¼ˆè‡ªç„¶ã€æµ“å¦†ã€å“¥ç‰¹ï¼‰
- **facial_hair**: èƒ¡é¡»ï¼ˆå¯¹ç”·æ€§äººåƒï¼‰
- **tattoos**: çº¹èº«
- **background**: èƒŒæ™¯çŽ¯å¢ƒ

### ä½Žä¼˜å…ˆçº§ï¼ˆæœªæ¥è€ƒè™‘ï¼‰

- **lighting_mood**: å…‰ç…§æƒ…ç»ª
- **color_palette**: è‰²å½©åŸºè°ƒ
- **artistic_style**: è‰ºæœ¯é£Žæ ¼

---

## ðŸ” æ„å›¾è¯†åˆ«

æœ¬Skillä¼šè‡ªåŠ¨è¯†åˆ«ä»¥ä¸‹æ„å›¾å…³é”®è¯ï¼š

| å…³é”®è¯ | æ„å›¾ | æ‰§è¡Œæ“ä½œ |
|--------|------|---------|
| å­¦ä¹ ã€æå–ã€åˆ†æžã€è¯†åˆ« | æ‰«æå•ä¸ªPrompt | `learner.py scan` |
| æ‰¹é‡ã€æ‰€æœ‰ã€å…¨éƒ¨ã€æ‰«æ | æ‰¹é‡æ‰«æ | `learner.py batch` |
| å‘çŽ°ã€ç¼ºå¤±ã€æ–°çš„ | å‘çŽ°æ–°ç‰¹å¾ | è‡ªåŠ¨åˆ¤æ–­å•ä¸ª/æ‰¹é‡ |

**ç¤ºä¾‹**:

```
ç”¨æˆ·: "å­¦ä¹ è¿™ä¸ªPromptçš„ç‰¹å¾"
â†’ è¯†åˆ«ä¸ºï¼šæ‰«æå•ä¸ª
â†’ æ‰§è¡Œï¼šlearner.py scan "<prompt>"

ç”¨æˆ·: "æ‰«ææ‰€æœ‰Promptså‘çŽ°æ–°ç»´åº¦"
â†’ è¯†åˆ«ä¸ºï¼šæ‰¹é‡æ‰«æ
â†’ æ‰§è¡Œï¼šlearner.py batch
```

---

## âš™ï¸ é…ç½®å’Œå‚æ•°

### ç½®ä¿¡åº¦é˜ˆå€¼

```python
# learner.py ä¸­çš„é…ç½®
CONFIDENCE_THRESHOLD = 0.7  # 70%ä»¥ä¸Šæ‰å»ºè®®æ·»åŠ 
OVERLAP_THRESHOLD = 0.7     # å…³é”®è¯é‡å åº¦>70%è§†ä¸ºå·²å­˜åœ¨
```

### æ–‡ä»¶è·¯å¾„

```python
# ç‰¹å¾åº“è·¯å¾„
LIBRARY_PATH = "extracted_results/facial_features_library.json"

# Promptsæ•°æ®è·¯å¾„
PROMPTS_PATH = "extracted_results/extracted_modules.json"

# å®¡æ ¸æŠ¥å‘Šè¾“å‡ºè·¯å¾„
REPORT_OUTPUT_DIR = "extracted_results/"
```

---

## ðŸ“ è¾“å‡ºæ–‡ä»¶

### 1. å•æ¬¡æ‰«æå®¡æ ¸æŠ¥å‘Š

**æ–‡ä»¶å**: `new_features_review_YYYYMMDD_HHMMSS.md`

**ä½ç½®**: `extracted_results/`

**å†…å®¹**:
- æºPrompt
- æ–°å‘çŽ°çš„ç‰¹å¾åˆ—è¡¨
- æ¯ä¸ªç‰¹å¾çš„è¯¦ç»†ä¿¡æ¯
- å®¡æ ¸é€‰é¡¹ï¼ˆæ‰¹å‡†/ä¿®æ”¹/æ‹’ç»ï¼‰

### 2. æ‰¹é‡æ‰«ææ±‡æ€»æŠ¥å‘Š

**æ–‡ä»¶å**: `batch_scan_summary_YYYYMMDD_HHMMSS.md`

**ä½ç½®**: `extracted_results/`

**å†…å®¹**:
- æ‰«æç»Ÿè®¡ä¿¡æ¯
- æŒ‰ç±»åˆ«åˆ†ç»„çš„æ–°ç‰¹å¾
- æ¯ä¸ªç‰¹å¾å…³è”çš„Prompt ID
- ç½®ä¿¡åº¦è¯„åˆ†

---

## ðŸŽ“ æŠ€æœ¯å®žçŽ°ç»†èŠ‚

### è§„åˆ™æå–ç¤ºä¾‹

```python
# hair_style æå–
regex = r"(long|short|medium)?\s*(straight|curly|wavy)?\s*(black|blonde|red)?\s*(hair|ponytail)"

# åŒ¹é…ç¤ºä¾‹
"long flowing black hair" â†’ ("long", "flowing", "black", "hair")
"short curly blonde hair" â†’ ("short", "curly", "blonde", "hair")
"twin tails" â†’ ("", "", "", "twin tails")
```

### å…³é”®è¯é‡å åº¦è®¡ç®—

```python
def calculate_overlap(keywords1, keywords2):
    set1 = set([k.lower() for k in keywords1])
    set2 = set([k.lower() for k in keywords2])

    intersection = len(set1 & set2)
    union = len(set1 | set2)

    return intersection / union  # Jaccardç›¸ä¼¼åº¦
```

**ç¤ºä¾‹**:
```
keywords1 = ["long flowing hair", "black hair"]
keywords2 = ["long straight hair", "black locks"]

é‡å è¯: "long", "black", "hair" (3ä¸ª)
æ€»è¯æ±‡: 6ä¸ª
é‡å åº¦: 3/6 = 50%
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. AIè¾…åŠ©åŠŸèƒ½éœ€è¦LLM API

å½“å‰å®žçŽ°ä¸­ï¼ŒAIè¾…åŠ©æå–åŠŸèƒ½è¿”å›žç©ºåˆ—è¡¨ï¼Œéœ€è¦é›†æˆçœŸå®žçš„LLM APIï¼ˆClaudeã€GPT-4ç­‰ï¼‰ã€‚

**é›†æˆæ–¹æ³•**:
```python
# learner.py ä¸­çš„ AIAssistedLearner.extract_features()
# éœ€è¦è°ƒç”¨å®žé™…çš„LLM API
response = anthropic_client.messages.create(
    model="claude-sonnet-4-5-20250929",
    system=self.system_prompt,
    messages=[{"role": "user", "content": prompt_text}]
)
```

### 2. äººå·¥å®¡æ ¸æ˜¯å¿…é¡»çš„

è‡ªåŠ¨æ£€æµ‹å¯èƒ½å­˜åœ¨ï¼š
- âŒ è¯¯è¯†åˆ«ï¼ˆfalse positiveï¼‰
- âŒ é—æ¼ï¼ˆfalse negativeï¼‰
- âŒ åˆ†ç±»ç ä¸å¤Ÿå‡†ç¡®

**è§£å†³æ–¹æ¡ˆ**:
- âœ… å§‹ç»ˆéœ€è¦äººå·¥å®¡æ ¸
- âœ… åªæœ‰ç½®ä¿¡åº¦>70%çš„æ‰å»ºè®®
- âœ… å¤šæ¬¡å‡ºçŽ°çš„ç‰¹å¾ä¼˜å…ˆçº§æ›´é«˜

### 3. é¿å…è¿‡åº¦ç»†åˆ†

ä¸è¦ä¸ºæ¯ä¸ªç»†å¾®å·®åˆ«åˆ›å»ºåˆ†ç±»ï¼š

```
âœ… å¥½: long_straight (é€šç”¨)
âŒ å·®: long_straight_waist_length_black_shiny (è¿‡ç»†)

å»ºè®®:
- å‘åž‹: long_straight
- å‘è‰²: black (å•ç‹¬åˆ†ç±»)
- é•¿åº¦: ç”¨æè¿°è¯è¡¨è¾¾ï¼Œä¸å•ç‹¬åˆ†ç±»
```

---

## ðŸš€ æœªæ¥æ‰©å±•

### çŸ­æœŸï¼ˆ1å‘¨å†…ï¼‰

1. **é›†æˆçœŸå®žLLM API**
   - ä½¿ç”¨Claude APIè¿›è¡Œæ™ºèƒ½æå–
   - æé«˜è¯†åˆ«å‡†ç¡®åº¦

2. **ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼**
   - æ·»åŠ æ›´å¤šåŒ¹é…æ¨¡å¼
   - æ”¯æŒä¸­æ–‡å…³é”®è¯

### ä¸­æœŸï¼ˆ1ä¸ªæœˆï¼‰

3. **Webå®¡æ ¸ç•Œé¢**
   - å¯è§†åŒ–å®¡æ ¸æµç¨‹
   - ä¸€é”®æ‰¹å‡†/æ‹’ç»
   - æ‰¹é‡æ“ä½œ

4. **è‡ªåŠ¨åº“æ›´æ–°**
   - å®¡æ ¸é€šè¿‡åŽè‡ªåŠ¨æ›´æ–°JSON
   - ç”Ÿæˆchangelog
   - ç‰ˆæœ¬æŽ§åˆ¶

### é•¿æœŸï¼ˆ3ä¸ªæœˆï¼‰

5. **æ™ºèƒ½æŽ¨è**
   - åŸºäºŽä½¿ç”¨é¢‘çŽ‡æŽ¨è
   - è‡ªåŠ¨ç»„åˆå»ºè®®
   - é£Žæ ¼ä¸€è‡´æ€§æ£€æŸ¥

6. **å¤šè¯­è¨€æ”¯æŒ**
   - ä¸­è‹±æ–‡æ··åˆPrompt
   - è‡ªåŠ¨ç¿»è¯‘åˆ†ç±»å

---

## ðŸ“– ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´å·¥ä½œæµç¨‹

```
1. ç”¨æˆ·å‘çŽ°æ–°Prompt
   "æˆ‘æœ‰ä¸€ä¸ªæ–°Prompt: A woman with long red hair, fair skin..."

2. è°ƒç”¨Learner Skill
   "å­¦ä¹ è¿™ä¸ªPromptçš„æ–°ç‰¹å¾"

3. ç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œ
   â†’ è§„åˆ™æå–
   â†’ åŒ¹é…çŽ°æœ‰åº“
   â†’ ç”Ÿæˆå®¡æ ¸æŠ¥å‘Š

4. ç”¨æˆ·æŸ¥çœ‹æŠ¥å‘Š
   â†’ æ‰“å¼€ new_features_review_*.md
   â†’ æŸ¥çœ‹æ–°å‘çŽ°çš„ç‰¹å¾

5. äººå·¥å®¡æ ¸
   â†’ æ‰¹å‡†: hair_style (long_flowing_red)
   â†’ æ‰¹å‡†: hair_color (red)
   â†’ æ‰¹å‡†: skin_tone (fair_pale)

6. æ‰‹åŠ¨æ›´æ–°åº“
   â†’ å°†æ‰¹å‡†çš„ç‰¹å¾æ·»åŠ åˆ° facial_features_library.json
   â†’ æ›´æ–°ç‰ˆæœ¬å·è‡³ v1.3

7. éªŒè¯
   â†’ é‡æ–°è¿è¡Œç”Ÿæˆå·¥å…·
   â†’ æ£€æŸ¥æ–°ç‰¹å¾æ˜¯å¦å¯ç”¨
```

---

**SkillçŠ¶æ€**: âœ… å¯ç”¨
**å®žçŽ°æ–¹å¼**: æ··åˆå­¦ä¹ ï¼ˆè§„åˆ™+AI+äººå·¥å®¡æ ¸ï¼‰
**CLIå·¥å…·**: `learner.py`
**è¾“å‡º**: Markdownå®¡æ ¸æŠ¥å‘Š
**ä¸‹ä¸€æ­¥**: é›†æˆLLM APIï¼Œåˆ›å»ºWebå®¡æ ¸ç•Œé¢



================================================
FILE: .claude/skills/art-master/skill.md
================================================
---
name: art-master
description: è‰ºæœ¯é£Žæ ¼ä¸»æŽ§ - è‡ªåŠ¨ç”Ÿæˆè‰ºæœ¯é£Žæ ¼æç¤ºè¯ï¼Œæ”¯æŒæ°´å¢¨ç”»ã€æ²¹ç”»ã€è¶…çŽ°å®žã€æ’ç”»ç­‰å¤šç§è‰ºæœ¯é£Žæ ¼
---

# Art Master - è‰ºæœ¯é£Žæ ¼ä¸»æŽ§ Skill

**ç‰ˆæœ¬**: 1.0
**é¢†åŸŸ**: è‰ºæœ¯é£Žæ ¼
**æž¶æž„**: Master-Subordinate
**æ•°æ®æº**: Universal Elements Database

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„è‰ºæœ¯é£Žæ ¼æç¤ºè¯ï¼Œæ”¯æŒï¼š
- ðŸŽ¨ è‰ºæœ¯é£Žæ ¼ï¼ˆæ°´å¢¨ç”»ã€æ²¹ç”»ã€è¶…çŽ°å®žã€æ’ç”»ç­‰ï¼‰
- âœ¨ ç‰¹æ®Šæ•ˆæžœï¼ˆçŽ»ç’ƒç¢Žç‰‡ã€å…‰å½±ã€ç²’å­æ•ˆæžœç­‰ï¼‰
- ðŸ–Œï¸ ç»˜ç”»æŠ€æ³•ï¼ˆç¬”è§¦ã€è´¨æ„Ÿã€æž„å›¾ç­‰ï¼‰
- ðŸŒˆ è‰²å½©è¿ç”¨ï¼ˆå†·æš–è‰²è°ƒã€å¯¹æ¯”ã€å’Œè°ï¼‰
- ðŸ“œ æ–‡åŒ–é£Žæ ¼ï¼ˆä¸­å¼ã€æ—¥å¼ã€è¥¿æ–¹å¤å…¸ç­‰ï¼‰

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### å¿«é€Ÿç”Ÿæˆ

```
ç”Ÿæˆä¸€ä¸ªä¸­å›½æ°´å¢¨ç”»é£Žæ ¼
```

æˆ–

```
è‰ºæœ¯é£Žæ ¼ï¼šè¶…çŽ°å®žä¸»ä¹‰ï¼Œæ¢¦å¢ƒæ°›å›´
```

---

## ðŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥
  â†“
æŸ¥è¯¢arté¢†åŸŸå…ƒç´  (1 element)
  - art_styles: ä¸­å›½æ°´å¢¨ç”»ç­‰
  - special_effects: çŽ»ç’ƒç¢Žç‰‡ç­‰ï¼ˆéœ€è¡¥å……ï¼‰
  â†“
ç»„è£…Prompt
  1. è‰ºæœ¯é£Žæ ¼æè¿°
  2. ç‰¹æ®Šæ•ˆæžœ
  3. ç»˜ç”»æŠ€æ³•
  4. è‰²å½©è¿ç”¨
  â†“
è¾“å‡ºå®Œæ•´è‰ºæœ¯Prompt
```

---

## ðŸ“Š æ•°æ®æº

**ä¸»è¦åº“**: `art` domain (1 element)

**å…ƒç´ ç±»åˆ«**:
- `art_styles` - è‰ºæœ¯é£Žæ ¼
- `special_effects` - ç‰¹æ®Šæ•ˆæžœï¼ˆå¾…è¡¥å……ï¼‰

**å¯ç”¨æ ‡ç­¾**:
- `chinese-ink`, `painting`, `traditional`
- `surreal`, `dreamlike`, `artistic`

---

## âœ… è¾“å‡ºç¤ºä¾‹

**è¾“å…¥**: `ç”Ÿæˆä¸­å›½æ°´å¢¨ç”»`

**è¾“å‡º**:
```
Traditional Chinese ink painting style, flowing brush strokes with varying
ink density, minimalist composition emphasizing negative space, monochromatic
black ink with subtle grey washes, artistic interpretation of natural subjects,
poetic atmosphere with calligraphic elements, traditional Eastern aesthetics,
masterful brushwork technique, contemplative mood
```

---

**SkillçŠ¶æ€**: âœ… å·²å®žçŽ°
**Note**: è‰ºæœ¯é¢†åŸŸå…ƒç´ è¾ƒå°‘ï¼ˆ1ä¸ªï¼‰ï¼Œå»ºè®®åŽç»­è¡¥å……æ›´å¤šart_styleså’Œspecial_effects



================================================
FILE: .claude/skills/design-master/skill.md
================================================
---
name: design-master
description: å¹³é¢è®¾è®¡ä¸»æŽ§ - è‡ªåŠ¨ç”Ÿæˆå¹³é¢è®¾è®¡æç¤ºè¯ï¼Œæ”¯æŒæµ·æŠ¥ã€logoã€æ’ç”»ç­‰å¤šç§è®¾è®¡ç±»åž‹
---

# Design Master - å¹³é¢è®¾è®¡ä¸»æŽ§ Skill

**ç‰ˆæœ¬**: 1.0
**é¢†åŸŸ**: å¹³é¢è®¾è®¡
**æž¶æž„**: Master-Subordinate
**æ•°æ®æº**: Universal Elements Database

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„å¹³é¢è®¾è®¡æç¤ºè¯ï¼Œæ”¯æŒï¼š
- ðŸŽ¨ å¸ƒå±€ç³»ç»Ÿï¼ˆBento Gridã€å¯¹åˆ†å±ã€ç½‘æ ¼æ‹¼è´´ç­‰ï¼‰
- âœ¨ è§†è§‰æ•ˆæžœï¼ˆGlassmorphismã€æ¸å˜ã€3Dç­‰ï¼‰
- ðŸŽ­ è®¾è®¡é£Žæ ¼ï¼ˆçŽ°ä»£æžç®€ã€å¤å¤ã€ç§‘æŠ€ç­‰ï¼‰
- ðŸŒˆ è‰²å½©æ–¹æ¡ˆï¼ˆé…è‰²è§„åˆ™ã€è‰²è°ƒæŽ§åˆ¶ï¼‰
- ðŸ“ æž„å›¾æŠ€å·§ï¼ˆå¯¹ç§°ã€é»„é‡‘æ¯”ä¾‹ã€è§†è§‰å±‚æ¬¡ï¼‰

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šå…ƒç´ çº§ç”Ÿæˆï¼ˆçµæ´»ç»„åˆï¼‰

```
ç”Ÿæˆä¸€ä¸ªBento Gridå¸ƒå±€æµ·æŠ¥
```

æˆ–

```
å¹³é¢è®¾è®¡ï¼šçŽ°ä»£æžç®€é£Žæ ¼ï¼ŒçŽ»ç’ƒæ€æ•ˆæžœ
```

**åŽŸç†**ï¼šä»Ž80ä¸ªdesignå…ƒç´ ä¸­æ™ºèƒ½é€‰æ‹©å¹¶ç»„åˆ

---

### æ–¹å¼2ï¼šæ¨¡æ¿çº§ç”Ÿæˆï¼ˆå®Œæ•´ç³»ç»Ÿï¼‰â­ æ–°å¢ž

```
ç”ŸæˆAppleé£Žæ ¼PPTæ¨¡æ¿
```

æˆ–

```
ä½¿ç”¨çŽ°ä»£å•†åŠ¡ç§‘æŠ€å…¸é›…é£Žæ ¼PPTæ¨¡æ¿
```

**å…³é”®è¯**ï¼šåŒ…å«"æ¨¡æ¿"ä¸€è¯è§¦å‘æ¨¡æ¿æŸ¥è¯¢

**åŽŸç†**ï¼šä»Ždesign_templatesè¡¨æŸ¥è¯¢å®Œæ•´è®¾è®¡ç³»ç»Ÿ

**è¿”å›žå†…å®¹**ï¼š
- è®¾è®¡ç†å¿µè¯´æ˜Ž
- å®Œæ•´å…ƒç´ åˆ—è¡¨ï¼ˆ12ä¸ªå…ƒç´ ï¼ŒæŒ‰ç»“æž„ç»„ç»‡ï¼‰
- ä½¿ç”¨åœºæ™¯å’ŒæŒ‡å—
- ç»„è£…å¥½çš„å®Œæ•´æç¤ºè¯

---

## ðŸ”„ å·¥ä½œæµç¨‹

### å…ƒç´ çº§æµç¨‹ï¼ˆé»˜è®¤ï¼‰

```
ç”¨æˆ·è¾“å…¥ï¼ˆä¸å«"æ¨¡æ¿"å…³é”®è¯ï¼‰
  â†“
æŸ¥è¯¢designé¢†åŸŸå…ƒç´  (80 elements)
  - layout_systems: Bentoç½‘æ ¼ã€å¯¹åˆ†å±ç­‰
  - visual_effects: çŽ»ç’ƒæ€ã€æ¸å˜ç­‰
  - color_schemes: é…è‰²æ–¹æ¡ˆ
  - typography: å­—ä½“ç³»ç»Ÿ
  - backgrounds: èƒŒæ™¯ç³»ç»Ÿ
  â†“
æ™ºèƒ½é€‰æ‹©å…ƒç´ 
  - æ ¹æ®ç”¨æˆ·éœ€æ±‚åŒ¹é…
  - è¯­ä¹‰ç›¸å…³æ€§æŽ’åº
  â†“
ç»„è£…Prompt
  1. å¸ƒå±€ç³»ç»Ÿ
  2. è§†è§‰æ•ˆæžœ
  3. è‰²å½©æ–¹æ¡ˆ
  4. æŠ€æœ¯å‚æ•°ï¼ˆ4Kã€DPIï¼‰
  â†“
è¾“å‡ºå®Œæ•´è®¾è®¡Prompt
```

### æ¨¡æ¿çº§æµç¨‹ï¼ˆåŒ…å«"æ¨¡æ¿"å…³é”®è¯ï¼‰â­ æ–°å¢ž

```
ç”¨æˆ·è¾“å…¥ï¼ˆåŒ…å«"æ¨¡æ¿"ï¼‰
  â†“
æ£€æµ‹å…³é”®è¯ï¼š"æ¨¡æ¿" | "template"
  â†“
æŸ¥è¯¢design_templatesè¡¨
  - åŒ¹é…nameã€chinese_nameã€style_tags
  - ç¤ºä¾‹ï¼šApple â†’ "Appleæ·¡è“å•†åŠ¡PPT"
  â†“
è¿”å›žå®Œæ•´æ¨¡æ¿
  - è®¾è®¡ç†å¿µ
  - 12ä¸ªå…ƒç´ ï¼ˆæŒ‰ç»“æž„ç»„ç»‡ï¼‰
  - ä½¿ç”¨åœºæ™¯
  - å®Œæ•´æç¤ºè¯
  â†“
è¾“å‡ºæ¨¡æ¿è¯¦æƒ… + æç¤ºè¯
```

---

## ðŸ“Š æ•°æ®æº

### å…ƒç´ åº“ï¼ˆelementsè¡¨ï¼‰

**é¢†åŸŸ**: `design` domain (80 elements)

**å…ƒç´ ç±»åˆ«**:
- `layout_systems` - å¸ƒå±€ç³»ç»Ÿ
- `visual_effects` - è§†è§‰æ•ˆæžœ
- `color_schemes` - é…è‰²æ–¹æ¡ˆ
- `typography` - å­—ä½“ç³»ç»Ÿ
- `backgrounds` - èƒŒæ™¯ç³»ç»Ÿ

**å¯ç”¨æ ‡ç­¾**:
- `bento-grid`, `glassmorphism`, `modern`
- `minimalist`, `grid`, `layout`, `apple`

### æ¨¡æ¿åº“ï¼ˆdesign_templatesè¡¨ï¼‰â­ æ–°å¢ž

**å½“å‰æ¨¡æ¿æ•°**: 1ä¸ª

**å·²æœ‰æ¨¡æ¿**:
1. **Appleæ·¡è“å•†åŠ¡PPT** (template_apple_soft_blue_ppt_v1)
   - ç±»åˆ«: ppt_design
   - åŒ…å«: 12ä¸ªå…ƒç´ 
   - æ ‡ç­¾: apple, business, soft_blue, minimal, professional
   - é€‚ç”¨: å•†åŠ¡æ±‡æŠ¥ã€äº§å“å‘å¸ƒä¼šã€æ•°æ®åˆ†æž

**æ¨¡æ¿åˆ†ç±»**:
- `ppt_design` - PPTæ¼”ç¤ºè®¾è®¡
- `ui_system` - UIè®¾è®¡ç³»ç»Ÿ
- `brand_vi` - å“ç‰Œè§†è§‰è¯†åˆ«
- `web_design` - ç½‘é¡µè®¾è®¡ç³»ç»Ÿ
- `dashboard` - ä»ªè¡¨æ¿è®¾è®¡

---

## âœ… è¾“å‡ºç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå…ƒç´ çº§ç”Ÿæˆ

**è¾“å…¥**: `ç”ŸæˆBento GridçŽ»ç’ƒæ€æµ·æŠ¥`

**è¾“å‡º**:
```
Modern Bento grid layout with 8 asymmetric modular cards, frosted glass effect
with 80% translucency and backdrop blur filter, minimalist modern aesthetics,
90% neutral colors with 10% vibrant accent colors, clean typography, 4K
resolution, professional graphic design, UI/UX design system, contemporary
digital poster design
```

### ç¤ºä¾‹2ï¼šæ¨¡æ¿çº§ç”Ÿæˆ â­ æ–°å¢ž

**è¾“å…¥**: `ç”ŸæˆAppleé£Žæ ¼PPTæ¨¡æ¿`

**è¾“å‡º**:
```
ðŸ“‹ æ‰¾åˆ°åŒ¹é…æ¨¡æ¿ï¼šçŽ°ä»£å•†åŠ¡ç§‘æŠ€å…¸é›…é£Žæ ¼PPT - æ·¡è“è£…é¥°ç‰ˆ

ðŸŽ¯ è®¾è®¡ç†å¿µï¼š
æžç®€ä¸»ä¹‰ç¾Žå­¦èžåˆæ¸©å’Œçš„ç§‘æŠ€æ„Ÿã€‚åœ¨Appleè®¾è®¡è¯­è¨€åŸºç¡€ä¸Šï¼Œ
åŠ å…¥æ·¡é›…çš„è“è‰²è°ƒå’Œç»†è…»çš„è£…é¥°çº¹ç†ï¼Œè¥é€ æ—¢ä¸“ä¸šåˆä¸å¤±æ¸©åº¦
çš„å•†åŠ¡æ°›å›´ã€‚

ðŸ“¦ å®Œæ•´æ¨¡æ¿åŒ…å«ï¼ˆ12ä¸ªå…ƒç´ ï¼‰ï¼š

ã€èƒŒæ™¯ç³»ç»Ÿã€‘
â€¢ Appleé£Žæ ¼æ·¡è“æ¸å˜èƒŒæ™¯
â€¢ å››å±‚è£…é¥°èƒŒæ™¯ç³»ç»Ÿ

ã€å¸ƒå±€ç³»ç»Ÿã€‘
â€¢ Appleé£Žæ ¼çŽ»ç’ƒå¡ç‰‡ç³»ç»Ÿ
â€¢ 12åˆ—8ç‚¹ç½‘æ ¼ç³»ç»Ÿ

ã€é…è‰²ç³»ç»Ÿã€‘
â€¢ Appleå•†åŠ¡è“é…è‰²ç³»ç»Ÿ

ã€å­—ä½“ç³»ç»Ÿã€‘
â€¢ Appleå­—ä½“å±‚çº§ç³»ç»Ÿ

ã€è§†è§‰æ•ˆæžœã€‘
â€¢ macOSçª—å£ä¸‰è‰²åœ†ç‚¹
â€¢ SF Symbolsè¶…ç»†çº¿æ€§å›¾æ ‡
â€¢ Appleé£Žæ ¼æŸ”å’Œè“æ•°æ®å›¾è¡¨
â€¢ æ·¡è“æ ‡ç­¾ç»„ä»¶
â€¢ Appleåœ†è§’å±‚çº§ç³»ç»Ÿ
â€¢ è“è‰²è°ƒæŠ•å½±ç³»ç»Ÿ

ðŸŽ¨ ä½¿ç”¨åœºæ™¯ï¼š
é«˜ç«¯å•†åŠ¡æ±‡æŠ¥ã€äº§å“å‘å¸ƒä¼šã€æ•°æ®åˆ†æžæŠ¥å‘Š

âœ¨ å®Œæ•´æ¨¡æ¿æç¤ºè¯ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[åŒ…å«å…¨éƒ¨12ä¸ªå…ƒç´ çš„å®Œæ•´æç¤ºè¯]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

**SkillçŠ¶æ€**: âœ… å·²å®žçŽ°ï¼ˆv1.1 - æ”¯æŒæ¨¡æ¿ç³»ç»Ÿï¼‰



================================================
FILE: .claude/skills/domain-classifier/skill.md
================================================
---
name: domain-classifier
description: AIé¢†åŸŸåˆ†ç±»å™¨ - æ™ºèƒ½åˆ†æžæç¤ºè¯å†…å®¹ï¼Œå‡†ç¡®åˆ¤æ–­æ‰€å±žé¢†åŸŸï¼ˆäººåƒ/è‰ºæœ¯/è®¾è®¡/äº§å“/è§†é¢‘ï¼‰
---

# Domain Classifier - AIé¢†åŸŸåˆ†ç±»å™¨

**ç‰ˆæœ¬**: 1.0
**ç”¨é€”**: æ™ºèƒ½åˆ†æžæç¤ºè¯å†…å®¹ï¼Œå‡†ç¡®åˆ¤æ–­æ‰€å±žé¢†åŸŸ
**è¾“å‡º**: ç»“æž„åŒ–JSONæ ¼å¼

---

## ðŸŽ¯ ä»»åŠ¡

åˆ†æžæç¤ºè¯å†…å®¹ï¼Œåˆ¤æ–­å®ƒå±žäºŽä»¥ä¸‹7å¤§é¢†åŸŸä¸­çš„å“ªä¸€ä¸ªï¼š

### 7å¤§é¢†åŸŸå®šä¹‰

**1. portrait (äººåƒæ‘„å½±)**
- äººç‰©è‚–åƒã€é¢éƒ¨ç‰¹å¾ã€è¡¨æƒ…ã€å§¿åŠ¿
- ç¾Žå¦†ã€å‘åž‹ã€æœè£…ã€é…é¥°
- äººåƒæ‘„å½±æŠ€æœ¯ã€å…‰ç…§ã€è§’åº¦
- å…³é”®è¯ï¼šäººã€è„¸ã€çœ¼ç›ã€è‚¤è‰²ã€å¦†å®¹ã€å‘åž‹ã€è¡¨æƒ…ã€å§¿åŠ¿

**2. interior (å®¤å†…è®¾è®¡)**
- å®¤å†…ç©ºé—´ã€å®¶å…·å¸ƒå±€ã€è£…ä¿®é£Žæ ¼
- å®¢åŽ…ã€å§å®¤ã€åŽ¨æˆ¿ã€åŠžå…¬å®¤ç­‰ç©ºé—´
- æè´¨ç»„åˆã€ç©ºé—´æ°›å›´
- å…³é”®è¯ï¼šå®¤å†…ã€æˆ¿é—´ã€å®¶å…·ã€ç©ºé—´ã€è£…ä¿®ã€å¸ƒå±€

**3. product (äº§å“æ‘„å½±)**
- äº§å“å±•ç¤ºã€å•†ä¸šæ‘„å½±
- ç‰©å“ã€å•†å“ã€åŒ…è£…ã€é™ç‰©
- äº§å“ç‰¹å†™ã€æè´¨å±•ç¤º
- å…³é”®è¯ï¼šäº§å“ã€ç‰©å“ã€å•†å“ã€åŒ…è£…ã€ç“¶å­ã€æ‰‹è¡¨ã€åŒ…åŒ…

**4. design (å¹³é¢è®¾è®¡)**
- æµ·æŠ¥ã€UIç•Œé¢ã€ä¿¡æ¯å›¾ã€åç‰‡
- æŽ’ç‰ˆã€ç½‘æ ¼å¸ƒå±€ã€Bento Grid
- å›¾å½¢è®¾è®¡ã€è§†è§‰ä¼ è¾¾
- å…³é”®è¯ï¼šæµ·æŠ¥ã€è®¾è®¡ã€å¸ƒå±€ã€ç½‘æ ¼ã€UIã€æŽ’ç‰ˆã€å›¾å½¢

**5. art (è‰ºæœ¯é£Žæ ¼)**
- ç»˜ç”»ã€æ’ç”»ã€è‰ºæœ¯åˆ›ä½œ
- æ°´å¢¨ã€æ²¹ç”»ã€æ°´å½©ã€ç´ æ
- è‰ºæœ¯é£Žæ ¼ã€æµæ´¾ã€æŠ€æ³•
- å…³é”®è¯ï¼šç»˜ç”»ã€è‰ºæœ¯ã€æ°´å¢¨ã€æ²¹ç”»ã€æ’ç”»ã€ç”»ä½œ

**6. video (è§†é¢‘ç”Ÿæˆ)**
- è§†é¢‘åœºæ™¯ã€é•œå¤´è¿åŠ¨
- åŠ¨æ€æ•ˆæžœã€åˆ†é•œã€åŠ¨ä½œ
- ç”µå½±åœºæ™¯ã€åŠ¨ç”»
- å…³é”®è¯ï¼šè§†é¢‘ã€é•œå¤´ã€è¿åŠ¨ã€åˆ†é•œã€ç”µå½±ã€åŠ¨ç”»ã€åœºæ™¯åˆ‡æ¢

**7. common (é€šç”¨æ‘„å½±)**
- æ‘„å½±æŠ€æœ¯ã€ç›¸æœºå‚æ•°
- å…‰ç…§ã€æž„å›¾ã€æ™¯æ·±
- ä¸ç‰¹å®šäºŽæŸä¸ªé¢†åŸŸçš„æ‘„å½±æŠ€å·§
- å…³é”®è¯ï¼šæ‘„å½±ã€ç›¸æœºã€é•œå¤´ã€å…‰ç…§ã€å¯¹ç„¦ã€æ™¯æ·±ã€æž„å›¾

---

## ðŸ“‹ åˆ†æžæµç¨‹

### Step 1: é˜…è¯»æç¤ºè¯
ä»”ç»†é˜…è¯»æç¤ºè¯çš„å®Œæ•´å†…å®¹ï¼Œç†è§£å…¶æ ¸å¿ƒä¸»é¢˜å’Œç›®çš„ã€‚

### Step 2: è¯†åˆ«å…³é”®å…ƒç´ 
ä»Žæç¤ºè¯ä¸­è¯†åˆ«ï¼š
- **ä¸»ä½“å¯¹è±¡**ï¼šæè¿°çš„æ˜¯ä»€ä¹ˆï¼ˆäºº/ç‰©/ç©ºé—´/è®¾è®¡ï¼‰ï¼Ÿ
- **è§†è§‰é£Žæ ¼**ï¼šæ˜¯æ‘„å½±/ç»˜ç”»/è®¾è®¡/åŠ¨æ€ï¼Ÿ
- **æŠ€æœ¯ç‰¹å¾**ï¼šä½¿ç”¨äº†å“ªäº›ç‰¹å®šé¢†åŸŸçš„æœ¯è¯­ï¼Ÿ
- **åº”ç”¨åœºæ™¯**ï¼šç”¨äºŽä»€ä¹ˆç›®çš„ï¼Ÿ

### Step 3: é¢†åŸŸåŒ¹é…
æ ¹æ®å…³é”®å…ƒç´ ï¼Œåˆ¤æ–­æœ€åŒ¹é…çš„é¢†åŸŸï¼š

**ä¼˜å…ˆçº§è§„åˆ™**ï¼š
1. å¦‚æžœä¸»ä½“æ˜¯**äººç‰©é¢éƒ¨/å…¨èº«** â†’ portrait
2. å¦‚æžœä¸»ä½“æ˜¯**å®¤å†…ç©ºé—´/å®¶å…·** â†’ interior
3. å¦‚æžœä¸»ä½“æ˜¯**äº§å“ç‰©å“**ä¸”å¼ºè°ƒå•†ä¸šå±•ç¤º â†’ product
4. å¦‚æžœæ˜¯**æµ·æŠ¥/UI/å¹³é¢ä½œå“** â†’ design
5. å¦‚æžœæ˜¯**ç»˜ç”»/è‰ºæœ¯åˆ›ä½œ** â†’ art
6. å¦‚æžœå¼ºè°ƒ**è§†é¢‘/åŠ¨æ€/é•œå¤´è¿åŠ¨** â†’ video
7. å¦‚æžœåªæ˜¯é€šç”¨çš„**æ‘„å½±æŠ€æœ¯** â†’ common

**ç‰¹æ®Šæƒ…å†µå¤„ç†**ï¼š
- å¦‚æžœåŒ…å«äººç‰©ä½†é‡ç‚¹æ˜¯**ç©ºé—´** â†’ interior
- å¦‚æžœåŒ…å«äº§å“ä½†é‡ç‚¹æ˜¯**è®¾è®¡æŽ’ç‰ˆ** â†’ design
- å¦‚æžœæ˜¯äººç‰©ä½†é‡‡ç”¨**ç»˜ç”»é£Žæ ¼** â†’ art
- å¦‚æžœæ— æ³•æ˜Žç¡®åˆ¤æ–­ â†’ é€‰æ‹©æœ€åŒ¹é…çš„é¢†åŸŸ

### Step 4: è®¡ç®—ç½®ä¿¡åº¦
åŸºäºŽä»¥ä¸‹å› ç´ è¯„ä¼°ç½®ä¿¡åº¦ï¼ˆ0-100%ï¼‰ï¼š
- **90-100%**: é¢†åŸŸç‰¹å¾éžå¸¸æ˜Žç¡®ï¼ŒåŒ…å«å¤šä¸ªè¯¥é¢†åŸŸå…³é”®è¯
- **70-89%**: é¢†åŸŸç‰¹å¾æ¸…æ™°ï¼Œæœ‰æ˜Žæ˜¾æ ‡å¿—
- **50-69%**: é¢†åŸŸç‰¹å¾åŸºæœ¬æ˜Žç¡®ï¼Œä½†æœ‰äº›æ¨¡ç³Š
- **30-49%**: é¢†åŸŸç‰¹å¾ä¸æ˜Žæ˜¾ï¼Œå¯èƒ½å±žäºŽå¤šä¸ªé¢†åŸŸ
- **0-29%**: æ— æ³•ç¡®å®šé¢†åŸŸ

---

## ðŸ“¤ è¾“å‡ºæ ¼å¼

**å¿…é¡»**è¾“å‡ºJSONæ ¼å¼ï¼š

```json
{
  "primary_domain": "portrait",
  "confidence": 85,
  "reasoning": "æç¤ºè¯æè¿°äº†ä¸€ä½å¥³æ€§çš„é¢éƒ¨ç‰¹å¾ï¼ŒåŒ…æ‹¬çœ¼ç›ã€è‚¤è‰²ã€å¦†å®¹ç­‰äººåƒæ‘„å½±å…ƒç´ ï¼Œæ˜Žç¡®å±žäºŽäººåƒæ‘„å½±é¢†åŸŸã€‚",
  "secondary_domains": ["common"],
  "keywords_found": ["é¢éƒ¨", "è‚¤è‰²", "å¦†å®¹", "æ‘„å½±"]
}
```

**å­—æ®µè¯´æ˜Ž**ï¼š
- `primary_domain`: ä¸»é¢†åŸŸIDï¼ˆportrait/interior/product/design/art/video/commonï¼‰
- `confidence`: ç½®ä¿¡åº¦ï¼ˆ0-100æ•´æ•°ï¼‰
- `reasoning`: åˆ¤æ–­ç†ç”±ï¼ˆ1-2å¥è¯ï¼Œä¸­æ–‡ï¼‰
- `secondary_domains`: æ¬¡è¦ç›¸å…³é¢†åŸŸï¼ˆå¯é€‰ï¼Œæ•°ç»„ï¼‰
- `keywords_found`: æ‰¾åˆ°çš„å…³é”®è¯ï¼ˆå¯é€‰ï¼Œæ•°ç»„ï¼‰

---

## ðŸ” ç¤ºä¾‹åˆ†æž

### ç¤ºä¾‹1ï¼šäººåƒæ‘„å½±

**è¾“å…¥**ï¼š
```
ä¸€ä½20å²çš„äºšæ´²å¥³æ€§ï¼Œé•¿å‘é£˜é€¸ï¼Œæ·¡å¦†ï¼Œæ¸©æŸ”çš„å¾®ç¬‘ï¼ŒæŸ”å’Œçš„å·¥ä½œå®¤å…‰ç…§ï¼Œ
æµ…æ™¯æ·±ï¼ŒèƒŒæ™¯è™šåŒ–ï¼Œ85mmé•œå¤´ï¼Œf/1.8å…‰åœˆã€‚
```

**è¾“å‡º**ï¼š
```json
{
  "primary_domain": "portrait",
  "confidence": 95,
  "reasoning": "æ˜Žç¡®æè¿°äººç‰©è‚–åƒï¼ŒåŒ…å«å¹´é¾„ã€æ€§åˆ«ã€é¢éƒ¨ç‰¹å¾ã€è¡¨æƒ…ç­‰äººåƒå…³é”®å…ƒç´ ï¼Œä¸”ä½¿ç”¨äººåƒæ‘„å½±æŠ€æœ¯ã€‚",
  "secondary_domains": ["common"],
  "keywords_found": ["å¥³æ€§", "é¢éƒ¨", "å¾®ç¬‘", "å·¥ä½œå®¤å…‰ç…§", "æµ…æ™¯æ·±", "85mmé•œå¤´"]
}
```

---

### ç¤ºä¾‹2ï¼šå®¤å†…è®¾è®¡

**è¾“å…¥**ï¼š
```
çŽ°ä»£ç®€çº¦é£Žæ ¼å®¢åŽ…ï¼Œç±³è‰²æ²™å‘ï¼Œæœ¨è´¨èŒ¶å‡ ï¼Œè½åœ°çª—ï¼Œè‡ªç„¶å…‰ç…§ï¼Œ
æžç®€ä¸»ä¹‰ï¼Œæ¸©é¦¨æ°›å›´ï¼Œ3Dæ¸²æŸ“ã€‚
```

**è¾“å‡º**ï¼š
```json
{
  "primary_domain": "interior",
  "confidence": 92,
  "reasoning": "æè¿°å®¤å†…ç©ºé—´å¸ƒå±€å’Œå®¶å…·ï¼Œæ˜Žç¡®æ˜¯å®¢åŽ…åœºæ™¯ï¼Œå±žäºŽå®¤å†…è®¾è®¡é¢†åŸŸã€‚",
  "secondary_domains": [],
  "keywords_found": ["å®¢åŽ…", "æ²™å‘", "èŒ¶å‡ ", "å®¤å†…", "ç©ºé—´"]
}
```

---

### ç¤ºä¾‹3ï¼šå¹³é¢è®¾è®¡

**è¾“å…¥**ï¼š
```
Bentoç½‘æ ¼å¸ƒå±€æµ·æŠ¥ï¼Œ8ä¸ªæ¨¡å—ï¼Œéžå¯¹ç§°æŽ’åˆ—ï¼ŒçŽ»ç’ƒæ€æ•ˆæžœï¼Œ
çŽ°ä»£æŽ’ç‰ˆï¼Œä¿¡æ¯å›¾è¡¨ï¼Œæ¨ªå‘16:9ã€‚
```

**è¾“å‡º**ï¼š
```json
{
  "primary_domain": "design",
  "confidence": 95,
  "reasoning": "æ˜Žç¡®çš„å¹³é¢è®¾è®¡ä½œå“ï¼ŒåŒ…å«Bentoç½‘æ ¼ã€æµ·æŠ¥ã€æŽ’ç‰ˆç­‰è®¾è®¡å…³é”®è¯ã€‚",
  "secondary_domains": [],
  "keywords_found": ["Bentoç½‘æ ¼", "æµ·æŠ¥", "å¸ƒå±€", "æŽ’ç‰ˆ", "ä¿¡æ¯å›¾"]
}
```

---

### ç¤ºä¾‹4ï¼šè‰ºæœ¯é£Žæ ¼

**è¾“å…¥**ï¼š
```
ä¸­å›½ä¼ ç»Ÿæ°´å¢¨ç”»ï¼Œå±±æ°´æ„å¢ƒï¼Œæ³¼å¢¨æŠ€æ³•ï¼Œå†™æ„é£Žæ ¼ï¼Œ
å®£çº¸è´¨æ„Ÿï¼Œé»‘ç™½ç°å±‚æ¬¡ï¼Œç•™ç™½è‰ºæœ¯ã€‚
```

**è¾“å‡º**ï¼š
```json
{
  "primary_domain": "art",
  "confidence": 98,
  "reasoning": "å…¸åž‹çš„è‰ºæœ¯ç»˜ç”»ä½œå“ï¼Œä½¿ç”¨ä¼ ç»Ÿç»˜ç”»æŠ€æ³•å’Œè‰ºæœ¯è¡¨çŽ°æ‰‹æ³•ã€‚",
  "secondary_domains": [],
  "keywords_found": ["æ°´å¢¨ç”»", "ç»˜ç”»", "æŠ€æ³•", "è‰ºæœ¯"]
}
```

---

### ç¤ºä¾‹5ï¼šæ¨¡ç³Šæ¡ˆä¾‹ï¼ˆäº§å“ vs è®¾è®¡ï¼‰

**è¾“å…¥**ï¼š
```
EviançŸ¿æ³‰æ°´ç“¶äº§å“å±•ç¤ºï¼ŒBentoç½‘æ ¼å¸ƒå±€ï¼Œ8ä¸ªä¿¡æ¯å¡ç‰‡ï¼Œ
çŽ»ç’ƒæè´¨ï¼Œäº§å“ä¿¡æ¯å›¾è¡¨è®¾è®¡ã€‚
```

**è¾“å‡º**ï¼š
```json
{
  "primary_domain": "design",
  "confidence": 65,
  "reasoning": "è™½ç„¶åŒ…å«äº§å“ï¼ˆEvianç“¶ï¼‰ï¼Œä½†é‡ç‚¹æ˜¯Bentoç½‘æ ¼å¸ƒå±€å’Œä¿¡æ¯è®¾è®¡ï¼Œå±žäºŽå¹³é¢è®¾è®¡èŒƒç•´ã€‚",
  "secondary_domains": ["product"],
  "keywords_found": ["Bentoç½‘æ ¼", "å¸ƒå±€", "ä¿¡æ¯å›¾è¡¨", "è®¾è®¡", "äº§å“"]
}
```

---

## âš ï¸ é‡è¦è§„åˆ™

1. **å¿…é¡»é€‰æ‹©ä¸€ä¸ªä¸»é¢†åŸŸ** - ä¸èƒ½è¿”å›žNoneæˆ–null
2. **ç½®ä¿¡åº¦ä¸èƒ½ä½ŽäºŽ30%** - å³ä½¿ä¸ç¡®å®šä¹Ÿè¦åšå‡ºæœ€ä½³åˆ¤æ–­
3. **reasoningå¿…é¡»å…·ä½“** - è¯´æ˜Žä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªé¢†åŸŸ
4. **ä¼˜å…ˆä¸»ä½“å¯¹è±¡** - å…ˆçœ‹æè¿°çš„æ˜¯ä»€ä¹ˆï¼Œå†çœ‹æŠ€æœ¯å’Œé£Žæ ¼
5. **ä¸­æ–‡ä¼˜å…ˆ** - è¾“å‡ºreasoningå’Œkeywords_foundæ—¶ä½¿ç”¨ä¸­æ–‡

---

## ðŸŽ¯ æ‰¹é‡å¤„ç†æ¨¡å¼

å½“éœ€è¦æ‰¹é‡åˆ†æžå¤šä¸ªæç¤ºè¯æ—¶ï¼Œè¾“å‡ºJSONæ•°ç»„ï¼š

```json
[
  {
    "file_id": "prompt_001.txt",
    "primary_domain": "portrait",
    "confidence": 85,
    "reasoning": "..."
  },
  {
    "file_id": "prompt_002.txt",
    "primary_domain": "design",
    "confidence": 72,
    "reasoning": "..."
  }
]
```

---

**ä½¿ç”¨æ­¤Skillæ—¶ï¼Œè¯·ä¸¥æ ¼éµå®ˆè¾“å‡ºæ ¼å¼ï¼Œç¡®ä¿JSONæœ‰æ•ˆï¼**



================================================
FILE: .claude/skills/intelligent-prompt-generator/SKILL.md
================================================
---
name: intelligent-prompt-generator
description: æ™ºèƒ½æç¤ºè¯ç”Ÿæˆå™¨ v2.0 - æ”¯æŒäººåƒ/è·¨domain/è®¾è®¡ä¸‰ç§æ¨¡å¼ï¼Œè¯­ä¹‰ç†è§£ã€å¸¸è¯†æŽ¨ç†ã€ä¸€è‡´æ€§æ£€æŸ¥
---

# Intelligent Prompt Generator Skill v2.0

ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½æç¤ºè¯ç”Ÿæˆä¸“å®¶ï¼Œæ‹¥æœ‰è¯­ä¹‰ç†è§£ã€å¸¸è¯†æŽ¨ç†å’Œä¸€è‡´æ€§æ£€æŸ¥èƒ½åŠ›ã€‚

## ðŸŽ‰ v2.0 æ–°åŠŸèƒ½

**ç³»ç»Ÿå·²å‡çº§åˆ°v2.0ï¼çŽ°åœ¨æ”¯æŒ3ç§ç”Ÿæˆæ¨¡å¼ï¼š**

### 1ï¸âƒ£ Portraitï¼ˆäººåƒï¼‰- å‘åŽå…¼å®¹
- **é€‚ç”¨**ï¼šçº¯äººåƒæ‘„å½±
- **ç¤ºä¾‹**ï¼š"ç”Ÿæˆä¸€ä¸ªå¹´è½»å¥³æ€§è‚–åƒ"
- **ä½¿ç”¨**ï¼športrait domain (502ä¸ªå…ƒç´ )

### 2ï¸âƒ£ Cross-Domainï¼ˆè·¨åŸŸï¼‰- ðŸ†• æ–°åŠŸèƒ½
- **é€‚ç”¨**ï¼šå¤æ‚åœºæ™¯ï¼Œéœ€è¦å¤šdomainç»„åˆ
- **ç¤ºä¾‹**ï¼š"é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ"
- **ä½¿ç”¨**ï¼šè‡ªåŠ¨è¯†åˆ«éœ€è¦çš„domainsï¼ˆportrait + video + art + commonï¼‰
- **ä¼˜åŠ¿**ï¼šå……åˆ†åˆ©ç”¨1,246ä¸ªå…ƒç´ ï¼Œåˆ©ç”¨çŽ‡ä»Ž40%æå‡åˆ°80%

### 3ï¸âƒ£ Designï¼ˆè®¾è®¡ï¼‰- ðŸ†• æ–°åŠŸèƒ½
- **é€‚ç”¨**ï¼šè®¾è®¡æµ·æŠ¥ã€å¡ç‰‡ï¼Œéœ€è¦ä¸“ä¸šè®¾è®¡è§„èŒƒ
- **ç¤ºä¾‹**ï¼š"æ¸©é¦¨å¯çˆ±é£Žæ ¼çš„å„¿ç«¥æ•™è‚²æµ·æŠ¥"
- **ä½¿ç”¨**ï¼šSQLiteå…ƒç´  + YAMLå˜é‡ï¼ˆé…è‰²ã€è¾¹æ¡†ã€è£…é¥°ï¼‰
- **ä¼˜åŠ¿**ï¼š20ä¸‡+ç§é…è‰²ç»„åˆ

---

## ðŸš€ å¦‚ä½•ä½¿ç”¨v2.0

**é‡è¦**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«ç”¨æˆ·éœ€æ±‚ç±»åž‹å¹¶é€‰æ‹©æœ€ä½³ç”Ÿæˆæ¨¡å¼ï¼

### è°ƒç”¨æ–¹å¼

å½“ç”¨æˆ·è¯·æ±‚ç”Ÿæˆæç¤ºè¯æ—¶ï¼Œä½ éœ€è¦ï¼š

1. **è§£æžç”¨æˆ·è¾“å…¥**ï¼Œè¯†åˆ«éœ€æ±‚ç±»åž‹
2. **è°ƒç”¨Pythonç”Ÿæˆå™¨**
3. **è¿”å›žç»“æžœ**

**å…³é”®ä»£ç **ï¼š

```python
import os
os.chdir('/Users/serva/.claude/skills/skill-prompt-generator')

from core.cross_domain_generator import CrossDomainGenerator

generator = CrossDomainGenerator()
result = generator.generate(user_input)

print(f"ç”Ÿæˆç±»åž‹: {result['type']}")
print(f"æç¤ºè¯: {result['prompt']}")

generator.close()
```

### è‡ªåŠ¨è¯†åˆ«è§„åˆ™

ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®ç”¨æˆ·è¾“å…¥è¯†åˆ«ç±»åž‹ï¼š

- **æœ‰äººç‰© + æ— å¤æ‚éœ€æ±‚** â†’ portrait
- **æœ‰äººç‰© + æœ‰åŠ¨ä½œ/ç‰¹æ•ˆ** â†’ cross_domain
- **æœ‰è®¾è®¡é£Žæ ¼å…³é”®è¯** â†’ design

---

## ðŸŒŸ Cross-Domainæ™ºèƒ½è¡¥å……æœºåˆ¶ï¼ˆé‡è¦ï¼ï¼‰

**æ ¸å¿ƒåŽŸåˆ™ï¼šæ•°æ®åº“æä¾›é€šç”¨å…ƒç´ ï¼ŒClaudeè¡¥å……è¯­ä¹‰å†…å®¹ï¼**

### ä¸ºä»€ä¹ˆéœ€è¦æ™ºèƒ½è¡¥å……ï¼Ÿ

æ•°æ®åº“åŒ…å«1,246ä¸ªå…ƒç´ ï¼Œæ¶µç›–ï¼š
- âœ… å…‰å½±æŠ€æœ¯ï¼ˆlighting_techniquesï¼‰
- âœ… æ‘„å½±æŠ€æœ¯ï¼ˆphotography_techniquesï¼‰
- âœ… æž„å›¾æ–¹å¼ï¼ˆposes, compositionsï¼‰
- âœ… æŠ€æœ¯å‚æ•°ï¼ˆtechnical_qualityï¼‰
- âœ… åŸºç¡€äººç‰©ç‰¹å¾ï¼ˆskin, face, eyesç­‰ï¼‰

ä½†æ•°æ®åº“**ä¸å¯èƒ½ç©·ä¸¾**ï¼š
- âŒ æ‰€æœ‰åŠ¨æ¼«IPï¼ˆé¾™ç ã€ç«å½±ã€æµ·è´¼çŽ‹...ï¼‰
- âŒ æ‰€æœ‰è§’è‰²ï¼ˆæ‚Ÿç©ºã€é¸£äººã€è·¯é£ž...ï¼‰
- âŒ æ‰€æœ‰ç‰¹æ®ŠæŠ€èƒ½ï¼ˆé¾Ÿæ´¾æ°”åŠŸã€èžºæ—‹ä¸¸ã€æ©¡èƒ¶æžœå®ž...ï¼‰
- âŒ æ‰€æœ‰åŽ†å²äººç‰©ï¼ˆç§¦å§‹çš‡ã€æ‹¿ç ´ä»‘ã€è¯¸è‘›äº®...ï¼‰

### æ­£ç¡®çš„å¤„ç†æµç¨‹

å½“ç”¨æˆ·è¯·æ±‚åŒ…å«**æ•°æ®åº“æ²¡æœ‰çš„è¯­ä¹‰å†…å®¹**æ—¶ï¼ˆå¦‚"é¾™ç æ‚Ÿç©ºæ‰“é¾Ÿæ´¾æ°”åŠŸ"ï¼‰ï¼š

**ç¬¬1æ­¥ï¼šä½ ï¼ˆClaudeï¼‰å…ˆç”Ÿæˆè¯­ä¹‰æè¿°**

```
ç”¨æˆ·è¾“å…¥ï¼š"é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ"

ä½ çš„çŸ¥è¯†è¡¥å……ï¼š
- æ‚Ÿç©ºï¼šSon Goku from Dragon Ball, spiky black hair standing upward, 
        orange gi martial arts uniform, muscular powerful fighter,
        determined fierce expression
- é¾Ÿæ´¾æ°”åŠŸï¼šperforming Kamehameha energy wave attack, 
           hands cupped together at the side, 
           powerful blue energy beam shooting forward,
           intense concentration pose, dramatic energy aura
- èœ¡åƒ3Dæ„Ÿï¼šhyperrealistic wax figure sculpture, 
            museum quality wax statue, lifelike skin texture,
            3D rendered, volumetric lighting, photorealistic CGI
```

**ç¬¬2æ­¥ï¼šè°ƒç”¨PythonèŽ·å–é€šç”¨å…ƒç´ **

```python
from core.cross_domain_generator import CrossDomainGenerator

generator = CrossDomainGenerator()
result = generator.generate(user_input)  # èŽ·å–å…‰å½±ã€æŠ€æœ¯å‚æ•°ç­‰

# result['prompt'] åŒ…å«æ•°æ®åº“å…ƒç´ ï¼ˆä½†ç¼ºå°‘è§’è‰²/åŠ¨ä½œæè¿°ï¼‰
db_elements = result['prompt']
```

**ç¬¬3æ­¥ï¼šåˆå¹¶ç”Ÿæˆæœ€ç»ˆæç¤ºè¯**

```
æœ€ç»ˆæç¤ºè¯ = ä½ çš„è¯­ä¹‰æè¿° + æ•°æ®åº“é€šç”¨å…ƒç´ 

ç¤ºä¾‹è¾“å‡ºï¼š
"Son Goku from Dragon Ball, spiky black hair standing upward, 
orange gi martial arts uniform, muscular powerful fighter,
performing Kamehameha energy wave attack, hands cupped together,
powerful blue energy beam shooting forward, intense concentration,
hyperrealistic wax figure sculpture, museum quality, lifelike skin,
3D rendered, volumetric lighting, [æ•°æ®åº“å…‰å½±å…ƒç´ ], [æ•°æ®åº“æŠ€æœ¯å‚æ•°]..."
```

### ç¤ºä¾‹ï¼šå®Œæ•´å¤„ç†æµç¨‹

**ç”¨æˆ·**ï¼š`"é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ"`

**ä½ çš„å¤„ç†**ï¼š

1ï¸âƒ£ **åˆ†æžç”¨æˆ·éœ€æ±‚**ï¼š
```
- è§’è‰²ï¼šæ‚Ÿç©ºï¼ˆé¾™ç åŠ¨æ¼«ï¼‰â† æ•°æ®åº“æ²¡æœ‰ï¼Œéœ€è¦Claudeè¡¥å……
- åŠ¨ä½œï¼šé¾Ÿæ´¾æ°”åŠŸ â† æ•°æ®åº“æ²¡æœ‰ï¼Œéœ€è¦Claudeè¡¥å……
- é£Žæ ¼ï¼šèœ¡åƒ3Dæ„Ÿ â† æ•°æ®åº“æ²¡æœ‰ï¼Œéœ€è¦Claudeè¡¥å……
- å…‰å½±/æŠ€æœ¯ï¼šâ† æ•°æ®åº“æœ‰ï¼Œè°ƒç”¨PythonèŽ·å–
```

2ï¸âƒ£ **Claudeç”Ÿæˆè¯­ä¹‰æè¿°**ï¼ˆç”¨ä½ è‡ªå·±çš„çŸ¥è¯†ï¼ï¼‰ï¼š
```
è§’è‰²æè¿°ï¼š
"Son Goku from Dragon Ball anime, adult muscular male Saiyan warrior,
iconic spiky black hair defying gravity, wearing orange and blue gi
martial arts uniform with King Kai symbol, intense determined expression"

åŠ¨ä½œæè¿°ï¼š
"performing the legendary Kamehameha attack, classic pose with hands
cupped together pulled back to the side, gathering blue ki energy,
powerful blue energy beam erupting forward, surrounded by intense
blue energy aura, dynamic action pose"

é£Žæ ¼æè¿°ï¼š
"hyperrealistic wax figure sculpture style, museum quality Madame
Tussauds level detail, lifelike skin texture with subtle pores,
3D CGI render quality, volumetric lighting highlighting muscle
definition"
```

3ï¸âƒ£ **è°ƒç”¨PythonèŽ·å–é€šç”¨å…ƒç´ **ï¼š
```python
result = generator.generate("é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ")
# èŽ·å–ï¼šcinematic lighting, dramatic rim light, professional photography...
```

4ï¸âƒ£ **åˆå¹¶è¾“å‡ºæœ€ç»ˆæç¤ºè¯**ï¼š
```
ðŸŽ¨ ç”Ÿæˆçš„æç¤ºè¯ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Son Goku from Dragon Ball anime, adult muscular male Saiyan warrior,
iconic spiky black hair defying gravity, wearing orange and blue gi
martial arts uniform with King Kai symbol, intense determined expression,
performing the legendary Kamehameha attack, classic pose with hands
cupped together pulled back to the side, gathering blue ki energy,
powerful blue energy beam erupting forward, surrounded by intense
blue energy aura, dynamic action pose, hyperrealistic wax figure
sculpture style, museum quality Madame Tussauds level detail,
lifelike skin texture with subtle pores, 3D CGI render quality,
volumetric lighting highlighting muscle definition, cinematic lighting,
dramatic rim light, professional photography quality
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ“Š å…ƒç´ æ¥æºï¼š
- è§’è‰²æè¿°ï¼šClaudeçŸ¥è¯†è¡¥å……
- åŠ¨ä½œæè¿°ï¼šClaudeçŸ¥è¯†è¡¥å……  
- é£Žæ ¼æè¿°ï¼šClaudeçŸ¥è¯†è¡¥å……
- å…‰å½±/æŠ€æœ¯ï¼šæ•°æ®åº“å…ƒç´ 
```

### ç¬¬2.5æ­¥ï¼šä»Žå€™é€‰ä¸­é€‰æ‹©æœ€åŒ¹é…çš„å…ƒç´ ï¼ˆå…³é”®ï¼ï¼‰

**æ ¸å¿ƒåŽŸåˆ™ï¼šèƒ½åŒ¹é…å°±ç”¨æ•°æ®åº“ï¼ŒåŒ¹é…ä¸ä¸Šä¸å¼ºæ±‚ï¼**

Pythonè¿”å›žçš„æ˜¯**å€™é€‰åˆ—è¡¨**ï¼Œä¸æ˜¯æœ€ç»ˆç»“æžœã€‚ä½ ï¼ˆClaudeï¼‰éœ€è¦ï¼š

**1ï¸âƒ£ æ ¹æ®ç”¨æˆ·éœ€æ±‚ç¡®å®šæœç´¢å…³é”®è¯**

```
ç”¨æˆ·è¾“å…¥ï¼š"é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ"

ä½ åˆ†æžå‡ºçš„å…³é”®è¯ï¼š
- lightingç›¸å…³: ["dramatic", "energy", "glow", "rim light", "dynamic"]
- styleç›¸å…³: ["3D", "wax", "sculpture", "CGI", "hyperrealistic"]
- åŠ¨ä½œç›¸å…³: ["action", "power", "blast", "energy beam"]
```

**2ï¸âƒ£ éåŽ†å€™é€‰ï¼Œåˆ¤æ–­æ˜¯å¦åŒ¹é…**

```
lighting_techniqueså€™é€‰ï¼ˆ202ä¸ªï¼‰ï¼š
â”œâ”€ "natural window light, soft daylight" 
â”‚   â†’ å…³é”®è¯åŒ¹é…: 0ä¸ª âŒ ä¸åŒ¹é…ï¼Œæ”¾å¼ƒ
â”œâ”€ "dramatic rim light, edge lighting"
â”‚   â†’ å…³é”®è¯åŒ¹é…: dramatic, rim light âœ… åŒ¹é…ï¼é€‰ä¸­
â”œâ”€ "neon glow, colorful lighting"
â”‚   â†’ å…³é”®è¯åŒ¹é…: glow âœ… éƒ¨åˆ†åŒ¹é…ï¼Œå¤‡é€‰
â””â”€ ...

art_styleså€™é€‰ï¼ˆ30ä¸ªï¼‰ï¼š
â”œâ”€ "watercolor painting style"
â”‚   â†’ å…³é”®è¯åŒ¹é…: 0ä¸ª âŒ ä¸åŒ¹é…ï¼Œæ”¾å¼ƒ
â”œâ”€ "oil painting classical"
â”‚   â†’ å…³é”®è¯åŒ¹é…: 0ä¸ª âŒ ä¸åŒ¹é…ï¼Œæ”¾å¼ƒ
â”œâ”€ "anime cel shading"
â”‚   â†’ å…³é”®è¯åŒ¹é…: 0ä¸ª âŒ ä¸åŒ¹é…ï¼Œæ”¾å¼ƒ
â””â”€ ï¼ˆéåŽ†å®Œï¼Œæ²¡æœ‰wax/3D/sculptureç›¸å…³ï¼‰
    â†’ âš ï¸ æ•´ä¸ªcategoryåŒ¹é…ä¸ä¸Šï¼Œä¸å¼ºæ±‚ï¼ç”±Claudeè¡¥å……
```

**3ï¸âƒ£ åŒ¹é…è§„åˆ™**

| æƒ…å†µ | å¤„ç†æ–¹å¼ |
|------|---------|
| å€™é€‰å…³é”®è¯åŒ…å«ç”¨æˆ·éœ€æ±‚ | âœ… é€‰ä¸­è¯¥å…ƒç´  |
| éƒ¨åˆ†åŒ¹é…ï¼ˆ1-2ä¸ªå…³é”®è¯ï¼‰ | âš ï¸ å¤‡é€‰ï¼Œçœ‹æ•´ä½“ä¸€è‡´æ€§ |
| å®Œå…¨ä¸åŒ¹é… | âŒ æ”¾å¼ƒï¼Œä¸è¦ç¡¬å¡ž |
| æ•´ä¸ªcategoryéƒ½åŒ¹é…ä¸ä¸Š | âš ï¸ è¯¥categoryç”±Claudeè¡¥å…… |

**4ï¸âƒ£ ç¤ºä¾‹ï¼šå®Œæ•´çš„é€‰æ‹©è¿‡ç¨‹**

```
ç”¨æˆ·ï¼š"é¾™ç æ‚Ÿç©ºæ‰“å‡ºé¾Ÿæ´¾æ°”åŠŸçš„èœ¡åƒ3Dæ„Ÿ"

ã€lighting_techniquesã€‘202ä¸ªå€™é€‰
  æœç´¢å…³é”®è¯: dramatic, energy, glow, rim, dynamic, power
  
  éåŽ†ç»“æžœ:
  - "natural window light" â†’ åŒ¹é…0ä¸ª â†’ æ”¾å¼ƒ
  - "soft diffused lighting" â†’ åŒ¹é…0ä¸ª â†’ æ”¾å¼ƒ
  - "dramatic rim light" â†’ åŒ¹é…2ä¸ª(dramatic, rim) â†’ âœ… é€‰ä¸­ï¼
  - "cinematic lighting" â†’ åŒ¹é…1ä¸ª(dynamicæ„Ÿè§‰ç›¸å…³) â†’ å¤‡é€‰
  
  æœ€ç»ˆé€‰æ‹©: "dramatic rim light, cinematic lighting"

ã€art_stylesã€‘30ä¸ªå€™é€‰
  æœç´¢å…³é”®è¯: 3D, wax, sculpture, CGI, hyperrealistic
  
  éåŽ†ç»“æžœ:
  - "watercolor" â†’ åŒ¹é…0ä¸ª â†’ æ”¾å¼ƒ
  - "anime style" â†’ åŒ¹é…0ä¸ª â†’ æ”¾å¼ƒ
  - ... (å…¨éƒ¨éåŽ†)
  - æ²¡æœ‰ä»»ä½•å€™é€‰åŒ¹é… wax/3D/sculpture
  
  æœ€ç»ˆé€‰æ‹©: âš ï¸ æ— åŒ¹é…ï¼Œç”±Claudeè¡¥å……

ã€photography_techniquesã€‘50ä¸ªå€™é€‰
  æœç´¢å…³é”®è¯: action, dynamic, motion, blur
  
  éåŽ†ç»“æžœ:
  - "portrait photography" â†’ åŒ¹é…0ä¸ª â†’ æ”¾å¼ƒ
  - "dynamic action shot" â†’ åŒ¹é…2ä¸ª(dynamic, action) â†’ âœ… é€‰ä¸­ï¼
  
  æœ€ç»ˆé€‰æ‹©: "dynamic action shot"
```

**5ï¸âƒ£ æœ€ç»ˆç»„åˆ**

```
æœ€ç»ˆæç¤ºè¯ = 
  Claudeè¡¥å……ï¼ˆæ•°æ®åº“æ²¡æœ‰/åŒ¹é…ä¸ä¸Šçš„ï¼‰:
    - æ‚Ÿç©ºå¤–è²Œæè¿°
    - é¾Ÿæ´¾æ°”åŠŸåŠ¨ä½œæè¿°
    - èœ¡åƒ3Dé£Žæ ¼æè¿°ï¼ˆart_stylesåŒ¹é…ä¸ä¸Šï¼‰
  +
  æ•°æ®åº“é€‰ä¸­ï¼ˆåŒ¹é…ä¸Šçš„ï¼‰:
    - dramatic rim lightï¼ˆlightingåŒ¹é…ä¸Šäº†ï¼‰
    - dynamic action shotï¼ˆphotographyåŒ¹é…ä¸Šäº†ï¼‰
    - cinematic qualityï¼ˆtechnicalåŒ¹é…ä¸Šäº†ï¼‰
```

---

### ä»€ä¹ˆæ—¶å€™éœ€è¦Claudeè¡¥å……ï¼Ÿ

| å†…å®¹ç±»åž‹ | æ•°æ®åº“æœ‰ï¼Ÿ | å¤„ç†æ–¹å¼ |
|---------|----------|---------|
| å…‰å½±æŠ€æœ¯ | âœ… æœ‰ | ä»Žå€™é€‰ä¸­é€‰æ‹©åŒ¹é…çš„ |
| æ‘„å½±å‚æ•° | âœ… æœ‰ | ä»Žå€™é€‰ä¸­é€‰æ‹©åŒ¹é…çš„ |
| åŸºç¡€äººç‰©ç‰¹å¾ | âœ… æœ‰ | ä»Žå€™é€‰ä¸­é€‰æ‹©åŒ¹é…çš„ |
| åŠ¨æ¼«è§’è‰² | âŒ æ²¡æœ‰ | **Claudeè¡¥å……** |
| æ¸¸æˆè§’è‰² | âŒ æ²¡æœ‰ | **Claudeè¡¥å……** |
| ç‰¹æ®ŠæŠ€èƒ½/åŠ¨ä½œ | âŒ æ²¡æœ‰ | **Claudeè¡¥å……** |
| åŽ†å²äººç‰© | âŒ æ²¡æœ‰ | **Claudeè¡¥å……** |
| ç‰¹å®šIPé£Žæ ¼ | âŒ æ²¡æœ‰ | **Claudeè¡¥å……** |
| æ•°æ®åº“æœ‰ä½†åŒ¹é…ä¸ä¸Š | âš ï¸ æœ‰ä½†ä¸åŒ¹é… | **Claudeè¡¥å……** |

### Claudeè¡¥å……æ—¶çš„è´¨é‡è¦æ±‚

âœ… **å¿…é¡»è¯¦ç»†æè¿°è§†è§‰ç‰¹å¾**ï¼š
```
âŒ é”™è¯¯ï¼š"Goku"ï¼ˆå¤ªç®€å•ï¼‰
âœ… æ­£ç¡®ï¼š"Son Goku from Dragon Ball, spiky black hair standing upward,
        orange gi uniform, muscular build, fierce determined expression"
```

âœ… **å¿…é¡»ä½¿ç”¨è‹±æ–‡**ï¼ˆå› ä¸ºå¤§å¤šæ•°å›¾åƒç”Ÿæˆæ¨¡åž‹ç”¨è‹±æ–‡è®­ç»ƒï¼‰

âœ… **å¿…é¡»åŒ…å«å…³é”®è§†è§‰å…ƒç´ **ï¼š
- è§’è‰²ï¼šå¤–è²Œã€æœè£…ã€å‘åž‹ã€è¡¨æƒ…
- åŠ¨ä½œï¼šå§¿åŠ¿ã€æ‰‹åŠ¿ã€è¿åŠ¨æ–¹å‘
- ç‰¹æ•ˆï¼šé¢œè‰²ã€å½¢æ€ã€å…‰æ•ˆ

âœ… **é£Žæ ¼æè¿°è¦å…·ä½“**ï¼š
```
âŒ é”™è¯¯ï¼š"3D style"ï¼ˆå¤ªæ¨¡ç³Šï¼‰
âœ… æ­£ç¡®ï¼š"hyperrealistic wax figure sculpture, museum quality,
        lifelike skin texture, volumetric lighting, photorealistic CGI"
```

---

## ðŸŽ¯ æ¡†æž¶ç³»ç»Ÿï¼ˆFramework Systemï¼‰

**é‡è¦**ï¼šæœ¬ç³»ç»ŸåŸºäºŽ `prompt_framework.yaml` æ¡†æž¶é…ç½®æ–‡ä»¶ã€‚

### æ¡†æž¶å®šä¹‰äº†ä»€ä¹ˆï¼š

1. **7å¤§ç±»ç»“æž„**ï¼šsubjectï¼ˆä¸»ä½“ï¼‰ã€facialï¼ˆé¢éƒ¨ï¼‰ã€stylingï¼ˆé€ åž‹ï¼‰ã€expressionï¼ˆè¡¨çŽ°ï¼‰ã€lightingï¼ˆå…‰å½±ï¼‰ã€sceneï¼ˆåœºæ™¯ï¼‰ã€technicalï¼ˆæŠ€æœ¯ï¼‰

2. **æ‰€æœ‰å¯ç”¨å­—æ®µ**ï¼šæ¯ä¸ªç±»åˆ«æœ‰å“ªäº›å­—æ®µï¼Œå“ªäº›å¿…é€‰ï¼Œå“ªäº›å¯é€‰

3. **å­—æ®µåˆ°æ•°æ®åº“çš„æ˜ å°„**ï¼šæ¯ä¸ªå­—æ®µå¯¹åº”å“ªä¸ª `db_category`ï¼Œä½¿ç”¨å“ªäº› `search_keywords`

4. **ä¾èµ–è§„åˆ™**ï¼šå­—æ®µä¹‹é—´çš„è‡ªåŠ¨æŽ¨å¯¼ï¼ˆå¦‚ era=ancient â†’ makeup=traditional_chineseï¼‰

5. **éªŒè¯è§„åˆ™**ï¼šå®Œæ•´æ€§å’Œä¸€è‡´æ€§æ£€æŸ¥

### ä½ å¦‚ä½•ä½¿ç”¨æ¡†æž¶ï¼š

**æ­¥éª¤0ï¼ˆè‡ªåŠ¨ï¼‰**ï¼šç³»ç»Ÿå·²åŠ è½½æ¡†æž¶ï¼Œä½ å¯ä»¥ç›´æŽ¥æŒ‰æ¡†æž¶å¡«å……Intent

**å…³é”®åŽŸåˆ™**ï¼š
- âœ… æŒ‰ç…§æ¡†æž¶çš„7å¤§ç±»ç»“æž„å¡«å……Intent
- âœ… å¿…é€‰å­—æ®µå¿…é¡»å¡«ï¼ˆstyling.makeup, lighting.lighting_typeç­‰ï¼‰
- âœ… æ¡†æž¶ä¼šè‡ªåŠ¨åº”ç”¨ä¾èµ–è§„åˆ™ï¼ˆå¦‚å¤è£…è‡ªåŠ¨æŽ¨å¯¼å¦†å®¹ï¼‰
- âœ… ä»£ç ä¼šæ ¹æ®æ¡†æž¶è‡ªåŠ¨æŸ¥è¯¢æ•°æ®åº“

**ç¤ºä¾‹Intentç»“æž„**ï¼š
```json
{
  "subject": {...},
  "facial": {...},
  "styling": {
    "makeup": "traditional_chinese"  // â† æ¡†æž¶å®šä¹‰çš„å­—æ®µï¼Œä»£ç è‡ªåŠ¨è¯†åˆ«
  },
  "lighting": {
    "lighting_type": "cinematic"
  },
  "scene": {...},
  "technical": {...}
}
```

---

## æ ¸å¿ƒèƒ½åŠ›

### 1. è¯­ä¹‰ç†è§£
ä½ èƒ½å¤Ÿå‡†ç¡®ç†è§£ç”¨æˆ·è¾“å…¥ï¼ŒåŒºåˆ†ï¼š
- **ä¸»ä½“å±žæ€§**ï¼ˆäººç‰©çš„å›ºæœ‰ç‰¹å¾ï¼šæ€§åˆ«ã€äººç§ã€å¹´é¾„ï¼‰
- **è§†è§‰é£Žæ ¼**ï¼ˆå‘ˆçŽ°æ–¹å¼ï¼šåŠ¨æ¼«ã€å†™å®žã€æ°´å¢¨ã€æ²¹ç”»ï¼‰
- **åœºæ™¯æ°›å›´**ï¼ˆçŽ¯å¢ƒï¼šèµ›åšæœ‹å…‹ã€å¤é£Žã€æœªæ¥ã€å¥‡å¹»ï¼‰

### 2. å¸¸è¯†æŽ¨ç†
ä½ çŸ¥é“åŸºæœ¬çš„äººç±»å­¦å¸¸è¯†ï¼š
- ä¸œäºšäººé€šå¸¸æ˜¯é»‘è‰²/æ·±æ£•/æ£•è‰²çœ¼ç›ï¼Œé»‘è‰²/æ·±æ£•å¤´å‘
- æ¬§æ´²äººå¯èƒ½æœ‰è“/ç»¿/æ£•/ç°è‰²çœ¼ç›ï¼Œé‡‘/æ£•/é»‘/çº¢å‘
- "åŠ¨æ¼«é£Žæ ¼"æ˜¯ç»˜ç”»æŠ€æ³•ï¼Œä¸ä¼šæ”¹å˜äººç‰©çš„äººç§ç‰¹å¾
- "èµ›åšæœ‹å…‹"æ˜¯åœºæ™¯æ°›å›´ï¼ˆéœ“è™¹ç¯ã€ç§‘æŠ€æ„Ÿï¼‰ï¼Œä¸æ˜¯äººç‰©å±žæ€§

### 3. ä¸€è‡´æ€§æ£€æŸ¥
ä½ èƒ½æ£€æµ‹å¹¶ä¿®æ­£é€»è¾‘å†²çªï¼š
- äººç§ vs çœ¼ç›é¢œè‰²/å‘è‰²çš„ä¸åŒ¹é…
- é£Žæ ¼å…³é”®è¯ vs äººç‰©å±žæ€§çš„æ··æ·†
- é‡å¤æˆ–çŸ›ç›¾çš„å…ƒç´ 

---

## å·¥ä½œæµç¨‹

å½“ç”¨æˆ·è¯·æ±‚ç”Ÿæˆæç¤ºè¯æ—¶ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š

### æ­¥éª¤1ï¼šç†è§£ç”¨æˆ·æ„å›¾å¹¶æž„é€ å®Œæ•´Intent

**é‡è¦**ï¼šæ¯ä¸ªintentå¿…é¡»åŒ…å«**å®Œæ•´çš„å¿…é€‰å…ƒç´ **ï¼Œå¦‚æžœç”¨æˆ·æœªæ˜Žç¡®æŒ‡å®šï¼Œä½ å¿…é¡»æ™ºèƒ½è¡¥å……é»˜è®¤å€¼ã€‚

---

#### å¿…é€‰å…ƒç´ ï¼ˆREQUIREDï¼‰

**æ ¸å¿ƒåŽŸåˆ™**ï¼šå…¨é¢æå–ç”¨æˆ·éœ€æ±‚çš„**æ‰€æœ‰æ¡ä»¶**ï¼Œä¸é—æ¼ä»»ä½•å…³é”®ä¿¡æ¯ï¼

**1. subjectï¼ˆä¸»ä½“ï¼‰**
- `gender`: ä»Žç”¨æˆ·è¾“å…¥è¯†åˆ«ï¼Œé»˜è®¤ `"female"`
- `ethnicity`: ä¸­æ–‡è¯­å¢ƒé»˜è®¤ `"East_Asian"`ï¼Œè‹±æ–‡è¯­å¢ƒæ ¹æ®æè¿°æŽ¨æ–­
- `age_range`: é»˜è®¤ `"young_adult"`

**2. clothingï¼ˆæœè£…ï¼‰** â† **æ–°å¢žï¼å¿…é¡»è¯†åˆ«æœè£…é£Žæ ¼**

æ ¹æ®ç”¨æˆ·è¾“å…¥è¯†åˆ«ï¼š

| ç”¨æˆ·è¾“å…¥ | clothingå€¼ | è¯´æ˜Ž |
|---------|-----------|------|
| "å¤è£…"ã€"ä¼ ç»Ÿæœé¥°"ã€"æ±‰æœ" | `"traditional_chinese"` | ä¸­å›½ä¼ ç»Ÿæœè£… |
| "å’Œæœ" | `"kimono"` | æ—¥æœ¬ä¼ ç»Ÿæœè£… |
| "çŽ°ä»£"ã€"æ—¶å°š"ã€æ— ç‰¹åˆ«è¯´æ˜Ž | `"modern"` | çŽ°ä»£æœè£…ï¼ˆé»˜è®¤ï¼‰|
| "èŒä¸šè£…"ã€"è¥¿è£…" | `"business"` | èŒä¸šè£… |
| "ä¼‘é—²" | `"casual"` | ä¼‘é—²è£… |
| "ç¤¼æœ" | `"formal"` | æ­£å¼ç¤¼æœ |

**3. hairstyleï¼ˆå‘åž‹ï¼‰** â† **æ–°å¢žï¼æœè£…åŒ¹é…å‘åž‹**

æ ¹æ®clothingè‡ªåŠ¨åŒ¹é…ï¼š

| clothing | hairstyle | è¯´æ˜Ž |
|----------|-----------|------|
| `traditional_chinese` | `"ancient_chinese"` | å¤ä»£å‘é«»ã€ç°ªèŠ± |
| `kimono` | `"traditional_japanese"` | ä¼ ç»Ÿæ—¥å¼å‘åž‹ |
| `modern` | `"modern"` | çŽ°ä»£å‘åž‹ï¼ˆé»˜è®¤ï¼‰|

**4. makeupï¼ˆå¦†å®¹ï¼‰** â† **æ–°å¢žï¼æ ¹æ®æ—¶ä»£å’Œæ–‡åŒ–èƒŒæ™¯**

æ ¹æ®era + æ–‡åŒ–èƒŒæ™¯è‡ªåŠ¨åŒ¹é…ï¼š

| æ¡ä»¶ | makeupå€¼ | è¯´æ˜Ž |
|------|---------|------|
| era=`ancient` + ä¸­å›½æ–‡åŒ– | `"traditional_chinese"` | ä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹ |
| era=`ancient` + æ—¥æœ¬æ–‡åŒ– | `"traditional_japanese"` | ä¼ ç»Ÿæ—¥å¼å¦†å®¹ |
| era=`ancient` + å…¶ä»–æ–‡åŒ– | `"traditional"` | ç›¸åº”ä¼ ç»Ÿå¦†å®¹ |
| era=`modern` + æ— ç‰¹æ®Šé£Žæ ¼ | `"natural"` | è‡ªç„¶çŽ°ä»£å¦†å®¹ï¼ˆé»˜è®¤ï¼‰|
| era=`modern` + ç”¨æˆ·æ˜Žç¡®è¦æ±‚éŸ©ç³» | `"k_beauty"` | éŸ©ç³»å¦†å®¹ |
| era=`modern` + ç”¨æˆ·æ˜Žç¡®è¦æ±‚ä¸­ç³» | `"c_beauty"` | ä¸­ç³»å¦†å®¹ |

**åŒ¹é…é€»è¾‘**ï¼š
- "å¤è£…"ã€"ä»™å‰‘å¥‡ä¾ ä¼ "ã€"æ­¦ä¾ " â†’ ä¸­å›½å¤ä»£èƒŒæ™¯ â†’ `makeup: "traditional_chinese"`
- "å’Œæœ"ã€"å¿è€…" â†’ æ—¥æœ¬å¤ä»£èƒŒæ™¯ â†’ `makeup: "traditional_japanese"`
- çŽ°ä»£åœºæ™¯ + æ— ç‰¹æ®Šè¦æ±‚ â†’ `makeup: "natural"`

**5. eraï¼ˆæ—¶ä»£èƒŒæ™¯ï¼‰** â† **å½±å“æ•´ä½“æ°›å›´**

| ç”¨æˆ·è¾“å…¥ | eraå€¼ | è¯´æ˜Ž |
|---------|-------|------|
| "å¤ä»£"ã€"å¤è£…" | `"ancient"` | å¤ä»£èƒŒæ™¯ |
| "æ°‘å›½" | `"republic_of_china"` | æ°‘å›½æ—¶æœŸ |
| "çŽ°ä»£"ã€æ— ç‰¹åˆ«è¯´æ˜Ž | `"modern"` | çŽ°ä»£ï¼ˆé»˜è®¤ï¼‰|

**6. lightingï¼ˆå…‰å½±ï¼‰** â† **æ ¸å¿ƒæ”¹è¿›ï¼šæ¯ä¸ªäººåƒå¿…é¡»æœ‰å…‰å½±ï¼**

æ ¹æ®ç”¨æˆ·è¾“å…¥é€‰æ‹©ï¼š

| ç”¨æˆ·è¾“å…¥ | lightingå€¼ | è¯´æ˜Ž |
|---------|-----------|------|
| æ— ç‰¹æ®Šè¯´æ˜Ž | `"natural"` | è‡ªç„¶å…‰ï¼ˆé»˜è®¤ï¼‰ |
| "ç”µå½±çº§"ã€"cinematic" | `"cinematic"` | ç”µå½±ç¯å…‰ |
| "å¼ è‰ºè°‹"ã€"å¼ è‰ºè°‹ç”µå½±" | `"zhang_yimou"` | æˆå‰§æ€§å…‰å½± |
| "é»‘è‰²ç”µå½±"ã€"film noir" | `"film_noir"` | é«˜å¯¹æ¯”å…‰å½± |
| "èµ›åšæœ‹å…‹" | `"neon"` | éœ“è™¹ç¯å…‰ |
| "æŸ”å…‰"ã€"soft" | `"soft"` | æŸ”å’Œå…‰çº¿ |
| "æˆå‰§"ã€"dramatic" | `"dramatic"` | æˆå‰§æ€§ç¯å…‰ |

**7. atmosphereï¼ˆæ°›å›´ï¼‰**
- `theme`: åœºæ™¯ä¸»é¢˜ï¼Œé»˜è®¤ `"natural"`
- `director_style`: å¯¼æ¼”/ç‰¹æ®Šé£Žæ ¼ï¼ˆè¯†åˆ«ç‰¹å®šå¯¼æ¼”æˆ–é£Žæ ¼æµæ´¾ï¼‰

**å¯¼æ¼”é£Žæ ¼è¯†åˆ«è¡¨**ï¼š

| ç”¨æˆ·è¾“å…¥ | director_style | ç‰¹å¾ |
|---------|---------------|------|
| "å¾å…‹"ã€"å¾å…‹é£Žæ ¼" | `"tsui_hark"` | æ­¦ä¾ ã€é£˜é€¸ã€åŠ¨æ„Ÿ |
| "å¼ è‰ºè°‹" | `"zhang_yimou"` | æˆå‰§æ€§å…‰å½±ã€çº¢é‡‘è‰²è°ƒ |
| "çŽ‹å®¶å«" | `"wong_kar_wai"` | æ€€æ—§ã€æ°›å›´æ„Ÿã€è‰²å½©æµ“éƒ |
| "æ­¦ä¾ " | `"wuxia"` | æ­¦ä¾ æ°›å›´ |
| "å¤è£…å‰§" | `"period_drama"` | å¤è£…å‰§æ°›å›´ |

---

#### å¯é€‰å…ƒç´ ï¼ˆOPTIONALï¼‰

**8. visual_styleï¼ˆè§†è§‰é£Žæ ¼ï¼‰**
- `art_style`: å¦‚ `"anime"`, `"realistic"`, `"illustration"`

**9. special_requirementsï¼ˆç‰¹æ®Šè¦æ±‚ï¼‰**
- ç”¨æˆ·çš„å…¶ä»–ç‰¹æ®Šéœ€æ±‚ï¼ˆé£˜é€¸ã€åŠ¨æ„Ÿã€ç¥žç§˜ç­‰ï¼‰

---

#### Intentæž„é€ ç¤ºä¾‹

**ç¤ºä¾‹0ï¼šç”¨æˆ·è¯´"å¾å…‹é£Žæ ¼çš„ç”µå½±çº§çš„å¹´è½»å¥³å­å¤è£…å›¾ç‰‡"** â† **å®Œæ•´éœ€æ±‚æå–ç¤ºèŒƒ**

**ä½ çš„å…¨é¢åˆ†æž**ï¼ˆæå–æ‰€æœ‰æ¡ä»¶ï¼‰ï¼š
```json
{
  "subject": {
    "gender": "female",
    "ethnicity": "East_Asian",
    "age_range": "young_adult",
    "reasoning": "å¹´è½»å¥³å­ â†’ ä¸œäºšå¥³æ€§"
  },
  "clothing": "traditional_chinese",  // â† "å¤è£…" â†’ ä¸­å›½ä¼ ç»Ÿæœè£…ï¼
  "hairstyle": "ancient_chinese",     // â† è‡ªåŠ¨åŒ¹é…ï¼šå¤è£…â†’å¤ä»£å‘åž‹ï¼
  "makeup": "traditional_chinese",    // â† è‡ªåŠ¨åŒ¹é…ï¼šå¤è£…+ä¸­å›½â†’ä¼ ç»Ÿä¸­å¼å¦†å®¹ï¼
  "era": "ancient",                   // â† "å¤è£…" â†’ å¤ä»£èƒŒæ™¯ï¼
  "lighting": "cinematic",            // â† "ç”µå½±çº§" â†’ ç”µå½±ç¯å…‰ï¼
  "atmosphere": {
    "theme": "period_drama",          // â† "å¤è£…" â†’ å¤è£…å‰§æ°›å›´
    "director_style": "tsui_hark",    // â† "å¾å…‹" â†’ æ­¦ä¾ ã€é£˜é€¸ã€åŠ¨æ„Ÿï¼
    "special": ["wuxia", "flowing", "dynamic"]  // â† å¾å…‹ç‰¹å¾
  },
  "visual_style": {
    "art_style": "cinematic"
  }
}
```

**å…³é”®**ï¼š
- âœ… "å¤è£…" â†’ æå–äº†4ä¸ªæ¡ä»¶ï¼šclothing, hairstyle, makeup, era
- âœ… "å¾å…‹é£Žæ ¼" â†’ è¯†åˆ«å¯¼æ¼”ç‰¹å¾ï¼šæ­¦ä¾ ã€é£˜é€¸
- âœ… "ç”µå½±çº§" â†’ lighting = cinematic
- âœ… **æ‰€æœ‰æ¡ä»¶éƒ½è¢«è¯†åˆ«ï¼Œæ²¡æœ‰é—æ¼ï¼**

---

**ç¤ºä¾‹1ï¼šç”¨æˆ·è¯´"ç”Ÿæˆä¸€ä¸ªå¥³å­©"**

**ä½ çš„åˆ†æž**ï¼ˆè¡¥å……æ‰€æœ‰é»˜è®¤å€¼ï¼‰ï¼š
```json
{
  "subject": {
    "gender": "female",
    "ethnicity": "East_Asian",
    "age_range": "young_adult",
    "reasoning": "ä¸­æ–‡è¯­å¢ƒï¼Œè¡¥å……é»˜è®¤å€¼"
  },
  "clothing": "modern",     // â† é»˜è®¤çŽ°ä»£æœè£…
  "hairstyle": "modern",    // â† é»˜è®¤çŽ°ä»£å‘åž‹
  "makeup": "natural",      // â† é»˜è®¤è‡ªç„¶å¦†å®¹
  "era": "modern",          // â† é»˜è®¤çŽ°ä»£èƒŒæ™¯
  "lighting": "natural",    // â† é»˜è®¤è‡ªç„¶å…‰
  "atmosphere": {
    "theme": "natural"
  }
}
```

**ç¤ºä¾‹2ï¼šç”¨æˆ·è¯´"èµ›åšæœ‹å…‹é£Žæ ¼çš„åŠ¨æ¼«å°‘å¥³"**

**ä½ çš„åˆ†æž**ï¼š
```json
{
  "subject": {
    "gender": "female",
    "age_range": "young_adult",
    "ethnicity": "East_Asian",
    "reasoning": "ä¸­æ–‡'å°‘å¥³' â†’ ä¸œäºšå¥³æ€§"
  },
  "makeup": "natural",      // â† çŽ°ä»£åœºæ™¯ï¼Œé»˜è®¤è‡ªç„¶å¦†å®¹
  "visual_style": {
    "art_style": "anime",
    "reasoning": "'åŠ¨æ¼«'æ˜¯ç»˜ç”»æŠ€æ³•ï¼Œä¸æ”¹å˜äººç‰©å±žæ€§"
  },
  "lighting": "neon",  // â† è¯†åˆ«"èµ›åšæœ‹å…‹" â†’ éœ“è™¹ç¯å…‰
  "atmosphere": {
    "theme": "cyberpunk",
    "reasoning": "'èµ›åšæœ‹å…‹'æ˜¯åœºæ™¯æ°›å›´ï¼Œä½¿ç”¨éœ“è™¹ç¯å…‰"
  }
}
```

**ç¤ºä¾‹3ï¼šç”¨æˆ·è¯´"ç”µå½±çº§çš„äºšæ´²å¥³æ€§ï¼Œå¼ è‰ºè°‹ç”µå½±é£Žæ ¼"**

**ä½ çš„åˆ†æž**ï¼š
```json
{
  "subject": {
    "gender": "female",
    "ethnicity": "East_Asian",
    "age_range": "young_adult"
  },
  "makeup": "natural",        // â† çŽ°ä»£åœºæ™¯ï¼Œé»˜è®¤è‡ªç„¶å¦†å®¹
  "visual_style": {
    "art_style": "cinematic"
  },
  "lighting": "zhang_yimou",  // â† è¯†åˆ«å¯¼æ¼”é£Žæ ¼ â†’ æˆå‰§æ€§å…‰å½±
  "atmosphere": {
    "theme": "cinematic",
    "director_style": "zhang_yimou",
    "reasoning": "å¼ è‰ºè°‹é£Žæ ¼éœ€è¦æˆå‰§æ€§å…‰å½±ï¼ˆdramatic shadows, rim lighting, chiaroscuroï¼‰"
  }
}
```

**ç¤ºä¾‹4ï¼šç”¨æˆ·è¯´"ä»™å‰‘å¥‡ä¾ ä¼ çœŸäººç”µå½±é£Žæ ¼çš„å¹´è½»å¤è£…å¥³å­"** â† **æ¡†æž¶æ ¼å¼ç¤ºä¾‹**

**ä½ çš„åˆ†æžï¼ˆæŒ‰æ¡†æž¶7å¤§ç±»ç»“æž„ï¼‰**ï¼š
```json
{
  "subject": {
    "gender": "female",
    "ethnicity": "East_Asian",
    "age_range": "young_adult"
  },
  "styling": {
    "clothing": "traditional_chinese",    // â† "å¤è£…" â†’ ä¸­å›½ä¼ ç»Ÿæœè£…
    "hairstyle": "ancient_chinese",       // â† å¤è£… â†’ å¤ä»£å‘åž‹
    "makeup": "traditional_chinese"       // â† å¤è£…+ä¸­å›½ â†’ ä¼ ç»Ÿä¸­å¼å¦†å®¹ï¼ˆä¸æ˜¯k_beautyï¼ï¼‰
  },
  "lighting": {
    "lighting_type": "cinematic"          // â† "ç”µå½±çº§" â†’ ç”µå½±ç¯å…‰
  },
  "scene": {
    "era": "ancient",                     // â† "å¤è£…" â†’ å¤ä»£èƒŒæ™¯
    "atmosphere": "fantasy"               // â† "ä»™å‰‘å¥‡ä¾ ä¼ " â†’ ä»™ä¾ å¥‡å¹»
  },
  "technical": {
    "art_style": "cinematic"              // â† "çœŸäººç”µå½±" â†’ ç”µå½±çº§å†™å®ž
  }
}
```

**å…³é”®**ï¼š
- âœ… æŒ‰æ¡†æž¶7å¤§ç±»ç»“æž„ç»„ç»‡Intent
- âœ… styling.makeup = "traditional_chinese"ï¼ˆä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹ï¼ŒNOT k_beautyï¼ï¼‰
- âœ… æ¡†æž¶ä¼šè‡ªåŠ¨åº”ç”¨ä¾èµ–è§„åˆ™
- âœ… ä»£ç ä¼šè‡ªåŠ¨è¯»å–æ¡†æž¶æŸ¥è¯¢æ•°æ®åº“

---

#### å…³é”®åŽŸåˆ™

âœ… **æ¯ä¸ªintentå¿…é¡»åŒ…å«lightingå’Œmakeupå­—æ®µ**ï¼ˆå³ä½¿ç”¨æˆ·æ²¡è¯´ï¼‰
âœ… **makeupç”±eraå’Œæ–‡åŒ–èƒŒæ™¯å†³å®š**ï¼šå¤è£…+ä¸­å›½ â†’ traditional_chinese
âœ… "åŠ¨æ¼«é£Žæ ¼" = ç»˜ç”»æŠ€æ³•ï¼ˆå¦‚ä½•ç”»ï¼‰ï¼Œä¸æ˜¯äººç‰©å±žæ€§ï¼ˆç”»ä»€ä¹ˆï¼‰
âœ… "èµ›åšæœ‹å…‹" = åœºæ™¯æ°›å›´ â†’ lightingåº”ä¸º"neon"ï¼ˆéœ“è™¹ç¯å…‰ï¼‰
âœ… "å°‘å¥³"ï¼ˆä¸­æ–‡è¯­å¢ƒï¼‰â†’ æŽ¨æ–­ä¸ºä¸œäºšå¥³æ€§
âœ… **å…‰å½±å’Œå¦†å®¹æ˜¯ç…§ç‰‡çš„åŸºç¡€å…ƒç´ ï¼Œä¸æ˜¯è£…é¥°ï¼**

---

### æ­¥éª¤2ï¼šæŸ¥è¯¢æ‰€æœ‰å€™é€‰å…ƒç´ 

**ä»£ç è´Ÿè´£æŸ¥è¯¢ï¼ŒSKILLè´Ÿè´£é€‰æ‹©**ï¼š

```python
from framework_loader import FrameworkDrivenGenerator

# åˆ›å»ºæ¡†æž¶é©±åŠ¨ç”Ÿæˆå™¨
gen = FrameworkDrivenGenerator()

# ä½ åœ¨æ­¥éª¤1æž„é€ çš„Intent
intent = {
    'subject': {'gender': 'female', 'ethnicity': 'East_Asian', 'age_range': 'young_adult'},
    'styling': {'makeup': 'traditional_chinese'},
    'lighting': {'lighting_type': 'cinematic'},
    'scene': {'era': 'ancient', 'atmosphere': 'fantasy'},
    'technical': {'art_style': 'cinematic'}
}

# æŸ¥è¯¢æ‰€æœ‰å€™é€‰å…ƒç´ ï¼ˆä¸åšé€‰æ‹©ï¼Œè¿”å›žæ‰€æœ‰ï¼‰
candidates = gen.query_all_candidates_by_framework(intent)

# è¿”å›žç»“æžœç¤ºä¾‹ï¼š
# {
#   'styling.makeup': [11ä¸ªå¦†å®¹å€™é€‰],
#   'lighting.lighting_type': [202ä¸ªå…‰å½±å€™é€‰],
#   'facial.eyes': [10ä¸ªçœ¼åž‹å€™é€‰],
#   ...
# }
```

**è¿™ä¸€æ­¥ä»£ç åšä»€ä¹ˆï¼š**
- âœ… æŸ¥è¯¢æ•°æ®åº“ï¼Œè¿”å›žæ¯ä¸ªå­—æ®µçš„æ‰€æœ‰å€™é€‰å…ƒç´ 
- âœ… æ¯ä¸ªå€™é€‰éƒ½åŒ…å«ï¼šåç§°ã€ä¸­æ–‡åã€æ¨¡æ¿ã€å…³é”®è¯ã€è¯„åˆ†
- âŒ ä¸åšé€‰æ‹©ï¼ˆä»£ç ä¸çŸ¥é“å“ªä¸ªæœ€åˆé€‚ï¼‰

---

### æ­¥éª¤3ï¼šSKILLåˆ†æžå’Œé€‰æ‹©æœ€ä¼˜å…ƒç´  â­

**è¿™æ˜¯æ ¸å¿ƒæ­¥éª¤ï¼ä½ ï¼ˆSKILLï¼‰è¦ä»Žå€™é€‰ä¸­é€‰å‡ºæœ€ä¼˜ç»„åˆ**

#### è¾“å…¥ä¿¡æ¯

1. **ç”¨æˆ·åŽŸå§‹éœ€æ±‚**ï¼šå¦‚"ä»™å‰‘å¥‡ä¾ ä¼ çœŸäººç”µå½±é£Žæ ¼çš„å¹´è½»å¤è£…å¥³å­"
2. **Intent**ï¼šæ­¥éª¤1æž„é€ çš„ç»“æž„åŒ–æ„å›¾
3. **æ‰€æœ‰å€™é€‰å…ƒç´ **ï¼šæ¯ä¸ªå­—æ®µçš„å®Œæ•´å€™é€‰åˆ—è¡¨ï¼ˆå¸¦è¯„åˆ†ï¼‰

#### åˆ†æžç»´åº¦

**å¿…é¡»è€ƒè™‘çš„ç»´åº¦**ï¼ˆä»Žç®€å•åˆ°å¤æ‚ï¼‰ï¼š

**ç»´åº¦1ï¼šè¯­ä¹‰åŒ¹é…** â­â­â­
```
ç”¨æˆ·è¦æ±‚ï¼šä»™å‰‘å¥‡ä¾ ä¼ å¤è£…å¥³å­
Intentï¼šmakeup = 'traditional_chinese'

å€™é€‰åˆ—è¡¨ï¼ˆstyling.makeupï¼‰ï¼š
1. éŸ©ç³»å¦†å®¹ (K-beauty) - è¯„åˆ† 9.8 âŒ éŸ©å›½çŽ°ä»£ï¼Œä¸åŒ¹é…
2. ä¸­ç³»å¦†å®¹ (C-beauty) - è¯„åˆ† 9.7 âœ“ ä¸­å›½çŽ°ä»£ï¼Œéƒ¨åˆ†åŒ¹é…
3. ä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹ - è¯„åˆ† 8.0 âœ… ä¸­å›½å¤ä»£ï¼Œå®Œç¾ŽåŒ¹é…ï¼

é€‰æ‹©ï¼šä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹ï¼ˆè™½ç„¶è¯„åˆ†ä½Žï¼Œä½†è¯­ä¹‰æœ€åŒ¹é…ï¼‰
```

**ç»´åº¦2ï¼šæ–‡åŒ–ä¸€è‡´æ€§** â­â­
```
å¦‚æžœé€‰äº†ï¼š
- clothing: æ±‰æœä¼ ç»Ÿæœé¥° âœ…
- hairstyle: ä¼ ç»Ÿä¸­å¼å‘é«» âœ…
- makeup: å°åº¦ä¼ ç»Ÿå¦†å®¹ âŒ ä¸ä¸€è‡´ï¼

ä¿®æ­£ï¼šmakeupä¹Ÿè¦é€‰ä¸­å¼
```

**ç»´åº¦3ï¼šæ—¶ä»£ä¸€è‡´æ€§** â­â­
```
åœºæ™¯ï¼šera = 'ancient'ï¼ˆå¤ä»£ï¼‰

æ£€æŸ¥æ‰€æœ‰å…ƒç´ ï¼š
- makeup: traditional_chinese âœ… å¤ä»£å¦†å®¹
- lighting: neon âŒ éœ“è™¹ç¯æ˜¯çŽ°ä»£çš„ï¼

ä¿®æ­£ï¼šå¤ä»£åœºæ™¯ä¸è¦ç”¨çŽ°ä»£å…ƒç´ 
```

**ç»´åº¦4ï¼šç”Ÿç‰©å­¦ä¸€è‡´æ€§** â­
```
subject.ethnicity = 'East_Asian'

çœ¼ç›å€™é€‰ï¼š
- blue eyes âŒ ä¸œäºšäººä¸ä¼šæœ‰è“çœ¼ç›
- green eyes âŒ ä¸œäºšäººä¸ä¼šæœ‰ç»¿çœ¼ç›
- almond brown eyes âœ… ç¬¦åˆä¸œäºšäººç‰¹å¾

é€‰æ‹©ï¼šalmond brown eyes
```

**ç»´åº¦5ï¼šæ•´ä½“åè°ƒæ€§** â­â­
```
ç”¨æˆ·è¦æ±‚ï¼šç”µå½±çº§çš„å¤è£…å¥³å­

æ£€æŸ¥å…ƒç´ é£Žæ ¼æ˜¯å¦ç»Ÿä¸€ï¼š
- lighting: cinematic âœ…
- clothing: traditional âœ…
- makeup: traditional âœ…
- hairstyle: traditional âœ…

æ‰€æœ‰å…ƒç´ é£Žæ ¼ä¸€è‡´ â†’ å¥½ï¼
```

**ç»´åº¦6ï¼šç»“æž„å®Œæ•´æ€§** â­â­â­
```
æ£€æŸ¥å¿…é€‰å­—æ®µï¼š
- makeupå­—æ®µï¼šâœ“ é€‰åˆ°äº†"ä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹"
- lightingå­—æ®µï¼šâœ“ é€‰åˆ°äº†"cinematic lighting"

æ‰€æœ‰å¿…é€‰å­—æ®µéƒ½æœ‰å…ƒç´  â†’ å®Œæ•´ï¼
```

#### é€‰æ‹©ç­–ç•¥ï¼šä½¿ç”¨å…¨å±€æœ€ä¼˜ç®—æ³• â­

**é‡è¦**ï¼šå¿…é¡»ä½¿ç”¨ `ElementSelector.select_best_element()` å‡½æ•°è¿›è¡Œå…¨å±€æœ€ä¼˜é€‰æ‹©ï¼

**ä¸ºä»€ä¹ˆä¸ç”¨è´ªå¿ƒç­–ç•¥ï¼Ÿ**
```
âŒ è´ªå¿ƒç­–ç•¥ï¼ˆç¬¬ä¸€ä¸ªåŒ¹é…å°±é€‰ï¼‰çš„é—®é¢˜ï¼š
   ç”¨æˆ·ï¼š"å©´å„¿è‚¥çš„æ—¥æœ¬å¥³ç”Ÿ"
   å…³é”®è¯ï¼š['round', 'soft', 'gentle']

   éåŽ†å€™é€‰ï¼š
   1. ç²¾è‡´é¹…è›‹è„¸ - ä¸åŒ…å«'soft' â†’ è·³è¿‡
   2. æŸ”å’Œå¤å…¸è„¸åž‹ - åŒ…å«'soft' â†’ é€‰è¿™ä¸ªï¼åœæ­¢
   3. åœ†è„¸ - åŒ…å«'round'å’Œ'plump' â†’ æ²¡åˆ°è¿™é‡Œ

   ç»“æžœï¼šé€‰äº†"æŸ”å’Œå¤å…¸"ï¼ˆç²¾è‡´ï¼‰ï¼Œè€Œä¸æ˜¯"åœ†è„¸"ï¼ˆä¸°æ»¡ï¼‰
   é—®é¢˜ï¼š'soft'æœ‰æ­§ä¹‰ï¼Œå¯èƒ½æ˜¯ç²¾è‡´çš„æŸ”å’Œï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸°æ»¡çš„æŸ”è½¯
```

**âœ… å…¨å±€æœ€ä¼˜ç­–ç•¥ï¼ˆå¿…é¡»ä½¿ç”¨ï¼‰ï¼š**

```python
from framework_loader import ElementSelector

# å¯¹æ¯ä¸ªå­—æ®µçš„å€™é€‰ï¼Œä½¿ç”¨å…¨å±€æœ€ä¼˜é€‰æ‹©
for field_name, candidates in candidates_dict.items():

    # 1. ç¡®å®šæœç´¢å…³é”®è¯ï¼ˆæ ¹æ®ç”¨æˆ·éœ€æ±‚ï¼‰
    if field_name == 'facial.face_shape':
        # ç”¨æˆ·è¯´"å©´å„¿è‚¥" â†’ ç²¾ç¡®å…³é”®è¯
        keywords = ['round', 'plump', 'full', 'chubby']
    elif field_name == 'styling.makeup':
        # ç”¨æˆ·è¯´"å¤è£…" â†’ ä¼ ç»Ÿä¸­å¼å¦†å®¹
        keywords = ['traditional', 'chinese', 'ancient']
    else:
        keywords = [intent_value]  # ä½¿ç”¨Intentä¸­çš„å€¼

    # 2. è°ƒç”¨å…¨å±€æœ€ä¼˜é€‰æ‹©å‡½æ•°
    best_elem, score = ElementSelector.select_best_element(
        candidates=candidates,           # æ‰€æœ‰å€™é€‰
        user_keywords=keywords,          # ç”¨æˆ·éœ€æ±‚å…³é”®è¯
        user_intent=intent,              # å®Œæ•´Intent
        field_name=field_name,           # å­—æ®µå
        debug=False                      # æ˜¯å¦æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
    )

    # 3. ä¿å­˜é€‰ä¸­çš„å…ƒç´ 
    if best_elem:
        selected_elements[field_name] = best_elem
```

**ElementSelectorçš„å·¥ä½œåŽŸç†**ï¼š

```
å¤šç»´åº¦è¯„åˆ†æœºåˆ¶ï¼ˆ0-100åˆ†ï¼‰ï¼š

1. å…³é”®è¯åŒ¹é…åº¦ï¼ˆ60%ï¼‰
   - ç”¨æˆ·å…³é”®è¯åœ¨å…ƒç´ ä¸­çš„è¦†ç›–çŽ‡
   - ä¾‹å¦‚ï¼š['round', 'plump', 'full'] ä¸­æœ‰2ä¸ªåŒ¹é… â†’ 2/3 = 67% â†’ 40åˆ†

2. å…ƒç´ è´¨é‡è¯„åˆ†ï¼ˆ30%ï¼‰
   - å…ƒç´ çš„reusability_scoreï¼ˆ0-10ï¼‰
   - ä¾‹å¦‚ï¼š9.0 â†’ (9.0/10) * 30 = 27åˆ†

3. è¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥ï¼ˆÂ±10%ï¼‰
   - æ£€æµ‹å†²çª â†’ æ‰£åˆ†ï¼ˆå¦‚ï¼šå©´å„¿è‚¥ vs ç²¾è‡´ â†’ -20åˆ†ï¼‰
   - å®Œç¾ŽåŒ¹é… â†’ åŠ åˆ†ï¼ˆæ‰€æœ‰å…³é”®è¯éƒ½åŒ¹é… â†’ +10åˆ†ï¼‰

æ€»åˆ† = 40 + 27 + 0 = 67åˆ†
```

**å®žé™…æ¡ˆä¾‹å¯¹æ¯”**ï¼š

```
åœºæ™¯ï¼šç”¨æˆ·è¦æ±‚"å©´å„¿è‚¥"

å€™é€‰1: æŸ”å’Œå¤å…¸è„¸åž‹
  - å…³é”®è¯ï¼š['soft classical', 'refined features']
  - åŒ¹é…ï¼š'soft' (1/4) â†’ 15åˆ†
  - è´¨é‡ï¼š9.5 â†’ 28.5åˆ†
  - ä¸€è‡´æ€§ï¼šåŒ…å«'refined'ï¼Œä¸Ž'plump'å†²çª â†’ -20åˆ†
  - æ€»åˆ†ï¼š23.5åˆ†

å€™é€‰2: åœ†è„¸
  - å…³é”®è¯ï¼š['round face', 'plump face', 'full cheeks']
  - åŒ¹é…ï¼š'round', 'plump', 'full' (3/4) â†’ 45åˆ†
  - è´¨é‡ï¼š9.0 â†’ 27åˆ†
  - ä¸€è‡´æ€§ï¼šå®Œç¾ŽåŒ¹é… â†’ +10åˆ†
  - æ€»åˆ†ï¼š82åˆ† âœ… æœ€é«˜ï¼

â†’ é€‰æ‹©"åœ†è„¸"ï¼ˆ82åˆ† > 23.5åˆ†ï¼‰
```

**ä½¿ç”¨å»ºè®®**ï¼š

1. **ç®€å•åœºæ™¯**ï¼š
   - å…³é”®è¯æ˜Žç¡® â†’ ç›´æŽ¥ä½¿ç”¨Intentå€¼ä½œä¸ºkeywords
   - ä¾‹å¦‚ï¼šmakeup='natural' â†’ keywords=['natural']

2. **å¤æ‚åœºæ™¯**ï¼š
   - ç”¨æˆ·æè¿°éœ€è¦ç¿»è¯‘ â†’ æž„é€ ç²¾ç¡®å…³é”®è¯åˆ—è¡¨
   - ä¾‹å¦‚ï¼š"å©´å„¿è‚¥" â†’ keywords=['round', 'plump', 'full', 'chubby']

3. **è°ƒè¯•æ¨¡å¼**ï¼š
   - è®¾ç½® debug=True å¯ä»¥çœ‹åˆ°æ¯ä¸ªå€™é€‰çš„è¯¦ç»†è¯„åˆ†
   - ç”¨äºŽç†è§£ä¸ºä»€ä¹ˆé€‰æ‹©äº†æŸä¸ªå…ƒç´ 

**é»˜è®¤è¡Œä¸º**ï¼š
- æ‰€æœ‰å­—æ®µéƒ½ä½¿ç”¨å…¨å±€æœ€ä¼˜ç­–ç•¥
- è‡ªåŠ¨åº”ç”¨è¯­ä¹‰ä¸€è‡´æ€§æ£€æŸ¥
- ç¡®ä¿é€‰æ‹©çœŸæ­£æœ€åŒ¹é…çš„å…ƒç´ 

#### è¾“å‡ºæ ¼å¼

```python
selected_elements = {
    'styling.makeup': <é€‰ä¸­çš„å¦†å®¹å…ƒç´ >,
    'lighting.lighting_type': <é€‰ä¸­çš„å…‰å½±å…ƒç´ >,
    'facial.eyes': <é€‰ä¸­çš„çœ¼åž‹å…ƒç´ >,
    ...
}

# åˆ†æžæŠ¥å‘Šï¼ˆå¯é€‰ï¼Œå½“ç”¨æˆ·è¦æ±‚è¯¦ç»†æ—¶è¾“å‡ºï¼‰
analysis_report = """
ðŸ“Š å…ƒç´ é€‰æ‹©åˆ†æžï¼š

ã€styling.makeupã€‘
å€™é€‰ï¼š11ä¸ª
é€‰æ‹©ï¼šä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹
ç†ç”±ï¼š
  - è¯­ä¹‰åŒ¹é…ï¼šç”¨æˆ·è¦"å¤è£…"ï¼Œéœ€è¦å¤ä»£ä¸­å¼å¦†å®¹
  - æŽ’é™¤ï¼šéŸ©ç³»ï¼ˆçŽ°ä»£ï¼‰ã€å°åº¦ï¼ˆéžä¸­å¼ï¼‰ã€C-beautyï¼ˆçŽ°ä»£ï¼‰
  - è™½ç„¶è¯„åˆ†ä¸æ˜¯æœ€é«˜ï¼Œä½†è¯­ä¹‰æœ€åŒ¹é…

ã€lighting.lighting_typeã€‘
å€™é€‰ï¼š202ä¸ª
é€‰æ‹©ï¼šcinematic lighting
ç†ç”±ï¼š
  - ç”¨æˆ·æ˜Žç¡®è¦æ±‚"ç”µå½±é£Žæ ¼"
  - åŒ¹é…"çœŸäººç”µå½±"çš„éœ€æ±‚
"""
```

---

### æ­¥éª¤4ï¼šç”Ÿæˆæœ€ç»ˆæç¤ºè¯

å°†é€‰ä¸­çš„å…ƒç´ ç»„åˆæˆæç¤ºè¯ï¼š

```python
# ä½¿ç”¨é€‰ä¸­çš„å…ƒç´ ç”Ÿæˆ
from intelligent_generator import IntelligentGenerator

gen_core = IntelligentGenerator()
prompt = gen_core.compose_prompt(selected_elements, mode='auto', keywords_limit=3)

gen_core.close()
```

---

### æ­¥éª¤5ï¼šè¿”å›žæç¤ºè¯

**å±•ç¤ºæ£€æµ‹åˆ°çš„é—®é¢˜å’Œä¿®æ­£**ï¼š

å¦‚æžœæ£€æµ‹åˆ°å†²çªï¼ˆä¾‹å¦‚ï¼šä¸œäºšäºº + ç»¿çœ¼ç›ï¼‰ï¼Œä½ åº”è¯¥ï¼š

1. **è¯´æ˜Žé—®é¢˜**ï¼š
   ```
   âš ï¸ æ£€æµ‹åˆ°ä¸ä¸€è‡´ï¼š
   - äººç§ï¼šä¸œäºšäºº
   - çœ¼ç›é¢œè‰²ï¼šç»¿è‰²
   - é—®é¢˜ï¼šä¸œäºšäººé€šå¸¸ä¸ä¼šæœ‰ç»¿çœ¼ç›
   ```

2. **è§£é‡ŠåŽŸå› **ï¼š
   ```
   ðŸ’¡ åˆ†æžï¼š
   - 'anime'å…³é”®è¯æœç´¢åˆ°äº†"anime hybrid green eyes"å…ƒç´ 
   - ä½†'anime'æ˜¯ç»˜ç”»é£Žæ ¼ï¼Œä¸åº”è¯¥æ”¹å˜äººç‰©çš„äººç§ç‰¹å¾
   - ç»¿çœ¼ç›æ˜¯æŸäº›åŠ¨æ¼«è§’è‰²çš„è™šæž„ç‰¹å¾ï¼Œä¸ç¬¦åˆä¸œäºšäººçš„çœŸå®žç‰¹å¾
   ```

3. **å±•ç¤ºä¿®æ­£**ï¼š
   ```
   âœ… è‡ªåŠ¨ä¿®æ­£ï¼š
   - ç§»é™¤ï¼šç»¿çœ¼ç›
   - æ›¿æ¢ä¸ºï¼šæ£•è‰²çœ¼ç›ï¼ˆç¬¦åˆä¸œäºšäººç‰¹å¾ï¼‰
   ```

---

### æ­¥éª¤4ï¼šè¿”å›žæç¤ºè¯

ç”Ÿæˆæ ¼å¼ï¼š

```
ðŸŽ¨ ä¸»é¢˜ï¼šèµ›åšæœ‹å…‹é£Žæ ¼çš„åŠ¨æ¼«å°‘å¥³

ðŸ“‹ æ„å›¾è§£æžï¼š
- ä¸»ä½“ï¼šä¸œäºšå¥³æ€§ï¼Œå¹´è½»æˆäºº
- ç»˜ç”»é£Žæ ¼ï¼šåŠ¨æ¼«é£Žæ ¼ï¼ˆçº¿æ¡ã€æ¸²æŸ“æ–¹å¼ï¼‰
- åœºæ™¯æ°›å›´ï¼šèµ›åšæœ‹å…‹ï¼ˆéœ“è™¹ç¯ã€ç§‘æŠ€æ„Ÿï¼‰

âœ… æ™ºèƒ½ä¿®æ­£ï¼ˆå¦‚æžœæœ‰ï¼‰ï¼š
- âœ“ ä¿®æ­£çœ¼ç›é¢œè‰²ï¼š'green eyes' â†’ 'brown eyes'ï¼ˆç¬¦åˆä¸œäºšäººç‰¹å¾ï¼‰
- âœ“ æŽ’é™¤äº†é£Žæ ¼å…³é”®è¯ä¸­çš„äººç‰©å±žæ€§å…ƒç´ 

âœ¨ ç”Ÿæˆçš„æç¤ºè¯ï¼š
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[å®Œæ•´æç¤ºè¯]
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ðŸ’¡ æç¤ºï¼š
- è¯æ•°ï¼šXXä¸ª
- æ¨¡å¼ï¼šautoï¼ˆè‡ªåŠ¨é€‰æ‹©keywordsï¼‰
- å¯å¤åˆ¶æ­¤æç¤ºè¯åˆ°å›¾åƒç”Ÿæˆå·¥å…·ä½¿ç”¨
```

---

### æ­¥éª¤6ï¼šä¿å­˜ç”ŸæˆåŽ†å² â­

**è¿™æ˜¯prompt-analyzerå·¥ä½œçš„å‰æï¼**

æ¯æ¬¡æˆåŠŸç”Ÿæˆæç¤ºè¯åŽï¼Œå¿…é¡»ä¿å­˜åˆ°æ•°æ®åº“ï¼Œä»¥ä¾¿åŽç»­åˆ†æžå’ŒæŽ¨èã€‚

#### æ‰§è¡Œä¿å­˜

```python
from intelligent_generator import save_generated_prompt

# ä¿å­˜ç”Ÿæˆçš„Prompt
prompt_id = save_generated_prompt(
    prompt_text=final_prompt,           # å®Œæ•´æç¤ºè¯
    user_intent="ä»™å‰‘å¥‡ä¾ ä¼ å¤è£…å¥³å­",    # ç”¨æˆ·åŽŸå§‹éœ€æ±‚
    elements_used=selected_elements,     # ä½¿ç”¨çš„å…ƒç´ åˆ—è¡¨
    style_tag="ancient_chinese",         # é£Žæ ¼æ ‡ç­¾
    quality_score=9.0                    # SKILLè¯„ä¼°çš„è´¨é‡ï¼ˆå¯é€‰ï¼‰
)

print(f"âœ… Promptå·²ä¿å­˜ï¼ŒID: #{prompt_id}")
```

#### elements_usedæ ¼å¼è¦æ±‚

æ¯ä¸ªå…ƒç´ å¿…é¡»åŒ…å«ï¼š
- `element_id`: å…ƒç´ IDï¼ˆå¿…é¡»ï¼‰
- `category`: ç±»åˆ«ï¼ˆå¦‚makeup_styles, lighting_techniquesï¼‰
- `field_name`: å­—æ®µåï¼ˆå¦‚styling.makeup, lighting.lighting_typeï¼‰

ç¤ºä¾‹ï¼š
```python
selected_elements = [
    {
        'element_id': 'portrait_makeup_styles_003',
        'name': 'traditional_chinese_makeup',
        'chinese_name': 'ä¼ ç»Ÿå¤é£Žä¸­å¼å¦†å®¹',
        'template': 'traditional Chinese makeup with soft red lips...',
        'category': 'makeup_styles',
        'field_name': 'styling.makeup',
        'reusability': 8.0
    },
    # ... å…¶ä»–å…ƒç´ 
]
```

#### ä¿å­˜åŽæ•°æ®æµå‘

```
save_generated_prompt()
    â†“
å†™å…¥ generated_prompts è¡¨      # PromptåŸºæœ¬ä¿¡æ¯
    â†“
å†™å…¥ prompt_elements è¡¨        # Prompt-å…ƒç´ å…³è”
    â†“
æ›´æ–° element_usage_stats è¡¨   # å…ƒç´ ä½¿ç”¨ç»Ÿè®¡
    â†“
è¿”å›ž prompt_id
    â†“
prompt-analyzer å¯ä»¥åˆ†æžè¿™ä¸ªPromptäº†ï¼
```

#### æ³¨æ„äº‹é¡¹

1. **å¿…é¡»è°ƒç”¨**ï¼šç”ŸæˆæˆåŠŸåŽå¿…é¡»ä¿å­˜ï¼Œå¦åˆ™prompt-analyzeræ— æ³•å·¥ä½œ
2. **style_tagè§„èŒƒ**ï¼š
   - ancient_chinese (å¤è£…ä¸­å¼)
   - modern_sci_fi (çŽ°ä»£ç§‘å¹»)
   - traditional_japanese (ä¼ ç»Ÿæ—¥å¼)
   - cyberpunk (èµ›åšæœ‹å…‹)
   - fantasy (å¥‡å¹»)
3. **è´¨é‡è¯„åˆ†**ï¼šSKILLåº”æ ¹æ®ä»¥ä¸‹ç»´åº¦è¯„ä¼°ï¼ˆé»˜è®¤9.0ï¼‰ï¼š
   - è¯­ä¹‰åŒ¹é…åº¦
   - ä¸€è‡´æ€§ï¼ˆæ— å†²çªï¼‰
   - å®Œæ•´æ€§ï¼ˆæ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼‰
   - å…ƒç´ è´¨é‡ï¼ˆå¹³å‡reusabilityï¼‰

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šå¼ è‰ºè°‹ç”µå½±é£Žæ ¼ï¼ˆå¯¼æ¼”é£Žæ ¼ + æˆå‰§æ€§å…‰å½±ï¼‰

**ç”¨æˆ·**ï¼š`"ç”Ÿæˆç”µå½±çº§çš„äºšæ´²å¥³æ€§ï¼Œå¼ è‰ºè°‹ç”µå½±é£Žæ ¼"`

**ä½ çš„å¤„ç†**ï¼š
1. **è§£æžintent**ï¼ˆæ­¥éª¤1ï¼‰ï¼š
```python
intent = {
    'subject': {
        'gender': 'female',
        'ethnicity': 'East_Asian',
        'age_range': 'young_adult'
    },
    'lighting': 'zhang_yimou',  # â† è¯†åˆ«å¯¼æ¼”é£Žæ ¼ï¼
    'visual_style': {
        'art_style': 'cinematic'
    },
    'atmosphere': {
        'theme': 'cinematic',
        'director_style': 'zhang_yimou'
    }
}
```

2. **è°ƒç”¨Python**ï¼ˆæ­¥éª¤2ï¼‰ï¼šç³»ç»Ÿæ ¹æ®lighting='zhang_yimou'æ·»åŠ å…‰å½±å…³é”®è¯
3. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šâœ… æ— å†²çªï¼ˆä¸œäºšå¥³æ€§ + é»‘çœ¼ç›ï¼‰
4. **è¿”å›žæç¤ºè¯**ï¼šåŒ…å«dramatic shadows, rim lighting, chiaroscuroç­‰å…‰å½±å…ƒç´ 

---

### ç¤ºä¾‹2ï¼šèµ›åšæœ‹å…‹åŠ¨æ¼«å°‘å¥³ï¼ˆéœ“è™¹å…‰å½±ï¼‰

**ç”¨æˆ·**ï¼š`"ç”Ÿæˆèµ›åšæœ‹å…‹é£Žæ ¼çš„åŠ¨æ¼«å°‘å¥³æç¤ºè¯"`

**ä½ çš„å¤„ç†**ï¼š
1. **è§£æžintent**ï¼ˆæ­¥éª¤1ï¼‰ï¼š
```python
intent = {
    'subject': {
        'gender': 'female',
        'ethnicity': 'East_Asian',
        'age_range': 'young_adult'
    },
    'lighting': 'neon',  # â† èµ›åšæœ‹å…‹ â†’ éœ“è™¹ç¯å…‰ï¼
    'visual_style': {
        'art_style': 'anime'
    },
    'atmosphere': {
        'theme': 'cyberpunk'
    }
}
```

2. **è°ƒç”¨Python**ï¼ˆæ­¥éª¤2ï¼‰ï¼šç³»ç»Ÿæ ¹æ®lighting='neon'é€‰æ‹©éœ“è™¹ç¯å…‰å…ƒç´ 
3. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šæ£€æµ‹åˆ°ç»¿çœ¼ç›é—®é¢˜ â†’ è‡ªåŠ¨ä¿®æ­£ä¸ºæ£•è‰²çœ¼ç›
4. **è¿”å›žæç¤ºè¯**ï¼šåŒ…å«neon lighting, colorful glowç­‰éœ“è™¹å…‰å½±

---

### ç¤ºä¾‹3ï¼šæ™®é€šå¥³å­©ï¼ˆé»˜è®¤è‡ªç„¶å…‰ï¼‰

**ç”¨æˆ·**ï¼š`"ç”Ÿæˆä¸€ä¸ªå¥³å­©"`

**ä½ çš„å¤„ç†**ï¼š
1. **è§£æžintent**ï¼ˆæ­¥éª¤1ï¼Œè¡¥å……æ‰€æœ‰é»˜è®¤å€¼ï¼‰ï¼š
```python
intent = {
    'subject': {
        'gender': 'female',
        'ethnicity': 'East_Asian',      # ä¸­æ–‡è¯­å¢ƒé»˜è®¤
        'age_range': 'young_adult'      # é»˜è®¤
    },
    'lighting': 'natural',  # â† ç”¨æˆ·æœªè¯´æ˜Ž â†’ é»˜è®¤è‡ªç„¶å…‰ï¼
    'atmosphere': {
        'theme': 'natural'
    }
}
```

2. **è°ƒç”¨Python**ï¼ˆæ­¥éª¤2ï¼‰ï¼šç³»ç»Ÿæ ¹æ®lighting='natural'é€‰æ‹©è‡ªç„¶å…‰å…ƒç´ 
3. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šâœ… æ— å†²çª
4. **è¿”å›žæç¤ºè¯**ï¼šåŒ…å«natural window light, soft daylightç­‰è‡ªç„¶å…‰å½±

**å…³é”®**ï¼šå³ä½¿ç”¨æˆ·æ²¡æœ‰æåˆ°ä»»ä½•é£Žæ ¼ï¼Œlightingå­—æ®µä¹Ÿå¿…é¡»å­˜åœ¨ï¼

---

### ç¤ºä¾‹4ï¼šæ¬§æ´²å¤å…¸æ²¹ç”»

**ç”¨æˆ·**ï¼š`"ç”Ÿæˆä¸€ä¸ªæ¬§æ´²è´µæ—å¥³æ€§çš„å¤å…¸æ²¹ç”»é£Žæ ¼è‚–åƒ"`

**ä½ çš„å¤„ç†**ï¼š
1. **è§£æžintent**ï¼ˆæ­¥éª¤1ï¼‰ï¼š
```python
intent = {
    'subject': {
        'gender': 'female',
        'ethnicity': 'European',
        'age_range': 'adult'
    },
    'lighting': 'soft',  # â† å¤å…¸æ²¹ç”» â†’ æŸ”å’Œå…‰çº¿
    'visual_style': {
        'art_style': 'oil_painting'
    },
    'atmosphere': {
        'theme': 'classical'
    }
}
```

2. **è°ƒç”¨Python**ï¼šæ¬§æ´²äººå¯ä»¥æœ‰è“/ç»¿/æ£•è‰²çœ¼ç›ï¼ˆéƒ½åˆç†ï¼‰
3. **ä¸€è‡´æ€§æ£€æŸ¥**ï¼šâœ… æ— å†²çª
4. **è¿”å›žæç¤ºè¯**ï¼šåŒ…å«soft lighting, classical portraitç­‰å…ƒç´ 

---

### ç¤ºä¾‹5ï¼šæ£€æµ‹å¤æ‚å†²çª

**ç”¨æˆ·**ï¼š`"ç”Ÿæˆä¸€ä¸ªé»‘çš®è‚¤çš„ç‘žå…¸äºº"`

**ä½ çš„å¤„ç†**ï¼š
1. æ£€æµ‹åˆ°å†²çªï¼šç‘žå…¸äººï¼ˆåŒ—æ¬§ï¼‰é€šå¸¸ä¸æ˜¯é»‘çš®è‚¤
2. è¯¢é—®ç”¨æˆ·ï¼š
   ```
   âš ï¸ æ£€æµ‹åˆ°ä¸å¸¸è§çš„ç»„åˆï¼š
   - ç‘žå…¸äºº + é»‘çš®è‚¤

   è¿™å¯èƒ½æ˜¯ï¼š
   A. ç‘žå…¸ç±éžæ´²è£”äººå£«ï¼ˆç§»æ°‘/åŽä»£ï¼‰
   B. è¾“å…¥é”™è¯¯

   è¯·ç¡®è®¤ï¼š
   1. ä¿æŒåŽŸæ ·ï¼ˆç‘žå…¸ç±éžæ´²è£”ï¼‰
   2. ä¿®æ”¹ä¸ºå…¸åž‹ç‘žå…¸äººï¼ˆç™½çš™çš®è‚¤ï¼‰
   3. ä¿®æ”¹ä¸ºéžæ´²äºº
   ```

---

## é‡è¦åŽŸåˆ™

### âœ… DOï¼ˆåº”è¯¥åšï¼‰

1. **åŒºåˆ†é£Žæ ¼å’Œå±žæ€§**
   - "åŠ¨æ¼«é£Žæ ¼" â†’ å½±å“å‘ˆçŽ°æ–¹å¼
   - "ä¸œäºšäºº" â†’ å›ºæœ‰å±žæ€§

2. **åº”ç”¨å¸¸è¯†**
   - ä¸œäºšäºº â†’ é»‘/æ£•çœ¼ç›
   - æ¬§æ´²äºº â†’ å¤šç§çœ¼ç›é¢œè‰²

3. **è‡ªåŠ¨ä¿®æ­£æ˜Žæ˜¾å†²çª**
   - ä¸œäºšäºº+ç»¿çœ¼ç› â†’ è‡ªåŠ¨æ”¹ä¸ºæ£•è‰²

4. **è¯¢é—®è¾¹ç•Œæƒ…å†µ**
   - ä¸å¸¸è§ä½†å¯èƒ½åˆç†çš„ç»„åˆ â†’ è¯¢é—®ç”¨æˆ·

### âŒ DON'Tï¼ˆä¸åº”è¯¥åšï¼‰

1. **ä¸è¦æœºæ¢°åŒ¹é…å…³é”®è¯**
   - âŒ æœç´¢'anime'å°±æ·»åŠ æ‰€æœ‰åŒ…å«animeçš„å…ƒç´ 
   - âœ… ç†è§£'anime'æ˜¯ç”»é£Žï¼Œåªæ·»åŠ é£Žæ ¼å…ƒç´ 

2. **ä¸è¦å¿½è§†å¸¸è¯†**
   - âŒ å…è®¸ä¸œäºšäººæœ‰ç»¿çœ¼ç›ï¼ˆé™¤éžæ˜¯cosplayç­‰ç‰¹æ®Šæƒ…å†µï¼‰
   - âœ… æ£€æŸ¥å¹¶ä¿®æ­£ä¸ç¬¦åˆå¸¸è¯†çš„ç»„åˆ

3. **ä¸è¦è¿‡åº¦é™åˆ¶**
   - âŒ å®Œå…¨ç¦æ­¢"ç©¿å’Œæœçš„æ³•å›½äºº"ï¼ˆå¯èƒ½æ˜¯æ—…æ¸¸/æ–‡åŒ–äº¤æµï¼‰
   - âœ… æç¤ºä¸å¸¸è§ï¼Œä½†å…è®¸ç”¨æˆ·å†³å®š

---

## è°ƒç”¨æ–¹æ³•

ç”¨æˆ·å¯ä»¥ç›´æŽ¥è¯´ï¼š
- "ç”ŸæˆXXXæç¤ºè¯"
- "å¸®æˆ‘ç”ŸæˆXXXçš„å›¾åƒæç¤ºè¯"
- "æˆ‘æƒ³è¦XXXé£Žæ ¼çš„å›¾ç‰‡"

ä½ è‡ªåŠ¨ï¼š
1. ç†è§£æ„å›¾
2. è°ƒç”¨Python
3. æ£€æŸ¥ä¸€è‡´æ€§
4. è¿”å›žå®Œç¾Žæç¤ºè¯

---

## æŠ€æœ¯ç»†èŠ‚

### Pythonæ¨¡å—è·¯å¾„
`intelligent_generator.py` åœ¨é¡¹ç›®æ ¹ç›®å½•

### æ ¸å¿ƒæ–¹æ³•
```python
gen = IntelligentGenerator()

# é€‰æ‹©å…ƒç´ 
elements = gen.select_elements_by_intent(intent)

# æ£€æŸ¥ä¸€è‡´æ€§
issues = gen.check_consistency(elements)

# ä¿®æ­£å†²çª
elements, fixes = gen.resolve_conflicts(elements, issues)

# ç”Ÿæˆæç¤ºè¯
prompt = gen.compose_prompt(elements, mode='auto')
```

### å¸¸è¯†çŸ¥è¯†åº“
åœ¨ `IntelligentGenerator.load_knowledge()` ä¸­å®šä¹‰ï¼ŒåŒ…æ‹¬ï¼š
- äººç§ â†’ å…¸åž‹çœ¼ç›é¢œè‰²
- äººç§ â†’ å…¸åž‹å‘è‰²
- é£Žæ ¼ç±»åž‹å®šä¹‰
- å¯¼æ¼”é£Žæ ¼ â†’ å…‰å½±éœ€æ±‚æ˜ å°„

---

## âš ï¸ é‡è¦æé†’

**æ¯æ¬¡ç”Ÿæˆæç¤ºè¯æ—¶ï¼Œä½ å¿…é¡»ï¼š**

1. âœ… **åœ¨intentä¸­åŒ…å«lightingå­—æ®µ**ï¼ˆå¿…é€‰ï¼Œä¸æ˜¯å¯é€‰ï¼ï¼‰
2. âœ… **æ ¹æ®æ­¥éª¤1çš„æ˜ å°„è¡¨é€‰æ‹©lightingå€¼**
3. âœ… **å¦‚æžœç”¨æˆ·æ²¡è¯´é£Žæ ¼ï¼Œä½¿ç”¨é»˜è®¤å€¼** `lighting: 'natural'`

**é”™è¯¯ç¤ºä¾‹**ï¼š
```python
# âŒ é”™è¯¯ï¼šç¼ºå°‘lightingå­—æ®µ
intent = {
    'subject': {'gender': 'female'},
    'atmosphere': {'theme': 'natural'}
}
```

**æ­£ç¡®ç¤ºä¾‹**ï¼š
```python
# âœ… æ­£ç¡®ï¼šåŒ…å«lightingå­—æ®µ
intent = {
    'subject': {'gender': 'female'},
    'lighting': 'natural',  # â† å¿…é¡»æœ‰ï¼
    'atmosphere': {'theme': 'natural'}
}
```

**è®°ä½**ï¼šå…‰å½±æ˜¯ç…§ç‰‡çš„åŸºç¡€å…ƒç´ ï¼Œä¸æ˜¯è£…é¥°ï¼æ¯ä¸ªäººåƒéƒ½å¿…é¡»æœ‰å…‰å½±ï¼Œå°±åƒæ¯ä¸ªäººç‰©éƒ½å¿…é¡»æœ‰æ€§åˆ«ä¸€æ ·ã€‚

---

å‡†å¤‡å¥½å¼€å§‹å·¥ä½œï¼ç­‰å¾…ç”¨æˆ·çš„æç¤ºè¯ç”Ÿæˆè¯·æ±‚ã€‚



================================================
FILE: .claude/skills/product-master/skill.md
================================================
---
name: product-master
description: äº§å“æ‘„å½±ä¸»æŽ§ - è‡ªåŠ¨ç”Ÿæˆäº§å“æ‘„å½±æç¤ºè¯ï¼Œæ”¯æŒå•†ä¸šæ‹æ‘„ã€ç”µå•†å›¾ç‰‡ç­‰åœºæ™¯
---

# Product Master - äº§å“æ‘„å½±ä¸»æŽ§ Skill

**ç‰ˆæœ¬**: 1.0
**é¢†åŸŸ**: äº§å“æ‘„å½±
**æž¶æž„**: Master-Subordinate
**æ•°æ®æº**: Universal Elements Database

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„äº§å“æ‘„å½±æç¤ºè¯ï¼Œæ”¯æŒï¼š
- ðŸ“¦ å¤šç§äº§å“ç±»åž‹ï¼ˆä¹¦ç±ã€ç”µå­äº§å“ã€é£Ÿå“ã€æ—¶å°šç­‰ï¼‰
- ðŸ“¸ ä¸“ä¸šæ‘„å½±æŠ€æœ¯ï¼ˆPhase Oneç›¸æœºã€å¾®è·ã€å…‰ç…§è®¾ç½®ï¼‰
- ðŸŽ¨ æè´¨çº¹ç†ï¼ˆçš®é©ã€é‡‘å±žã€çŽ»ç’ƒã€æœ¨æç­‰ï¼‰
- ðŸ’¡ å…‰ç…§å¸ƒå±€ï¼ˆæŸ”å…‰ç®±ã€çŽ¯å½¢å…‰ã€è‡ªç„¶å…‰ç­‰ï¼‰
- ðŸ† é«˜ç«¯è´¨æ„Ÿï¼ˆå¥¢åŽã€ç®€çº¦ã€ç§‘æŠ€ã€å¤å¤ç­‰ï¼‰

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šå¿«é€Ÿç”Ÿæˆ

```
ç”Ÿæˆä¸€ä¸ªé«˜ç«¯ä¹¦ç±äº§å“æ‘„å½±
```

æˆ–

```
äº§å“æ‘„å½±ï¼šæ”¶è—ç‰ˆæ¸¸æˆå‘¨è¾¹
```

### æ–¹å¼2ï¼šè¯¦ç»†å®šåˆ¶

```
ç”Ÿæˆä¸€ä¸ªäº§å“æ‘„å½±ï¼š
- äº§å“ï¼šå¥¢åŽæ‰‹è¡¨
- é£Žæ ¼ï¼šæžç®€é«˜ç«¯
- æè´¨ï¼šé‡‘å±ž+çš®é©
- å…‰ç…§ï¼šæŸ”å’Œåå…‰
```

### æ–¹å¼3ï¼šå‚è€ƒé£Žæ ¼

```
ç”Ÿæˆç±»ä¼¼Prompt #1çš„äº§å“æ‘„å½±ï¼ˆæ”¶è—ç‰ˆä¹¦ç±é£Žæ ¼ï¼‰
```

### æ–¹å¼4ï¼šç½‘æ ¼æ‹¼è´´å¸ƒå±€ï¼ˆGrid Collageï¼‰

**é€‚ç”¨åœºæ™¯**ï¼š
- å¤šè§’åº¦äº§å“å±•ç¤º
- ç”µå•†è¯¦æƒ…é¡µ
- ç¤¾äº¤åª’ä½“å†…å®¹
- äº§å“å¯¹æ¯”å±•ç¤º

**è§¦å‘å…³é”®è¯**ï¼š
- "9å®«æ ¼"ã€"3Ã—3å¸ƒå±€"ã€"grid"
- "å¤šè§’åº¦å±•ç¤º"ã€"å¤šè§†è§’"
- "ä¸­é—´3Dçªå‡º"ã€"3D pop-out"
- "4å®«æ ¼"ã€"2Ã—2å¸ƒå±€"

**ç¤ºä¾‹**ï¼š
```
ç”Ÿæˆ9å®«æ ¼æ‰‹è¡¨äº§å“æ‘„å½±ï¼Œä¸­é—´3Dçªå‡º
```

**Skillä¼šè‡ªåŠ¨ï¼š**
1. è¯†åˆ«è¿™æ˜¯Grid Collageæ¨¡å¼
2. åŠ è½½ä¸“ä¸šæ¡†æž¶æ¨¡æ¿ï¼ˆå‚è€ƒ `modules/layouts/grid_collage.md`ï¼‰
3. ç”ŸæˆåŒ…å«ä»¥ä¸‹ç‰¹æ€§çš„å®Œæ•´æç¤ºè¯ï¼š
   - ä¸¥æ ¼çš„ç½‘æ ¼ç­‰åˆ†å¸ƒå±€ï¼ˆ3Ã—3ã€2Ã—2ç­‰ï¼‰
   - THICK WHITE LINES æ¸…æ™°åˆ†éš”
   - ä¸­é—´æ ¼å­è¢«3Däº§å“å®Œå…¨é®æŒ¡
   - æ·±æ™¯æ·±ï¼ˆf/16ï¼‰ç¡®ä¿æ‰€æœ‰æ ¼å­æ¸…æ™°
   - ä¸“ä¸šæ·±åº¦æ•ˆæžœï¼ˆæŠ•å½±ã€å±‚æ¬¡ã€é¥±å’Œåº¦æå‡ï¼‰
   - å®Œæ•´çš„ä¸€è‡´æ€§æ£€æŸ¥æ¸…å•

**è¾“å‡ºç‰¹ç‚¹**ï¼š
- 8ä¸ªä¸åŒè§’åº¦çš„äº§å“æ‘„å½±ï¼ˆèƒŒæ™¯å±‚ï¼‰
- 1ä¸ªè¶…å¤§3Dæ¸²æŸ“äº§å“ï¼ˆå‰æ™¯å±‚ï¼Œä»Žé¡¶åˆ°åº•å æ»¡ç”»å¸ƒï¼‰
- é®æŒ¡æœºåˆ¶ï¼šä¸­é—´æ ¼å­100%é®æŒ¡ï¼Œå‘¨å›´4æ ¼éƒ¨åˆ†é®æŒ¡
- è¶…çŽ°å®žæ‹¼è´´è‰ºæœ¯æ•ˆæžœ

---

## ðŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥
  â†“
ã€è¯†åˆ«éœ€æ±‚ã€‘
  - äº§å“ç±»åž‹
  - é£Žæ ¼åå¥½
  - æè´¨è¦æ±‚
  â†“
ã€æŸ¥è¯¢æ•°æ®åº“ã€‘builder.md
  - ä»Želements.dbæœç´¢producté¢†åŸŸå…ƒç´ 
  - æŒ‰æ ‡ç­¾ç­›é€‰ï¼ˆluxury, premium, glass...ï¼‰
  - æŒ‰å¤ç”¨æ€§æŽ’åº
  â†“
ã€ç»„è£…Promptã€‘
  1. äº§å“ä¸»ä½“æè¿° (product_types)
  2. æè´¨çº¹ç† (material_textures)
  3. æ‘„å½±æŠ€æœ¯ (photography_techniques)
  4. å…‰ç…§è®¾ç½® (lighting_techniques)
  5. æŠ€æœ¯å‚æ•° (technical_effects)
  6. è´¨é‡å¢žå¼ºè¯
  â†“
ã€è¾“å‡ºå®Œæ•´Promptã€‘
```

---

## ðŸ“Š æ•°æ®æº

**ä¸»è¦åº“**:
- `product` domain (4 elements)
- `common` domain (31 elements)

**å…ƒç´ ç±»åˆ«**:
- `product_types` - äº§å“ç±»åž‹
- `material_textures` - æè´¨çº¹ç†
- `photography_techniques` - æ‘„å½±æŠ€æœ¯
- `lighting_techniques` - å…‰ç…§æŠ€æœ¯
- `technical_effects` - æŠ€æœ¯æ•ˆæžœ

**å¯ç”¨æ ‡ç­¾**:
- `luxury`, `premium`, `high-end`
- `glossy`, `matte`, `reflective`
- `leather`, `metal`, `glass`, `wood`
- `macro`, `editorial`, `commercial`

---

## ðŸŽ¨ æ”¯æŒçš„é£Žæ ¼

- **Luxury Editorial** - å¥¢åŽç¼–è¾‘é£Žæ ¼ï¼ˆæ‚å¿—çº§ï¼‰
- **Minimalist Modern** - æžç®€çŽ°ä»£é£Žæ ¼
- **Tech Premium** - ç§‘æŠ€é«˜ç«¯é£Žæ ¼
- **Vintage Classic** - å¤å¤ç»å…¸é£Žæ ¼
- **Artisanal Craft** - æ‰‹å·¥è‰ºå“é£Žæ ¼

---

## âœ… è¾“å‡ºç¤ºä¾‹

**è¾“å…¥**:
```
ç”Ÿæˆä¸€ä¸ªå¥¢åŽä¹¦ç±äº§å“æ‘„å½±
```

**è¾“å‡º**:
```
Premium collector's edition book photographed with Phase One medium format
camera with 100mm macro lens, sophisticated softbox rim lighting creating
elegant highlights on Italian calfskin leather binding, glossy reflective
surface with high-end finish, metallic gold-embossed details, 4K ultra high
resolution, shallow depth of field isolating the subject, editorial magazine
quality photography, razor-sharp macro focus capturing every texture detail,
photorealistic render, professional commercial product shot, luxury brand
aesthetic, pristine studio environment with controlled lighting
```

---

## ðŸ”§ æ¨¡å—è¯´æ˜Ž

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| ä¸»æŽ§ | `skill.md` | æ„å›¾è¯†åˆ«å’Œè·¯ç”± |
| ç»„è£…å™¨ | `modules/core/builder.md` | æŸ¥è¯¢æ•°æ®åº“å¹¶ç»„è£…Prompt |

---

**SkillçŠ¶æ€**: âœ… å·²å®žçŽ°
**æœ€åŽæ›´æ–°**: 2026-01-01
**ç»´æŠ¤è€…**: Universal Library System



================================================
FILE: .claude/skills/product-master/modules/core/builder.md
================================================
# Product Builder - äº§å“Promptç»„è£…å™¨

**åŠŸèƒ½**: ä»ŽUniversal Elements DatabaseæŸ¥è¯¢å…ƒç´ å¹¶ç»„è£…äº§å“æ‘„å½±Prompt

---

## ðŸŽ¯ ç»„è£…ç­–ç•¥

### åŸºç¡€ç»“æž„

```
äº§å“æ‘„å½±Prompt =
  äº§å“æè¿° (20%) +
  æè´¨çº¹ç† (15%) +
  æ‘„å½±æŠ€æœ¯ (25%) +
  å…‰ç…§è®¾ç½® (20%) +
  æŠ€æœ¯å‚æ•° (10%) +
  è´¨é‡å¢žå¼º (10%)
```

---

## ðŸ“‹ ç»„è£…æµç¨‹

### Step 1: æŸ¥è¯¢äº§å“å…ƒç´ 

```python
from element_db import ElementDB

db = ElementDB('extracted_results/elements.db')

# æŸ¥è¯¢äº§å“ç±»åž‹
product_elements = db.search_by_domain(
    'product',
    category_id='product_types',
    min_reusability=6.0
)

# å¦‚æžœç”¨æˆ·æŒ‡å®šäº†æ ‡ç­¾ï¼ˆå¦‚"luxury"ï¼‰
if user_tags:
    product_elements = db.search_by_tags(
        user_tags + ['product'],
        require_all=False
    )
```

### Step 2: æŸ¥è¯¢æè´¨çº¹ç†

```python
# æŸ¥è¯¢æè´¨
materials = db.search_by_domain(
    'product',
    category_id='material_textures',
    min_reusability=7.0,
    limit=2
)

# æˆ–æŒ‰æ ‡ç­¾æŸ¥è¯¢
materials = db.search_by_tags(['glossy', 'leather', 'metal'])
```

### Step 3: æŸ¥è¯¢æ‘„å½±æŠ€æœ¯

```python
# æŸ¥è¯¢ä¸“ä¸šæ‘„å½±æŠ€æœ¯
photo_tech = db.search_by_domain(
    'common',
    category_id='photography_techniques',
    min_reusability=8.0
)

# äº§å“æ‘„å½±å¸¸ç”¨ï¼šmacro, Phase One, editorial
macro_tech = [e for e in photo_tech if 'macro' in e['name'].lower()]
```

### Step 4: æŸ¥è¯¢å…‰ç…§æŠ€æœ¯

```python
# æŸ¥è¯¢å…‰ç…§
lighting = db.search_by_domain(
    'common',
    category_id='lighting_techniques',
    min_reusability=8.0
)

# äº§å“æ‘„å½±å¸¸ç”¨ï¼šsoftbox, rim lighting, studio lighting
product_lighting = [e for e in lighting if any(kw in e['ai_prompt_template'].lower()
                    for kw in ['softbox', 'rim', 'studio'])]
```

### Step 5: æŸ¥è¯¢æŠ€æœ¯æ•ˆæžœ

```python
# æŸ¥è¯¢åˆ†è¾¨çŽ‡ç­‰æŠ€æœ¯å‚æ•°
tech_effects = db.search_by_domain(
    'common',
    category_id='technical_effects',
    min_reusability=9.0
)

# 4K/8K resolution
resolution = [e for e in tech_effects if '4k' in e['name'].lower() or '8k' in e['name'].lower()]
```

---

## ðŸ”§ ç»„è£…ç®—æ³•

```python
def build_product_prompt(
    product_type: str = "premium product",
    style: str = "luxury",
    user_tags: list = None
) -> str:
    """
    ç»„è£…äº§å“æ‘„å½±Prompt

    Args:
        product_type: äº§å“ç±»åž‹ï¼ˆå¦‚"book", "watch", "electronics"ï¼‰
        style: é£Žæ ¼ï¼ˆå¦‚"luxury", "minimalist", "tech"ï¼‰
        user_tags: ç”¨æˆ·æŒ‡å®šçš„æ ‡ç­¾

    Returns:
        å®Œæ•´çš„äº§å“æ‘„å½±Prompt
    """

    db = ElementDB('extracted_results/elements.db')
    prompt_parts = []

    # 1. äº§å“ä¸»ä½“
    if product_type != "premium product":
        # æœç´¢ç‰¹å®šäº§å“
        products = db.search_by_tags([product_type, 'product'])
    else:
        # ä½¿ç”¨é€šç”¨äº§å“æè¿°
        products = db.search_by_domain('product', limit=1)

    if products:
        prompt_parts.append(products[0]['ai_prompt_template'])
    else:
        prompt_parts.append(f"premium {product_type}")

    # 2. æ‘„å½±æŠ€æœ¯ï¼ˆæ ¸å¿ƒï¼‰
    photo_tech = db.search_by_domain('common', category_id='photography_techniques', limit=1)
    if photo_tech:
        prompt_parts.append(photo_tech[0]['ai_prompt_template'])

    # 3. å…‰ç…§è®¾ç½®
    lighting = db.search_by_domain('product', category_id='lighting_techniques', limit=1)
    if lighting:
        prompt_parts.append(lighting[0]['ai_prompt_template'])

    # 4. æè´¨çº¹ç†ï¼ˆå¦‚æžœæœ‰styleè¦æ±‚ï¼‰
    if style and style.lower() in ['luxury', 'premium', 'high-end']:
        materials = db.search_by_tags(['luxury'], require_all=False)
        if materials:
            prompt_parts.append(materials[0]['ai_prompt_template'])

    # 5. æŠ€æœ¯å‚æ•°
    tech = db.search_by_tags(['4k', 'resolution'])
    if tech:
        prompt_parts.append(tech[0]['ai_prompt_template'])

    # 6. è´¨é‡å¢žå¼ºè¯
    quality_enhancers = [
        "photorealistic",
        "ultra-detailed",
        "professional commercial photography",
        "editorial magazine quality",
        "pristine studio environment",
        "perfectly controlled lighting"
    ]

    prompt_parts.extend(quality_enhancers)

    # ç»„è£…
    prompt = ', '.join(prompt_parts)

    db.close()
    return prompt
```

---

## ðŸ“Š è¾“å‡ºç¤ºä¾‹

### ç¤ºä¾‹1: å¥¢åŽä¹¦ç±

**è¾“å…¥**:
```python
build_product_prompt(
    product_type="collector edition book",
    style="luxury"
)
```

**è¾“å‡º**:
```
Premium collector's edition book, luxury binding, Italian calfskin cover,
Phase One medium format camera with 100mm macro lens, sophisticated softbox
rim lighting, 4K resolution, photorealistic, ultra-detailed, professional
commercial photography, editorial magazine quality, pristine studio environment,
perfectly controlled lighting
```

---

### ç¤ºä¾‹2: ç§‘æŠ€äº§å“

**è¾“å…¥**:
```python
build_product_prompt(
    product_type="smartphone",
    style="tech",
    user_tags=["glass", "modern"]
)
```

**è¾“å‡º**:
```
Premium smartphone with glossy glass surface, modern sleek design, Phase One
camera with macro lens capturing screen details, soft studio lighting creating
elegant reflections, 4K ultra high resolution, photorealistic render,
professional tech product photography, minimal background, clean aesthetic
```

---

## âœ… è´¨é‡ä¿è¯

### å¿…å¤‡å…ƒç´ æ£€æŸ¥

æ¯ä¸ªäº§å“Promptåº”åŒ…å«ï¼š
- âœ… äº§å“æè¿°
- âœ… æ‘„å½±æŠ€æœ¯ï¼ˆç›¸æœº/é•œå¤´ï¼‰
- âœ… å…‰ç…§è®¾ç½®
- âœ… åˆ†è¾¨çŽ‡/è´¨é‡å‚æ•°

### é•¿åº¦æŽ§åˆ¶

- ç›®æ ‡: 150-250è¯
- æœ€å°: 100è¯
- æœ€å¤§: 300è¯

---

**æ¨¡å—çŠ¶æ€**: âœ… å·²å®žçŽ°
**æŸ¥è¯¢æ•ˆçŽ‡**: O(log n) ç´¢å¼•æŸ¥è¯¢



================================================
FILE: .claude/skills/product-master/modules/layouts/grid_collage.md
================================================
# Grid Collage å¸ƒå±€æ¨¡æ¿

**ç‰ˆæœ¬**: 1.0
**ç”¨é€”**: å¤šè§’åº¦äº§å“å±•ç¤ºçš„ç½‘æ ¼æ‹¼è´´å¸ƒå±€
**å‚è€ƒ**: åŸºäºŽä¸“ä¸šæ—¶å°šæ‘„å½±çš„9å®«æ ¼æ¡†æž¶

---

## ðŸ“ æ”¯æŒçš„å¸ƒå±€ç±»åž‹

### 3Ã—3 Grid (9å®«æ ¼) - æŽ¨è

**é€‚ç”¨åœºæ™¯**ï¼š
- å…¨æ–¹ä½äº§å“å±•ç¤º
- é«˜ç«¯ç”µå•†è¯¦æƒ…é¡µ
- ç¤¾äº¤åª’ä½“è½®æ’­å›¾
- äº§å“å®£ä¼ æµ·æŠ¥

**ç‰¹ç‚¹**ï¼š
- 8æ ¼å¯è§ + 1æ ¼ä¸­é—´é®æŒ¡ = 9æ ¼æ€»æ•°
- ä¸­é—´3Däº§å“å·¨å¤§çªå‡º
- æœ€ä½³è§†è§‰å†²å‡»åŠ›

### 2Ã—2 Grid (4å®«æ ¼)

**é€‚ç”¨åœºæ™¯**ï¼š
- ç®€æ´å¯¹æ¯”å±•ç¤º
- ç§»åŠ¨ç«¯ä¼˜åŒ–
- å¿«é€Ÿäº§å“é¢„è§ˆ

**ç‰¹ç‚¹**ï¼š
- 4æ ¼å…¨éƒ¨å¯è§æˆ–3æ ¼å¯è§+1æ ¼é®æŒ¡
- é€‚åˆç®€çº¦é£Žæ ¼

### 4Ã—1 Carousel (è½®æ’­æ¡)

**é€‚ç”¨åœºæ™¯**ï¼š
- ç§»åŠ¨ç«¯æ¨ªå‘æ»‘åŠ¨
- äº§å“ç»†èŠ‚å±•ç¤º
- æ•…äº‹åŒ–å™äº‹

**ç‰¹ç‚¹**ï¼š
- æ¨ªå‘4æ ¼æŽ’åˆ—
- é€‚åˆç§»åŠ¨è®¾å¤‡

---

## ðŸŽ¨ 3Ã—3 Grid å®Œæ•´æ¡†æž¶ï¼ˆä¸“ä¸šæ¨¡æ¿ï¼‰

ä»¥ä¸‹æ˜¯ç”¨äºŽç”Ÿæˆ9å®«æ ¼äº§å“æ‘„å½±çš„å®Œæ•´æç¤ºè¯æ¡†æž¶ï¼š

### åŸºç¡€ç»“æž„

```
Create a 2:3 portrait luxury product poster featuring THE SAME [PRODUCT] shown in 9 different product photography styles with 3D pop-out effect:
```

---

### PRODUCT CONSISTENCY (äº§å“ä¸€è‡´æ€§è§„åˆ™)

**CRITICAL - HIGHEST PRIORITY**

THE SAME [äº§å“ç±»åž‹] appears in ALL 9 positions:
- Same product model, same design, same brand
- [äº§å“å…·ä½“æè¿°ï¼šæè´¨ã€é¢œè‰²ã€ç‰¹å¾]
- [å…³é”®ç»†èŠ‚1]
- [å…³é”®ç»†èŠ‚2]
- [å…³é”®ç»†èŠ‚3]
- Its identity NEVER changes across all 9 appearances

**ç¤ºä¾‹ï¼ˆæ‰‹è¡¨ï¼‰**ï¼š
```
THE SAME luxury timepiece appears in ALL 9 positions:
- Same watch model, same design, same brand
- Premium Swiss automatic watch with blue dial
- Stainless steel case with polished and brushed finish
- Blue sunburst dial with applied silver hour markers
- Date window at 3 o'clock position
- Steel bracelet with three-link design
- Sapphire crystal with anti-reflective coating
- Its identity NEVER changes across all 9 appearances
```

---

### BACKGROUND LAYER (Z=0) - 8æ ¼èƒŒæ™¯æ‘„å½±

**Grid Structure & Occlusion:**
- Standard 3Ã—3 layout = 9 product photography shots
- **8 visible cells** (center cell [2,2] COMPLETELY OCCLUDED by 3D product)
- Cells separated by DISTINCT THICK WHITE LINES (3-4px) for clear separation

**8ä¸ªä¸åŒæ‘„å½±è§’åº¦å®šä¹‰**ï¼š

```
[1,1] Top View - [äº§å“é¡¶è§†è§’]:
- Same product, face-up/top-down perspective
- Style: Macro close-up of top details
- Lighting: Soft top light, minimal shadows
- Sharp focus, clear details

[1,2] [å…³é”®ç»†èŠ‚1] Detail:
- Same product, [å…·ä½“è§’åº¦]
- Style: Macro detail of [ç‰¹å®šéƒ¨ä½]
- Lighting: Rim light highlighting [æè´¨]
- Sharp focus, clear details

[1,3] [å…³é”®ç»†èŠ‚2] Detail:
- Same product, [å…·ä½“è§’åº¦]
- Style: [æ‹æ‘„é£Žæ ¼]
- Lighting: Controlled reflection on [æè´¨]
- Sharp focus, clear details

[2,1] 45-Degree Hero Angle:
- Same product, classic product photography angle
- Style: Editorial magazine presentation
- Lighting: Three-point lighting, elegant shadows
- Sharp focus, clear details

[2,3] [ç‰¹æ®Šè§’åº¦] View:
- Same product, [å…·ä½“æè¿°]
- Style: [æŠ€æœ¯/è‰ºæœ¯ç‰¹ç‚¹]
- Lighting: [å…‰ç…§æ–¹å¼]
- Sharp focus, clear details

[3,1] Lifestyle/Context Shot:
- Same product, in use or lifestyle context
- Style: [åœºæ™¯æè¿°]
- Lighting: Natural elegant ambient light
- Sharp focus, clear details

[3,2] [æè´¨/çº¹ç†] Detail:
- Same product, texture close-up
- Style: Macro focus on [æè´¨ç»†èŠ‚]
- Lighting: Gradient light revealing texture
- Sharp focus, clear details

[3,3] Packaging/Presentation:
- Same product, in premium display/packaging
- Style: Unboxing luxury experience
- Lighting: Soft diffused light on presentation
- Sharp focus, clear details
```

**æ‰‹è¡¨ç¤ºä¾‹**ï¼š
- [1,1] Top View - Dial Detailï¼ˆè¡¨ç›˜ä¿¯è§†ï¼‰
- [1,2] Crown & Case Side Detailï¼ˆè¡¨å† ä¾§é¢ï¼‰
- [1,3] Clasp Mechanism Detailï¼ˆè¡¨æ‰£ç»†èŠ‚ï¼‰
- [2,1] 45-Degree Hero Angleï¼ˆç»å…¸45åº¦è§’ï¼‰
- [2,3] Case Back Exhibitionï¼ˆåº•ç›–/æœºèŠ¯ï¼‰
- [3,1] On-Wrist Lifestyle Shotï¼ˆä¸Šæ‰‹æ•ˆæžœï¼‰
- [3,2] Bracelet Link Detailï¼ˆè¡¨å¸¦é“¾èŠ‚ï¼‰
- [3,3] Packaging & Presentationï¼ˆåŒ…è£…ç›’ï¼‰

---

### CRITICAL TECHNICAL SPECS (èƒŒæ™¯ç½‘æ ¼æŠ€æœ¯è§„èŒƒ)

- Deep depth of field (f/16) - ALL products sharp and clear
- NO bokeh, NO blur, NO out-of-focus areas
- Even bright studio lighting across all cells
- High resolution details in every cell
- Thick white grid lines clearly visible between cells
- Background color: Bright minimalist studio white/grey gradient

---

### FOREGROUND LAYER (Z=5-10cm forward) - 3Dçªå‡ºäº§å“

**THE SAME [PRODUCT] (Center Dominant Presentation):**

- Massive hyper-realistic 3D rendered product dominating the center
- Positioned at EXACT CENTER, completely occluding center cell [2,2]
- **Product top touches very top edge of canvas**
- **Product bottom touches very bottom edge of canvas**
- Occupies MAXIMUM vertical space for strong 3D illusion

**Presentation Style:**
- Dynamic floating perspective with slight rotation
- [å…·ä½“è§’åº¦ï¼Œå¦‚ï¼š30-degree tilt showing both front and side]
- Suspended in space, [æ— èƒŒæ™¯å¹²æ‰°]
- Direct frontal presentation, commanding presence
- Full product visible from top to bottom

**Technical Execution:**
- Product extends 5-10cm forward from background plane
- Hyper-realistic 3D render (Blender/Cinema 4D quality)
- Substance 3D material: [æè´¨åˆ—è¡¨ï¼špolished metal, glass, leatherç­‰]
- +20% saturation compared to background for "pop forward" effect
- Slightly sharper focus than background (but background still sharp)
- Photorealistic reflections and refractions
- Visible [äº§å“ç‰¹å¾] clearly rendered

---

### OCCLUSION MECHANICS (é®æŒ¡æœºåˆ¶)

**9æ ¼ - 1æ ¼é®æŒ¡ = 8æ ¼å¯è§**

**Complete Occlusion:**
- Product body COMPLETELY covers center cell [2,2] (100% invisible)
- Center shot is fully hidden behind 3D product

**Partial Occlusion (Natural Edge Overlap):**
- Top [1,2]: [äº§å“é¡¶éƒ¨] overlaps 10-15% into top detail shot
- Left [2,1]: [äº§å“å·¦ä¾§] overlaps 15-20% into hero angle shot
- Right [2,3]: [äº§å“å³ä¾§] overlaps 15-20% into right view shot
- Bottom [3,2]: [äº§å“åº•éƒ¨] overlaps 10-15% into bottom detail shot
- Overlaps break the white grid boundaries naturally

**Edge Treatment:**
- Soft organic transitions, NO hard cutout edges
- Product appears to physically exist in front of the grid
- Like a 3D display stand showcasing product above poster

---

### DEPTH EFFECTS (æ·±åº¦æ•ˆæžœ)

**Shadows:**
- Drop shadow from 3D product onto grid background
  * Blur: 12px
  * Color: rgba(0,0,0,0.25)
  * Offset: X=6px, Y=10px
- Contact shadow where product "hovers" on background
  * Blur: 8px
  * Color: rgba(0,0,0,0.35)
  * Creates floating suspension effect

**Lighting:**
- Background grid: Even bright studio lighting (no dramatic shadows)
- Foreground 3D product:
  * Key light upper left 45Â°
  * Fill light reducing harsh shadows
  * Rim light on edges for separation
  * Spotlight on key features for emphasis
- Consistent lighting direction across all elements

**Separation Techniques:**
- Slight brightness difference (foreground +10% brighter)
- Slight saturation boost (foreground +20% more saturated)
- Subtle sharpening halo around product edges
- Clear Z-axis spatial hierarchy

---

### CONSISTENCY RULES (ä¸€è‡´æ€§è§„åˆ™)

**Same Product Verification:**
- Same product model in all 9 positions
- Same [ç‰¹å¾1] with identical [ç»†èŠ‚]
- Same [ç‰¹å¾2] with same [ç»†èŠ‚]
- Same [ç‰¹å¾3]
- Same [å…³é”®å…ƒç´ ] position
- Same brand logo placement

**What Changes:**
- âœ… Photography style (macro, lifestyle, technical, editorial)
- âœ… Camera angle and perspective
- âœ… Lighting setup and mood
- âœ… Focal point (different details in each cell)

**What NEVER Changes:**
- âŒ The product model or brand
- âŒ The [æ ¸å¿ƒç‰¹å¾1]
- âŒ The [æ ¸å¿ƒç‰¹å¾2]
- âŒ Any product specifications

---

### TECHNICAL SPECIFICATIONS (æŠ€æœ¯è§„æ ¼)

**Image Composition:**
- Aspect ratio: 2:3 portrait (or 9:16 vertical)
- Resolution: 2000Ã—3000 pixels (or higher)
- Color mode: RGB, sRGB color space
- Quality: Professional commercial product photography

**Camera & Focus:**
- **Deep depth of field (f/16 or higher)**
- **NO selective focus, NO bokeh, NO blur**
- **ALL products in background grid MUST be sharp and clear**
- Foreground product slightly sharper for hierarchy
- Both layers fully illuminated and visible

**Environment:**
- Bright minimalist indoor studio
- Pure white or soft grey gradient background
- Clean, uncluttered aesthetic
- Premium luxury brand presentation
- Museum-quality display mood

**Layout:**
- Background: Clear 3Ã—3 grid with THICK WHITE LINES visible
- Foreground: Massive full-product 3D render breaking grid boundaries
- Surreal creative product collage composition
- Editorial luxury advertising feel

**Material Rendering (3D Product):**
[æ ¹æ®äº§å“ç±»åž‹å®šåˆ¶æè´¨åˆ—è¡¨]
- [æè´¨1]: [å…·ä½“æ•ˆæžœæè¿°]
- [æè´¨2]: [å…·ä½“æ•ˆæžœæè¿°]
- [æè´¨3]: [å…·ä½“æ•ˆæžœæè¿°]

---

### FORBIDDEN ELEMENTS (ä¸¥æ ¼ç¦æ­¢)

**Product:**
- âŒ Different product models in different cells
- âŒ Changing colors or designs
- âŒ Different brands or styles
- âŒ Inconsistent product details

**Technical:**
- âŒ Blurred background or bokeh effect
- âŒ Out of focus products in grid
- âŒ Shallow depth of field
- âŒ Missing or unclear grid lines
- âŒ Dark shadows obscuring details
- âŒ Low resolution or pixelation
- âŒ Deformed product shapes
- âŒ Messy composition

**Structure:**
- âŒ 4Ã—4 or other grid sizes (must be 3Ã—3)
- âŒ All 9 cells visible (center must be occluded)
- âŒ Flat composition (must have clear 3D depth)
- âŒ Hard cutout edges on foreground product

---

### QUALITY CHECKLIST (è´¨é‡æ£€æŸ¥æ¸…å•)

**Before Generation:**
- [ ] Same product model in all 9 positions?
- [ ] Each cell shows different photography style?
- [ ] Center cell [2,2] completely hidden?
- [ ] 8 visible background cells clearly defined?
- [ ] Thick white grid lines visible?
- [ ] ALL background products sharp and clear (no blur)?
- [ ] Foreground product full-size, top-to-bottom?
- [ ] Product extends maximum vertical space?
- [ ] Clear 3D pop-out effect with shadows?
- [ ] Natural edge overlaps into adjacent cells?
- [ ] Hyper-realistic 3D render quality?
- [ ] Deep depth of field maintained (f/16)?
- [ ] Material reflections realistic?
- [ ] Transparency/translucency visible (if applicable)?

---

### MIDJOURNEY COMMAND FORMAT

```
/imagine prompt: A surreal 3x3 luxury [product type] grid collage with THICK WHITE LINES separating cells. Background shows THE SAME [product description] in 8 different professional product photography styles ([åˆ—å‡º8ä¸ªè§’åº¦]) - various angles but identical product. CENTER CELL HIDDEN. OVERLAID by a massive hyper-realistic 3D rendered floating version of THE SAME PRODUCT, top touching top edge, bottom touching bottom edge, [angle description]. ALL products in background sharp and in focus, deep depth of field f/16, no blur anywhere, bright studio lighting, clear white grid lines visible, strong 3D pop-out effect with drop shadows, professional commercial product photography, same product 9 times, photorealistic Substance 3D materials, [material list], 8k resolution --ar 2:3 --v 6.1 --style raw --quality 2
```

---

### MATHEMATICAL LOGIC (æ•°å­¦é€»è¾‘)

```
Same product Ã— 9 different photography styles arranged in 3Ã—3 grid.

Center style completely occluded by 3D foreground version =
8 visible background shots + 1 foreground 3D render =
9 total appearances of ONE PRODUCT with NINE photographic interpretations.
```

---

## ðŸŽ¯ äº§å“ç±»åž‹é€‚é…

### æ‰‹è¡¨ (Luxury Watch)

**8ä¸ªè§’åº¦**ï¼š
1. è¡¨ç›˜ä¿¯è§† (Top View - Dial Detail)
2. è¡¨å† ä¾§é¢ (Crown & Case Side Detail)
3. è¡¨æ‰£ç»†èŠ‚ (Clasp Mechanism Detail)
4. ç»å…¸45åº¦è§’ (45-Degree Hero Angle)
5. åº•ç›–/æœºèŠ¯ (Case Back Exhibition)
6. ä¸Šæ‰‹æ•ˆæžœ (On-Wrist Lifestyle Shot)
7. è¡¨å¸¦é“¾èŠ‚ (Bracelet Link Detail)
8. åŒ…è£…ç›’ (Packaging & Presentation)

**æè´¨æ¸²æŸ“**ï¼š
- Polished stainless steel: mirror reflections
- Brushed steel: subtle linear grain
- Sapphire crystal: transparent with refraction
- Leather strap: realistic texture and stitching

### é¦™æ°´ (Perfume Bottle)

**8ä¸ªè§’åº¦**ï¼š
1. ç“¶ç›–ä¿¯è§† (Cap Top View)
2. ç“¶èº«ä¾§é¢ (Bottle Side Profile)
3. å“ç‰ŒLogoç‰¹å†™ (Brand Logo Detail)
4. ç»å…¸45åº¦è§’ (45-Degree Hero Angle)
5. ç“¶åº•è®¾è®¡ (Base Design Detail)
6. ä½¿ç”¨åœºæ™¯ (Lifestyle Context Shot)
7. æ¶²ä½“/æ¸å˜ (Liquid Gradient Detail)
8. åŒ…è£…ç›’ (Luxury Box Presentation)

**æè´¨æ¸²æŸ“**ï¼š
- Glass bottle: transparency, light refraction
- Gold cap: metallic sheen
- Liquid: color gradient, translucency
- Embossed logo: subtle depth

### ç”µå­äº§å“ (Electronics)

**8ä¸ªè§’åº¦**ï¼š
1. æ­£é¢å±å¹• (Front Screen View)
2. ä¾§é¢ç«¯å£ (Side Ports Detail)
3. èƒŒé¢Logo (Back Logo & Design)
4. ç»å…¸45åº¦è§’ (45-Degree Hero Angle)
5. å†…éƒ¨ç»“æž„ (Internal Structure/Components)
6. ä½¿ç”¨åœºæ™¯ (In-Use Lifestyle Shot)
7. æè´¨çº¹ç† (Material Texture Close-up)
8. åŒ…è£…å…¨å®¶ç¦ (Unboxing All Contents)

**æè´¨æ¸²æŸ“**ï¼š
- Aluminum body: brushed metal finish
- Glass screen: anti-glare coating
- Plastic: matte or glossy finish
- LED indicators: subtle glow

---

## ðŸ’¡ ä½¿ç”¨å»ºè®®

1. **é€‰æ‹©åˆé€‚çš„äº§å“è§’åº¦**ï¼šæ ¹æ®äº§å“ç‰¹ç‚¹é€‰æ‹©æœ€èƒ½å±•ç¤ºç‰¹å¾çš„8ä¸ªè§’åº¦
2. **ä¿æŒä¸€è‡´æ€§**ï¼šæ‰€æœ‰9ä¸ªä½ç½®å¿…é¡»æ˜¯åŒä¸€äº§å“
3. **æè´¨çœŸå®žæ€§**ï¼š3Dæ¸²æŸ“çš„æè´¨è¦ä¸Žå®žç‰©ç…§ç‰‡ä¸€è‡´
4. **å…‰ç…§ç»Ÿä¸€**ï¼šèƒŒæ™¯8æ ¼ç”¨å‡åŒ€å…‰ç…§ï¼Œå‰æ™¯3Dç”¨æˆå‰§æ€§å…‰ç…§
5. **æ·±æ™¯æ·±å¿…é¡»**ï¼šf/16ç¡®ä¿æ‰€æœ‰æ ¼å­éƒ½æ¸…æ™°ï¼Œé¿å…bokeh

---

**æœ€åŽæ›´æ–°**: 2026-01-04
**ç»´æŠ¤è€…**: Product Master Skill System



================================================
FILE: .claude/skills/prompt-analyzer/SKILL.md
================================================
---
name: prompt-analyzer
description: æç¤ºè¯åˆ†æžä¸Žæ´žå¯Ÿ - æŸ¥çœ‹Promptè¯¦æƒ…ã€å¯¹æ¯”å·®å¼‚ã€æŽ¨èç›¸ä¼¼æç¤ºè¯ã€å…ƒç´ åº“ç»Ÿè®¡
---

# Prompt Analyzer - æç¤ºè¯åˆ†æžå™¨

## ðŸŽ¯ æ ¸å¿ƒèŒè´£

**ä¸“æ³¨äºŽå·²ç”ŸæˆPromptçš„åˆ†æžå’Œæ´žå¯Ÿ**ï¼Œä¸è´Ÿè´£ç”Ÿæˆæ–°Promptã€‚

æä¾›ä»¥ä¸‹5å¤§åŠŸèƒ½ï¼š
1. **æŸ¥çœ‹è¯¦æƒ…** - åˆ†æžPromptä½¿ç”¨äº†å“ªäº›å…ƒç´ 
2. **å¯¹æ¯”åˆ†æž** - å¯¹æ¯”ä¸¤ä¸ªPromptçš„å·®å¼‚
3. **ç›¸ä¼¼æŽ¨è** - æŽ¨èç›¸ä¼¼çš„Prompt
4. **å…ƒç´ ç»Ÿè®¡** - æŸ¥è¯¢å…ƒç´ åº“ç»Ÿè®¡ä¿¡æ¯
5. **é£Žæ ¼æŽ¨è** - æŒ‰é£Žæ ¼æŽ¨èæœ€ä½³å…ƒç´ ç»„åˆ

---

## ðŸ“‹ åŠŸèƒ½1ï¼šæŸ¥çœ‹Promptè¯¦æƒ…

### è§¦å‘åœºæ™¯

ç”¨æˆ·è¯´ï¼š
- "æŸ¥çœ‹Prompt #5çš„è¯¦æƒ…"
- "åˆ†æžä¸€ä¸‹Prompt #5ç”¨äº†å“ªäº›å…ƒç´ "
- "æ˜¾ç¤ºPrompt #5çš„å®Œæ•´ä¿¡æ¯"
- "Prompt #5åŒ…å«ä»€ä¹ˆï¼Ÿ"

### SKILLå¤„ç†æµç¨‹

#### æ­¥éª¤1ï¼šè¯†åˆ«æ„å›¾

ä»Žç”¨æˆ·è¾“å…¥ä¸­æå–Prompt IDï¼š

```python
# ç¤ºä¾‹ï¼šç”¨æˆ·è¯´ "æŸ¥çœ‹Prompt #5çš„è¯¦æƒ…"
prompt_id = 5
```

#### æ­¥éª¤2ï¼šè°ƒç”¨æ‰§è¡Œå±‚

```python
from prompt_analyzer import analyze_prompt_detail

result = analyze_prompt_detail(prompt_id=5)
```

#### æ­¥éª¤3ï¼šæ£€æŸ¥ç»“æžœ

å¦‚æžœPromptä¸å­˜åœ¨ï¼š
```python
if 'error' in result:
    print(f"âŒ {result['error']}")
    # æç¤ºç”¨æˆ·ï¼šè¯¥Promptä¸å­˜åœ¨ï¼Œå¯èƒ½è¿˜æ²¡ç”Ÿæˆè¿‡ä»»ä½•Prompt
```

#### æ­¥éª¤4ï¼šæ ¼å¼åŒ–å±•ç¤º

```markdown
ðŸ“¸ Prompt #5 è¯¦æƒ…

**ç”¨æˆ·éœ€æ±‚**: {result['user_intent']}
**ç”Ÿæˆæ—¶é—´**: {result['generation_date']}
**è´¨é‡è¯„åˆ†**: {result['quality_score']}/10
**é£Žæ ¼æ ‡ç­¾**: {result['style_tag']}

**ä½¿ç”¨çš„å…ƒç´ ** ({len(result['elements'])}ä¸ª):

1. [{field_name}] {chinese_name} (å¤ç”¨åº¦: {reusability})
   - ç±»åˆ«: {category}
   - æ¨¡æ¿: {template}

2. ...

**å®Œæ•´Prompt**:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
{result['prompt_text']}
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ðŸ“‹ åŠŸèƒ½2ï¼šå¯¹æ¯”ä¸¤ä¸ªPrompts

### è§¦å‘åœºæ™¯

ç”¨æˆ·è¯´ï¼š
- "å¯¹æ¯”Prompt #5å’Œ#17"
- "#5å’Œ#17æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"
- "æ¯”è¾ƒä¸€ä¸‹Prompt #5å’Œ#17"

### SKILLå¤„ç†æµç¨‹

#### æ­¥éª¤1ï¼šè¯†åˆ«æ„å›¾

ä»Žç”¨æˆ·è¾“å…¥ä¸­æå–ä¸¤ä¸ªPrompt IDï¼š

```python
# ç¤ºä¾‹ï¼šç”¨æˆ·è¯´ "å¯¹æ¯”Prompt #5å’Œ#17"
prompt_id1 = 5
prompt_id2 = 17
```

#### æ­¥éª¤2ï¼šè°ƒç”¨æ‰§è¡Œå±‚

```python
from prompt_analyzer import compare_prompts

result = compare_prompts(prompt_id1=5, prompt_id2=17)
```

#### æ­¥éª¤3ï¼šåˆ†æžå·®å¼‚ç»´åº¦

SKILLåˆ†æžè¿”å›žçš„æ•°æ®ï¼Œç”Ÿæˆå¯¹æ¯”è¡¨æ ¼ï¼š

```markdown
âš–ï¸ Promptå¯¹æ¯”ï¼š#5 vs #17

### åŸºæœ¬ä¿¡æ¯å¯¹æ¯”

| ç»´åº¦ | Prompt #5 | Prompt #17 |
|------|-----------|-----------|
| ç”¨æˆ·éœ€æ±‚ | {p1['user_intent']} | {p2['user_intent']} |
| é£Žæ ¼æ ‡ç­¾ | {p1['style_tag']} | {p2['style_tag']} |
| è´¨é‡è¯„åˆ† | {p1['quality_score']}/10 | {p2['quality_score']}/10 |
| å…ƒç´ æ€»æ•° | {len(p1['elements'])}ä¸ª | {len(p2['elements'])}ä¸ª |
| ç”Ÿæˆæ—¶é—´ | {p1['generation_date']} | {p2['generation_date']} |

### å…ƒç´ å·®å¼‚åˆ†æž

**ç›¸ä¼¼åº¦**: {result['similarity_score']*100:.1f}%

**å…±åŒå…ƒç´ ** ({len(result['common_elements'])}ä¸ª):
- {common_element['chinese_name']} ({common_element['category']})
- ...

**Prompt #5 ç‹¬æœ‰** ({len(result['unique_to_p1'])}ä¸ª):
- {element['chinese_name']} ({element['category']})
  å…³é”®è¯: {element['template'][:50]}...
- ...

**Prompt #17 ç‹¬æœ‰** ({len(result['unique_to_p2'])}ä¸ª):
- {element['chinese_name']} ({element['category']})
  å…³é”®è¯: {element['template'][:50]}...
- ...
```

#### æ­¥éª¤4ï¼šåˆ†æžç»“è®º

SKILLæ ¹æ®ç›¸ä¼¼åº¦ç»™å‡ºç»“è®ºï¼š

```python
if result['similarity_score'] > 0.7:
    print("ðŸ’¡ è¿™ä¸¤ä¸ªPromptéžå¸¸ç›¸ä¼¼ï¼Œé£Žæ ¼æŽ¥è¿‘")
elif result['similarity_score'] > 0.4:
    print("ðŸ’¡ è¿™ä¸¤ä¸ªPromptæœ‰ä¸€å®šç›¸ä¼¼æ€§ï¼Œä½†é£Žæ ¼æœ‰æ˜Žæ˜¾å·®å¼‚")
else:
    print("ðŸ’¡ è¿™ä¸¤ä¸ªPromptå®Œå…¨ä¸åŒï¼Œå±žäºŽä¸åŒé£Žæ ¼")
```

---

## ðŸ“‹ åŠŸèƒ½3ï¼šæŽ¨èç›¸ä¼¼Prompts

### è§¦å‘åœºæ™¯

ç”¨æˆ·è¯´ï¼š
- "æŽ¨èä¸Ž#5ç›¸ä¼¼çš„Prompt"
- "æœ‰æ²¡æœ‰ç±»ä¼¼#5çš„ï¼Ÿ"
- "æ‰¾ä¸€äº›ç›¸ä¼¼çš„æç¤ºè¯"
- "åŸºäºŽPrompt #5æŽ¨èç›¸ä¼¼çš„"

### SKILLå¤„ç†æµç¨‹

#### æ­¥éª¤1ï¼šè¯†åˆ«æ„å›¾

```python
# ç¤ºä¾‹ï¼šç”¨æˆ·è¯´ "æŽ¨èä¸Ž#5ç›¸ä¼¼çš„Prompt"
prompt_id = 5
top_n = 3  # é»˜è®¤æŽ¨è3ä¸ª
```

#### æ­¥éª¤2ï¼šè°ƒç”¨æ‰§è¡Œå±‚

```python
from prompt_analyzer import recommend_similar_prompts

result = recommend_similar_prompts(prompt_id=5, top_n=3)
```

#### æ­¥éª¤3ï¼šåˆ†æžæŽ¨èç†ç”±

SKILLè§£è¯»ç›¸ä¼¼åº¦åŽŸå› ï¼Œä¸ºæ¯ä¸ªæŽ¨èPromptç”Ÿæˆç†ç”±ï¼š

```python
# åˆ†æžå…±åŒå…ƒç´ ï¼Œæ‰¾å‡ºç›¸ä¼¼çš„åŽŸå› 
def analyze_similarity_reason(common_element_ids, target_prompt, candidate_prompt):
    """
    åˆ†æžä¸¤ä¸ªPromptä¸ºä»€ä¹ˆç›¸ä¼¼

    è¿”å›žï¼š
    - å…±åŒçš„é£Žæ ¼æ ‡ç­¾
    - å…±åŒçš„å…ƒç´ ç±»åˆ«
    - æŽ¨èç†ç”±åˆ—è¡¨
    """
    reasons = []

    # æ£€æŸ¥é£Žæ ¼æ ‡ç­¾
    if target_prompt['style_tag'] == candidate_prompt['style_tag']:
        reasons.append(f"âœ“ åŒä¸º{candidate_prompt['style_tag']}é£Žæ ¼")

    # æŒ‰ç±»åˆ«ç»Ÿè®¡å…±åŒå…ƒç´ 
    category_count = {}
    for elem_id in common_element_ids:
        # æŸ¥è¯¢å…ƒç´ è¯¦æƒ…èŽ·å–category
        # ... (æ‰§è¡Œå±‚å·²è¿”å›ž)
        category = ...
        category_count[category] = category_count.get(category, 0) + 1

    # åˆ—å‡ºé‡è¦çš„å…±åŒç±»åˆ«
    for category, count in category_count.items():
        if count >= 2:
            reasons.append(f"âœ“ {count}ä¸ªå…±åŒçš„{category}å…ƒç´ ")

    return reasons
```

#### æ­¥éª¤4ï¼šæ ¼å¼åŒ–å±•ç¤º

```markdown
ðŸ” ä¸ºPrompt #5æŽ¨èç›¸ä¼¼æç¤ºè¯

[1] Prompt #{recommendation['prompt_id']} - {recommendation['user_intent']}
    ç›¸ä¼¼åº¦: {recommendation['similarity']*100:.1f}%
    å…±åŒå…ƒç´ : {recommendation['common_count']}ä¸ª
    è´¨é‡è¯„åˆ†: {recommendation['quality_score']}/10

    ç†ç”±:
    - âœ“ åŒä¸º{style_tag}é£Žæ ¼
    - âœ“ å…±ç”¨3ä¸ªmakeupå…ƒç´ 
    - âœ“ å…±ç”¨2ä¸ªlightingå…ƒç´ 

[2] ...

[3] ...
```

---

## ðŸ“‹ åŠŸèƒ½4ï¼šå…ƒç´ åº“ç»Ÿè®¡

### è§¦å‘åœºæ™¯

ç”¨æˆ·è¯´ï¼š
- "å…ƒç´ åº“æœ‰å“ªäº›ç±»åˆ«ï¼Ÿ"
- "makeupç±»åˆ«æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Ÿ"
- "å“ªäº›å…ƒç´ ç”¨å¾—æœ€å¤šï¼Ÿ"
- "æŸ¥çœ‹å…ƒç´ åº“ç»Ÿè®¡"
- "makeup_stylesçš„è¯¦ç»†ä¿¡æ¯"

### SKILLå¤„ç†æµç¨‹

#### æ­¥éª¤1ï¼šè¯†åˆ«æ„å›¾

```python
# åœºæ™¯Aï¼šç”¨æˆ·è¯´ "å…ƒç´ åº“æœ‰å“ªäº›ç±»åˆ«ï¼Ÿ"
category = None  # æŸ¥è¯¢æ•´ä½“ç»Ÿè®¡

# åœºæ™¯Bï¼šç”¨æˆ·è¯´ "makeupç±»åˆ«æœ‰å¤šå°‘ä¸ªå…ƒç´ ï¼Ÿ"
category = 'makeup_styles'  # æŸ¥è¯¢ç‰¹å®šç±»åˆ«
```

#### æ­¥éª¤2ï¼šè°ƒç”¨æ‰§è¡Œå±‚

```python
from prompt_analyzer import get_library_statistics

# æ•´ä½“ç»Ÿè®¡
result = get_library_statistics()

# æˆ–è€…ç‰¹å®šç±»åˆ«
result = get_library_statistics(category='makeup_styles')
```

#### æ­¥éª¤3ï¼šæ ¼å¼åŒ–å±•ç¤º

**åœºæ™¯Aï¼šæ•´ä½“ç»Ÿè®¡**

```markdown
ðŸ“Š å…ƒç´ åº“ç»Ÿè®¡

**æ€»è®¡**: {result['total_elements']} ä¸ªå…ƒç´ 

**æŒ‰ç±»åˆ«åˆ†å¸ƒ**:
- makeup_styles: {count}ä¸ª
- clothing_styles: {count}ä¸ª
- hair_styles: {count}ä¸ª
- lighting_techniques: {count}ä¸ª
- facial_features: {count}ä¸ª
- ...

ðŸ’¡ ä½¿ç”¨ "æŸ¥çœ‹makeup_stylesè¯¦æƒ…" æŸ¥çœ‹å…·ä½“å…ƒç´ åˆ—è¡¨
```

**åœºæ™¯Bï¼šç±»åˆ«è¯¦æƒ…**

```markdown
ðŸ“Š å…ƒç´ åº“ç»Ÿè®¡ - {category}

**ç±»åˆ«**: {result['category_details']['category']}
**æ€»æ•°**: {result['category_details']['total_count']} ä¸ªå…ƒç´ 

**æœ€å¸¸ç”¨å…ƒç´ ** (Top 10):

| æŽ’å | å…ƒç´ åç§° | å¤ç”¨åº¦ | ä½¿ç”¨æ¬¡æ•° | å¹³å‡è´¨é‡ |
|------|---------|--------|---------|---------|
| 1 | {chinese_name} | {reusability} | {usage_count}æ¬¡ | {avg_quality}/10 |
| 2 | ... | ... | ... | ... |
| ... |

**æœ€é«˜è´¨é‡å…ƒç´ ** (Top 5):
[æŒ‰avg_qualityæŽ’åº]

**ä»Žæœªä½¿ç”¨çš„å…ƒç´ ** ({count}ä¸ª):
[usage_count = 0çš„å…ƒç´ ]
```

---

## ðŸ“‹ åŠŸèƒ½5ï¼šæŒ‰é£Žæ ¼æŽ¨èå…ƒç´ ç»„åˆ

### è§¦å‘åœºæ™¯

ç”¨æˆ·è¯´ï¼š
- "å¤è£…é£Žæ ¼åº”è¯¥ç”¨ä»€ä¹ˆå…ƒç´ ï¼Ÿ"
- "ç§‘å¹»é£Žæ ¼çš„æœ€ä½³å…ƒç´ ç»„åˆæ˜¯ä»€ä¹ˆï¼Ÿ"
- "æŽ¨èè¥¿éƒ¨ä¸–ç•Œé£Žæ ¼çš„å…ƒç´ "
- "ancient_chineseé£Žæ ¼ç”¨å“ªäº›å…ƒç´ å¥½ï¼Ÿ"

### SKILLå¤„ç†æµç¨‹

#### æ­¥éª¤1ï¼šè¯†åˆ«æ„å›¾

```python
# ç¤ºä¾‹ï¼šç”¨æˆ·è¯´ "å¤è£…é£Žæ ¼åº”è¯¥ç”¨ä»€ä¹ˆå…ƒç´ ï¼Ÿ"

# æ˜ å°„ç”¨æˆ·æè¿°åˆ°style_tag
style_mapping = {
    'å¤è£…': 'ancient_chinese',
    'å¤è£…ä¸­å¼': 'ancient_chinese',
    'ä»™å‰‘å¥‡ä¾ ä¼ ': 'ancient_chinese',
    'ç§‘å¹»': 'modern_sci_fi',
    'è¥¿éƒ¨ä¸–ç•Œ': 'westworld_android',
    'èµ›åšæœ‹å…‹': 'cyberpunk',
    'å¥‡å¹»': 'fantasy'
}

style = style_mapping.get('å¤è£…', 'ancient_chinese')
```

#### æ­¥éª¤2ï¼šè°ƒç”¨æ‰§è¡Œå±‚

```python
from prompt_analyzer import recommend_elements_by_style

result = recommend_elements_by_style(style='ancient_chinese')
```

#### æ­¥éª¤3ï¼šæŒ‰ç±»åˆ«ç»„ç»‡æŽ¨è

SKILLå°†è¿”å›žçš„å…ƒç´ æŒ‰ç±»åˆ«åˆ†ç»„ï¼Œä¾¿äºŽå±•ç¤ºï¼š

```python
# æŒ‰categoryåˆ†ç»„
elements_by_category = {}
for element in result['recommended_elements']:
    category = element['category']
    if category not in elements_by_category:
        elements_by_category[category] = []
    elements_by_category[category].append(element)

# æŒ‰ç±»åˆ«çš„æœ€é«˜ä½¿ç”¨é¢‘çŽ‡æŽ’åº
sorted_categories = sorted(
    elements_by_category.items(),
    key=lambda x: max(e['usage_frequency'] for e in x[1]),
    reverse=True
)
```

#### æ­¥éª¤4ï¼šæ ¼å¼åŒ–å±•ç¤º

```markdown
ðŸŽ¨ é£Žæ ¼æŽ¨èï¼š{result['style']}

**æ•°æ®æ¥æº**: åŸºäºŽ{result['total_prompts']}ä¸ªåŽ†å²Promptåˆ†æž

**æŽ¨èå…ƒç´ ç»„åˆ** (æŒ‰ç±»åˆ«):

### 1. {category_name}

[{field_name}] {chinese_name}
- ä½¿ç”¨é¢‘çŽ‡: {usage_frequency*100:.0f}% ({usage_count}/{total_prompts}ä¸ªPromptä½¿ç”¨)
- å¤ç”¨åº¦: {reusability}/10
- å¹³å‡è´¨é‡: {avg_quality}/10
- å…³é”®è¯: {template[:80]}...

### 2. {category_name}

...

**ä½¿ç”¨å»ºè®®**:
- âœ“ è¿™ä¸ªç»„åˆåœ¨{style}é£Žæ ¼ä¸­æœ€å¸¸ç”¨ï¼Œè´¨é‡ç¨³å®š
- âœ“ æŽ¨èæ­é…ï¼š{æŽ¨èçš„åŸºç¡€å±žæ€§ï¼Œå¦‚"ä¸œäºšå¥³æ€§"}
- âš ï¸ é¿å…æ­é…ï¼š{å†²çªçš„å…ƒç´ }
```

---

## ðŸ”§ æ‰§è¡Œå±‚å‡½æ•°åˆ—è¡¨

SKILLè°ƒç”¨ä»¥ä¸‹æ‰§è¡Œå‡½æ•°ï¼ˆä»£ç å±‚åªæ‰§è¡Œï¼Œä¸å†³ç­–ï¼‰ï¼š

```python
# æ‰€æœ‰å‡½æ•°åœ¨ prompt_analyzer.py ä¸­

def analyze_prompt_detail(prompt_id: int) -> dict:
    """æŸ¥è¯¢Promptå®Œæ•´ä¿¡æ¯"""

def compare_prompts(prompt_id1: int, prompt_id2: int) -> dict:
    """å¯¹æ¯”ä¸¤ä¸ªPromptå·®å¼‚"""

def recommend_similar_prompts(prompt_id: int, top_n: int = 3) -> list:
    """æŽ¨èç›¸ä¼¼Prompts"""

def get_library_statistics(category: str = None) -> dict:
    """æŸ¥è¯¢å…ƒç´ åº“ç»Ÿè®¡"""

def recommend_elements_by_style(style: str) -> dict:
    """æŒ‰é£Žæ ¼æŽ¨èå…ƒç´ ç»„åˆ"""
```

---

## ðŸ“ æ•°æ®ä¾èµ–

```
elements.db
â”œâ”€â”€ elements                 # å…ƒç´ åº“ï¼ˆç”±universal-learnerç»´æŠ¤ï¼‰
â”œâ”€â”€ generated_prompts        # ç”ŸæˆåŽ†å²ï¼ˆç”±intelligent-prompt-generatorå†™å…¥ï¼‰
â”œâ”€â”€ prompt_elements          # Prompt-å…ƒç´ å…³è”
â””â”€â”€ element_usage_stats      # å…ƒç´ ä½¿ç”¨ç»Ÿè®¡
```

**é‡è¦**ï¼šprompt-analyzerä¾èµ–intelligent-prompt-generatorç”Ÿæˆçš„åŽ†å²æ•°æ®ã€‚å¦‚æžœæ•°æ®åº“ä¸­æ²¡æœ‰generated_promptsè®°å½•ï¼Œåˆ†æžåŠŸèƒ½æ— æ³•å·¥ä½œã€‚

---

## âš™ï¸ æž¶æž„åŽŸåˆ™

âœ… **SKILL = å¤§è„‘ï¼ˆå†³ç­–å±‚ï¼‰**
- è¯†åˆ«ç”¨æˆ·æ„å›¾
- åˆ†æžè¿”å›žæ•°æ®
- æ ¼å¼åŒ–å±•ç¤ºç»“æžœ
- ç”ŸæˆæŽ¨èç†ç”±

âœ… **ä»£ç  = æ‰‹è„šï¼ˆæ‰§è¡Œå±‚ï¼‰**
- æŸ¥è¯¢æ•°æ®åº“
- è®¡ç®—ç›¸ä¼¼åº¦
- è¿”å›žåŽŸå§‹æ•°æ®

âŒ **ä»£ç ä¸åšå†³ç­–**
- ä¸åˆ¤æ–­"å“ªä¸ªæ›´å¥½"
- ä¸å†³å®š"å±•ç¤ºä»€ä¹ˆ"
- åªè´Ÿè´£"å–æ•°æ®"

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæŸ¥çœ‹è¯¦æƒ…

**ç”¨æˆ·**: "æŸ¥çœ‹Prompt #1çš„è¯¦æƒ…"

**SKILLå¤„ç†**:
```python
from prompt_analyzer import analyze_prompt_detail

result = analyze_prompt_detail(prompt_id=1)

# å±•ç¤ºæ ¼å¼åŒ–ç»“æžœ
print(f"ðŸ“¸ Prompt #{result['prompt_id']} è¯¦æƒ…\n")
print(f"**ç”¨æˆ·éœ€æ±‚**: {result['user_intent']}")
print(f"**ç”Ÿæˆæ—¶é—´**: {result['generation_date']}")
# ...
```

### ç¤ºä¾‹2ï¼šå¯¹æ¯”Prompts

**ç”¨æˆ·**: "å¯¹æ¯”Prompt #1å’Œ#2"

**SKILLå¤„ç†**:
```python
from prompt_analyzer import compare_prompts

result = compare_prompts(prompt_id1=1, prompt_id2=2)

# åˆ†æžç›¸ä¼¼åº¦
similarity = result['similarity_score']
if similarity > 0.7:
    conclusion = "éžå¸¸ç›¸ä¼¼"
elif similarity > 0.4:
    conclusion = "æœ‰ä¸€å®šç›¸ä¼¼æ€§"
else:
    conclusion = "å®Œå…¨ä¸åŒ"

# å±•ç¤ºå¯¹æ¯”è¡¨æ ¼å’Œç»“è®º
# ...
```

### ç¤ºä¾‹3ï¼šæŽ¨èç›¸ä¼¼Prompt

**ç”¨æˆ·**: "æŽ¨èä¸Ž#1ç›¸ä¼¼çš„Prompt"

**SKILLå¤„ç†**:
```python
from prompt_analyzer import recommend_similar_prompts

recommendations = recommend_similar_prompts(prompt_id=1, top_n=3)

# ä¸ºæ¯ä¸ªæŽ¨èåˆ†æžç†ç”±
for rec in recommendations:
    reasons = analyze_similarity_reason(
        rec['common_element_ids'],
        target_prompt_id=1,
        candidate_prompt_id=rec['prompt_id']
    )

    # å±•ç¤ºæŽ¨èå’Œç†ç”±
    # ...
```

### ç¤ºä¾‹4ï¼šå…ƒç´ åº“ç»Ÿè®¡

**ç”¨æˆ·**: "æŸ¥çœ‹makeup_stylesç±»åˆ«è¯¦æƒ…"

**SKILLå¤„ç†**:
```python
from prompt_analyzer import get_library_statistics

result = get_library_statistics(category='makeup_styles')

# å±•ç¤ºç»Ÿè®¡è¡¨æ ¼
details = result['category_details']
print(f"ðŸ“Š {details['category']} - {details['total_count']}ä¸ªå…ƒç´ \n")

# æŒ‰ä½¿ç”¨æ¬¡æ•°æŽ’åºå±•ç¤º
# ...
```

### ç¤ºä¾‹5ï¼šé£Žæ ¼æŽ¨è

**ç”¨æˆ·**: "å¤è£…é£Žæ ¼åº”è¯¥ç”¨ä»€ä¹ˆå…ƒç´ ï¼Ÿ"

**SKILLå¤„ç†**:
```python
from prompt_analyzer import recommend_elements_by_style

result = recommend_elements_by_style(style='ancient_chinese')

# æŒ‰ç±»åˆ«ç»„ç»‡å±•ç¤º
elements_by_category = group_by_category(result['recommended_elements'])

# å±•ç¤ºæ¯ä¸ªç±»åˆ«çš„æŽ¨è
for category, elements in elements_by_category.items():
    print(f"### {category}")
    for elem in elements:
        print(f"  - {elem['chinese_name']} (ä½¿ç”¨é¢‘çŽ‡: {elem['usage_frequency']*100:.0f}%)")
# ...
```

---

## âš ï¸ é‡è¦æé†’

1. **æ•°æ®å‰æ**ï¼šå¿…é¡»å…ˆæœ‰ç”ŸæˆåŽ†å²æ‰èƒ½åˆ†æž
   - å¦‚æžœç”¨æˆ·è¯´"æŸ¥çœ‹Prompt #5"ï¼Œä½†æ•°æ®åº“ä¸­æ²¡æœ‰ä»»ä½•Promptï¼Œåº”æç¤ºï¼š
     ```
     âŒ æ•°æ®åº“ä¸­è¿˜æ²¡æœ‰ç”ŸæˆåŽ†å²ã€‚
     ðŸ’¡ è¯·å…ˆä½¿ç”¨ intelligent-prompt-generator ç”Ÿæˆä¸€äº›Promptã€‚
     ```

2. **Prompt IDèŒƒå›´**ï¼šåªèƒ½æŸ¥è¯¢å·²å­˜åœ¨çš„Prompt ID
   - ç”¨æˆ·è¾“å…¥çš„IDå¯èƒ½ä¸å­˜åœ¨ï¼Œéœ€è¦æ£€æŸ¥errorå­—æ®µ

3. **é£Žæ ¼æ ‡ç­¾ä¸€è‡´æ€§**ï¼šé£Žæ ¼æŽ¨èä¾èµ–style_tag
   - style_tagç”±intelligent-prompt-generatoråœ¨ä¿å­˜æ—¶è®¾ç½®
   - å¸¸è§æ ‡ç­¾ï¼šancient_chinese, modern_sci_fi, cyberpunk, fantasy, westworld_android

4. **å…ƒç´ ç±»åˆ«åç§°**ï¼šæŸ¥è¯¢ç»Ÿè®¡æ—¶ä½¿ç”¨æ­£ç¡®çš„categoryåç§°
   - makeup_styles (ä¸æ˜¯makeup)
   - lighting_techniques (ä¸æ˜¯lighting)
   - clothing_styles, hair_styles, facial_features ç­‰

---

å‡†å¤‡å¥½åˆ†æžæç¤ºè¯ï¼ç­‰å¾…ç”¨æˆ·çš„åˆ†æžè¯·æ±‚ã€‚



================================================
FILE: .claude/skills/prompt-extractor/README.md
================================================
# Prompt Extractor - AIç»˜ç”»æç¤ºè¯æ¨¡å—åŒ–æå–å·¥å…·

## å¿«é€Ÿå¼€å§‹

### 1. æ¿€æ´»Skill

åœ¨Claude Codeä¸­è°ƒç”¨ï¼š
```
/skill prompt-extractor
```

æˆ–è€…ç›´æŽ¥è¯´ï¼š
```
ä½¿ç”¨ prompt-extractor åˆ†æžæˆ‘çš„æç¤ºè¯
```

### 2. è¾“å…¥æ–¹å¼ï¼ˆäºŒé€‰ä¸€ï¼‰

**æ–¹å¼Aï¼šæ–‡ä»¶è·¯å¾„**ï¼ˆé€‚åˆå¤§æ‰¹é‡ï¼‰

æ”¯æŒä¸‰ç§æ ¼å¼ï¼š

**TXTæ ¼å¼** (æ¯è¡Œä¸€ä¸ªæç¤ºè¯)
```
a portrait of a woman, cinematic lighting, 85mm lens, ultra detailed
cyberpunk city at night, neon lights, rain, photorealistic
```

**CSVæ ¼å¼**
```csv
id,prompt,score
1,"a portrait of a woman, cinematic lighting",8.5
2,"cyberpunk city at night, neon lights",9.2
```

**JSONæ ¼å¼**
```json
[
  {"prompt": "a portrait of a woman, cinematic lighting, 85mm lens"},
  {"prompt": "cyberpunk city at night, neon lights, rain"}
]
```

**æ–¹å¼Bï¼šç›´æŽ¥ç²˜è´´**ï¼ˆé€‚åˆå¿«é€Ÿåˆ†æžï¼ŒæŽ¨èï¼âœ¨ï¼‰

```
æˆ‘ï¼šå¸®æˆ‘åˆ†æžè¿™äº›æç¤ºè¯ï¼š

a portrait of a woman, cinematic lighting, 85mm lens, ultra detailed
cyberpunk city at night, neon lights, rain, photorealistic
beautiful landscape, golden hour, dramatic clouds, HDR
```

**æ— éœ€åˆ›å»ºæ–‡ä»¶ï¼Œç›´æŽ¥ç²˜è´´å³å¯ï¼**

è¯¦è§ï¼š[ç²˜è´´æ¨¡å¼å®Œæ•´æŒ‡å—](PASTE_MODE_GUIDE.md)

### 3. è‡ªåŠ¨å¤„ç†

Skillä¼šè‡ªåŠ¨ï¼š
1. è¯†åˆ«æ–‡ä»¶æ ¼å¼
2. æ¸…æ´—å’ŒåŽ»é‡
3. èšç±»åˆ†æžï¼ˆå¦‚æžœ>100æ¡ï¼‰
4. é€æ¡æå–æ¨¡å—
5. ç”Ÿæˆæ¨¡å—åº“å’Œåˆ†æžæŠ¥å‘Š

## è¾“å‡ºæ–‡ä»¶è¯´æ˜Ž

### extracted_modules.json
å®Œæ•´çš„æå–ç»“æžœï¼Œæ¯æ¡æç¤ºè¯å¯¹åº”ä¸€ä¸ªJSONå¯¹è±¡ï¼š

```json
{
  "original_prompt": "a portrait of a young woman, cinematic lighting, 85mm lens f/1.4, ultra detailed, photorealistic",
  "theme": "äººåƒæ‘„å½±",
  "modules": {
    "subject_variables": {
      "main": "young woman",
      "modifiers": ["portrait"],
      "is_replaceable": true
    },
    "visual_style": {
      "art_style": "photorealistic",
      "reference_artists": [],
      "color_palette": "natural tones"
    },
    "technical_parameters": {
      "camera": "85mm lens f/1.4",
      "lighting": "cinematic lighting",
      "render_engine": null,
      "resolution": "ultra detailed"
    },
    "detail_enhancers": ["ultra detailed", "photorealistic"],
    "mood_atmosphere": "professional, elegant",
    "constraints": {
      "negative_prompt": "",
      "exclusions": []
    }
  },
  "quality_score": {
    "clarity": 9,
    "detail_richness": 8,
    "reusability": 9,
    "comments": "ç»“æž„æ¸…æ™°ï¼ŒæŠ€æœ¯å‚æ•°å…·ä½“ï¼Œé«˜åº¦å¯å¤ç”¨"
  },
  "extracted_patterns": {
    "structure_type": "åˆ†å±‚æè¿°ï¼šä¸»ä½“ + æŠ€æœ¯ + è´¨é‡",
    "advantages": ["å‚æ•°æ˜Žç¡®", "æ˜“äºŽæ›¿æ¢ä¸»ä½“", "ä¸“ä¸šæ‘„å½±æ ‡å‡†"],
    "reusable_templates": "{ä¸»ä½“}, {å…‰çº¿}, {é•œå¤´å‚æ•°}, {è´¨é‡å¢žå¼º}"
  }
}
```

### module_library.json
åŽ»é‡åŽçš„é€šç”¨æ¨¡å—åº“ï¼š

```json
{
  "visual_styles": {
    "art_styles": ["photorealistic", "cinematic", "cyberpunk", "anime", "oil painting"],
    "frequency": {"photorealistic": 45, "cinematic": 38}
  },
  "technical_params": {
    "camera_angles": ["85mm lens", "wide angle", "macro", "aerial view"],
    "lighting": ["cinematic lighting", "soft light", "backlight", "golden hour"],
    "render_engines": ["Unreal Engine", "Octane Render", "V-Ray"]
  },
  "detail_enhancers": [
    "ultra detailed", "8k", "hyperrealistic", "intricate details",
    "sharp focus", "professional photography"
  ],
  "templates": [
    {
      "name": "äººåƒæ‘„å½±æ¨¡æ¿",
      "structure": "{ä¸»ä½“}, {å…‰çº¿}, {é•œå¤´}, {è´¨é‡å¢žå¼º}",
      "example": "a portrait of {subject}, cinematic lighting, 85mm lens, ultra detailed",
      "usage_count": 23,
      "avg_quality_score": 8.7
    },
    {
      "name": "åœºæ™¯æž„å›¾æ¨¡æ¿",
      "structure": "{åœºæ™¯}, {æ°›å›´}, {è§†è§’}, {é£Žæ ¼}, {è´¨é‡}",
      "example": "{location} at {time}, {mood}, {camera_angle}, {art_style}, {detail_enhancers}",
      "usage_count": 18,
      "avg_quality_score": 8.2
    }
  ],
  "high_value_modules": [
    {
      "module": "cinematic lighting, 85mm lens f/1.4",
      "reusability_score": 9.5,
      "category": "technical_parameters",
      "usage_scenarios": ["äººåƒ", "äº§å“", "é™ç‰©"]
    }
  ]
}
```

### analysis_report.md
å¯è¯»çš„åˆ†æžæŠ¥å‘Šï¼š

```markdown
# æç¤ºè¯åˆ†æžæŠ¥å‘Š

## æ•°æ®æ¦‚è§ˆ
- æ€»æ•°ï¼š500æ¡
- æ¸…æ´—åŽï¼š487æ¡
- åŽ»é‡ï¼š13æ¡
- ä¸»é¢˜åˆ†å¸ƒï¼š
  - äººåƒæ‘„å½±ï¼š145æ¡ (29.8%)
  - é£Žæ™¯åœºæ™¯ï¼š132æ¡ (27.1%)
  - æ¦‚å¿µè‰ºæœ¯ï¼š98æ¡ (20.1%)
  - å…¶ä»–ï¼š112æ¡ (23.0%)

## é«˜é¢‘æ¨¡å—

### è§†è§‰é£Žæ ¼ Top 5
1. photorealistic (92æ¬¡)
2. cinematic (76æ¬¡)
3. cyberpunk (54æ¬¡)
4. anime style (43æ¬¡)
5. oil painting (38æ¬¡)

### æŠ€æœ¯å‚æ•° Top 5
1. cinematic lighting (88æ¬¡)
2. 85mm lens (67æ¬¡)
3. ultra detailed (156æ¬¡)
4. 8k (89æ¬¡)
5. Unreal Engine (45æ¬¡)

## æŽ¨èç»„åˆ

### ç»„åˆ1ï¼šä¸“ä¸šäººåƒ
**æ¨¡æ¿ï¼š** {äººç‰©}, cinematic lighting, 85mm lens f/1.4, ultra detailed, photorealistic
**ä¼˜åŠ¿ï¼š** æŠ€æœ¯å‚æ•°æ˜Žç¡®ï¼Œæˆç‰‡çŽ‡é«˜
**é€‚ç”¨åœºæ™¯ï¼š** äººåƒã€åŠèº«åƒã€ç‰¹å†™

### ç»„åˆ2ï¼šèµ›åšæœ‹å…‹åŸŽå¸‚
**æ¨¡æ¿ï¼š** cyberpunk {åœºæ™¯}, neon lights, rain, night, cinematic, 8k
**ä¼˜åŠ¿ï¼š** æ°›å›´å¼ºçƒˆï¼Œè§†è§‰å†²å‡»åŠ›å¼º
**é€‚ç”¨åœºæ™¯ï¼š** ç§‘å¹»ã€åŸŽå¸‚ã€æœªæ¥ä¸»ä¹‰

## æ”¹è¿›å»ºè®®

1. **å¢žåŠ è´Ÿé¢æç¤º**ï¼šåªæœ‰23%çš„æç¤ºè¯åŒ…å«è´Ÿé¢æç¤ºï¼Œå»ºè®®è¡¥å……
2. **ç»†åŒ–æŠ€æœ¯å‚æ•°**ï¼š67%çš„æç¤ºç¼ºä¹å…·ä½“é•œå¤´å‚æ•°
3. **æ˜Žç¡®è‰ºæœ¯é£Žæ ¼**ï¼šå»ºè®®æ¯ä¸ªæç¤ºéƒ½æŒ‡å®šæ¸…æ™°çš„é£Žæ ¼æ ‡ç­¾
```

## ä½¿ç”¨åœºæ™¯ç¤ºä¾‹

### åœºæ™¯1ï¼šæ–°æ‰‹å­¦ä¹ ä¼˜ç§€æç¤ºè¯ç»“æž„

```
ç”¨æˆ·ï¼šæˆ‘æœ‰ä¸€ä¸ªæ”¶è—çš„500æ¡AIç»˜ç”»æç¤ºè¯ï¼Œæƒ³å­¦ä¹ å®ƒä»¬çš„ç»“æž„
æ“ä½œï¼šä½¿ç”¨ prompt-extractor åˆ†æž favorites.txt
è¾“å‡ºï¼š
  - å‘çŽ°85%ä½¿ç”¨"ä¸»ä½“+æŠ€æœ¯+è´¨é‡"ç»“æž„
  - æå–10ä¸ªé«˜å¤ç”¨æ¨¡æ¿
  - ç”Ÿæˆå­¦ä¹ æ‰‹å†Œ
```

### åœºæ™¯2ï¼šæž„å»ºè‡ªå·±çš„æ¨¡å—åº“

```
ç”¨æˆ·ï¼šæˆ‘æƒ³ä»Ž1ä¸‡æ¡æç¤ºè¯ä¸­æç‚¼å‡ºæˆ‘çš„ä¸“å±žæ¨¡å—åº“
æ“ä½œï¼šåˆ†æ‰¹å¤„ç†ï¼Œæ¯æ¬¡2000æ¡
è¾“å‡ºï¼š
  - åŽ»é‡åŽçš„5000+ç‹¬ç‰¹æ¨¡å—
  - æŒ‰ä¸»é¢˜åˆ†ç±»çš„æ¨¡æ¿åº“
  - å¯ç›´æŽ¥å¤ç”¨çš„JSONæ–‡ä»¶
```

### åœºæ™¯3ï¼šæå‡æç¤ºè¯è´¨é‡

```
ç”¨æˆ·ï¼šæˆ‘çš„æç¤ºè¯æ•ˆæžœä¸å¥½ï¼Œæƒ³æ‰¾åˆ°é«˜è´¨é‡æ¨¡å¼
æ“ä½œï¼šä¸Šä¼ å¤±è´¥æ¡ˆä¾‹å’ŒæˆåŠŸæ¡ˆä¾‹ä¸¤ä¸ªæ–‡ä»¶å¯¹æ¯”
è¾“å‡ºï¼š
  - è¯†åˆ«æˆåŠŸæ¡ˆä¾‹çš„å…±åŒæ¨¡å¼
  - æŒ‡å‡ºå¤±è´¥æ¡ˆä¾‹çš„ç¼ºé™·ï¼ˆå¦‚ç¼ºä¹æŠ€æœ¯å‚æ•°ï¼‰
  - æä¾›æ”¹è¿›å»ºè®®
```

## é«˜çº§åŠŸèƒ½

### 1. å¢žé‡æ›´æ–°æ¨¡å—åº“

```python
# åˆå¹¶æ–°æç¤ºè¯åˆ°çŽ°æœ‰åº“
python preprocessor.py new_prompts.txt updated_library.json
```

### 2. ä¸»é¢˜è¿‡æ»¤

åœ¨skillä¸­æŒ‡å®šï¼š
```
åªæå–"äººåƒæ‘„å½±"ä¸»é¢˜çš„æ¨¡å—
```

### 3. è‡ªå®šä¹‰è¯„åˆ†æ ‡å‡†

ä¿®æ”¹ skill.md ä¸­çš„è¯„åˆ†æƒé‡ï¼š
```json
"quality_score": {
  "clarity": {"weight": 0.3, "score": 8},
  "detail_richness": {"weight": 0.3, "score": 9},
  "reusability": {"weight": 0.4, "score": 7}
}
```

## æœ€ä½³å®žè·µ

### æ•°æ®å‡†å¤‡
1. å…ˆæ¸…ç†æ˜Žæ˜¾æ— æ•ˆçš„æç¤ºï¼ˆå¦‚ä¹±ç ã€æµ‹è¯•æ–‡æœ¬ï¼‰
2. å¦‚æžœæœ‰è¯„åˆ†ï¼Œä¿ç•™é«˜åˆ†æç¤ºä¼˜å…ˆå¤„ç†
3. æŒ‰ä¸»é¢˜åˆ†æ–‡ä»¶æ›´æ˜“ç®¡ç†

### æ‰¹æ¬¡å¤„ç†ç­–ç•¥
- **<100æ¡**ï¼šä¸€æ¬¡æ€§å¤„ç†ï¼Œç²¾ç»†æå–
- **100-500æ¡**ï¼šæŽ¨èè§„æ¨¡ï¼Œå•æ¬¡skillè°ƒç”¨
- **>500æ¡**ï¼šåˆ†æ‰¹å¤„ç†ï¼Œæ¯æ‰¹300-500æ¡

### è´¨é‡ä¿éšœ
1. é¦–æ¬¡å¤„ç†å‰ï¼Œæ‰‹åŠ¨æ ‡æ³¨20-50æ¡ä½œä¸ºåŸºå‡†
2. å¯¹æ¯”AIæå–ç»“æžœï¼Œè°ƒæ•´meta-prompt
3. è¿­ä»£3-5æ¬¡è¾¾åˆ°æ»¡æ„ç²¾åº¦

## æ•…éšœæŽ’é™¤

### é—®é¢˜1ï¼šæ–‡ä»¶æ ¼å¼è¯†åˆ«å¤±è´¥
**åŽŸå› **ï¼šç¼–ç é—®é¢˜æˆ–æ ¼å¼ä¸æ ‡å‡†
**è§£å†³**ï¼š
```bash
# è½¬æ¢ç¼–ç ä¸ºUTF-8
iconv -f GBK -t UTF-8 input.txt > output.txt
```

### é—®é¢˜2ï¼šæå–è´¨é‡å·®
**åŽŸå› **ï¼šæç¤ºè¯æœ¬èº«è´¨é‡ä½Žæˆ–ç»“æž„æ··ä¹±
**è§£å†³**ï¼š
- å…ˆèšç±»ï¼Œåªå¤„ç†ä¸»é¢˜æ¸…æ™°çš„ç°‡
- æé«˜ min_length é˜ˆå€¼è¿‡æ»¤çŸ­æç¤º
- äººå·¥reviewå‰100æ¡ï¼Œè°ƒæ•´æå–è§„åˆ™

### é—®é¢˜3ï¼šå¤„ç†é€Ÿåº¦æ…¢
**åŽŸå› **ï¼šå•æ¬¡å¤„ç†é‡è¿‡å¤§
**è§£å†³**ï¼š
- å‡å°‘æ‰¹æ¬¡å¤§å°ï¼ˆæŽ¨è50-100æ¡/æ‰¹ï¼‰
- å…ˆèšç±»åŽå¹¶è¡Œå¤„ç†å„ç°‡
- ä½¿ç”¨é¢„å¤„ç†è„šæœ¬å…ˆè¿‡æ»¤

## æŠ€æœ¯æ”¯æŒ

å¦‚éœ€å¸®åŠ©ï¼Œåœ¨Claude Codeä¸­é—®ï¼š
```
prompt-extractor å¦‚ä½•å¤„ç†CSVä¸­çš„å¤šåˆ—æ•°æ®ï¼Ÿ
prompt-extractor å¦‚ä½•è‡ªå®šä¹‰æ¨¡å—åˆ†ç±»ï¼Ÿ
```

## æ›´æ–°æ—¥å¿—

**v1.0** (å½“å‰ç‰ˆæœ¬)
- æ”¯æŒ txt/csv/json ä¸‰ç§æ ¼å¼
- è‡ªåŠ¨èšç±»å’Œä¸»é¢˜è¯†åˆ«
- æ¨¡å—åŒ–æå–å’Œè´¨é‡è¯„åˆ†
- ç”Ÿæˆå¯å¤ç”¨æ¨¡æ¿åº“

**è·¯çº¿å›¾**
- [ ] æ”¯æŒå¤šè¯­è¨€æç¤ºè¯ï¼ˆä¸­æ–‡ã€æ—¥æ–‡ï¼‰
- [ ] å¯è§†åŒ–åˆ†æždashboard
- [ ] ä¸ŽMidjourney/SDå‚æ•°åº“å¯¹æŽ¥
- [ ] åœ¨çº¿æ¨¡å—æœç´¢å¼•æ“Ž



================================================
FILE: .claude/skills/prompt-extractor/example_prompts.txt
================================================
a portrait of a young woman, cinematic lighting, 85mm lens f/1.4, soft focus, ultra detailed, photorealistic, professional photography
cyberpunk city at night, neon lights reflecting on wet streets, rain, cinematic atmosphere, 8k, Unreal Engine, hyperrealistic
beautiful landscape, mountain range at golden hour, dramatic clouds, wide angle lens, nature photography, sharp focus, HDR
anime style character, colorful hair, detailed eyes, studio ghibli inspired, digital art, vibrant colors, trending on artstation
macro photography of a flower, morning dew drops, shallow depth of field, natural lighting, bokeh background, highly detailed
futuristic spaceship interior, sci-fi concept art, blue and white color scheme, volumetric lighting, 4k, octane render
oil painting of a still life, fruits on wooden table, classical composition, warm tones, rembrandt lighting, masterpiece
street photography, candid moment, black and white, film grain, 35mm lens, documentary style, authentic emotion
fantasy castle on a cliff, sunset, epic scale, matte painting, dramatic lighting, concept art, highly detailed architecture
minimalist product photography, white background, studio lighting, clean composition, commercial photography, high resolution
portrait of an elderly man, wisdom in eyes, natural wrinkles, storytelling portrait, medium format, shallow depth of field
underwater scene, coral reef, tropical fish, blue water, sun rays penetrating water, marine photography, crystal clear
cyberpunk portrait, woman with neon tattoos, dark background, purple and blue lighting, futuristic fashion, cinematic, 4k
cozy coffee shop interior, warm ambient lighting, wooden furniture, plants, lifestyle photography, inviting atmosphere
abstract digital art, geometric shapes, gradient colors, modern art, minimalist design, 8k wallpaper
desert landscape at sunset, sand dunes, long shadows, warm color palette, landscape photography, dramatic sky
steampunk mechanism, gears and brass, intricate details, victorian era inspired, sepia tones, technical illustration
fashion photography, model on runway, dramatic pose, high fashion, professional lighting, vogue style, editorial
enchanted forest, misty atmosphere, rays of light through trees, magical mood, fantasy art, detailed foliage
urban architecture, modern building, geometric lines, blue hour photography, symmetrical composition, architectural photography
food photography, gourmet dish, garnished beautifully, shallow depth of field, natural light, appetizing presentation
space nebula, stars and cosmic dust, deep space photography, vibrant colors, Hubble telescope style, astronomical
retro 80s aesthetic, vaporwave style, pink and cyan colors, grid patterns, nostalgic, digital art
wildlife photography, tiger in natural habitat, golden hour light, telephoto lens, national geographic style
post-apocalyptic cityscape, overgrown buildings, nature reclaiming civilization, moody atmosphere, concept art
japanese garden, cherry blossoms, koi pond, traditional architecture, serene atmosphere, spring season, peaceful
neon sign close-up, glowing letters, dark background, urban photography, bokeh effect, night scene
hyperrealistic eye close-up, detailed iris, reflections, macro photography, extreme detail, beauty photography
art deco interior design, gold and marble, geometric patterns, luxury, 1920s inspired, elegant composition
mountain climber on peak, dramatic landscape, achievement moment, adventure photography, wide vista, inspiring



================================================
FILE: .claude/skills/prompt-extractor/MODULE_REFERENCE.md
================================================
# 10å¤§æ¨¡å—åˆ†ç±»å®Œæ•´å‚è€ƒæ‰‹å†Œ

## æ¨¡å—ä½“ç³»æ¦‚è§ˆ

```
AIç»˜ç”»æç¤ºè¯ = 10å¤§æ¨¡å—çš„ç»„åˆ
â”œâ”€â”€ 1. ä¸»ä½“å˜é‡ (Subject Variables)
â”œâ”€â”€ 2. è§†è§‰é£Žæ ¼ (Visual Style)
â”œâ”€â”€ 3. æŠ€æœ¯å‚æ•° (Technical Parameters)
â”œâ”€â”€ 4. ç»†èŠ‚å¢žå¼º (Detail Enhancers)
â”œâ”€â”€ 5. æƒ…ç»ªæ°›å›´ (Mood & Atmosphere)
â”œâ”€â”€ 6. çº¦æŸæ¡ä»¶ (Constraints)
â”œâ”€â”€ 7. æž„å›¾å‚æ•° (Composition) â† æ–°å¢ž
â”œâ”€â”€ 8. è‰²å½©æ–¹æ¡ˆ (Color Scheme) â† æ–°å¢ž
â”œâ”€â”€ 9. æ—¶é—´/å­£èŠ‚ (Time & Season) â† æ–°å¢ž
â””â”€â”€ 10. å‚è€ƒè‰ºæœ¯å®¶/ä½œå“ (References) â† æ–°å¢ž
```

---

## 1. ä¸»ä½“å˜é‡ (Subject Variables)

**å®šä¹‰**ï¼šæç¤ºè¯çš„æ ¸å¿ƒå¯¹è±¡ï¼Œå¯æ›¿æ¢æ€§æœ€å¼ºçš„éƒ¨åˆ†ã€‚

### å­æ¨¡å—
- **main**: ä¸»å¯¹è±¡ï¼ˆäººç‰©ã€ç‰©ä½“ã€åœºæ™¯ï¼‰
- **modifiers**: ä¿®é¥°è¯
- **attributes**: å…·ä½“å±žæ€§
- **is_replaceable**: æ˜¯å¦å¯æ›¿æ¢ï¼ˆå¸ƒå°”å€¼ï¼‰

### ç¤ºä¾‹

| æç¤ºè¯ | ä¸»å¯¹è±¡ | ä¿®é¥°è¯ | å±žæ€§ |
|--------|--------|--------|------|
| "a young woman" | woman | young | - |
| "cyberpunk city" | city | cyberpunk | - |
| "red sports car" | sports car | - | red |
| "elven warrior, silver hair" | elven warrior | - | silver hair |

### æå–æŠ€å·§
- é€šå¸¸åœ¨æç¤ºè¯å¼€å¤´
- åè¯æˆ–åè¯çŸ­è¯­
- åŽ»æŽ‰åŽæç¤ºè¯å¤±åŽ»ä¸»é¢˜çš„éƒ¨åˆ†

### å¤ç”¨ä»·å€¼
â­â­â­â­â­ (æœ€é«˜)
- æ›¿æ¢ä¸»ä½“å¯ç”ŸæˆåŒé£Žæ ¼ä¸åŒä¸»é¢˜çš„ä½œå“
- æ¨¡æ¿å¤ç”¨çš„æ ¸å¿ƒ

---

## 2. è§†è§‰é£Žæ ¼ (Visual Style)

**å®šä¹‰**ï¼šæ•´ä½“è‰ºæœ¯é£Žæ ¼ã€ç”»é£Žã€å¹´ä»£æ„Ÿã€‚

### å­æ¨¡å—
- **art_style**: è‰ºæœ¯é£Žæ ¼
- **era**: å¹´ä»£æ„Ÿ/æ—¶ä»£

### å¸¸è§é£Žæ ¼åˆ†ç±»

**å†™å®žç±»**ï¼š
- photorealistic, hyperrealistic, photo-real
- cinematic, filmic
- documentary style

**è‰ºæœ¯ç±»**ï¼š
- oil painting, watercolor, ink drawing
- digital art, concept art
- pixel art, low poly

**é£Žæ ¼æµæ´¾**ï¼š
- impressionism, surrealism, abstract
- anime style, manga style
- art deco, art nouveau

**ç‰¹å®šä¸–ç•Œè§‚**ï¼š
- cyberpunk, steampunk, dieselpunk
- fantasy, sci-fi, post-apocalyptic
- retro, vintage, futuristic

### ç¤ºä¾‹

```
photorealistic â†’ ç…§ç‰‡çº§çœŸå®ž
anime style â†’ åŠ¨æ¼«é£Žæ ¼
oil painting, renaissance style â†’ æ–‡è‰ºå¤å…´æ²¹ç”»
cyberpunk aesthetic â†’ èµ›åšæœ‹å…‹ç¾Žå­¦
minimalist design â†’ æžç®€ä¸»ä¹‰è®¾è®¡
```

### å¤ç”¨ä»·å€¼
â­â­â­â­â­
- å®šä¹‰æ•´ä½“è§†è§‰åŸºè°ƒ
- é£Žæ ¼ä¸€è‡´æ€§çš„å…³é”®

---

## 3. æŠ€æœ¯å‚æ•° (Technical Parameters)

**å®šä¹‰**ï¼šæ‘„å½±/æ¸²æŸ“çš„æŠ€æœ¯è§„æ ¼ã€‚

### å­æ¨¡å—
- **camera**: é•œå¤´å‚æ•°
- **lighting**: å…‰çº¿æè¿°
- **render_engine**: æ¸²æŸ“å¼•æ“Ž
- **resolution**: åˆ†è¾¨çŽ‡/è´¨é‡

### é•œå¤´å‚æ•°è¯¦è§£

**ç„¦è·**ï¼š
- 14mm, 24mm â†’ è¶…å¹¿è§’
- 35mm, 50mm â†’ æ ‡å‡†é•œå¤´
- 85mm, 105mm â†’ äººåƒé•œå¤´
- 200mm+ â†’ é•¿ç„¦/é‡Žç”ŸåŠ¨ç‰©

**å…‰åœˆ**ï¼š
- f/1.4, f/1.8 â†’ å¤§å…‰åœˆï¼Œæµ…æ™¯æ·±
- f/8, f/11 â†’ å°å…‰åœˆï¼Œå¤§æ™¯æ·±

### å…‰çº¿ç±»åž‹

**è‡ªç„¶å…‰**ï¼š
- natural lighting, sunlight
- window light, diffused light
- golden hour, blue hour

**äººå·¥å…‰**ï¼š
- studio lighting, softbox
- ring light, key light
- neon lights, LED

**ç‰¹æ®Šå…‰æ•ˆ**ï¼š
- rim lighting (è½®å»“å…‰)
- backlighting (é€†å…‰)
- volumetric lighting (ä½“ç§¯å…‰)
- god rays (ä¸è¾¾å°”æ•ˆåº”)

### æ¸²æŸ“å¼•æ“Ž

```
Unreal Engine 5 â†’ æ¸¸æˆçº§å®žæ—¶æ¸²æŸ“
Octane Render â†’ é«˜è´¨é‡ç¦»çº¿æ¸²æŸ“
V-Ray â†’ å»ºç­‘å¯è§†åŒ–
Blender Cycles â†’ å¼€æºæ¸²æŸ“å™¨
```

### ç¤ºä¾‹

```
85mm lens f/1.4 â†’ äººåƒæ ‡å‡†é…ç½®
wide angle 24mm â†’ é£Žå…‰/å»ºç­‘
macro 100mm lens â†’ å¾®è·æ‘„å½±
cinematic lighting, rim light â†’ ç”µå½±çº§å…‰æ•ˆ
rendered in Unreal Engine 5 â†’ UE5æ¸²æŸ“
```

### å¤ç”¨ä»·å€¼
â­â­â­â­
- ç›´æŽ¥å½±å“æˆç‰‡è´¨é‡
- ä¸“ä¸šæ„Ÿçš„ä½“çŽ°

---

## 4. ç»†èŠ‚å¢žå¼º (Detail Enhancers)

**å®šä¹‰**ï¼šæå‡è´¨é‡ã€ç»†èŠ‚çš„ä¿®é¥°è¯ã€‚

### åˆ†ç±»

**åˆ†è¾¨çŽ‡/æ¸…æ™°åº¦**ï¼š
- 8k, 4k, ultra high resolution
- sharp focus, crystal clear
- highly detailed, intricate details

**è´¨é‡æ ‡å‡†**ï¼š
- professional photography
- award-winning
- masterpiece, best quality

**å¹³å°/ç«žèµ›**ï¼š
- trending on artstation
- featured on behance
- contest winner

### å¸¸è§ç»„åˆ

```
ultra detailed, 8k, sharp focus
highly detailed, intricate, professional
hyperrealistic, photorealistic, 8k uhd
masterpiece, best quality, award-winning
```

### ç¤ºä¾‹

| æç¤ºè¯ | æ•ˆæžœ |
|--------|------|
| 8k | æš—ç¤ºæžé«˜åˆ†è¾¨çŽ‡ |
| sharp focus | å¼ºè°ƒæ¸…æ™°åº¦ |
| intricate details | å¤æ‚ç»†èŠ‚ |
| professional photography | ä¸“ä¸šæ‘„å½±æ°´å‡† |

### å¤ç”¨ä»·å€¼
â­â­â­â­
- å‡ ä¹Žæ‰€æœ‰æç¤ºè¯éƒ½éœ€è¦
- æ˜¾è‘—æå‡ç”Ÿæˆè´¨é‡

---

## 5. æƒ…ç»ªæ°›å›´ (Mood & Atmosphere)

**å®šä¹‰**ï¼šæƒ…æ„ŸåŸºè°ƒã€æ°›å›´æ„Ÿå—ã€‚

### æƒ…ç»ªç±»åž‹

**æ­£é¢æƒ…ç»ª**ï¼š
- joyful, cheerful, uplifting
- peaceful, serene, calm
- epic, majestic, grand

**è´Ÿé¢æƒ…ç»ª**ï¼š
- melancholic, sad, somber
- tense, anxious, ominous
- dark, gloomy, moody

**ä¸­æ€§/å¤æ‚**ï¼š
- mysterious, enigmatic
- nostalgic, wistful
- ethereal, dreamlike

### æ°›å›´æè¿°

**ç©ºé—´æ°›å›´**ï¼š
- cozy, intimate
- vast, expansive
- claustrophobic, confined

**æ—¶é—´æ°›å›´**ï¼š
- timeless, eternal
- fleeting, transient
- suspended in time

### ç¤ºä¾‹

```
peaceful morning atmosphere
dark and mysterious mood
epic and dramatic feeling
nostalgic 80s vibe
ethereal dreamlike quality
```

### å¤ç”¨ä»·å€¼
â­â­â­
- ä¼ é€’æƒ…æ„Ÿä¿¡æ¯
- æå‡è‰ºæœ¯è¡¨çŽ°åŠ›

---

## 6. çº¦æŸæ¡ä»¶ (Constraints)

**å®šä¹‰**ï¼šè´Ÿé¢æç¤ºã€æŽ’é™¤å…ƒç´ ã€æŠ€æœ¯çº¦æŸã€‚

### å­æ¨¡å—
- **negative_prompt**: è´Ÿé¢æç¤º
- **exclusions**: æŽ’é™¤å…ƒç´ 

### å¸¸è§è´Ÿé¢æç¤º

**è´¨é‡ç›¸å…³**ï¼š
- no blur, not blurry
- no distortion, no artifacts
- no noise, no grain (é™¤éžåˆ»æ„è¦èƒ¶ç‰‡æ„Ÿ)

**å†…å®¹ç›¸å…³**ï¼š
- no text, no watermark
- no extra limbs, no deformed
- no low quality, no bad anatomy

**Stable Diffusionä¸“ç”¨**ï¼š
```
Negative: ugly, tiling, poorly drawn hands, poorly drawn feet,
poorly drawn face, out of frame, extra limbs, disfigured,
deformed, body out of frame, blurry, bad anatomy, blurred,
watermark, grainy, signature, cut off, draft
```

**Midjourneyä¸“ç”¨**ï¼š
```
--no text, watermark, signature
--no blur, distortion
```

### ç¤ºä¾‹

```
portrait of a woman, beautiful, detailed
Negative: ugly, deformed, blurry, low quality

landscape, mountains, epic
--no people, buildings, text
```

### å¤ç”¨ä»·å€¼
â­â­â­â­
- é¿å…å¸¸è§é—®é¢˜
- æé«˜æˆç‰‡çŽ‡

---

## 7. æž„å›¾å‚æ•° (Composition) âœ¨ æ–°å¢ž

**å®šä¹‰**ï¼šç”»é¢æž„å›¾ã€è§†è§’ã€æ™¯æ·±ç­‰è§†è§‰ç»„ç»‡æ–¹å¼ã€‚

### å­æ¨¡å—
- **perspective**: è§†è§’
- **depth_of_field**: æ™¯æ·±
- **aspect_ratio**: ç”»å¹…æ¯”ä¾‹
- **symmetry**: å¯¹ç§°æ€§
- **rule**: æž„å›¾æ³•åˆ™

### è§†è§’ç±»åž‹

**é«˜åº¦è§†è§’**ï¼š
- bird's eye view (é¸Ÿçž°)
- high angle (ä¿¯è§†)
- eye level (å¹³è§†)
- low angle (ä»°è§†)
- worm's eye view (è™«è§†)

**è·ç¦»è§†è§’**ï¼š
- extreme close-up (å¤§ç‰¹å†™)
- close-up (ç‰¹å†™)
- medium shot (ä¸­æ™¯)
- full body (å…¨èº«)
- wide shot (è¿œæ™¯)

**ç‰¹æ®Šè§†è§’**ï¼š
- first person POV (ç¬¬ä¸€äººç§°)
- over the shoulder (è¿‡è‚©)
- dutch angle (è·å…°è§’/å€¾æ–œ)

### æ™¯æ·±æè¿°

```
shallow depth of field (æµ…æ™¯æ·±) â†’ èƒŒæ™¯è™šåŒ–
deep depth of field (å¤§æ™¯æ·±) â†’ å…¨æ™¯æ¸…æ™°
bokeh background (ç„¦å¤–æ•£æ™¯)
f/1.4, soft bokeh â†’ æŸ”ç¾Žæ•£æ™¯
```

### ç”»å¹…æ¯”ä¾‹

| æ¯”ä¾‹ | ç”¨é€” | ç¤ºä¾‹ |
|------|------|------|
| 1:1 | ç¤¾äº¤åª’ä½“ | Instagram |
| 16:9 | ç”µå½±/æ¨ªå± | YouTube |
| 9:16 | ç«–å±è§†é¢‘ | TikTok |
| 4:3 | ä¼ ç»Ÿæ‘„å½± | ç»å…¸ç…§ç‰‡ |
| 21:9 | è¶…å®½ç”µå½± | å½±é™¢ |

### æž„å›¾æ³•åˆ™

**ç»å…¸æ³•åˆ™**ï¼š
- rule of thirds (ä¸‰åˆ†æ³•)
- golden ratio (é»„é‡‘åˆ†å‰²)
- leading lines (å¼•å¯¼çº¿)
- frame within frame (æ¡†ä¸­æ¡†)

**å¯¹ç§°æž„å›¾**ï¼š
- symmetrical composition
- centered composition
- radial symmetry

### ç¤ºä¾‹

```
portrait, close-up, shallow DOF, f/1.4
landscape, wide shot, deep focus, rule of thirds
architectural photo, symmetrical composition, centered
bird's eye view, urban cityscape, dramatic perspective
```

### å¤ç”¨ä»·å€¼
â­â­â­â­â­
- ä¸“ä¸šæ‘„å½±å¿…å¤‡
- æ˜¾è‘—æå‡æž„å›¾è´¨é‡

---

## 8. è‰²å½©æ–¹æ¡ˆ (Color Scheme) âœ¨ æ–°å¢ž

**å®šä¹‰**ï¼šè‰²è°ƒã€é…è‰²ã€é¥±å’Œåº¦ç­‰è‰²å½©ç›¸å…³æè¿°ã€‚

### å­æ¨¡å—
- **tone**: è‰²è°ƒï¼ˆæš–/å†·ï¼‰
- **palette**: è°ƒè‰²æ¿/ä¸»è¦é¢œè‰²
- **saturation**: é¥±å’Œåº¦
- **contrast**: å¯¹æ¯”åº¦
- **temperature**: è‰²æ¸©

### è‰²è°ƒåˆ†ç±»

**æ¸©åº¦è‰²è°ƒ**ï¼š
- warm tones (æš–è‰²è°ƒ) â†’ çº¢æ©™é»„
- cool tones (å†·è‰²è°ƒ) â†’ è“ç»¿ç´«
- neutral tones (ä¸­æ€§è‰²è°ƒ) â†’ ç°ç™½é»‘

**æ˜Žåº¦è‰²è°ƒ**ï¼š
- bright colors (æ˜Žäº®è‰²)
- pastel colors (ç²‰å½©è‰²)
- dark colors (æ·±è‰²)
- muted colors (æŸ”å’Œè‰²)

### é…è‰²æ–¹æ¡ˆ

**å•è‰²ç³»**ï¼š
- monochromatic (å•è‰²)
- black and white (é»‘ç™½)
- sepia tones (æ£•è¤è‰²)

**äº’è¡¥è‰²**ï¼š
- blue and orange
- purple and yellow
- red and cyan

**ç±»ä¼¼è‰²**ï¼š
- analogous colors (é‚»è¿‘è‰²)
- earth tones (å¤§åœ°è‰²)
- jewel tones (å®çŸ³è‰²)

**ç‰¹å®šé…è‰²**ï¼š
- cyberpunk colors (èµ›åšæœ‹å…‹) â†’ ç´«ã€é’ã€ç²‰
- vaporwave aesthetic â†’ ç²‰ã€é’ã€ç´«æ¸å˜
- autumn colors â†’ æ©™ã€é»„ã€æ£•
- nordic palette â†’ ç°ã€ç™½ã€è“

### é¥±å’Œåº¦æè¿°

```
highly saturated, vibrant colors â†’ é«˜é¥±å’Œé²œè‰³
desaturated, washed out â†’ ä½Žé¥±å’Œè¤ªè‰²
oversaturated, neon colors â†’ è¿‡é¥±å’Œéœ“è™¹
natural colors, true to life â†’ è‡ªç„¶çœŸå®žè‰²å½©
```

### å¯¹æ¯”åº¦

```
high contrast â†’ å¼ºå¯¹æ¯”
low contrast, soft â†’ ä½Žå¯¹æ¯”æŸ”å’Œ
dramatic contrast â†’ æˆå‰§æ€§å¯¹æ¯”
subtle contrast â†’ å¾®å¦™å¯¹æ¯”
```

### ç¤ºä¾‹

```
warm color palette, golden tones â†’ æš–è‰²ç³»é‡‘è‰²è°ƒ
cool blue and purple tones, high contrast
cyberpunk colors, neon pink and cyan, vibrant
pastel colors, soft and dreamy, low saturation
monochromatic blue, various shades of blue
```

### å¤ç”¨ä»·å€¼
â­â­â­â­â­
- å®šä¹‰è§†è§‰æƒ…ç»ª
- é£Žæ ¼ä¸€è‡´æ€§å…³é”®

---

## 9. æ—¶é—´/å­£èŠ‚ (Time & Season) âœ¨ æ–°å¢ž

**å®šä¹‰**ï¼šæ—¶é—´æ®µã€å­£èŠ‚ã€å¤©æ°”çŠ¶æ€ã€‚

### å­æ¨¡å—
- **time_of_day**: æ—¶é—´æ®µ
- **season**: å­£èŠ‚
- **weather**: å¤©æ°”çŠ¶æ€

### æ—¶é—´æ®µ

**é»„é‡‘æ—¶åˆ»**ï¼š
- golden hour (æ—¥å‡ºæ—¥è½å‰åŽ1å°æ—¶)
- blue hour (æ°‘ç”¨æ›™æš®å…‰æ—¶æ®µ)
- magic hour (é­”æ³•æ—¶åˆ»)

**ä¸€å¤©æ—¶æ®µ**ï¼š
- dawn, sunrise (é»Žæ˜Žã€æ—¥å‡º)
- morning, noon (æ—©æ™¨ã€æ­£åˆ)
- afternoon (ä¸‹åˆ)
- dusk, sunset (é»„æ˜ã€æ—¥è½)
- twilight (æš®å…‰)
- night, midnight (å¤œæ™šã€åˆå¤œ)

### å­£èŠ‚ç‰¹å¾

| å­£èŠ‚ | è§†è§‰ç‰¹å¾ | å…³é”®è¯ |
|------|---------|--------|
| æ˜¥ Spring | æ–°ç»¿ã€èŠ±æœµ | cherry blossoms, fresh green |
| å¤ Summer | æ˜Žäº®ã€é˜³å…‰ | bright sunlight, lush |
| ç§‹ Autumn | é‡‘é»„ã€è½å¶ | golden leaves, harvest |
| å†¬ Winter | é›ªã€å†·è‰² | snow, frost, cold |

### å¤©æ°”çŠ¶æ€

**æ™´æœ—**ï¼š
- clear sky, sunny
- cloudless, bright

**äº‘é›¾**ï¼š
- cloudy, overcast
- misty, foggy
- hazy

**é™æ°´**ï¼š
- rainy, rain drops
- snowy, snowfall
- stormy

**ç‰¹æ®Šå¤©æ°”**ï¼š
- dramatic clouds
- storm clouds, lightning
- rainbow after rain

### å…‰çº¿ä¸Žæ—¶é—´çš„å…³ç³»

```
golden hour â†’ æ¸©æš–é‡‘è‰²å…‰çº¿ï¼Œé•¿é˜´å½±
blue hour â†’ å†·è“è‰²è°ƒï¼ŒæŸ”å’Œå…‰çº¿
noon â†’ å¼ºçƒˆé¡¶å…‰ï¼ŒçŸ­é˜´å½±
overcast â†’ æŸ”å’Œæ¼«å°„å…‰ï¼Œæ— æ˜Žæ˜¾é˜´å½±
```

### ç¤ºä¾‹

```
golden hour lighting, warm sunset glow
misty morning, soft diffused light
winter scene, snow falling, cold blue tones
stormy sky, dramatic clouds, moody atmosphere
cherry blossom season, spring, soft pink petals
```

### å¤ç”¨ä»·å€¼
â­â­â­â­
- è‡ªç„¶å…‰æ•ˆçš„å…³é”®
- æ°›å›´è¥é€ é‡è¦å…ƒç´ 

---

## 10. å‚è€ƒè‰ºæœ¯å®¶/ä½œå“ (References) âœ¨ æ–°å¢ž

**å®šä¹‰**ï¼šå¼•ç”¨ç‰¹å®šè‰ºæœ¯å®¶ã€ä½œå“é£Žæ ¼ã€å¹³å°é£Žæ ¼ã€‚

### å­æ¨¡å—
- **artists**: è‰ºæœ¯å®¶åç§°åˆ—è¡¨
- **styles**: ç‰¹å®šé£Žæ ¼å¼•ç”¨
- **platforms**: å¹³å°é£Žæ ¼

### çƒ­é—¨è‰ºæœ¯å®¶

**æ•°å­—è‰ºæœ¯**ï¼š
- Greg Rutkowski (å¥‡å¹»ã€å²è¯—)
- Artgerm (äººç‰©ã€æ’ç”»)
- Sakimichan (åŠ¨æ¼«é£Ž)
- Loish (è‰²å½©ã€è§’è‰²)

**ä¼ ç»Ÿå¤§å¸ˆ**ï¼š
- Rembrandt (å…‰å½±å¤§å¸ˆ)
- Monet (å°è±¡æ´¾)
- Van Gogh (åŽå°è±¡æ´¾)
- Caravaggio (å·´æ´›å…‹)

**æ¦‚å¿µè‰ºæœ¯**ï¼š
- Syd Mead (æœªæ¥ä¸»ä¹‰)
- H.R. Giger (ç”Ÿç‰©æœºæ¢°)
- Moebius (ç§‘å¹»æ¼«ç”»)

**æ‘„å½±å¸ˆ**ï¼š
- Annie Leibovitz (äººåƒ)
- Ansel Adams (é£Žå…‰)
- Steve McCurry (çºªå®ž)

### å·¥ä½œå®¤/å“ç‰Œé£Žæ ¼

```
Studio Ghibli style â†’ å‰åœåŠ›åŠ¨ç”»é£Žæ ¼
Pixar style â†’ çš®å…‹æ–¯3DåŠ¨ç”»
Disney animation â†’ è¿ªå£«å°¼é£Žæ ¼
Wes Anderson aesthetic â†’ éŸ¦æ–¯Â·å®‰å¾·æ£®ç”µå½±ç¾Žå­¦
```

### å¹³å°å¼•ç”¨

**è‰ºæœ¯ç¤¾åŒº**ï¼š
- trending on ArtStation
- featured on Behance
- DeviantArt popular

**æ‘„å½±å¹³å°**ï¼š
- 500px, Flickr
- National Geographic style
- Vogue magazine style

### ä½¿ç”¨æŠ€å·§

**å•ä¸€å¼•ç”¨**ï¼š
```
portrait by Annie Leibovitz â†’ æ¸…æ™°é£Žæ ¼æŒ‡å‘
```

**æ··åˆå¼•ç”¨**ï¼š
```
Greg Rutkowski and Alphonse Mucha style â†’ èžåˆä¸¤ç§é£Žæ ¼
in the style of Studio Ghibli meets Moebius â†’ é£Žæ ¼ç¢°æ’ž
```

**æ—¶ä»£å¼•ç”¨**ï¼š
```
renaissance painting style â†’ æ–‡è‰ºå¤å…´é£Žæ ¼
80s retro aesthetic â†’ 80å¹´ä»£å¤å¤
```

### ç¤ºä¾‹

```
fantasy landscape, Greg Rutkowski style, dramatic lighting
portrait, Annie Leibovitz style, fashion photography
cyberpunk city, Syd Mead inspired, futuristic
anime character, Studio Ghibli style, watercolor
trending on ArtStation, award-winning digital art
```

### å¤ç”¨ä»·å€¼
â­â­â­â­â­
- å¿«é€Ÿä¼ è¾¾é£Žæ ¼æœŸæœ›
- ä¸“ä¸šåœˆå±‚è®¤å¯åº¦é«˜

---

## æ¨¡å—ä½¿ç”¨ç­–ç•¥

### å¿…å¤‡æ¨¡å—ï¼ˆæ¯ä¸ªæç¤ºè¯éƒ½åº”åŒ…å«ï¼‰

1. âœ… **ä¸»ä½“å˜é‡** - æ ¸å¿ƒå¯¹è±¡
2. âœ… **ç»†èŠ‚å¢žå¼º** - è´¨é‡ä¿éšœ
3. âœ… **è§†è§‰é£Žæ ¼** æˆ– **å‚è€ƒè‰ºæœ¯å®¶** - é£Žæ ¼å®šä¹‰

### é«˜ä»·å€¼æ¨¡å—ï¼ˆæ˜¾è‘—æå‡è´¨é‡ï¼‰

4. â­ **æŠ€æœ¯å‚æ•°** - ä¸“ä¸šæ„Ÿ
5. â­ **æž„å›¾å‚æ•°** - ä¸“ä¸šæ‘„å½±æ„Ÿ
6. â­ **è‰²å½©æ–¹æ¡ˆ** - è§†è§‰ä¸€è‡´æ€§

### æ°›å›´æ¨¡å—ï¼ˆå¢žå¼ºè¡¨çŽ°åŠ›ï¼‰

7. **æƒ…ç»ªæ°›å›´** - æƒ…æ„Ÿä¼ é€’
8. **æ—¶é—´/å­£èŠ‚** - è‡ªç„¶å…‰æ•ˆ

### è¾…åŠ©æ¨¡å—ï¼ˆæŒ‰éœ€ä½¿ç”¨ï¼‰

9. **çº¦æŸæ¡ä»¶** - é¿å…å¸¸è§é—®é¢˜
10. å…¶ä»–ä¸“é¡¹æ¨¡å—

---

## æ¨¡å—ç»„åˆæ¨¡æ¿

### äººåƒæ‘„å½±æ¨¡æ¿

```
{ä¸»ä½“} + {æŠ€æœ¯å‚æ•°} + {å…‰çº¿} + {æž„å›¾} + {ç»†èŠ‚å¢žå¼º}

ç¤ºä¾‹ï¼š
portrait of a young woman, 85mm lens f/1.4, soft studio lighting,
shallow depth of field, rule of thirds composition,
ultra detailed, photorealistic, 8k
```

ä½¿ç”¨æ¨¡å—ï¼š1, 3, 4, 7, 5

---

### é£Žæ™¯æ‘„å½±æ¨¡æ¿

```
{åœºæ™¯} + {æ—¶é—´/å­£èŠ‚} + {è‰²å½©} + {æž„å›¾} + {æ°›å›´} + {ç»†èŠ‚}

ç¤ºä¾‹ï¼š
mountain landscape, golden hour sunset, warm orange and purple tones,
wide angle shot, dramatic atmosphere, highly detailed, 8k, HDR
```

ä½¿ç”¨æ¨¡å—ï¼š1, 9, 8, 7, 5, 4

---

### æ¦‚å¿µè‰ºæœ¯æ¨¡æ¿

```
{ä¸»ä½“} + {é£Žæ ¼} + {å‚è€ƒ} + {è‰²å½©} + {æ°›å›´} + {ç»†èŠ‚}

ç¤ºä¾‹ï¼š
futuristic city, cyberpunk aesthetic, Syd Mead inspired,
neon purple and cyan colors, moody atmosphere,
highly detailed, trending on ArtStation, 8k
```

ä½¿ç”¨æ¨¡å—ï¼š1, 2, 10, 8, 5, 4

---

### è§’è‰²è®¾è®¡æ¨¡æ¿

```
{è§’è‰²} + {å¤–è§‚} + {é£Žæ ¼} + {å‚è€ƒ} + {ç»†èŠ‚}

ç¤ºä¾‹ï¼š
elven warrior princess, silver armor with celtic patterns,
fantasy art, Greg Rutkowski style, intricate details,
highly detailed, 8k, masterpiece
```

ä½¿ç”¨æ¨¡å—ï¼š1, 2, 10, 4

---

## æ¨¡å—æƒé‡å»ºè®®

ä¸åŒAIå·¥å…·å¯¹æ¨¡å—çš„æ•æ„Ÿåº¦ä¸åŒï¼š

| æ¨¡å— | Midjourney | Stable Diffusion | DALL-E 3 |
|------|------------|------------------|----------|
| ä¸»ä½“å˜é‡ | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­â­ |
| è§†è§‰é£Žæ ¼ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| æŠ€æœ¯å‚æ•° | â­â­â­â­ | â­â­â­â­â­ | â­â­â­ |
| ç»†èŠ‚å¢žå¼º | â­â­â­ | â­â­â­â­â­ | â­â­ |
| å‚è€ƒè‰ºæœ¯å®¶ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­ |
| æž„å›¾å‚æ•° | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| è‰²å½©æ–¹æ¡ˆ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| æ—¶é—´/å­£èŠ‚ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| çº¦æŸæ¡ä»¶ | â­â­â­ (--no) | â­â­â­â­â­ | â­â­ |

---

## å¿«é€Ÿå‚è€ƒå¡ç‰‡

**æœ€å°å¯ç”¨æç¤ºè¯**ï¼ˆ3æ¨¡å—ï¼‰ï¼š
```
{ä¸»ä½“} + {é£Žæ ¼} + {è´¨é‡}
girl + anime style + detailed
```

**æ ‡å‡†æç¤ºè¯**ï¼ˆ5-6æ¨¡å—ï¼‰ï¼š
```
{ä¸»ä½“} + {é£Žæ ¼} + {æŠ€æœ¯} + {æž„å›¾} + {è‰²å½©} + {è´¨é‡}
portrait + cinematic + 85mm f/1.4 + close-up + warm tones + 8k
```

**ä¸“ä¸šæç¤ºè¯**ï¼ˆ8-10æ¨¡å—å…¨è¦†ç›–ï¼‰ï¼š
```
æ‰€æœ‰æ¨¡å—ç²¾ç»†é…ç½®ï¼Œ300+ tokens
```

---

**ä½¿ç”¨è¿™ä¸ªå‚è€ƒæ‰‹å†Œ**å¯ä»¥ï¼š
- å¿«é€ŸæŸ¥æ‰¾æ¨¡å—å®šä¹‰
- ç†è§£æ¯ä¸ªæ¨¡å—çš„ä½œç”¨
- å­¦ä¹ ä¸“ä¸šæœ¯è¯­
- æž„å»ºè‡ªå·±çš„æç¤ºè¯æ¨¡æ¿


================================================
FILE: .claude/skills/prompt-extractor/PASTE_MODE_GUIDE.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-extractor/preprocessor.py
================================================
#!/usr/bin/env python3
"""
æç¤ºè¯é¢„å¤„ç†å’Œèšç±»è„šæœ¬
æ”¯æŒ txt, csv, json æ ¼å¼çš„è‡ªåŠ¨è§£æžå’Œæ¸…æ´—
"""

import json
import csv
import re
from pathlib import Path
from typing import List, Dict, Any
from collections import Counter


class PromptPreprocessor:
    """æç¤ºè¯é¢„å¤„ç†å™¨"""

    def __init__(self, min_length: int = 10):
        self.min_length = min_length
        self.prompts = []
        self.metadata = {}

    def load_file(self, file_path: str) -> List[str]:
        """è‡ªåŠ¨è¯†åˆ«æ ¼å¼å¹¶åŠ è½½æ–‡ä»¶"""
        path = Path(file_path)

        if not path.exists():
            raise FileNotFoundError(f"æ–‡ä»¶ä¸å­˜åœ¨: {file_path}")

        suffix = path.suffix.lower()

        if suffix == '.txt':
            return self._load_txt(path)
        elif suffix == '.csv':
            return self._load_csv(path)
        elif suffix == '.json':
            return self._load_json(path)
        else:
            raise ValueError(f"ä¸æ”¯æŒçš„æ–‡ä»¶æ ¼å¼: {suffix}. æ”¯æŒ .txt, .csv, .json")

    def _load_txt(self, path: Path) -> List[str]:
        """åŠ è½½txtæ–‡ä»¶ï¼ˆæ¯è¡Œä¸€ä¸ªæç¤ºè¯ï¼‰"""
        with open(path, 'r', encoding='utf-8') as f:
            lines = f.readlines()

        prompts = [line.strip() for line in lines if line.strip()]
        self.metadata['format'] = 'txt'
        self.metadata['original_count'] = len(prompts)
        return prompts

    def _load_csv(self, path: Path) -> List[str]:
        """åŠ è½½csvæ–‡ä»¶ï¼ˆè‡ªåŠ¨è¯†åˆ«æç¤ºè¯åˆ—ï¼‰"""
        with open(path, 'r', encoding='utf-8') as f:
            reader = csv.DictReader(f)
            rows = list(reader)

        if not rows:
            return []

        # æ™ºèƒ½è¯†åˆ«æç¤ºè¯åˆ—ï¼ˆåŒ…å« prompt, text, description ç­‰å…³é”®è¯ï¼‰
        headers = list(rows[0].keys())
        prompt_col = None

        for keyword in ['prompt', 'text', 'description', 'content']:
            for header in headers:
                if keyword in header.lower():
                    prompt_col = header
                    break
            if prompt_col:
                break

        # å¦‚æžœæ²¡æ‰¾åˆ°ï¼Œä½¿ç”¨ç¬¬ä¸€åˆ—
        if not prompt_col:
            prompt_col = headers[0]

        prompts = [row[prompt_col].strip() for row in rows if row.get(prompt_col, '').strip()]

        self.metadata['format'] = 'csv'
        self.metadata['prompt_column'] = prompt_col
        self.metadata['original_count'] = len(prompts)

        return prompts

    def _load_json(self, path: Path) -> List[str]:
        """åŠ è½½jsonæ–‡ä»¶ï¼ˆæ”¯æŒæ•°ç»„æˆ–å¯¹è±¡æ•°ç»„ï¼‰"""
        with open(path, 'r', encoding='utf-8') as f:
            data = json.load(f)

        if isinstance(data, list):
            # å¦‚æžœæ˜¯å­—ç¬¦ä¸²æ•°ç»„
            if all(isinstance(item, str) for item in data):
                prompts = data
            # å¦‚æžœæ˜¯å¯¹è±¡æ•°ç»„ï¼Œå°è¯•æ‰¾åˆ°æç¤ºè¯å­—æ®µ
            else:
                prompt_key = None
                for key in ['prompt', 'text', 'description', 'content']:
                    if data and key in data[0]:
                        prompt_key = key
                        break

                if not prompt_key:
                    prompt_key = list(data[0].keys())[0] if data else None

                prompts = [item[prompt_key] for item in data if prompt_key in item]
                self.metadata['prompt_key'] = prompt_key
        else:
            raise ValueError("JSONæ ¼å¼é”™è¯¯ï¼šéœ€è¦æ•°ç»„æˆ–å¯¹è±¡æ•°ç»„")

        self.metadata['format'] = 'json'
        self.metadata['original_count'] = len(prompts)

        return prompts

    def clean_prompts(self, prompts: List[str]) -> List[str]:
        """æ¸…æ´—æç¤ºè¯"""
        cleaned = []

        for prompt in prompts:
            # åŽ»é™¤å¤šä½™ç©ºæ ¼
            prompt = re.sub(r'\s+', ' ', prompt.strip())

            # ç»Ÿä¸€æ ‡ç‚¹ï¼ˆå…¨è§’è½¬åŠè§’ï¼‰
            prompt = prompt.replace('ï¼Œ', ', ').replace('ã€‚', '. ')

            # è¿‡æ»¤çŸ­æç¤º
            if len(prompt) >= self.min_length:
                cleaned.append(prompt)

        # åŽ»é‡ï¼ˆä¿æŒé¡ºåºï¼‰
        seen = set()
        unique = []
        for p in cleaned:
            if p not in seen:
                seen.add(p)
                unique.append(p)

        self.metadata['after_cleaning'] = len(unique)
        self.metadata['duplicates_removed'] = len(cleaned) - len(unique)

        return unique

    def extract_keywords(self, prompts: List[str], top_n: int = 50) -> List[tuple]:
        """æå–é«˜é¢‘å…³é”®è¯ï¼ˆç”¨äºŽèšç±»ï¼‰"""
        # ç®€å•çš„å…³é”®è¯æå–ï¼ˆåŸºäºŽè¯é¢‘ï¼‰
        all_words = []

        # åœç”¨è¯ï¼ˆéœ€è¦æ‰©å±•ï¼‰
        stopwords = {'a', 'an', 'the', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by'}

        for prompt in prompts:
            # åˆ†è¯ï¼ˆç®€åŒ–ç‰ˆï¼ŒæŒ‰é€—å·å’Œç©ºæ ¼ï¼‰
            words = re.split(r'[,\s]+', prompt.lower())
            words = [w.strip('.,!?;:()[]{}') for w in words]
            words = [w for w in words if w and w not in stopwords and len(w) > 2]
            all_words.extend(words)

        # ç»Ÿè®¡è¯é¢‘
        word_counts = Counter(all_words)

        return word_counts.most_common(top_n)

    def simple_cluster(self, prompts: List[str], n_clusters: int = 5) -> Dict[str, List[str]]:
        """ç®€å•èšç±»ï¼ˆåŸºäºŽå…³é”®è¯å…±çŽ°ï¼‰"""
        # æå–å…³é”®è¯
        keywords = self.extract_keywords(prompts, top_n=30)
        top_keywords = [kw[0] for kw in keywords[:n_clusters * 2]]

        # ä¸ºæ¯ä¸ªå…³é”®è¯åˆ›å»ºç°‡
        clusters = {f"cluster_{i}": [] for i in range(n_clusters)}
        cluster_keywords = {}

        # é€‰æ‹©æœ€å…·ä»£è¡¨æ€§çš„å…³é”®è¯
        for i in range(min(n_clusters, len(top_keywords))):
            cluster_keywords[f"cluster_{i}"] = top_keywords[i]

        # åˆ†é…æç¤ºè¯åˆ°ç°‡
        unassigned = []

        for prompt in prompts:
            assigned = False
            prompt_lower = prompt.lower()

            # æ£€æŸ¥æ˜¯å¦åŒ…å«ç°‡å…³é”®è¯
            for cluster_id, keyword in cluster_keywords.items():
                if keyword in prompt_lower:
                    clusters[cluster_id].append(prompt)
                    assigned = True
                    break

            if not assigned:
                unassigned.append(prompt)

        # æœªåˆ†é…çš„æ”¾å…¥æœ€åŽä¸€ä¸ªç°‡æˆ–æ–°ç°‡
        if unassigned:
            clusters["cluster_other"] = unassigned

        # ç§»é™¤ç©ºç°‡
        clusters = {k: v for k, v in clusters.items() if v}

        return clusters

    def generate_stats(self, prompts: List[str]) -> Dict[str, Any]:
        """ç”Ÿæˆç»Ÿè®¡ä¿¡æ¯"""
        lengths = [len(p) for p in prompts]

        return {
            "total_prompts": len(prompts),
            "avg_length": sum(lengths) / len(lengths) if lengths else 0,
            "min_length": min(lengths) if lengths else 0,
            "max_length": max(lengths) if lengths else 0,
            "top_keywords": self.extract_keywords(prompts, top_n=20)
        }


def main():
    """å‘½ä»¤è¡ŒæŽ¥å£"""
    import sys

    if len(sys.argv) < 2:
        print("ç”¨æ³•: python preprocessor.py <æ–‡ä»¶è·¯å¾„> [è¾“å‡ºæ–‡ä»¶]")
        sys.exit(1)

    input_file = sys.argv[1]
    output_file = sys.argv[2] if len(sys.argv) > 2 else "preprocessed_prompts.json"

    preprocessor = PromptPreprocessor()

    # åŠ è½½å’Œæ¸…æ´—
    print(f"æ­£åœ¨åŠ è½½: {input_file}")
    prompts = preprocessor.load_file(input_file)
    print(f"åŽŸå§‹æ•°é‡: {len(prompts)}")

    prompts = preprocessor.clean_prompts(prompts)
    print(f"æ¸…æ´—åŽ: {len(prompts)}")

    # èšç±»
    clusters = preprocessor.simple_cluster(prompts, n_clusters=5)
    print(f"\nèšç±»ç»“æžœ:")
    for cluster_id, cluster_prompts in clusters.items():
        print(f"  {cluster_id}: {len(cluster_prompts)} æ¡")

    # ç”Ÿæˆç»Ÿè®¡
    stats = preprocessor.generate_stats(prompts)

    # ä¿å­˜ç»“æžœ
    result = {
        "metadata": preprocessor.metadata,
        "statistics": stats,
        "clusters": {k: v[:10] for k, v in clusters.items()},  # æ¯ç°‡åªä¿å­˜å‰10ä¸ªç¤ºä¾‹
        "all_prompts": prompts
    }

    with open(output_file, 'w', encoding='utf-8') as f:
        json.dump(result, f, ensure_ascii=False, indent=2)

    print(f"\nç»“æžœå·²ä¿å­˜åˆ°: {output_file}")


if __name__ == "__main__":
    main()



================================================
FILE: .claude/skills/prompt-extractor/QUICKSTART.md
================================================
# Prompt Extractor - å¿«é€Ÿå¼€å§‹æŒ‡å—

## 5åˆ†é’Ÿä¸Šæ‰‹

### æ­¥éª¤1ï¼šæµ‹è¯•çŽ¯å¢ƒ

```bash
cd .claude/skills/prompt-extractor
./test_extractor.sh
```

ä½ åº”è¯¥çœ‹åˆ°ï¼š
```
âœ“ é¢„å¤„ç†æˆåŠŸ
  åŽŸå§‹æ•°é‡: 30
  æ¸…æ´—åŽ: 30
  å¹³å‡é•¿åº¦: 115.4 å­—ç¬¦
  èšç±»æ•°é‡: 5
```

### æ­¥éª¤2ï¼šåœ¨Claude Codeä¸­æ¿€æ´»Skill

åœ¨Claude Codeå¯¹è¯ä¸­è¾“å…¥ï¼š
```
ä½¿ç”¨ prompt-extractor skill
```

æˆ–è€…ç›´æŽ¥è¯´ï¼š
```
å¸®æˆ‘åˆ†æžAIç»˜ç”»æç¤ºè¯
```

### æ­¥éª¤3ï¼šæä¾›ä½ çš„æç¤ºè¯æ–‡ä»¶

Skillä¼šè¯¢é—®ä½ ï¼š
```
è¯·æä¾›æç¤ºè¯æ–‡ä»¶è·¯å¾„ï¼ˆæ”¯æŒ .txt, .csv, .jsonï¼‰ï¼š
```

ç¤ºä¾‹å›žå¤ï¼š
```
./my_prompts.txt
```

æˆ–è€…ä½¿ç”¨æä¾›çš„ç¤ºä¾‹ï¼š
```
.claude/skills/prompt-extractor/example_prompts.txt
```

### æ­¥éª¤4ï¼šæŸ¥çœ‹ç»“æžœ

Skillä¼šè‡ªåŠ¨ç”Ÿæˆä¸‰ä¸ªæ–‡ä»¶åˆ° `./extracted_results/` ç›®å½•ï¼š

1. **extracted_modules.json** - å®Œæ•´æå–æ•°æ®
2. **module_library.json** - å¯å¤ç”¨æ¨¡å—åº“
3. **analysis_report.md** - äººç±»å¯è¯»çš„åˆ†æžæŠ¥å‘Š

## å®žæˆ˜ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šåˆ†æž100æ¡æ”¶è—çš„æç¤ºè¯

**ä½ çš„æ–‡ä»¶** (prompts.txt):
```
a portrait of a woman, cinematic lighting, 85mm lens, ultra detailed
cyberpunk city, neon lights, rain, photorealistic, 8k
beautiful landscape, golden hour, dramatic clouds, HDR
...ï¼ˆ97æ¡æ›´å¤šï¼‰
```

**æ“ä½œ**:
```
æˆ‘ï¼šä½¿ç”¨ prompt-extractor åˆ†æž prompts.txt

Claudeï¼š
[è‡ªåŠ¨æ‰§è¡Œ]
1. âœ“ å·²è¯»å–100æ¡æç¤ºè¯
2. âœ“ æ¸…æ´—åŽ97æ¡ï¼ˆåŽ»é‡3æ¡ï¼‰
3. âœ“ è¯†åˆ«5ä¸ªä¸»é¢˜ç°‡
4. âœ“ å¼€å§‹æå–æ¨¡å—...
   - äººåƒæ‘„å½±ï¼š32æ¡ [è¿›è¡Œä¸­ 12/32]
   ...
```

**5åˆ†é’ŸåŽå¾—åˆ°**:
- æå–äº†450+ä¸ªç‹¬ç‰¹æ¨¡å—
- å‘çŽ°12ä¸ªé«˜è´¨é‡æ¨¡æ¿
- è¯†åˆ«å‡ºTop 20é«˜å¤ç”¨ç»„åˆ

### ç¤ºä¾‹2ï¼šä»ŽCSVå¯¼å…¥å¹¶ç­›é€‰ä¸»é¢˜

**ä½ çš„æ–‡ä»¶** (midjourney_export.csv):
```csv
prompt,likes,created_at
"portrait of woman, cinematic, 85mm",234,2024-01-15
"cyberpunk city at night, neon",189,2024-01-16
...
```

**æ“ä½œ**:
```
æˆ‘ï¼šç”¨ prompt-extractor å¤„ç† midjourney_export.csvï¼Œåªè¦"äººåƒ"ä¸»é¢˜

Claudeï¼š
[è‡ªåŠ¨è¯†åˆ«CSVæ ¼å¼]
âœ“ æ£€æµ‹åˆ° 'prompt' åˆ—
âœ“ è¯»å–500æ¡
âœ“ èšç±»å‘çŽ° "äººåƒæ‘„å½±" ä¸»é¢˜ï¼ˆ143æ¡ï¼‰
âœ“ ä»…æå–äººåƒç›¸å…³æ¨¡å—...
```

**ç»“æžœ**:
```json
{
  "theme_filter": "äººåƒæ‘„å½±",
  "extracted_count": 143,
  "top_modules": {
    "lighting": ["cinematic lighting", "soft light", "rembrandt"],
    "lens": ["85mm f/1.4", "50mm f/1.8"],
    "style": ["photorealistic", "editorial", "fashion"]
  }
}
```

## å¸¸è§é—®é¢˜é€ŸæŸ¥

### Q1: æˆ‘çš„æ–‡ä»¶æ˜¯ä¸­æ–‡æç¤ºè¯æ€Žä¹ˆåŠžï¼Ÿ
**A**: å®Œå…¨æ”¯æŒï¼é¢„å¤„ç†å™¨ä¼šè‡ªåŠ¨å¤„ç†ä¸­æ–‡ï¼š
```python
preprocessor = PromptPreprocessor()
prompts = preprocessor.load_file("ä¸­æ–‡æç¤ºè¯.txt")
```

### Q2: CSVæœ‰å¤šåˆ—ï¼Œå¦‚ä½•æŒ‡å®šï¼Ÿ
**A**: è‡ªåŠ¨è¯†åˆ«åŒ…å« 'prompt', 'text', 'description' çš„åˆ—ã€‚å¦‚æžœéƒ½æ²¡æœ‰ï¼Œä½¿ç”¨ç¬¬ä¸€åˆ—ã€‚

### Q3: å¤„ç†1000æ¡éœ€è¦å¤šä¹…ï¼Ÿ
**A**:
- é¢„å¤„ç†ï¼š<10ç§’
- AIæå–ï¼šçº¦5-10åˆ†é’Ÿï¼ˆå–å†³äºŽç½‘ç»œå’Œæ‰¹æ¬¡å¤§å°ï¼‰
- å»ºè®®åˆ†æ‰¹ï¼šæ¯æ‰¹200-300æ¡

### Q4: å¦‚ä½•åˆå¹¶å¤šä¸ªæ¨¡å—åº“ï¼Ÿ
**A**: ä½¿ç”¨Pythonè„šæœ¬ï¼š
```python
import json

# è¯»å–ä¸¤ä¸ªåº“
with open('lib1.json') as f1, open('lib2.json') as f2:
    data1, data2 = json.load(f1), json.load(f2)

# åˆå¹¶ï¼ˆç¤ºä¾‹ï¼šåˆå¹¶è§†è§‰é£Žæ ¼ï¼‰
combined_styles = list(set(data1['visual_styles'] + data2['visual_styles']))
```

## ä¸‹ä¸€æ­¥

### è¿›é˜¶ä½¿ç”¨
- é˜…è¯» [README.md](README.md) äº†è§£å®Œæ•´åŠŸèƒ½
- æŸ¥çœ‹ [skill.md](skill.md) äº†è§£æå–é€»è¾‘
- è‡ªå®šä¹‰ meta-prompt æé«˜ç²¾åº¦

### æ‰©å±•åˆ°1ä¸‡æ¡
1. å…ˆç”¨100æ¡æµ‹è¯•éªŒè¯è´¨é‡
2. è°ƒæ•´è¯„åˆ†æ ‡å‡†å’Œæ¨¡å—åˆ†ç±»
3. åˆ†10æ‰¹æ¬¡ï¼Œæ¯æ‰¹1000æ¡
4. æœ€åŽåˆå¹¶æ‰€æœ‰æ¨¡å—åº“

### é›†æˆåˆ°å·¥ä½œæµ
```bash
# å®šæœŸæ›´æ–°æ¨¡å—åº“
./update_library.sh new_prompts.txt

# æœç´¢æ¨¡å—
python search_modules.py "cinematic lighting portrait"

# ç”Ÿæˆæ–°æç¤º
python generate_prompt.py --template portrait --style cinematic
```

## èŽ·å–å¸®åŠ©

åœ¨Claude Codeä¸­éšæ—¶è¯¢é—®ï¼š
```
prompt-extractor å¦‚ä½•å¤„ç†å¤§æ–‡ä»¶ï¼Ÿ
prompt-extractor æå–è´¨é‡ä¸é«˜æ€Žä¹ˆåŠžï¼Ÿ
prompt-extractor èƒ½å¯¼å‡ºä¸ºExcelå—ï¼Ÿ
```

## æˆåŠŸæ¡ˆä¾‹

**æ¡ˆä¾‹1**: æ‘„å½±å¸ˆæ•´ç†3å¹´ç§¯ç´¯çš„800æ¡prompt
- æå–å‡º65ä¸ªæ ¸å¿ƒæ¨¡å—
- æž„å»ºäº†15å¥—ä¸“ä¸šæ¨¡æ¿
- æ–°ä½œå“åˆ›ä½œæ•ˆçŽ‡æå‡3å€

**æ¡ˆä¾‹2**: AIè‰ºæœ¯å®¶åˆ†æžé¡¶çº§ä½œå“prompt
- ä»Ž5000æ¡ä¸­å‘çŽ°é«˜è´¨é‡æ¨¡å¼
- è¯†åˆ«å‡º"ç”µå½±çº§"é£Žæ ¼çš„å…³é”®ç»„åˆ
- æˆç‰‡çŽ‡ä»Ž30%æå‡åˆ°75%

---

**å¼€å§‹ä½ çš„ç¬¬ä¸€æ¬¡æå–å§ï¼** ðŸš€



================================================
FILE: .claude/skills/prompt-extractor/skill.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-extractor/test_extractor.sh
================================================
#!/bin/bash
# å¿«é€Ÿæµ‹è¯•è„šæœ¬

echo "===== Prompt Extractor æµ‹è¯• ====="
echo ""

# æ£€æŸ¥Python
if ! command -v python3 &> /dev/null; then
    echo "é”™è¯¯: éœ€è¦å®‰è£… Python 3"
    exit 1
fi

# æµ‹è¯•é¢„å¤„ç†å™¨
echo "1. æµ‹è¯•é¢„å¤„ç†å™¨..."
python3 preprocessor.py example_prompts.txt test_output.json

if [ -f test_output.json ]; then
    echo "âœ“ é¢„å¤„ç†æˆåŠŸ"
    echo ""
    echo "2. æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯..."
    python3 -c "
import json
with open('test_output.json', 'r') as f:
    data = json.load(f)
    print(f\"  åŽŸå§‹æ•°é‡: {data['metadata']['original_count']}\")
    print(f\"  æ¸…æ´—åŽ: {data['metadata']['after_cleaning']}\")
    print(f\"  å¹³å‡é•¿åº¦: {data['statistics']['avg_length']:.1f} å­—ç¬¦\")
    print(f\"  èšç±»æ•°é‡: {len(data['clusters'])}\")
    print(f\"\\n  Top 10 å…³é”®è¯:\")
    for kw, count in data['statistics']['top_keywords'][:10]:
        print(f\"    - {kw}: {count}æ¬¡\")
"
else
    echo "âœ— é¢„å¤„ç†å¤±è´¥"
    exit 1
fi

echo ""
echo "===== æµ‹è¯•å®Œæˆ ====="
echo "ä¸‹ä¸€æ­¥: åœ¨ Claude Code ä¸­è¿è¡Œ 'prompt-extractor' skill"



================================================
FILE: .claude/skills/prompt-extractor/test_output.json
================================================
{
  "metadata": {
    "format": "txt",
    "original_count": 30,
    "after_cleaning": 30,
    "duplicates_removed": 0
  },
  "statistics": {
    "total_prompts": 30,
    "avg_length": 115.43333333333334,
    "min_length": 97,
    "max_length": 134,
    "top_keywords": [
      [
        "photography",
        19
      ],
      [
        "lighting",
        9
      ],
      [
        "art",
        9
      ],
      [
        "and",
        7
      ],
      [
        "detailed",
        6
      ],
      [
        "style",
        6
      ],
      [
        "atmosphere",
        5
      ],
      [
        "dramatic",
        5
      ],
      [
        "portrait",
        4
      ],
      [
        "lens",
        4
      ],
      [
        "landscape",
        4
      ],
      [
        "colors",
        4
      ],
      [
        "natural",
        4
      ],
      [
        "background",
        4
      ],
      [
        "blue",
        4
      ],
      [
        "composition",
        4
      ],
      [
        "cinematic",
        3
      ],
      [
        "neon",
        3
      ],
      [
        "hour",
        3
      ],
      [
        "inspired",
        3
      ]
    ]
  },
  "clusters": {
    "cluster_0": [
      "a portrait of a young woman, cinematic lighting, 85mm lens f/1.4, soft focus, ultra detailed, photorealistic, professional photography",
      "beautiful landscape, mountain range at golden hour, dramatic clouds, wide angle lens, nature photography, sharp focus, HDR",
      "macro photography of a flower, morning dew drops, shallow depth of field, natural lighting, bokeh background, highly detailed",
      "street photography, candid moment, black and white, film grain, 35mm lens, documentary style, authentic emotion",
      "minimalist product photography, white background, studio lighting, clean composition, commercial photography, high resolution",
      "underwater scene, coral reef, tropical fish, blue water, sun rays penetrating water, marine photography, crystal clear",
      "cozy coffee shop interior, warm ambient lighting, wooden furniture, plants, lifestyle photography, inviting atmosphere",
      "desert landscape at sunset, sand dunes, long shadows, warm color palette, landscape photography, dramatic sky",
      "fashion photography, model on runway, dramatic pose, high fashion, professional lighting, vogue style, editorial",
      "urban architecture, modern building, geometric lines, blue hour photography, symmetrical composition, architectural photography"
    ],
    "cluster_1": [
      "futuristic spaceship interior, sci-fi concept art, blue and white color scheme, volumetric lighting, 4k, octane render",
      "oil painting of a still life, fruits on wooden table, classical composition, warm tones, rembrandt lighting, masterpiece",
      "fantasy castle on a cliff, sunset, epic scale, matte painting, dramatic lighting, concept art, highly detailed architecture",
      "cyberpunk portrait, woman with neon tattoos, dark background, purple and blue lighting, futuristic fashion, cinematic, 4k"
    ],
    "cluster_2": [
      "anime style character, colorful hair, detailed eyes, studio ghibli inspired, digital art, vibrant colors, trending on artstation",
      "abstract digital art, geometric shapes, gradient colors, modern art, minimalist design, 8k wallpaper",
      "enchanted forest, misty atmosphere, rays of light through trees, magical mood, fantasy art, detailed foliage",
      "retro 80s aesthetic, vaporwave style, pink and cyan colors, grid patterns, nostalgic, digital art",
      "post-apocalyptic cityscape, overgrown buildings, nature reclaiming civilization, moody atmosphere, concept art",
      "art deco interior design, gold and marble, geometric patterns, luxury, 1920s inspired, elegant composition"
    ],
    "cluster_3": [
      "steampunk mechanism, gears and brass, intricate details, victorian era inspired, sepia tones, technical illustration"
    ],
    "cluster_other": [
      "cyberpunk city at night, neon lights reflecting on wet streets, rain, cinematic atmosphere, 8k, Unreal Engine, hyperrealistic",
      "portrait of an elderly man, wisdom in eyes, natural wrinkles, storytelling portrait, medium format, shallow depth of field",
      "japanese garden, cherry blossoms, koi pond, traditional architecture, serene atmosphere, spring season, peaceful"
    ]
  },
  "all_prompts": [
    "a portrait of a young woman, cinematic lighting, 85mm lens f/1.4, soft focus, ultra detailed, photorealistic, professional photography",
    "cyberpunk city at night, neon lights reflecting on wet streets, rain, cinematic atmosphere, 8k, Unreal Engine, hyperrealistic",
    "beautiful landscape, mountain range at golden hour, dramatic clouds, wide angle lens, nature photography, sharp focus, HDR",
    "anime style character, colorful hair, detailed eyes, studio ghibli inspired, digital art, vibrant colors, trending on artstation",
    "macro photography of a flower, morning dew drops, shallow depth of field, natural lighting, bokeh background, highly detailed",
    "futuristic spaceship interior, sci-fi concept art, blue and white color scheme, volumetric lighting, 4k, octane render",
    "oil painting of a still life, fruits on wooden table, classical composition, warm tones, rembrandt lighting, masterpiece",
    "street photography, candid moment, black and white, film grain, 35mm lens, documentary style, authentic emotion",
    "fantasy castle on a cliff, sunset, epic scale, matte painting, dramatic lighting, concept art, highly detailed architecture",
    "minimalist product photography, white background, studio lighting, clean composition, commercial photography, high resolution",
    "portrait of an elderly man, wisdom in eyes, natural wrinkles, storytelling portrait, medium format, shallow depth of field",
    "underwater scene, coral reef, tropical fish, blue water, sun rays penetrating water, marine photography, crystal clear",
    "cyberpunk portrait, woman with neon tattoos, dark background, purple and blue lighting, futuristic fashion, cinematic, 4k",
    "cozy coffee shop interior, warm ambient lighting, wooden furniture, plants, lifestyle photography, inviting atmosphere",
    "abstract digital art, geometric shapes, gradient colors, modern art, minimalist design, 8k wallpaper",
    "desert landscape at sunset, sand dunes, long shadows, warm color palette, landscape photography, dramatic sky",
    "steampunk mechanism, gears and brass, intricate details, victorian era inspired, sepia tones, technical illustration",
    "fashion photography, model on runway, dramatic pose, high fashion, professional lighting, vogue style, editorial",
    "enchanted forest, misty atmosphere, rays of light through trees, magical mood, fantasy art, detailed foliage",
    "urban architecture, modern building, geometric lines, blue hour photography, symmetrical composition, architectural photography",
    "food photography, gourmet dish, garnished beautifully, shallow depth of field, natural light, appetizing presentation",
    "space nebula, stars and cosmic dust, deep space photography, vibrant colors, Hubble telescope style, astronomical",
    "retro 80s aesthetic, vaporwave style, pink and cyan colors, grid patterns, nostalgic, digital art",
    "wildlife photography, tiger in natural habitat, golden hour light, telephoto lens, national geographic style",
    "post-apocalyptic cityscape, overgrown buildings, nature reclaiming civilization, moody atmosphere, concept art",
    "japanese garden, cherry blossoms, koi pond, traditional architecture, serene atmosphere, spring season, peaceful",
    "neon sign close-up, glowing letters, dark background, urban photography, bokeh effect, night scene",
    "hyperrealistic eye close-up, detailed iris, reflections, macro photography, extreme detail, beauty photography",
    "art deco interior design, gold and marble, geometric patterns, luxury, 1920s inspired, elegant composition",
    "mountain climber on peak, dramatic landscape, achievement moment, adventure photography, wide vista, inspiring"
  ]
}


================================================
FILE: .claude/skills/prompt-generator/skill.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-master/skill.md
================================================
---
name: prompt-master
description: æç¤ºè¯ä¸»æŽ§ - æ™ºèƒ½é€‰æ‹©åˆé€‚çš„é¢†åŸŸskillå¹¶ç”Ÿæˆæç¤ºè¯ï¼Œæ”¯æŒè‡ªåŠ¨é¢†åŸŸåˆ†ç±»å’Œè°ƒåº¦
---

# âš ï¸ æ—§æž¶æž„ - Prompt Master - æç¤ºè¯ä¸»æŽ§ Skill

> **æ³¨æ„**ï¼šè¿™æ˜¯æ—§æž¶æž„ç³»ç»Ÿï¼Œä½¿ç”¨JSONæ–‡ä»¶ï¼ˆfacial_features_library.jsonï¼‰ä½œä¸ºæ•°æ®æºã€‚
>
> **æ–°æž¶æž„**è¯·ä½¿ç”¨ï¼š`intelligent-prompt-generator`ï¼ˆä½¿ç”¨elements.dbæ•°æ®åº“ï¼‰

**ç‰ˆæœ¬**: 1.0
**åˆ›å»ºæ—¥æœŸ**: 2026-01-01
**æž¶æž„**: Master-Subordinate (ä¸»ä»Žç»“æž„)

---

## ðŸ“‹ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªæ™ºèƒ½æç¤ºè¯ç®¡ç†ç³»ç»Ÿçš„ä¸»æŽ§ Skillï¼Œè´Ÿè´£ï¼š
1. ç†è§£ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æ„å›¾
2. è·¯ç”±åˆ°å¯¹åº”çš„å­æ¨¡å—
3. æ•´åˆå­æ¨¡å—è¾“å‡ºå¹¶è¿”å›žç»“æžœ

---

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

### 1. æ„å›¾è¯†åˆ« (Intent Recognition)

è‡ªåŠ¨è¯†åˆ«ç”¨æˆ·è¯·æ±‚çš„5ç§æ„å›¾ç±»åž‹ï¼š

| æ„å›¾ç±»åž‹ | å…³é”®è¯ | ç¤ºä¾‹è¯·æ±‚ | è·¯ç”±åˆ° |
|---------|--------|----------|--------|
| **æå–** (Extract) | æå–ã€åˆ†æžã€åˆ†ç±»ã€è¯†åˆ« | "æå–è¿™ä¸ªPromptä¸­çš„äº”å®˜ç‰¹å¾" | extractor.md |
| **ç»„è£…** (Build) | ç”Ÿæˆã€ç»„è£…ã€åˆ›å»ºã€åˆ¶ä½œ | "ç”Ÿæˆä¸€ä¸ªç”µå½±çº§ç¾Žå°‘å¥³çš„æç¤ºè¯" | builder.md |
| **ä¼˜åŒ–** (Optimize) | ä¼˜åŒ–ã€æ”¹è¿›ã€å¢žå¼ºã€è°ƒæ•´ | "ä¼˜åŒ–è¿™ä¸ªæç¤ºè¯" | optimizer.md |
| **æŽ¨è** (Recommend) | æŽ¨èã€å»ºè®®ã€ç›¸ä¼¼ã€åŒ¹é… | "æŽ¨èç±»ä¼¼çš„æç¤ºè¯" | recommender.md |
| **åˆ†æž** (Analyze) | åˆ†æžã€å¯¹æ¯”ã€è¯„ä¼°ã€æŸ¥è¯¢ | "åˆ†æžè¿™ä¸¤ä¸ªæç¤ºè¯çš„åŒºåˆ«" | analyzer.md |

### 2. æ•°æ®æº

ç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹JSONæ•°æ®æ–‡ä»¶ï¼š
- `facial_features_library.json` (v1.2) - äººåƒé¢éƒ¨ç‰¹å¾åº“ï¼ˆ28ä¸ªåˆ†ç±»ï¼‰
- `module_library.json` - æ‘„å½±æµæ´¾ä¸Žè®¾å¤‡ç´¢å¼•
- `extracted_modules.json` - 18ä¸ªæºPromptsçš„æå–ç»“æžœ

---

## ðŸ¤– æ‰§è¡Œæµç¨‹

### Step 1: æ„å›¾è¯†åˆ«

åˆ†æžç”¨æˆ·è¾“å…¥ï¼Œè¯†åˆ«æ„å›¾ç±»åž‹ï¼š

```python
# ä¼ªä»£ç ç¤ºä¾‹
user_input = "ç”Ÿæˆä¸€ä¸ªç”µå½±çº§ç¾Žå°‘å¥³çš„æç¤ºè¯"

if any(keyword in user_input for keyword in ["ç”Ÿæˆ", "ç»„è£…", "åˆ›å»º", "åˆ¶ä½œ"]):
    intent = "build"
elif any(keyword in user_input for keyword in ["æå–", "åˆ†æžPrompt", "è¯†åˆ«"]):
    intent = "extract"
elif any(keyword in user_input for keyword in ["ä¼˜åŒ–", "æ”¹è¿›", "å¢žå¼º"]):
    intent = "optimize"
elif any(keyword in user_input for keyword in ["æŽ¨è", "å»ºè®®", "ç›¸ä¼¼"]):
    intent = "recommend"
elif any(keyword in user_input for keyword in ["åˆ†æž", "å¯¹æ¯”", "æŸ¥è¯¢"]):
    intent = "analyze"
else:
    # é»˜è®¤ï¼šbuildï¼ˆæœ€å¸¸ç”¨ï¼‰
    intent = "build"
```

### Step 2: è·¯ç”±åˆ°å­æ¨¡å—

æ ¹æ®æ„å›¾è°ƒç”¨å¯¹åº”æ¨¡å—ï¼š

```python
# ä¼ªä»£ç ç¤ºä¾‹
if intent == "build":
    # è°ƒç”¨ builder.md
    result = call_builder_module(user_input)
elif intent == "extract":
    # è°ƒç”¨ extractor.md
    result = call_extractor_module(user_input)
# ... å…¶ä»–æ¨¡å—
```

### Step 3: è¿”å›žç»“æžœ

æ•´åˆå­æ¨¡å—è¾“å‡ºï¼Œæ ¼å¼åŒ–è¿”å›žç»™ç”¨æˆ·ã€‚

---

## ðŸ“¦ å­æ¨¡å—è¯´æ˜Ž

### 1. extractor.md - æå–æ¨¡å—
**åŠŸèƒ½**: ä»Žç”¨æˆ·æä¾›çš„Promptä¸­æå–å¯å¤ç”¨çš„æ¨¡å—
**è¾“å…¥**: åŽŸå§‹Promptæ–‡æœ¬
**è¾“å‡º**: æå–çš„æ¨¡å—åˆ†ç±»ï¼ˆçœ¼åž‹ã€è„¸åž‹ã€å”‡åž‹ç­‰ï¼‰

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "æå–è¿™ä¸ªPromptçš„äº”å®˜ç‰¹å¾: A beautiful young woman with large blue eyes..."
è¾“å‡º:
  - çœ¼åž‹: large blue expressive
  - æ€§åˆ«: female
  - å¹´é¾„: young_adult
```

### 2. builder.md - ç»„è£…æ¨¡å—
**åŠŸèƒ½**: æ ¹æ®ç”¨æˆ·æè¿°æ™ºèƒ½ç»„è£…æç¤ºè¯
**è¾“å…¥**: ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€æè¿°
**è¾“å‡º**: å®Œæ•´çš„æç¤ºè¯

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "ç”Ÿæˆä¸€ä¸ªç”µå½±çº§ç¾Žå°‘å¥³çš„æç¤ºè¯"
è¾“å‡º: A beautiful East Asian young woman, large expressive almond eyes, ...
```

### 3. optimizer.md - ä¼˜åŒ–æ¨¡å—
**åŠŸèƒ½**: ä¼˜åŒ–ç”¨æˆ·æä¾›çš„æç¤ºè¯
**è¾“å…¥**: åŽŸå§‹æç¤ºè¯
**è¾“å‡º**: ä¼˜åŒ–åŽçš„æç¤ºè¯ + ä¼˜åŒ–å»ºè®®

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "ä¼˜åŒ–è¿™ä¸ªæç¤ºè¯: A woman with eyes"
è¾“å‡º: A beautiful young East Asian woman, large expressive almond eyes, ...
å»ºè®®: æ·»åŠ äº†å¹´é¾„ã€äººç§ã€çœ¼åž‹ç»†èŠ‚
```

### 4. recommender.md - æŽ¨èæ¨¡å—
**åŠŸèƒ½**: æŽ¨èç›¸ä¼¼æˆ–ç›¸å…³çš„æç¤ºè¯/æ¨¡å—
**è¾“å…¥**: Prompt ID æˆ– æè¿°
**è¾“å‡º**: æŽ¨èåˆ—è¡¨ï¼ˆå¸¦ç›¸ä¼¼åº¦è¯„åˆ†ï¼‰

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "æŽ¨èä¸ŽPrompt #5ç›¸ä¼¼çš„æç¤ºè¯"
è¾“å‡º:
  1. Prompt #18 (ç›¸ä¼¼åº¦: 85%) - åŒä¸ºæ¸…çº¯å°‘å¥³é£Žæ ¼
  2. Prompt #10 (ç›¸ä¼¼åº¦: 75%) - åŒä¸ºEast Asianäººåƒ
```

### 5. analyzer.md - åˆ†æžæ¨¡å—
**åŠŸèƒ½**: åˆ†æžæç¤ºè¯ã€å¯¹æ¯”ã€æŸ¥è¯¢ä¿¡æ¯
**è¾“å…¥**: Prompt ID æˆ– æŸ¥è¯¢æ¡ä»¶
**è¾“å‡º**: è¯¦ç»†åˆ†æžç»“æžœ

**ç¤ºä¾‹**:
```
ç”¨æˆ·: "å¯¹æ¯”Prompt #5å’Œ#17çš„åŒºåˆ«"
è¾“å‡º:
  - Prompt #5: æ¸…çº¯å°‘å¥³ï¼Œå¤å…¸ä¼˜é›…
  - Prompt #17: æ€§æ„ŸæŒ‘é€—ï¼Œå›é€†é£Žæ ¼
  å·®å¼‚: è¡¨æƒ…ã€çœ¼åž‹ã€çš®è‚¤è´¨æ„Ÿå®Œå…¨ä¸åŒ
```

---

## ðŸ”§ å®žé™…æ‰§è¡Œé€»è¾‘

å½“ä½ ä½œä¸º Prompt Master Skill è¢«è°ƒç”¨æ—¶ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š

### 1. æŽ¥æ”¶ç”¨æˆ·è¾“å…¥

ä»Žç”¨æˆ·æ¶ˆæ¯ä¸­æå–å…³é”®ä¿¡æ¯ï¼š
- æ„å›¾ç±»åž‹ï¼ˆæå–/ç»„è£…/ä¼˜åŒ–/æŽ¨è/åˆ†æžï¼‰
- å…·ä½“å‚æ•°ï¼ˆPrompt IDã€æè¿°ã€æŸ¥è¯¢æ¡ä»¶ç­‰ï¼‰

### 2. æ„å›¾è¯†åˆ«

ä½¿ç”¨å…³é”®è¯åŒ¹é…è¯†åˆ«ç”¨æˆ·æ„å›¾ï¼š

**æå–æ„å›¾**:
- å…³é”®è¯: "æå–", "åˆ†æžPromptä¸­çš„", "è¯†åˆ«", "è¿™ä¸ªPromptçš„"
- ç¤ºä¾‹: "æå–Prompt #18çš„çœ¼åž‹"

**ç»„è£…æ„å›¾**:
- å…³é”®è¯: "ç”Ÿæˆ", "åˆ›å»º", "ç»„è£…", "åˆ¶ä½œ", "æˆ‘æƒ³è¦"
- ç¤ºä¾‹: "ç”Ÿæˆä¸€ä¸ªæ¸…çº¯å°‘å¥³çš„æç¤ºè¯"

**ä¼˜åŒ–æ„å›¾**:
- å…³é”®è¯: "ä¼˜åŒ–", "æ”¹è¿›", "å¢žå¼º", "è°ƒæ•´", "ä¿®æ­£"
- ç¤ºä¾‹: "ä¼˜åŒ–è¿™ä¸ªæç¤ºè¯"

**æŽ¨èæ„å›¾**:
- å…³é”®è¯: "æŽ¨è", "å»ºè®®", "ç›¸ä¼¼", "ç±»ä¼¼", "ç›¸å…³"
- ç¤ºä¾‹: "æŽ¨èç›¸ä¼¼çš„æç¤ºè¯"

**åˆ†æžæ„å›¾**:
- å…³é”®è¯: "åˆ†æž", "å¯¹æ¯”", "æŸ¥è¯¢", "æŸ¥çœ‹", "è¯¦ç»†ä¿¡æ¯"
- ç¤ºä¾‹: "åˆ†æžPrompt #5çš„ç‰¹ç‚¹"

### 3. è°ƒç”¨å­æ¨¡å—

**é‡è¦**: ä½ ä¸èƒ½ç›´æŽ¥æ‰§è¡Œå­æ¨¡å—çš„é€»è¾‘ã€‚ä½ éœ€è¦ï¼š

#### é€‰é¡¹A: è°ƒç”¨CLIå·¥å…·ï¼ˆæŽ¨èï¼‰
ä½¿ç”¨ `prompt_tool.py` CLIå·¥å…·ï¼š
```bash
# ç»„è£…åŠŸèƒ½
python3 prompt_tool.py build "ç”µå½±çº§ç¾Žå°‘å¥³"
python3 prompt_tool.py generate  # äº¤äº’å¼ç”Ÿæˆ

# æŸ¥è¯¢åŠŸèƒ½
python3 prompt_tool.py show 5
python3 prompt_tool.py recommend 5
python3 prompt_tool.py compare 5 17

# äº”å®˜æŸ¥è¯¢
python3 prompt_tool.py facial --list-types
python3 prompt_tool.py facial --style "æ¸…çº¯å°‘å¥³"
```

#### é€‰é¡¹B: ç›´æŽ¥è¯»å–JSONæ•°æ®
å½“CLIå·¥å…·æ— æ³•æ»¡è¶³éœ€æ±‚æ—¶ï¼Œç›´æŽ¥æ“ä½œJSONæ•°æ®ï¼š
```python
# è¯»å–æ•°æ®æ–‡ä»¶
facial_lib = load_json("extracted_results/facial_features_library.json")
module_lib = load_json("extracted_results/module_library.json")
prompts_data = load_json("extracted_results/extracted_modules.json")

# æ ¹æ®æ„å›¾å¤„ç†æ•°æ®
# ...
```

### 4. æ ¼å¼åŒ–è¾“å‡º

å°†ç»“æžœä»¥æ¸…æ™°æ˜“è¯»çš„æ ¼å¼è¿”å›žç»™ç”¨æˆ·ï¼š
- ä½¿ç”¨Markdownæ ¼å¼åŒ–
- çªå‡ºå…³é”®ä¿¡æ¯
- æä¾›å¯æ“ä½œçš„å»ºè®®

---

## ðŸ“Š ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ç»„è£…æç¤ºè¯

**ç”¨æˆ·è¾“å…¥**:
```
"æˆ‘æƒ³ç”Ÿæˆä¸€ä¸ªç”µå½±çº§çš„æ¸…çº¯ç¾Žå°‘å¥³çš„æç¤ºè¯"
```

**æ‰§è¡Œæµç¨‹**:
1. è¯†åˆ«æ„å›¾: buildï¼ˆç»„è£…ï¼‰
2. æå–å…³é”®è¯: "ç”µå½±çº§" â†’ cinematic_narrative, "æ¸…çº¯ç¾Žå°‘å¥³" â†’ æ¸…çº¯å°‘å¥³
3. è°ƒç”¨CLI: `python3 prompt_tool.py build "ç”µå½±çº§çš„æ¸…çº¯ç¾Žå°‘å¥³"`
4. è¿”å›žç”Ÿæˆçš„å®Œæ•´æç¤ºè¯

**è¾“å‡º**:
```
âœ¨ å·²ç”Ÿæˆæç¤ºè¯:

A beautiful East Asian young woman, large expressive almond eyes, thick natural lashes, deep clear iris, dewy sparkle, soft highlights, oval face, delicate refined Asian facial structure, soft full lips, gentle pink gloss, small straight delicate nose, flawless porcelain skin, radiant jade-like brightness, natural subtle blush, dewy luminous glow, innocent gaze, gentle smile, soft introspective, photographed with canon_eos_r5, 35mm f/2.8, 8K HDR, cinematic lighting, photorealistic, ultra-detailed

ðŸ“‹ ç»„åˆè¯¦æƒ…:
- æµæ´¾: ç”µå½±å™äº‹æ‘„å½±
- é£Žæ ¼: æ¸…çº¯å°‘å¥³
- äººç§: ä¸œäºšäºº
- å¹´é¾„: é’å¹´ï¼ˆ18-25å²ï¼‰
- æ€§åˆ«: å¥³æ€§
```

### ç¤ºä¾‹2: æŽ¨èç›¸ä¼¼æç¤ºè¯

**ç”¨æˆ·è¾“å…¥**:
```
"æŽ¨èä¸ŽPrompt #5ç›¸ä¼¼çš„æç¤ºè¯"
```

**æ‰§è¡Œæµç¨‹**:
1. è¯†åˆ«æ„å›¾: recommendï¼ˆæŽ¨èï¼‰
2. æå–Prompt ID: 5
3. è°ƒç”¨CLI: `python3 prompt_tool.py recommend 5`
4. è¿”å›žæŽ¨èåˆ—è¡¨

**è¾“å‡º**:
```
ðŸ” ä¸º Prompt #5 (æ¸…çº¯å°‘å¥³å¤å…¸ç¾Ž) æŽ¨èç›¸å…³æç¤ºè¯

[1] #18 æ¸…çº¯å…¬ä¸»Cosplay
    ç›¸ä¼¼åº¦: 75%
    ç†ç”±: åŒä¸ºæ¸…çº¯å°‘å¥³é£Žæ ¼ + åŒç”¨ä¸œäºšäººç§

[2] #10 æ¸©æŸ”å°‘å¥³äººåƒ
    ç›¸ä¼¼åº¦: 65%
    ç†ç”±: åŒä¸ºäººåƒç¾Žå®¹æ‘„å½± + ä¸»é¢˜ç›¸å…³

[3] #17 æ€§æ„Ÿæœ‹å…‹å°‘å¥³
    ç›¸ä¼¼åº¦: 45%
    ç†ç”±: åŒä¸ºå¹´è½»å¥³æ€§äººåƒï¼ˆé£Žæ ¼å·®å¼‚å¤§ï¼‰
```

### ç¤ºä¾‹3: æŸ¥è¯¢äº”å®˜ç»„åˆ

**ç”¨æˆ·è¾“å…¥**:
```
"æ¸…çº¯å°‘å¥³é£Žæ ¼åº”è¯¥ç”¨ä»€ä¹ˆäº”å®˜ç»„åˆï¼Ÿ"
```

**æ‰§è¡Œæµç¨‹**:
1. è¯†åˆ«æ„å›¾: analyzeï¼ˆåˆ†æž/æŸ¥è¯¢ï¼‰
2. è¯†åˆ«é£Žæ ¼: "æ¸…çº¯å°‘å¥³"
3. è°ƒç”¨CLI: `python3 prompt_tool.py facial --style "æ¸…çº¯å°‘å¥³"`
4. è¿”å›žäº”å®˜ç»„åˆæŽ¨è

**è¾“å‡º**:
```
ðŸŽ¨ é£Žæ ¼: æ¸…çº¯å°‘å¥³

æŽ¨èäº”å®˜ç»„åˆ:

æ€§åˆ«: å¥³æ€§ (female)
å¹´é¾„: é’å¹´ï¼ˆ18-25å²ï¼‰ (young_adult)
äººç§: ä¸œäºšäºº (east_asian)
çœ¼åž‹: å¤§çœ¼æä»çœ¼ (large_expressive_almond) [9.8/10]
  å…³é”®è¯: large expressive eyes, almond eyes, thick natural lashes
å”‡åž‹: ç²‰å«©å…‰æ³½å”‡ (soft_pink_gloss) [9.0/10]
  å…³é”®è¯: soft full lips, gentle pink gloss, natural lip color
é¼»åž‹: å°å·§ç›´é¼» (small_straight_delicate) [9.0/10]
  å…³é”®è¯: small straight nose, delicate nose
çš®è‚¤: ç“·è‚Œæ— ç‘•ï¼ˆå‘å…‰è´¨æ„Ÿï¼‰ (porcelain_flawless_radiant) [9.5/10]
  å…³é”®è¯: flawless porcelain skin, radiant jade-like brightness
è¡¨æƒ…: æ¸…çº¯æ¸©æŸ”çœ¼ç¥ž (innocent_gentle_gaze) [9.5/10]
  å…³é”®è¯: innocent gaze, gentle smile, soft introspective
```

---

## ðŸŽ¯ æœ€ä½³å®žè·µ

### 1. ä¼˜å…ˆä½¿ç”¨CLIå·¥å…·
- âœ… CLIå·¥å…·å·²ç»è¿‡æµ‹è¯•ï¼Œç¨³å®šå¯é 
- âœ… è¾“å‡ºæ ¼å¼ç»Ÿä¸€ï¼Œæ˜“äºŽç†è§£
- âœ… åŒ…å«å½©è‰²è¾“å‡ºï¼Œä½“éªŒæ›´å¥½

### 2. æ¸…æ™°çš„è¾“å‡ºæ ¼å¼
- ä½¿ç”¨Markdownæ ¼å¼åŒ–
- ä½¿ç”¨emojiå¢žå¼ºå¯è¯»æ€§
- çªå‡ºæ˜¾ç¤ºå…³é”®ä¿¡æ¯

### 3. æ™ºèƒ½è·¯ç”±
- å½“ç”¨æˆ·æ„å›¾ä¸æ˜Žç¡®æ—¶ï¼Œæä¾›é€‰é¡¹è®©ç”¨æˆ·é€‰æ‹©
- å¯¹äºŽå¤æ‚è¯·æ±‚ï¼Œå¯èƒ½éœ€è¦è°ƒç”¨å¤šä¸ªå­æ¨¡å—

### 4. é”™è¯¯å¤„ç†
- å½“JSONæ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼Œæç¤ºç”¨æˆ·
- å½“Prompt IDä¸å­˜åœ¨æ—¶ï¼Œåˆ—å‡ºå¯ç”¨ID
- å½“å…³é”®è¯æ— æ³•åŒ¹é…æ—¶ï¼Œæä¾›å»ºè®®

---

## ðŸ“š æ•°æ®æ–‡ä»¶è·¯å¾„

```
/Users/huangzongning/prompt_gen_image/
â”œâ”€â”€ extracted_results/
â”‚   â”œâ”€â”€ facial_features_library.json (v1.2, 28åˆ†ç±»)
â”‚   â”œâ”€â”€ module_library.json (10æ‘„å½±æµæ´¾)
â”‚   â””â”€â”€ extracted_modules.json (18 Prompts)
â”œâ”€â”€ prompt_tool.py (CLIå·¥å…·)
â””â”€â”€ demo_generate.py (æ¼”ç¤ºè„šæœ¬)
```

---

## ðŸ” æ‰§è¡ŒæŒ‡ä»¤

å½“ç”¨æˆ·è°ƒç”¨è¿™ä¸ªSkillæ—¶ï¼Œè¯·ï¼š

1. **åˆ†æžç”¨æˆ·æ„å›¾**
   - ä»”ç»†é˜…è¯»ç”¨æˆ·è¾“å…¥
   - è¯†åˆ«å…³é”®è¯å’Œå‚æ•°

2. **é€‰æ‹©æ‰§è¡Œæ–¹å¼**
   - ä¼˜å…ˆä½¿ç”¨CLIå·¥å…·ï¼ˆBashè°ƒç”¨ prompt_tool.pyï¼‰
   - å¿…è¦æ—¶ç›´æŽ¥è¯»å–JSONæ•°æ®ï¼ˆRead toolï¼‰

3. **æ‰§è¡Œå¹¶è¿”å›ž**
   - æ ¼å¼åŒ–è¾“å‡ºç»“æžœ
   - æä¾›å¯æ“ä½œçš„åŽç»­å»ºè®®

4. **ä¸»åŠ¨ä¼˜åŒ–**
   - å¦‚æžœç”¨æˆ·æä¾›çš„ä¿¡æ¯ä¸å®Œæ•´ï¼Œä¸»åŠ¨ä¼˜åŒ–æˆ–è¯¢é—®
   - æä¾›æ”¹è¿›å»ºè®®

---

**SkillçŠ¶æ€**: âœ… å¯ç”¨
**æ”¯æŒçš„æ“ä½œ**: æå–ã€ç»„è£…ã€ä¼˜åŒ–ã€æŽ¨èã€åˆ†æž
**æ•°æ®ç‰ˆæœ¬**: facial_features_library v1.2
**æ€»åˆ†ç±»æ•°**: 28ä¸ªï¼ˆ9å¤§ç±»ï¼‰



================================================
FILE: .claude/skills/prompt-master/modules/core/analyzer.md
================================================
# âš ï¸ æ—§æž¶æž„ - Analyzer Module - åˆ†æžæŸ¥è¯¢æ¨¡å—

> **æ³¨æ„**ï¼šè¿™æ˜¯æ—§æž¶æž„æ¨¡å—ï¼Œå±žäºŽprompt-masterç³»ç»Ÿ


**åŠŸèƒ½**: åˆ†æžã€æŸ¥è¯¢ã€å¯¹æ¯”æç¤ºè¯å’Œæ¨¡å—ä¿¡æ¯
**è°ƒç”¨æ–¹å¼**: é€šè¿‡ä¸»Skillè·¯ç”±æˆ–ç›´æŽ¥CLIè°ƒç”¨

---

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

Analyzeræ¨¡å—æä¾›ä»¥ä¸‹åˆ†æžåŠŸèƒ½ï¼š
- æŸ¥çœ‹Promptè¯¦ç»†ä¿¡æ¯
- å¯¹æ¯”ä¸¤ä¸ªPromptsçš„å·®å¼‚
- æŸ¥è¯¢äº”å®˜æ¨¡å—ä¿¡æ¯
- æŸ¥è¯¢æµæ´¾å’Œè®¾å¤‡ä¿¡æ¯

---

## ðŸ”§ CLIå‘½ä»¤

### 1. æŸ¥çœ‹Promptè¯¦ç»†ä¿¡æ¯

**å‘½ä»¤**:
```bash
python3 prompt_tool.py show <id>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py show 5
```

**è¾“å‡º**:
```
ðŸ“¸ Prompt #5: æ¸…çº¯å°‘å¥³å¤å…¸ç¾Ž

åŸºæœ¬ä¿¡æ¯:
  ä¸»é¢˜: æ¸…çº¯å°‘å¥³ / å¤å…¸ä¼˜é›… / è‡ªç„¶å…‰äººåƒ
  é•¿åº¦: 892 å­—ç¬¦
  è¯„åˆ†: 10.0/10

æ‘„å½±æµæ´¾:
  äººåƒç¾Žå®¹æ‘„å½± (ç½®ä¿¡åº¦: 95%)

æŠ€æœ¯å‚æ•°:
  ç›¸æœº: Canon EOS R5
  é•œå¤´: RF 50mm f/1.2L
  åˆ†è¾¨çŽ‡: 8K

å¯¹ç«‹æ ‡å‡†:
  aesthetic:
    âœ“ å¿…é¡»: flawless porcelain skin, soft classical contour
    âœ— ç¦æ­¢: modern edgy makeup, harsh contours
```

### 2. å¯¹æ¯”ä¸¤ä¸ªPrompts

**å‘½ä»¤**:
```bash
python3 prompt_tool.py compare <id1> <id2>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py compare 5 17
```

**è¾“å‡º**:
```
âš–ï¸  å¯¹æ¯”: #5 vs #17

å±žæ€§         Prompt #5                  Prompt #17
=======================================================
æ ‡é¢˜         æ¸…çº¯å°‘å¥³å¤å…¸ç¾Ž             æ€§æ„Ÿæœ‹å…‹Jinx
è¯„åˆ†         10.0/10                    9.8/10
æµæ´¾         äººåƒç¾Žå®¹æ‘„å½±               èƒ¶ç‰‡è‰ºæœ¯æ‘„å½±
ç›¸æœº         Canon EOS R5               Hasselblad 503CX
åˆ†è¾¨çŽ‡       8K                         medium format
```

### 3. æŸ¥è¯¢äº”å®˜ç±»åž‹åˆ—è¡¨

**å‘½ä»¤**:
```bash
python3 prompt_tool.py facial --list-types
```

**è¾“å‡º**:
```
ðŸ“Š äº”å®˜ç‰¹å¾åˆ†ç±»åº“

çœ¼åž‹ (4ç§):
  large_expressive_almond    å¤§çœ¼æä»çœ¼      (9.8/10) Prompts: [5]
  large_blue_expressive      å¤§è“çœ¼ï¼ˆçœŸäººåŒ–ï¼‰(8.5/10) Prompts: [18]
  half_lidded_seductive      åŠé—­è¯±æƒ‘çœ¼      (8.0/10) Prompts: [17]
  anime_hybrid_green         åŠ¨æ¼«æ··åˆç»¿çœ¼    (8.5/10) Prompts: [11]

è„¸åž‹ (2ç§):
  oval_asian_refined         ç²¾è‡´é¹…è›‹è„¸ï¼ˆäºšæ´²ï¼‰(10.0/10) Prompts: [17, 18]
  classical_soft_contour     æŸ”å’Œå¤å…¸è„¸åž‹      (9.5/10)  Prompts: [5]

... (å…¶ä»–ç±»åˆ«)
```

### 4. æŸ¥è¯¢ç‰¹å®šäº”å®˜ç±»åž‹

**å‘½ä»¤**:
```bash
python3 prompt_tool.py facial --eye-type <ç±»åž‹>
python3 prompt_tool.py facial --skin-texture <ç±»åž‹>
python3 prompt_tool.py facial --expression <ç±»åž‹>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py facial --eye-type almond
```

**è¾“å‡º**:
```
ðŸ” äº”å®˜ç‰¹å¾: å¤§çœ¼æä»çœ¼

è§†è§‰ç‰¹å¾:
  â€¢ size: å¤§è€Œå¯Œæœ‰è¡¨çŽ°åŠ› (large and expressive)
  â€¢ shape: æä»å½¢ (almond-shaped)
  â€¢ eyelashes: æµ“å¯†ä¿®é•¿çš„è‡ªç„¶ç«æ¯› (thick long natural lashes)

æç¤ºè¯å…³é”®è¯:
  â€¢ large expressive eyes
  â€¢ almond eyes
  â€¢ thick natural lashes
  â€¢ deep clear iris
  â€¢ dewy sparkle

é€‚åˆé£Žæ ¼:
  â€¢ æ¸…çº¯å°‘å¥³
  â€¢ é‚»å®¶å°å¦¹
  â€¢ å¤å…¸æ¸©æŸ”
  â€¢ çŽ°ä»£å•†ä¸šäººåƒ

ä½¿ç”¨è¯¥ç‰¹å¾çš„Prompts (1ä¸ª):
  #5   æ¸…çº¯å°‘å¥³å¤å…¸ç¾Ž                      10.0/10

ä½¿ç”¨å»ºè®®:
  â€¢ best_for: ä¸‡èƒ½çœ¼åž‹ï¼Œé€‚åˆæ¸…çº¯ã€ä¼˜é›…ã€å¤å…¸é£Žæ ¼
  â€¢ pair_with: æ­é… 'innocent', 'gentle', 'youthful' å¼ºåŒ–çº¯å‡€æ„Ÿ
  â€¢ lighting: é»„é‡‘æ—¶åˆ»æŸ”å’Œå…‰ (golden hour soft light) æœ€ä½³
```

### 5. æŒ‰é£Žæ ¼æŽ¨èäº”å®˜ç»„åˆ

**å‘½ä»¤**:
```bash
python3 prompt_tool.py facial --style <é£Žæ ¼>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py facial --style "æ¸…çº¯å°‘å¥³"
```

**è¾“å‡º**:
```
ðŸŽ¨ é£Žæ ¼: æ¸…çº¯å°‘å¥³

æŽ¨èäº”å®˜ç»„åˆ:

æ€§åˆ«: å¥³æ€§ (female)
å¹´é¾„: é’å¹´ï¼ˆ18-25å²ï¼‰ (young_adult) [10.0/10]
äººç§: ä¸œäºšäºº (east_asian) [10.0/10]
  å…³é”®è¯: East Asian, Asian features

çœ¼åž‹: å¤§çœ¼æä»çœ¼ (large_expressive_almond) [9.8/10]
  å…³é”®è¯: large expressive eyes, almond eyes, thick natural lashes

å”‡åž‹: ç²‰å«©å…‰æ³½å”‡ (soft_pink_gloss) [9.0/10]
  å…³é”®è¯: soft full lips, gentle pink gloss, natural lip color

é¼»åž‹: å°å·§ç›´é¼» (small_straight_delicate) [9.0/10]
  å…³é”®è¯: small straight nose, delicate nose

çš®è‚¤: ç“·è‚Œæ— ç‘•ï¼ˆå‘å…‰è´¨æ„Ÿï¼‰ (porcelain_flawless_radiant) [9.5/10]
  å…³é”®è¯: flawless porcelain skin, radiant jade-like brightness

è¡¨æƒ…: æ¸…çº¯æ¸©æŸ”çœ¼ç¥ž (innocent_gentle_gaze) [9.5/10]
  å…³é”®è¯: innocent gaze, gentle smile, soft introspective
```

### 6. æŒ‰æµæ´¾æœç´¢

**å‘½ä»¤**:
```bash
python3 prompt_tool.py search --genre <æµæ´¾>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py search --genre cinematic_narrative
```

**è¾“å‡º**:
```
ðŸ” æµæ´¾: ç”µå½±å™äº‹æ‘„å½±

æµæ´¾ç‰¹å¾:
  â€¢ 8K HDRè¶…é«˜æ¸…æ•°ç æ‘„å½±
  â€¢ ç”µå½±çº§å®žæ™¯æ‹æ‘„
  â€¢ è‡ªç„¶å™äº‹æ€§å…‰ç…§
  â€¢ çœŸäººåŒ–è§’è‰²æ¼”ç»Ž

å…¸åž‹è®¾å¤‡:
  â€¢ Canon EOS R5
  â€¢ RF 35mm f/2.8 macro IS STM

åº”ç”¨åœºæ™¯:
  â€¢ çœŸäººåŒ–è§’è‰²æ‘„å½±
  â€¢ ç”µå½±çº§æ¦‚å¿µè‰ºæœ¯
  â€¢ æ¸¸æˆIPçœŸäººåŒ–

ç›¸å…³æç¤ºè¯ (2ä¸ª):
  #18  Princess PeachçœŸäººåŒ–                    9.8/10
  #11  SaberçœŸäººåŒ–                             9.5/10
```

### 7. æŒ‰è®¾å¤‡æœç´¢

**å‘½ä»¤**:
```bash
python3 prompt_tool.py search --equipment <è®¾å¤‡>
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py search --equipment R5
```

---

## ðŸŽ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å­¦ä¹ ä¼˜ç§€Prompt

```
ç”¨æˆ·: "æˆ‘æƒ³å­¦ä¹ Prompt #5çš„ç»†èŠ‚"
â†’ è°ƒç”¨: python3 prompt_tool.py show 5
â†’ æŸ¥çœ‹å®Œæ•´æŠ€æœ¯å‚æ•°ã€å¯¹ç«‹æ ‡å‡†ã€ç‹¬ç‰¹ç‰¹å¾
```

### åœºæ™¯2: å¯¹æ¯”ä¸¤ç§é£Žæ ¼

```
ç”¨æˆ·: "æ¸…çº¯å’Œæ€§æ„Ÿé£Žæ ¼æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ"
â†’ è°ƒç”¨: python3 prompt_tool.py compare 5 17
â†’ å¯¹æ¯”è¡¨æ ¼ä¸€ç›®äº†ç„¶
```

### åœºæ™¯3: æŸ¥è¯¢äº”å®˜åº“

```
ç”¨æˆ·: "æœ‰å“ªäº›çœ¼åž‹å¯é€‰ï¼Ÿ"
â†’ è°ƒç”¨: python3 prompt_tool.py facial --list-types
â†’ æŸ¥çœ‹æ‰€æœ‰6å¤§ç±»äº”å®˜åˆ†ç±»
```

### åœºæ™¯4: å­¦ä¹ é£Žæ ¼æ­é…

```
ç”¨æˆ·: "å¤å…¸ä¼˜é›…é£Žæ ¼åº”è¯¥ç”¨ä»€ä¹ˆäº”å®˜ï¼Ÿ"
â†’ è°ƒç”¨: python3 prompt_tool.py facial --style "å¤å…¸ä¼˜é›…"
â†’ èŽ·å–å®Œæ•´äº”å®˜ç»„åˆæŽ¨è
```

---

## ðŸ“ æ•°æ®ä¾èµ–

```
facial_features_library.json (v1.2)
â”œâ”€â”€ 9å¤§ç±»åˆ«ã€28ä¸ªåˆ†ç±»
â””â”€â”€ usage_index.by_style_mood (4ç§é£Žæ ¼)

module_library.json
â”œâ”€â”€ photography_genres (10æµæ´¾)
â””â”€â”€ camera_equipment_index (è®¾å¤‡åº“)

extracted_modules.json
â””â”€â”€ 18ä¸ªæºPromptsçš„å®Œæ•´æ•°æ®
```

---

**æ¨¡å—çŠ¶æ€**: âœ… å¯ç”¨
**CLIå‘½ä»¤**: `show`, `compare`, `search`, `facial`
**æ”¯æŒæŸ¥è¯¢**: Promptã€æµæ´¾ã€è®¾å¤‡ã€äº”å®˜ã€é£Žæ ¼



================================================
FILE: .claude/skills/prompt-master/modules/core/builder.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-master/modules/core/extractor.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-master/modules/core/learner.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-master/modules/core/optimizer.md
================================================
[Binary file]


================================================
FILE: .claude/skills/prompt-master/modules/core/recommender.md
================================================
# âš ï¸ æ—§æž¶æž„ - Recommender Module - æŽ¨èæ¨¡å—

> **æ³¨æ„**ï¼šè¿™æ˜¯æ—§æž¶æž„æ¨¡å—ï¼Œå±žäºŽprompt-masterç³»ç»Ÿ


**åŠŸèƒ½**: æŽ¨èç›¸ä¼¼æˆ–ç›¸å…³çš„æç¤ºè¯å’Œæ¨¡å—
**è°ƒç”¨æ–¹å¼**: é€šè¿‡ä¸»Skillè·¯ç”±æˆ–ç›´æŽ¥CLIè°ƒç”¨

---

## ðŸ“‹ åŠŸèƒ½æ¦‚è¿°

Recommenderæ¨¡å—åŸºäºŽç›¸ä¼¼åº¦ç®—æ³•æŽ¨èï¼š
- ç›¸ä¼¼çš„Promptsï¼ˆåŸºäºŽæµæ´¾ã€è®¾å¤‡ã€ä¸»é¢˜ï¼‰
- ç›¸å…³çš„äº”å®˜æ¨¡å—ç»„åˆ
- é€‚åˆçš„æ‘„å½±æµæ´¾å’Œè®¾å¤‡

---

## ðŸ”§ CLIå‘½ä»¤

### 1. æŽ¨èç›¸ä¼¼Prompts

**å‘½ä»¤**:
```bash
python3 prompt_tool.py recommend <id> [-n <æ•°é‡>]
```

**ç¤ºä¾‹**:
```bash
python3 prompt_tool.py recommend 5 -n 3
```

**è¾“å‡º**:
```
ðŸ” ä¸º Prompt #5 (æ¸…çº¯å°‘å¥³å¤å…¸ç¾Ž) æŽ¨èç›¸å…³æç¤ºè¯

[1] #18 Princess PeachçœŸäººåŒ–
    ç›¸ä¼¼åº¦: 75%
    ç†ç”±: åŒä¸ºæ¸…çº¯å°‘å¥³é£Žæ ¼ + åŒç”¨East Asianäººç§

[2] #10 æ¸©æŸ”å°‘å¥³äººåƒ
    ç›¸ä¼¼åº¦: 65%
    ç†ç”±: åŒä¸ºäººåƒç¾Žå®¹æ‘„å½± + ä¸»é¢˜ç›¸å…³

[3] #17 æ€§æ„Ÿæœ‹å…‹Jinx
    ç›¸ä¼¼åº¦: 45%
    ç†ç”±: åŒä¸ºå¹´è½»å¥³æ€§äººåƒï¼ˆé£Žæ ¼å·®å¼‚å¤§ï¼‰
```

---

## ðŸ“Š æŽ¨èç®—æ³•

### ç›¸ä¼¼åº¦è®¡ç®—

åŸºäºŽä»¥ä¸‹ç»´åº¦è®¡ç®—ç›¸ä¼¼åº¦ï¼š

| ç»´åº¦ | æƒé‡ | è¯´æ˜Ž |
|------|------|------|
| æ‘„å½±æµæ´¾ | 50% | æµæ´¾ç›¸åŒå¾—åˆ†æœ€é«˜ |
| ç›¸æœºè®¾å¤‡ | 30% | è®¾å¤‡ç›¸åŒè¯´æ˜ŽæŠ€æœ¯ç›¸ä¼¼ |
| ä¸»é¢˜å…³é”®è¯ | 20% | ä¸»é¢˜ç›¸å…³æ€§ |

**è®¡ç®—é€»è¾‘**:
```python
score = 0.0
reasons = []

# æµæ´¾ç›¸åŒ +0.5
if current_genre == candidate_genre:
    score += 0.5
    reasons.append(f"åŒä¸º{genre_name}")

# è®¾å¤‡ç›¸åŒ +0.3
if current_camera == candidate_camera:
    score += 0.3
    reasons.append(f"åŒç”¨{camera_name}")

# ä¸»é¢˜ç›¸å…³ +0.2
if theme_keywords_match:
    score += 0.2
    reasons.append("ä¸»é¢˜ç›¸å…³")

similarity = score * 100  # è½¬æ¢ä¸ºç™¾åˆ†æ¯”
```

---

## ðŸŽ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å¯»æ‰¾ç›¸ä¼¼é£Žæ ¼

```
ç”¨æˆ·: "æŽ¨èä¸ŽPrompt #5ç›¸ä¼¼çš„æç¤ºè¯"
â†’ è°ƒç”¨: python3 prompt_tool.py recommend 5
â†’ èŽ·å–Top 3ç›¸ä¼¼Prompts
```

### åœºæ™¯2: å‘çŽ°æ–°é£Žæ ¼

```
ç”¨æˆ·: "æˆ‘å–œæ¬¢Prompt #17ï¼Œè¿˜æœ‰ç±»ä¼¼çš„å—ï¼Ÿ"
â†’ è°ƒç”¨: python3 prompt_tool.py recommend 17
â†’ å‘çŽ°æ€§æ„Ÿã€å›é€†é£Žæ ¼çš„å…¶ä»–Prompts
```

### åœºæ™¯3: å­¦ä¹ ç‰¹å®šæµæ´¾

```
ç”¨æˆ·: "å“ªäº›Promptså±žäºŽç”µå½±å™äº‹æ‘„å½±ï¼Ÿ"
â†’ è°ƒç”¨: python3 prompt_tool.py search --genre cinematic_narrative
â†’ æŸ¥çœ‹è¯¥æµæ´¾çš„æ‰€æœ‰Prompts
```

---

## ðŸ’¡ æŽ¨èç­–ç•¥

### 1. åŸºäºŽæµæ´¾æŽ¨è

**æœ€å‡†ç¡®**: æµæ´¾ç›¸åŒçš„PromptsæŠ€æœ¯é£Žæ ¼æœ€æŽ¥è¿‘
```
ç”µå½±å™äº‹æ‘„å½± â†’ Prompt #18, #11
èƒ¶ç‰‡è‰ºæœ¯æ‘„å½± â†’ Prompt #17
äººåƒç¾Žå®¹æ‘„å½± â†’ Prompt #5, #10
```

### 2. åŸºäºŽè®¾å¤‡æŽ¨è

**æŠ€æœ¯ç»´åº¦**: è®¾å¤‡ç›¸åŒè¯´æ˜ŽæŠ€æœ¯å‚æ•°æŽ¥è¿‘
```
Canon EOS R5 â†’ #5, #18, #11
Hasselblad + Kodak Portra 400 â†’ #17
```

### 3. åŸºäºŽä¸»é¢˜æŽ¨è

**å†…å®¹ç»´åº¦**: ä¸»é¢˜å…³é”®è¯é‡å 
```
æ¸…çº¯å°‘å¥³ â†’ #5, #18
æ€§æ„ŸæŒ‘é€— â†’ #17
è§’è‰²Cosplay â†’ #18, #11
```

---

## ðŸ“ æ•°æ®ä¾èµ–

```
extracted_modules.json
â”œâ”€â”€ prompt_id
â”œâ”€â”€ theme
â”œâ”€â”€ modules.visual_style.photography_genre
â””â”€â”€ modules.technical_parameters.camera

module_library.json
â”œâ”€â”€ photography_genres.<genre>.prompts
â””â”€â”€ camera_equipment_index.<equipment>.prompts
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ç›¸ä¼¼åº¦é˜ˆå€¼**
   - > 70%: é«˜åº¦ç›¸ä¼¼ï¼Œå¼ºæŽ¨è
   - 50-70%: ä¸­åº¦ç›¸ä¼¼ï¼Œå¯å‚è€ƒ
   - < 50%: ä½Žç›¸ä¼¼åº¦ï¼Œä»…ä½œå‚è€ƒ

2. **å¤šç»´åº¦å¹³è¡¡**
   - æµæ´¾ç›¸åŒä½†ä¸»é¢˜ä¸åŒ â†’ å¯å­¦ä¹ æŠ€æœ¯
   - ä¸»é¢˜ç›¸ä¼¼ä½†æµæ´¾ä¸åŒ â†’ å¯å°è¯•æ–°é£Žæ ¼

3. **æŽ¨èæ•°é‡**
   - é»˜è®¤æŽ¨èTop 3
   - å¯é€šè¿‡ `-n` å‚æ•°è°ƒæ•´ï¼ˆæœ€å¤š10ä¸ªï¼‰

---

**æ¨¡å—çŠ¶æ€**: âœ… å¯ç”¨
**CLIå‘½ä»¤**: `recommend`, `search`
**æŽ¨èç»´åº¦**: æµæ´¾ã€è®¾å¤‡ã€ä¸»é¢˜
**ç®—æ³•**: å¤šç»´åº¦åŠ æƒç›¸ä¼¼åº¦



================================================
FILE: .claude/skills/prompt-xray/README.md
================================================
# Prompt Xray - æç¤ºè¯Xå…‰é€è§†ç³»ç»Ÿ

**çŠ¶æ€**: ðŸš§ å¼€å‘ä¸­
**ç‰ˆæœ¬**: 1.0
**çµæ„Ÿ**: BerryXia Multi-Agent Architecture

## å¿«é€Ÿå¼€å§‹

```bash
# ä»Žé¡¹ç›®æ ¹ç›®å½•è¿è¡Œ
python -m claude.skills.prompt_xray.xray_controller
```

## ç›®å½•ç»“æž„

```
prompt-xray/
â”œâ”€â”€ skill.md          # Skillè¯´æ˜Žæ–‡æ¡£
â”œâ”€â”€ xray_controller.py  # ä¸»æŽ§åˆ¶å™¨
â”œâ”€â”€ agents/            # 8ä¸ªåˆ†æžAgent
â”‚   â”œâ”€â”€ color_analyzer.py
â”‚   â”œâ”€â”€ layout_architect.py
â”‚   â””â”€â”€ ...
â””â”€â”€ utils/             # å·¥å…·å‡½æ•°
```

## å·²å®žçŽ°åŠŸèƒ½

- [x] COLOR_ANALYZER - é…è‰²çŸ¥è¯†æå–
- [x] LAYOUT_ARCHITECT - å¸ƒå±€çŸ¥è¯†æå–
- [ ] SYMBOL_EXTRACTOR - ç¬¦å·æ·»åŠ æ–¹æ³•
- [ ] TYPOGRAPHY_ANALYST - æŽ’ç‰ˆçŸ¥è¯†
- [ ] MATERIAL_ENGINEER - æè´¨çŸ¥è¯†
- [ ] LIGHT_PHYSICIST - å…‰å½±çŸ¥è¯†
- [ ] KNOWLEDGE_SYNTHESIZER - çŸ¥è¯†èšåˆ



================================================
FILE: .claude/skills/prompt-xray/skill.md
================================================
---
name: prompt-xray
description: æç¤ºè¯Xå…‰é€è§† - ä»Žä¼˜ç§€æç¤ºè¯ä¸­é€†å‘æå–"å¦‚ä½•åšX"çš„çŸ¥è¯†ï¼Œè®©é»‘ç›’å˜é€æ˜Ž
---

# Prompt Xray - æç¤ºè¯é€†å‘å·¥ç¨‹ç³»ç»Ÿ

**è®¾è®¡å“²å­¦**: æ‹†è§£é»‘ç›’ï¼Œè®©æ¨¡ç³Šå˜æ¸…æ™°
**æ ¸å¿ƒèƒ½åŠ›**: å›žç­”"å¦‚ä½•åšX"çš„é—®é¢˜

---

## ðŸŽ¯ è§£å†³çš„é—®é¢˜

**é—®é¢˜**: æç¤ºè¯æ˜¯é»‘ç›’ â†’ ä¸çŸ¥é“ï¼š
- å¦‚ä½•æŽ§åˆ¶é¢œè‰²ï¼Ÿ
- å¦‚ä½•æŽ§åˆ¶ç©ºé—´å¸ƒå±€ï¼Ÿ
- å¦‚ä½•æ·»åŠ æ ‡å¿—æ€§ç¬¦å·ï¼Ÿ
- å¦‚ä½•è°ƒæ•´æŽ’ç‰ˆï¼Ÿ
- å¦‚ä½•æŽ§åˆ¶æè´¨ï¼Ÿ
- å¦‚ä½•æŽ§åˆ¶å…‰å½±ï¼Ÿ

**è§£å†³**: ä»ŽNä¸ªä¼˜ç§€æç¤ºè¯ä¸­æå–è§„å¾‹ â†’ ç”ŸæˆçŸ¥è¯†åº“

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šæå–å•ä¸€ç»´åº¦çŸ¥è¯†

```
ä»Žå·²åˆ†æžçš„æç¤ºè¯ä¸­ï¼Œæå–"å¦‚ä½•æŽ§åˆ¶é¢œè‰²"çš„çŸ¥è¯†
```

### æ–¹å¼2ï¼šæå–æ‰€æœ‰ç»´åº¦çŸ¥è¯†

```
ä»Žå·²åˆ†æžçš„æç¤ºè¯ä¸­ï¼Œæž„å»ºå®Œæ•´çŸ¥è¯†åº“
```

### æ–¹å¼3ï¼šæŒ‡å®šèŒƒå›´

```
åˆ†æžmoss_terrariumç³»åˆ—ï¼Œæå–é…è‰²çŸ¥è¯†
```

---

## ðŸ”„ æ‰§è¡Œæµç¨‹

å½“ç”¨æˆ·è¯·æ±‚æå–çŸ¥è¯†æ—¶ï¼Œä½ éœ€è¦ï¼š

### Step 1: è¯»å–æ•°æ®
ä½¿ç”¨å·¥å…·è¯»å– `extracted_results/` ä¸‹çš„æ‰€æœ‰ `*_extracted.json` æ–‡ä»¶ï¼š
```python
from xray_helper import load_prompts
prompts = load_prompts(pattern="*_extracted.json")
```

### Step 2: æŒ‰ç»´åº¦åˆ†æž
æ ¹æ®ç”¨æˆ·è¯·æ±‚çš„ç»´åº¦ï¼Œåˆ†æžå¯¹åº”æ¨¡å—ï¼š

#### å¦‚æžœç”¨æˆ·è¦"é¢œè‰²"çŸ¥è¯†ï¼š
- æå–æ‰€æœ‰ `color_scheme` æ¨¡å—
- åˆ†æžé…è‰²å…¬å¼ã€å…³é”®è¯ã€æŠ€å·§
- æŒ‰ä¸‹é¢çš„æ¨¡æ¿ç”ŸæˆMarkdown

#### å¦‚æžœç”¨æˆ·è¦"å¸ƒå±€"çŸ¥è¯†ï¼š
- æå–æ‰€æœ‰ `composition` æ¨¡å—
- åˆ†æžè§†è§’ã€æž„å›¾è§„åˆ™ã€å®šä½æ–¹æ³•
- æŒ‰æ¨¡æ¿ç”ŸæˆMarkdown

#### å¦‚æžœç”¨æˆ·è¦"ç¬¦å·"çŸ¥è¯†ï¼š
- æå– `constraints` å’Œ `detail_enhancers` æ¨¡å—
- åˆ†æžæ–‡å­—è¯­æ³•ã€Logoæ·»åŠ æ–¹æ³•
- æŒ‰æ¨¡æ¿ç”ŸæˆMarkdown

#### å¦‚æžœç”¨æˆ·è¦"æè´¨"çŸ¥è¯†ï¼š
- æå– `detail_enhancers` å’Œç›¸å…³æè¿°
- åˆ†æžè¡¨é¢ç‰¹å¾ã€ç‰©ç†å±žæ€§ã€è´¨æ„Ÿå…³é”®è¯
- æŒ‰æ¨¡æ¿ç”ŸæˆMarkdown

#### å¦‚æžœç”¨æˆ·è¦"å…‰å½±"çŸ¥è¯†ï¼š
- æå– `technical_parameters.lighting` å’Œ `mood_atmosphere`
- åˆ†æžå…‰æºç±»åž‹ã€å¸ƒå…‰æ–¹æ¡ˆã€æ°›å›´æ•ˆæžœ
- æŒ‰æ¨¡æ¿ç”ŸæˆMarkdown

#### å¦‚æžœç”¨æˆ·è¦"æŽ’ç‰ˆ"çŸ¥è¯†ï¼ˆè®¾è®¡ç±»ï¼‰ï¼š
- æå– `composition` å’Œ `visual_style`
- åˆ†æžæ …æ ¼ç³»ç»Ÿã€è§†è§‰å±‚çº§ã€å¯¹é½è§„åˆ™
- æŒ‰æ¨¡æ¿ç”ŸæˆMarkdown

### Step 3: ç”ŸæˆçŸ¥è¯†å¡ç‰‡
ä½¿ç”¨å·¥å…·ä¿å­˜ç»“æžœï¼š
```python
from xray_helper import save_knowledge_card
save_knowledge_card(dimension="color", content=markdown_content)
```

---

## ðŸ“ è¾“å‡ºæ¨¡æ¿

### æ¨¡æ¿1: å¦‚ä½•æŽ§åˆ¶é¢œè‰²ï¼Ÿ

```markdown
# å¦‚ä½•æŽ§åˆ¶é¢œè‰²ï¼Ÿ

**åˆ†æžæ—¶é—´**: {å½“å‰æ—¶é—´}
**æ ·æœ¬æ•°é‡**: {åˆ†æžäº†å¤šå°‘ä¸ªæç¤ºè¯}
**æ•°æ®æ¥æº**: {å“ªäº›æç¤ºè¯}

---

## ðŸŽ¨ é…è‰²å…¬å¼

### å…¬å¼1: å†·æš–å¯¹ç«‹ï¼ˆ7:3é»„é‡‘æ¯”ä¾‹ï¼‰
- **å…¬å¼**: `70% cool base + 30% warm accent`
- **æ¥æº**: moss_terrarium_001
- **æ•ˆæžœ**: è‡ªç„¶å’Œè° + è§†è§‰å±‚æ¬¡

### å…¬å¼2: ...

---

## ðŸ“š é¢œè‰²å…³é”®è¯åº“

### å†·è‰²ç³»
- `rich forest greens`
- `deep ocean blues`
- `ice whites`

### æš–è‰²ç³»
- `warm amber wood tones`
- `sunset orange`
- `golden hour light`

### ä¸­æ€§è‰²
- `grayscale`
- `pristine whites`

---

## ðŸ› ï¸ é…è‰²æŠ€å·§

1. **æ¸©åº¦å¯¹æ¯”** - å†·è‰²çŽ¯å¢ƒ + æš–è‰²ç„¦ç‚¹ = è§†è§‰å±‚æ¬¡
2. **7:3æ¯”ä¾‹** - ä¸»è‰²70%ï¼Œç„¦ç‚¹è‰²30%
3. **å•è‰²è°ƒ+ç„¦ç‚¹è‰²** - æžç®€é£Žæ ¼

---

## ðŸ’¡ åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1: moss_terrarium_001
**é…è‰²æ–¹æ¡ˆ**: rich forest greens (70%) + warm amber wood (30%)
**æ•ˆæžœ**: Natural harmony, clear focal point
**é€‚ç”¨åœºæ™¯**: è‡ªç„¶åœºæ™¯ã€æ¤ç‰©æ‘„å½±

### æ¡ˆä¾‹2: ...

```

### æ¨¡æ¿2: å¦‚ä½•æŽ§åˆ¶ç©ºé—´å¸ƒå±€ï¼Ÿ

```markdown
# å¦‚ä½•æŽ§åˆ¶ç©ºé—´å¸ƒå±€ï¼Ÿ

**åˆ†æžæ—¶é—´**: {å½“å‰æ—¶é—´}
**æ ·æœ¬æ•°é‡**: {åˆ†æžäº†å¤šå°‘ä¸ªæç¤ºè¯}

---

## ðŸŽ¥ è§†è§’é€‰æ‹©

### `slight top-down angle`
**é€‚ç”¨åœºæ™¯**: å¾®ç¼©åœºæ™¯ã€äº§å“æ‘„å½±ã€ç”Ÿæ€ç“¶
**å…³é”®è¯**: `top-down view`, `bird's eye view`, `overhead angle`
**æ¡ˆä¾‹**: moss_terrarium_001, moss_terrarium_002
**æ•ˆæžœ**: å±•ç¤ºå…¨è²Œï¼Œé€‚åˆå¹³é“ºå¸ƒå±€

### `isometric view`
**é€‚ç”¨åœºæ™¯**: 3Däº§å“ã€æ¸¸æˆåœºæ™¯ã€å»ºç­‘
**å…³é”®è¯**: `isometric`, `45-degree angle`
**æ•ˆæžœ**: ä¿æŒå¹³è¡Œçº¿ï¼Œæ— é€è§†å˜å½¢

---

## ðŸ“ æž„å›¾è§„åˆ™

### Golden Ratioï¼ˆé»„é‡‘æ¯”ä¾‹ï¼‰
**å…³é”®è¯**: `golden ratio composition`, `phi grid`
**æ•ˆæžœ**: ç»å…¸å’Œè°æ¯”ä¾‹ï¼Œè§†è§‰å¹³è¡¡
**ä½¿ç”¨é¢‘çŽ‡**: 3æ¬¡

### Rule of Thirdsï¼ˆä¸‰åˆ†æ³•ï¼‰
**å…³é”®è¯**: `rule of thirds`, `thirds grid`
**æ•ˆæžœ**: åŠ¨æ€å¹³è¡¡ï¼Œå¼•å¯¼è§†çº¿

### Centered Symmetryï¼ˆä¸­å¿ƒå¯¹ç§°ï¼‰
**å…³é”®è¯**: `centered`, `perfectly symmetrical`
**æ•ˆæžœ**: ç¨³å®šã€åº„é‡æ„Ÿ

---

## ðŸŽ¯ å®šä½æ–¹æ³•

### ç›¸å¯¹ä½ç½®æè¿°
- `iPhone placed next to notebook`
- `floating in 3D space`
- `bottom-left quadrant`

### ç²¾ç¡®åæ ‡ï¼ˆé«˜çº§ï¼‰
- `Subject A [X: 20-40, Y: 60-100] (Bottom-Left)`
- `Subject B [X: 60-80, Y: 0-40] (Top-Right)`

---

## ðŸ’¡ åº”ç”¨æ¡ˆä¾‹

### æ¡ˆä¾‹1: moss_terrarium_001
**è§†è§’**: slight top-down angle
**æž„å›¾**: centered in frame, golden ratio
**å®šä½**: terrarium centered, cottage as focal point

```

### æ¨¡æ¿3: å¦‚ä½•æ·»åŠ æ ‡å¿—æ€§ç¬¦å·ï¼Ÿ

```markdown
# å¦‚ä½•æ·»åŠ æ ‡å¿—æ€§ç¬¦å·ï¼Ÿ

---

## âœï¸ æ–‡å­—æ·»åŠ è¯­æ³•

### åŸºç¡€è¯­æ³•
```
text "HELLO" in bold serif
large bold sans-serif text "SALE" in red
neon red cursive script "OPEN"
```

### ä½ç½®æŽ§åˆ¶
- `lower left corner`
- `centered at top`
- `floating in 3D space`

---

## ðŸ·ï¸ Logo/æ°´å°æ·»åŠ 

### æ­£ç¡®ç¤ºä¾‹
```
small square watermark in lower left corner
simple logo in top-right, 10% opacity
brand symbol integrated into design
```

### âŒ åé¢æ¡ˆä¾‹ï¼ˆé¿å…ï¼‰
- `exactly 10x10 pixels` â†’ AIæ— æ³•ä¿è¯åƒç´ ç²¾åº¦
- `Gothic font AND Arial font` â†’ çŸ›ç›¾æŒ‡ä»¤
- `mandatory mandatory mandatory` â†’ é‡å¤æ— æ•ˆ

---

## ðŸŽ¨ ç¬¦å·é£Žæ ¼

### æè´¨æ•ˆæžœ
- `neon` - éœ“è™¹ç¯æ•ˆæžœ
- `embossed` - æµ®é›•æ•ˆæžœ
- `metallic sheen` - é‡‘å±žå…‰æ³½
- `glowing` - å‘å…‰æ•ˆæžœ

### å­—ä½“é£Žæ ¼
- `bold serif` - ç²—ä½“è¡¬çº¿
- `sans-serif` - æ— è¡¬çº¿
- `cursive script` - è‰ä¹¦
- `calligraphy` - ä¹¦æ³•ä½“

```

### æ¨¡æ¿4: å¦‚ä½•æŽ§åˆ¶æè´¨ï¼Ÿ

```markdown
# å¦‚ä½•æŽ§åˆ¶æè´¨ï¼Ÿ

---

## ðŸ” è¡¨é¢ç‰¹å¾

### é‡‘å±žæè´¨
- `brushed titanium` - æ‹‰ä¸é’›é‡‘å±ž
- `polished chrome` - æŠ›å…‰é•€é“¬
- `metallic sheen` - é‡‘å±žå…‰æ³½

### æœ‰æœºæè´¨
- `living green textures` - ç”Ÿæœºå‹ƒå‹ƒçš„ç»¿è‰²è´¨æ„Ÿ
- `natural wood grain` - å¤©ç„¶æœ¨çº¹
- `rough bark` - ç²—ç³™æ ‘çš®

### çŽ»ç’ƒ/é€æ˜Ž
- `under glass` - çŽ»ç’ƒä¸‹
- `translucent` - åŠé€æ˜Ž
- `crystal clear` - æ™¶èŽ¹å‰”é€

---

## âš™ï¸ ç‰©ç†å±žæ€§

- `glossy` / `matte` - å…‰æ³½/å“‘å…‰
- `reflective` / `absorptive` - åå°„/å¸æ”¶
- `weathered` / `pristine` - é£ŽåŒ–/åŽŸå§‹
- `soft` / `rigid` - æŸ”è½¯/åšç¡¬

---

## âœ¨ å…‰å­¦æ•ˆæžœ

- `morning dew droplets` - æ™¨éœ²æ°´ç 
- `soft sunlight reflections on glass` - çŽ»ç’ƒä¸Šçš„æŸ”å’Œé˜³å…‰åå°„
- `condensation` - å†·å‡æ°´æ±½
- `refraction` - æŠ˜å°„

```

### æ¨¡æ¿5: å¦‚ä½•æŽ§åˆ¶å…‰å½±ï¼Ÿ

```markdown
# å¦‚ä½•æŽ§åˆ¶å…‰å½±ï¼Ÿ

---

## ðŸ’¡ å…‰æºç±»åž‹

### è‡ªç„¶å…‰
- `soft diffused daylight` - æŸ”å’Œæ¼«å°„æ—¥å…‰
- `golden hour light` - é»„é‡‘æ—¶æ®µå…‰çº¿
- `morning sunlight` - æ™¨å…‰
- `harsh noon sun` - æ­£åˆå¼ºå…‰

### äººå·¥å…‰
- `studio lighting` - å½±æ£šç¯å…‰
- `neon lights` - éœ“è™¹ç¯
- `rim light` - è½®å»“å…‰
- `softbox overhead` - å¤´é¡¶æŸ”å…‰ç®±

---

## ðŸŽ¬ å¸ƒå…‰æ–¹æ¡ˆ

### Rembrandt Lightingï¼ˆä¼¦å‹ƒæœ—å¸ƒå…‰ï¼‰
**æ•ˆæžœ**: æˆå‰§æ€§ï¼Œé€‚åˆäººåƒ
**å…³é”®è¯**: `Rembrandt light`, `triangle highlight`, `dramatic shadows`

### Soft Diffused Lightï¼ˆæŸ”å’Œæ¼«å°„å…‰ï¼‰
**æ•ˆæžœ**: è‡ªç„¶ã€æ¸…æ–°ã€æ— ç¡¬å½±
**å…³é”®è¯**: `soft diffused`, `natural ambient`, `no harsh shadows`

### Rim Lightï¼ˆè½®å»“å…‰ï¼‰
**æ•ˆæžœ**: å‹¾å‹’è¾¹ç¼˜ï¼Œåˆ†ç¦»ä¸»ä½“å’ŒèƒŒæ™¯
**å…³é”®è¯**: `rim lighting`, `backlight`, `edge highlight`

---

## ðŸŒ¤ï¸ å…‰çº¿+æ°›å›´å…¬å¼

### æ¸…æ–°å®é™
```
soft diffused daylight + morning dew = fresh, peaceful atmosphere
```

### æˆå‰§å¼ åŠ›
```
Rembrandt light + rim light = dramatic portrait with depth
```

### ç§‘æŠ€æœªæ¥
```
neon accent lights + volumetric fog = cyberpunk atmosphere
```

---

## ðŸŒ«ï¸ å¤§æ°”æ•ˆæžœ

- `volumetric fog` - ä½“ç§¯é›¾
- `misty` - é›¾è’™è’™
- `hazy` - æœ¦èƒ§
- `clear crisp air` - æ¸…æ¾ˆç©ºæ°”

```

---

## ðŸ› ï¸ å·¥å…·å‡½æ•°

ä½ éœ€è¦ä½¿ç”¨ `xray_helper.py` ä¸­çš„å·¥å…·å‡½æ•°ï¼š

### è¯»å–æç¤ºè¯
```python
from xray_helper import load_prompts

# åŠ è½½æ‰€æœ‰æç¤ºè¯
all_prompts = load_prompts()

# åŠ è½½ç‰¹å®šèŒƒå›´
moss_prompts = load_prompts(pattern="moss_terrarium*")
```

### ä¿å­˜çŸ¥è¯†å¡ç‰‡
```python
from xray_helper import save_knowledge_card

save_knowledge_card(
    dimension="color",
    content=markdown_content,
    metadata={
        'samples': 10,
        'source': 'moss_terrarium + ethereal_deity'
    }
)
```

---

## ðŸ’¡ å…³é”®åŽŸåˆ™

### 1. å¯»æ‰¾è§„å¾‹ï¼Œä¸æ˜¯ç½—åˆ—
âŒ é”™è¯¯ï¼šåªåˆ—å‡ºæ‰€æœ‰é¢œè‰²å…³é”®è¯
âœ… æ­£ç¡®ï¼šå‘çŽ°é…è‰²å…¬å¼ï¼ˆå¦‚ï¼š70% cool + 30% warmï¼‰

### 2. æå–æŠ€å·§ï¼Œä¸æ˜¯æè¿°
âŒ é”™è¯¯ï¼š"è¿™ä¸ªæç¤ºè¯ç”¨äº†æ£®æž—ç»¿"
âœ… æ­£ç¡®ï¼š"å†·è‰²çŽ¯å¢ƒ + æš–è‰²ç„¦ç‚¹ = è§†è§‰å±‚æ¬¡"

### 3. ç»™å‡ºæ¡ˆä¾‹ï¼Œå¯ç›´æŽ¥å¤ç”¨
âŒ é”™è¯¯ï¼šæ¨¡ç³Šæè¿°"ä½¿ç”¨å¯¹æ¯”è‰²"
âœ… æ­£ç¡®ï¼šå…·ä½“æ¡ˆä¾‹ `rich forest greens + warm amber wood`

### 4. å­¦ä¹ ä¼˜ç§€ï¼Œä¹Ÿå­¦ä¹ é”™è¯¯
- ä»ŽAçº§æç¤ºè¯å­¦ä¹ æœ€ä½³å®žè·µ
- ä»ŽDçº§æç¤ºè¯ï¼ˆå¦‚pencil_sketch_idolï¼‰å­¦ä¹ åé¢æ¡ˆä¾‹

---

## ðŸ“Š åˆ†æžæ­¥éª¤ï¼ˆè¯¦ç»†ï¼‰

### å½“ç”¨æˆ·è¯´ï¼š"æå–å¦‚ä½•æŽ§åˆ¶é¢œè‰²çš„çŸ¥è¯†"

**Step 1**: åŠ è½½æ•°æ®
```python
prompts = load_prompts()
```

**Step 2**: éåŽ†æ‰€æœ‰æç¤ºè¯ï¼Œæå– color_scheme æ¨¡å—
```python
color_data = []
for prompt in prompts:
    if 'color_scheme' in prompt['modules']:
        color_data.append({
            'id': prompt['prompt_id'],
            'scheme': prompt['modules']['color_scheme']
        })
```

**Step 3**: åˆ†æžé…è‰²å…¬å¼
- æŸ¥æ‰¾ `primary_palette` å­—æ®µ
- æ£€æŸ¥ `temperature` æè¿°ï¼ˆå¦‚ï¼š"balanced - cool greens + warm wood"ï¼‰
- è¯†åˆ«æ¯”ä¾‹å…³ç³»ï¼ˆ70%/30%ï¼‰
- æå– `concept`ï¼ˆå¦‚ï¼š"Cold Shell, Warm Heart"ï¼‰

**Step 4**: åˆ†ç±»å…³é”®è¯
- éåŽ†æ‰€æœ‰é¢œè‰²æè¿°
- åˆ†ä¸ºå†·è‰²/æš–è‰²/ä¸­æ€§è‰²
- åŽ»é‡ï¼ŒæŽ’åº

**Step 5**: æå–æŠ€å·§
- æ¸©åº¦å¯¹æ¯”ï¼Ÿ
- é«˜å¯¹æ¯”/ä½Žå¯¹æ¯”ï¼Ÿ
- å•è‰²è°ƒ+ç„¦ç‚¹è‰²ï¼Ÿ

**Step 6**: åˆ›å»ºæ¡ˆä¾‹
- é€‰æ‹©æœ€ä½³3-5ä¸ªæ¡ˆä¾‹
- åŒ…å«ï¼šé…è‰²æ–¹æ¡ˆã€æ•ˆæžœã€é€‚ç”¨åœºæ™¯

**Step 7**: ç”ŸæˆMarkdown
- æŒ‰æ¨¡æ¿å¡«å……å†…å®¹
- ä½¿ç”¨ `save_knowledge_card()` ä¿å­˜

---

## ðŸŽ¯ è¾“å‡ºä½ç½®

æ‰€æœ‰çŸ¥è¯†å¡ç‰‡ä¿å­˜åˆ°ï¼š
```
knowledge_base/
â”œâ”€â”€ how_to_control_color.md
â”œâ”€â”€ how_to_control_layout.md
â”œâ”€â”€ how_to_add_symbols.md
â”œâ”€â”€ how_to_control_materials.md
â”œâ”€â”€ how_to_control_lighting.md
â””â”€â”€ how_to_control_typography.md (é’ˆå¯¹è®¾è®¡ç±»)
```

---

## âœ… éªŒæ”¶æ ‡å‡†

ç”Ÿæˆçš„çŸ¥è¯†å¡ç‰‡åº”è¯¥ï¼š
1. âœ… å›žç­”"å¦‚ä½•åšX"çš„é—®é¢˜
2. âœ… åŒ…å«å…·ä½“çš„å…³é”®è¯å’Œå…¬å¼
3. âœ… æœ‰3+ä¸ªçœŸå®žæ¡ˆä¾‹
4. âœ… å¯ä»¥ç›´æŽ¥å¤ç”¨åˆ°æ–°æç¤ºè¯ä¸­
5. âœ… æ—¢æœ‰æ­£é¢æ¡ˆä¾‹ï¼Œä¹Ÿæœ‰åé¢æ•™è®­

---

**SkillçŠ¶æ€**: âœ… è®¾è®¡å®Œæˆ
**æœ€åŽæ›´æ–°**: 2026-01-04
**ä½¿ç”¨å·¥å…·**: xray_helper.py



================================================
FILE: .claude/skills/prompt-xray/xray_helper.py
================================================
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Xray Helper - ç®€å•çš„æ•°æ®è¯»å–å’Œä¿å­˜å·¥å…·
ä»…è´Ÿè´£æ–‡ä»¶IOï¼Œä¸åšä»»ä½•åˆ†æžå†³ç­–
"""

import json
from pathlib import Path
from typing import List, Dict
from datetime import datetime


def load_prompts(pattern: str = "*_extracted.json",
                 base_dir: str = "extracted_results") -> List[Dict]:
    """
    è¯»å–å·²åˆ†æžçš„æç¤ºè¯JSONæ–‡ä»¶

    Args:
        pattern: æ–‡ä»¶åæ¨¡å¼ï¼ˆå¦‚ï¼šmoss_terrarium*ï¼‰
        base_dir: JSONæ–‡ä»¶æ‰€åœ¨ç›®å½•

    Returns:
        List of prompt data
    """
    base_path = Path(base_dir)
    prompts = []

    if not base_path.exists():
        print(f"âŒ ç›®å½•ä¸å­˜åœ¨: {base_path}")
        return []

    for json_file in base_path.glob(pattern):
        try:
            with open(json_file, 'r', encoding='utf-8') as f:
                data = json.load(f)

                # å¤„ç†å•ä¸ªæç¤ºè¯æˆ–æç¤ºè¯æ•°ç»„
                if isinstance(data, list):
                    prompts.extend(data)
                else:
                    prompts.append(data)

                print(f"âœ… å·²åŠ è½½: {json_file.name}")
        except Exception as e:
            print(f"âŒ åŠ è½½å¤±è´¥ {json_file.name}: {e}")

    print(f"\nðŸ“Š æ€»è®¡åŠ è½½: {len(prompts)} ä¸ªæç¤ºè¯")
    return prompts


def save_knowledge_card(dimension: str,
                       content: str,
                       metadata: Dict = None,
                       output_dir: str = "knowledge_base") -> str:
    """
    ä¿å­˜çŸ¥è¯†å¡ç‰‡åˆ°Markdownæ–‡ä»¶

    Args:
        dimension: ç»´åº¦åç§°ï¼ˆcolor/layout/symbolsç­‰ï¼‰
        content: Markdownå†…å®¹
        metadata: å¯é€‰çš„å…ƒæ•°æ®
        output_dir: è¾“å‡ºç›®å½•

    Returns:
        ä¿å­˜çš„æ–‡ä»¶è·¯å¾„
    """
    output_path = Path(output_dir)
    output_path.mkdir(exist_ok=True)

    # ç”Ÿæˆæ–‡ä»¶å
    filename = f"how_to_control_{dimension}.md"
    filepath = output_path / filename

    # ä¿å­˜æ–‡ä»¶
    with open(filepath, 'w', encoding='utf-8') as f:
        f.write(content)

    print(f"ðŸ’¾ å·²ä¿å­˜: {filepath}")

    # å¦‚æžœæœ‰å…ƒæ•°æ®ï¼Œä¹Ÿä¿å­˜JSONç‰ˆæœ¬
    if metadata:
        json_filename = f"how_to_control_{dimension}.json"
        json_filepath = output_path / json_filename

        output_data = {
            'dimension': dimension,
            'creation_time': datetime.now().isoformat(),
            'metadata': metadata,
            'markdown_content': content
        }

        with open(json_filepath, 'w', encoding='utf-8') as f:
            json.dump(output_data, f, ensure_ascii=False, indent=2)

        print(f"ðŸ’¾ å·²ä¿å­˜å…ƒæ•°æ®: {json_filepath}")

    return str(filepath)


def list_available_prompts(base_dir: str = "extracted_results") -> List[str]:
    """
    åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æç¤ºè¯æ–‡ä»¶

    Args:
        base_dir: JSONæ–‡ä»¶æ‰€åœ¨ç›®å½•

    Returns:
        æ–‡ä»¶ååˆ—è¡¨
    """
    base_path = Path(base_dir)

    if not base_path.exists():
        print(f"âŒ ç›®å½•ä¸å­˜åœ¨: {base_path}")
        return []

    files = sorted([f.name for f in base_path.glob("*_extracted.json")])

    print(f"\nðŸ“ å¯ç”¨çš„æç¤ºè¯æ–‡ä»¶ ({len(files)}ä¸ª):")
    for f in files:
        print(f"  - {f}")

    return files


if __name__ == '__main__':
    """æµ‹è¯•å‡½æ•°"""
    print("=" * 60)
    print("  ðŸ”¬ Xray Helper - å·¥å…·æµ‹è¯•")
    print("=" * 60)

    # æµ‹è¯•ï¼šåˆ—å‡ºå¯ç”¨æ–‡ä»¶
    list_available_prompts()

    # æµ‹è¯•ï¼šåŠ è½½æç¤ºè¯
    print("\n" + "=" * 60)
    prompts = load_prompts()

    if prompts:
        print(f"\nðŸ“‹ ç¬¬ä¸€ä¸ªæç¤ºè¯ç¤ºä¾‹:")
        print(f"  ID: {prompts[0].get('prompt_id', 'unknown')}")
        print(f"  ä¸»é¢˜: {prompts[0].get('theme', 'unknown')}")

    # æµ‹è¯•ï¼šä¿å­˜çŸ¥è¯†å¡ç‰‡
    print("\n" + "=" * 60)
    test_content = """# æµ‹è¯•çŸ¥è¯†å¡ç‰‡

è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
"""

    save_knowledge_card(
        dimension="test",
        content=test_content,
        metadata={'test': True, 'samples': 2}
    )

    print("\n" + "=" * 60)
    print("âœ… æµ‹è¯•å®Œæˆï¼")



================================================
FILE: .claude/skills/universal-learner/SKILL.md
================================================
---
name: universal-learner
description: é€šç”¨å­¦ä¹ å™¨ - ä»Žä»»ä½•é¢†åŸŸçš„Promptä¸­è‡ªåŠ¨æå–å¯å¤ç”¨å…ƒç´ ï¼ŒæŒç»­å­¦ä¹ å’Œç§¯ç´¯çŸ¥è¯†
---

# Universal Learner - é€šç”¨å­¦ä¹ å™¨ Skill

**ç‰ˆæœ¬**: 1.0
**æž¶æž„**: Master-Subordinate
**å­¦ä¹ æ–¹å¼**: åŠè‡ªåŠ¨ï¼ˆç”ŸæˆæŠ¥å‘Š + äººå·¥å®¡æ ¸ï¼‰

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

ä»Žä»»ä½•é¢†åŸŸçš„Promptä¸­è‡ªåŠ¨æå–å¯å¤ç”¨å…ƒç´ ï¼Œå­˜å…¥Universal Elements Libraryæ•°æ®åº“ã€‚

æ”¯æŒ7å¤§é¢†åŸŸï¼š
- ðŸ“· **portrait** - äººåƒæ‘„å½±
- ðŸ  **interior** - å®¤å†…è®¾è®¡
- ðŸ“¦ **product** - äº§å“æ‘„å½±
- ðŸŽ¨ **design** - å¹³é¢è®¾è®¡
- ðŸŽ­ **art** - è‰ºæœ¯é£Žæ ¼
- ðŸŽ¬ **video** - è§†é¢‘ç”Ÿæˆ
- ðŸ“¸ **common** - é€šç”¨æ‘„å½±æŠ€æœ¯

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### æ–¹å¼1ï¼šå­¦ä¹ å•ä¸ªPrompt

```
å­¦ä¹ è¿™ä¸ªPrompt: [ç²˜è´´å®Œæ•´Prompt]
```

æˆ–

```
åˆ†æžå¹¶å­¦ä¹ : A premium collector's edition book photographed with Phase One camera, featuring Italian calfskin binding...
```

### æ–¹å¼2ï¼šæ‰¹é‡å­¦ä¹ 18ä¸ªæºPrompts

```
æ‰¹é‡å­¦ä¹ æ‰€æœ‰Prompts
```

æˆ–

```
å­¦ä¹ extracted_modules.jsonä¸­çš„æ‰€æœ‰Prompts
```

### æ–¹å¼3ï¼šå­¦ä¹ ç‰¹å®šé¢†åŸŸ

```
åªå­¦ä¹ producté¢†åŸŸçš„Prompts
```

æˆ–

```
å­¦ä¹ Prompt #1, #6, #14, #16ï¼ˆäº§å“æ‘„å½±ï¼‰
```

### æ–¹å¼4ï¼šå­¦ä¹ è®¾è®¡ç³»ç»Ÿ/æ¨¡å—ç³»ç»Ÿ â­ æ–°å¢ž

```
å­¦ä¹ è¿™ä¸ªè®¾è®¡ç³»ç»Ÿï¼š[ç²˜è´´å®Œæ•´çš„è®¾è®¡ç³»ç»Ÿè§„èŒƒ]
```

æˆ–

```
å­¦ä¹ è¿™ä¸ªå·¥ä½œæµæ¨¡å—ï¼š[å®Œæ•´å·¥ä½œæµå†…å®¹]
```

**è‡ªåŠ¨è¯†åˆ«ç‰¹å¾**ï¼š
- åŒ…å«å…³é”®è¯ï¼š**æ¨¡å— / ç³»ç»Ÿ / å·¥ä½œæµ / æ¡†æž¶**
- æœ‰å±‚çº§ç»“æž„ï¼ˆèƒŒæ™¯ç³»ç»Ÿ + é…è‰²æ–¹æ¡ˆ + å­—ä½“ç³»ç»Ÿ...ï¼‰
- åŒ…å«è®¾è®¡ç†å¿µè¯´æ˜Žæˆ–æµç¨‹æ­¥éª¤

**ç‰¹æ®Šå¤„ç†ï¼ˆæ¨¡å—ç³»ç»Ÿæ¨¡å¼ï¼‰**ï¼š
- æå–å…ƒç´  â†’ elementsè¡¨
- åˆ›å»ºè®¾è®¡ç³»ç»Ÿè®°å½• â†’ design_templatesè¡¨
- **ä¿å­˜å®Œæ•´åŽŸå§‹å†…å®¹ â†’ visual_referenceå­—æ®µ** â­ å…³é”®å¢žå¼º

---

## ðŸ”„ å·¥ä½œæµç¨‹

```
è¾“å…¥Prompt
  â†“
ã€Step 0: ç±»åž‹è¯†åˆ«ã€‘â­ æ–°å¢ž
  - åˆ¤æ–­æ˜¯"ç”»é¢æè¿°åž‹" è¿˜æ˜¯ "è®¾è®¡ç³»ç»Ÿåž‹"
  - è®¾è®¡ç³»ç»Ÿç‰¹å¾ï¼šåŒ…å«"è®¾è®¡ç³»ç»Ÿ"ã€"é£Žæ ¼è§„èŒƒ"ã€æœ‰å±‚çº§ç»“æž„
  - è¾“å‡º: {"type": "prompt" | "design_system"}
  â†“
ã€Step 0.1: æ¨¡å—ç³»ç»Ÿåˆ¤æ–­ã€‘â­ å…³é”®å¢žå¼º
  - æ£€æµ‹å…³é”®è¯ï¼šã€æ¨¡å—ã€‘ã€ç³»ç»Ÿã€‘ã€å·¥ä½œæµã€‘ã€æ¡†æž¶ã€‘
  - YES â†’ æ¨¡å—ç³»ç»Ÿæ¨¡å¼ï¼ˆéœ€ä¿å­˜å®Œæ•´åŽŸå§‹å†…å®¹ï¼‰
  - NO  â†’ æ™®é€šå­¦ä¹ æ¨¡å¼ï¼ˆåªæå–å…ƒç´ ï¼‰
  â†“
ã€Step 1: é¢†åŸŸåˆ†ç±»ã€‘domain_classifier.md
  - è¯†åˆ«ä¸»è¦é¢†åŸŸï¼ˆproduct/design/art/video...ï¼‰
  - åˆ¤æ–­æ˜¯å¦å¤šé¢†åŸŸ
  - è¾“å‡º: {"primary": "product", "secondary": ["photography"]}
  â†“
ã€Step 2: å…ƒç´ æå–ã€‘element_extractor.md
  - æ ¹æ®é¢†åŸŸæå–å¯¹åº”å…ƒç´ 
  - product â†’ product_types, materials, photography_techniques
  - design â†’ layouts, effects, typography
  - art â†’ art_styles, special_effects
  - è¾“å‡º: List[{category, name, template, keywords}]
  â†“
ã€Step 3: è‡ªåŠ¨æ‰“æ ‡ç­¾ã€‘tagger.md
  - åŸºäºŽkeywordsç”Ÿæˆtags
  - æ·»åŠ é¢†åŸŸæ ‡ç­¾ã€ç±»åˆ«æ ‡ç­¾
  - è·¨é¢†åŸŸæ ‡ç­¾è¯†åˆ«ï¼ˆluxury, glass, dynamic...ï¼‰
  - è¾“å‡º: tagsåˆ—è¡¨
  â†“
ã€Step 4: è®¡ç®—å¤ç”¨æ€§ã€‘
  - reusability_score (1-10)
  - åŸºäºŽï¼šé€šç”¨æ€§ã€æ¸…æ™°åº¦ã€ç‹¬ç«‹æ€§
  â†“
ã€Step 5: æ›´æ–°æ•°æ®åº“ã€‘library_updater.md
  - æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ï¼ˆåŽ»é‡ï¼‰
  - ç”Ÿæˆelement_id
  - å†™å…¥elements.db
  - æ›´æ–°tag_index
  â†“
ã€Step 5.1: å¦‚æžœæ˜¯è®¾è®¡ç³»ç»Ÿã€‘â­ æ–°å¢ž
  - åŒæ—¶åˆ›å»ºæ¨¡æ¿è®°å½•
  - å†™å…¥design_templatesè¡¨
  - å…³è”æ‰€æœ‰æå–çš„å…ƒç´ 
  - ä¿å­˜è®¾è®¡ç†å¿µã€ä½¿ç”¨æŒ‡å—ç­‰å®Œæ•´ä¿¡æ¯
  â†“
ã€Step 5.2: å¦‚æžœæ˜¯æ¨¡å—ç³»ç»Ÿæ¨¡å¼ã€‘â­ å…³é”®å¢žå¼º
  - æŠŠå®Œæ•´åŽŸå§‹å†…å®¹ä¿å­˜åˆ° visual_reference å­—æ®µ
  - åŒ…æ‹¬ï¼šå®Œæ•´å·¥ä½œæµã€æ‰€æœ‰æ¨¡æ¿ã€é…ç½®å‚æ•°ç­‰
  - ç›®çš„ï¼šå¯ç›´æŽ¥ä½¿ç”¨ï¼Œæ— éœ€é‡æ–°ç»„åˆå…ƒç´ 
  â†“
ã€Step 6: ç”ŸæˆæŠ¥å‘Šã€‘
  - æ–°å­¦ä¹ çš„å…ƒç´ åˆ—è¡¨
  - æŒ‰é¢†åŸŸå’Œç±»åˆ«åˆ†ç»„
  - æŽ¨èçš„tags
  - è´¨é‡è¯„ä¼°
  - ï¼ˆè®¾è®¡ç³»ç»Ÿï¼‰é¢å¤–æ˜¾ç¤ºæ¨¡æ¿ä¿¡æ¯
```

---

## ðŸ“Š è¾“å‡ºç¤ºä¾‹

### å­¦ä¹ æŠ¥å‘Š

```markdown
# Universal Learner - å­¦ä¹ æŠ¥å‘Š

**å­¦ä¹ æ—¶é—´**: 2026-01-01 18:30:00
**æºPrompt**: Prompt #1

## ðŸŽ¯ é¢†åŸŸè¯†åˆ«

ä¸»é¢†åŸŸ: **product** (äº§å“æ‘„å½±)
æ¬¡é¢†åŸŸ: **common** (é€šç”¨æ‘„å½±)

## ðŸ“¦ æå–çš„å…ƒç´ 

### äº§å“ç±»åž‹ (product_types)

1. **collector_edition_book** - æ”¶è—ç‰ˆä¹¦ç±
   - æ¨¡æ¿: premium collector's edition book, luxury binding, Italian calfskin cover
   - å…³é”®è¯: collector's edition, premium book, luxury binding
   - æ ‡ç­¾: product, book, luxury, collectible
   - å¤ç”¨æ€§: 7.5/10
   - element_id: product_product_types_001

### æè´¨çº¹ç† (material_textures)

2. **glossy_reflective** - å…‰æ³½åå°„æè´¨
   - æ¨¡æ¿: high-end glossy surface, reflective finish, metallic sheen
   - å…³é”®è¯: glossy, reflective, shiny, polished
   - æ ‡ç­¾: material, glossy, luxury, product
   - å¤ç”¨æ€§: 8.5/10
   - element_id: product_material_textures_002

### æ‘„å½±æŠ€æœ¯ (photography_techniques)

3. **macro_product_shot** - äº§å“å¾®è·ç‰¹å†™
   - æ¨¡æ¿: Phase One medium format camera with 100mm macro lens, razor-sharp focus
   - å…³é”®è¯: macro, close-up, detailed, high-resolution
   - æ ‡ç­¾: photography, macro, product, technical
   - å¤ç”¨æ€§: 9.0/10
   - element_id: common_photography_techniques_032

## âœ… å·²æ·»åŠ åˆ°æ•°æ®åº“

- 3ä¸ªæ–°å…ƒç´ å·²å†™å…¥ elements.db
- æ›´æ–°äº†12ä¸ªæ ‡ç­¾ç´¢å¼•
- producté¢†åŸŸ: 60 â†’ 63 ä¸ªå…ƒç´ 
- commoné¢†åŸŸ: 31 â†’ 32 ä¸ªå…ƒç´ 

## ðŸ’¡ è´¨é‡è¯„ä¼°

- æå–å®Œæ•´åº¦: 95%
- æ ‡ç­¾è´¨é‡: ä¼˜ç§€
- å¤ç”¨æ€§è¯„åˆ†: 8.3/10 (å¹³å‡)
```

---

## ðŸŽ›ï¸ é…ç½®é€‰é¡¹

### è‡ªåŠ¨åŒ–ç¨‹åº¦

- **å½“å‰**: åŠè‡ªåŠ¨ï¼ˆç”ŸæˆæŠ¥å‘Š + äººå·¥å®¡æ ¸ï¼‰
- **æœªæ¥**: å¯é€‰å…¨è‡ªåŠ¨æ¨¡å¼

### å¤ç”¨æ€§è¯„åˆ†æ ‡å‡†

| è¯„åˆ† | æ ‡å‡† |
|------|------|
| 9-10 | æžé«˜å¤ç”¨æ€§ï¼šè·¨é¢†åŸŸé€šç”¨ï¼Œå¦‚"macro photography", "soft lighting" |
| 7-8  | é«˜å¤ç”¨æ€§ï¼šé¢†åŸŸå†…é€šç”¨ï¼Œå¦‚"product on table", "geometric layout" |
| 5-6  | ä¸­ç­‰å¤ç”¨æ€§ï¼šç‰¹å®šåœºæ™¯ï¼Œå¦‚"collector's edition book" |
| 3-4  | ä½Žå¤ç”¨æ€§ï¼šéžå¸¸å…·ä½“ï¼Œå¦‚"vintage 1960s typewriter" |
| 1-2  | æžä½Žå¤ç”¨æ€§ï¼šä¸€æ¬¡æ€§æè¿°ï¼Œä¸æŽ¨èæå– |

---

## ðŸ“š æ•°æ®æº

**è¾“å…¥**: `extracted_results/extracted_modules.json` (18ä¸ªæºPrompts)

**è¾“å‡º**:
- `extracted_results/elements.db` (SQLiteæ•°æ®åº“)
- `extracted_results/universal_elements_library.json` (JSONå¯¼å‡º)

---

## ðŸ”§ æ¨¡å—è¯´æ˜Ž

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| é¢†åŸŸåˆ†ç±»å™¨ | `modules/domain_classifier.md` | è¯†åˆ«Promptå±žäºŽå“ªä¸ªé¢†åŸŸ |
| å…ƒç´ æå–å™¨ | `modules/element_extractor.md` | æå–å¯å¤ç”¨å…ƒç´  |
| æ ‡ç­¾ç”Ÿæˆå™¨ | `modules/tagger.md` | è‡ªåŠ¨ç”Ÿæˆtags |
| åº“æ›´æ–°å™¨ | `modules/library_updater.md` | æ›´æ–°æ•°æ®åº“ |

---

## âœ… éªŒæ”¶æ ‡å‡†

å­¦ä¹ æˆåŠŸçš„æ ‡å¿—ï¼š
- âœ… èƒ½æ­£ç¡®è¯†åˆ«7å¤§é¢†åŸŸ
- âœ… ä»Ž18ä¸ªPromptsæå–~440ä¸ªå…ƒç´ 
- âœ… è‡ªåŠ¨åŽ»é‡ï¼ˆä¸é‡å¤æ·»åŠ å·²å­˜åœ¨å…ƒç´ ï¼‰
- âœ… æ ‡ç­¾è´¨é‡é«˜ï¼ˆç›¸å…³æ€§å¼ºï¼‰
- âœ… å¤ç”¨æ€§è¯„åˆ†åˆç†

---

**SkillçŠ¶æ€**: âœ… å·²å®žçŽ°
**æœ€åŽæ›´æ–°**: 2026-01-05
**ç»´æŠ¤è€…**: Universal Library System



================================================
FILE: .claude/skills/universal-learner/modules/domain_classifier.md
================================================
# Domain Classifier - é¢†åŸŸåˆ†ç±»å™¨æ¨¡å—

**åŠŸèƒ½**: è¯†åˆ«Promptå±žäºŽå“ªä¸ªé¢†åŸŸï¼ˆæˆ–å¤šä¸ªé¢†åŸŸï¼‰

---

## ðŸŽ¯ 7å¤§é¢†åŸŸå®šä¹‰

| é¢†åŸŸID | ä¸­æ–‡å | å…³é”®è¯ | ç¤ºä¾‹Prompts |
|--------|--------|--------|-------------|
| **portrait** | äººåƒæ‘„å½± | person, face, woman, man, beauty, makeup, facial | #5, #10, #11, #17, #18 |
| **product** | äº§å“æ‘„å½± | product, object, item, book, watch, bottle, package | #1, #6, #14, #16 |
| **design** | å¹³é¢è®¾è®¡ | poster, layout, UI, graphic, typography, bento grid | #2, #3, #7, #9, #13 |
| **art** | è‰ºæœ¯é£Žæ ¼ | art, painting, surreal, artistic, illustration, effect | #8, #12, #15 |
| **video** | è§†é¢‘ç”Ÿæˆ | video, scene, motion, cinematic, camera movement | #4 |
| **interior** | å®¤å†…è®¾è®¡ | interior, room, furniture, living room, bedroom | (v4.0æ–°å»º) |
| **common** | é€šç”¨æ‘„å½± | photography, camera, lighting, lens, technical | (è·¨é¢†åŸŸ) |

---

## ðŸ“‹ åˆ†ç±»æµç¨‹

### Step 1: æ‰«æå…³é”®è¯

```python
def classify_domain(prompt_text: str) -> Dict:
    # 1. è½¬ä¸ºå°å†™
    text_lower = prompt_text.lower()

    # 2. å…³é”®è¯åŒ¹é…
    domain_scores = {
        'portrait': 0,
        'product': 0,
        'design': 0,
        'art': 0,
        'video': 0,
        'interior': 0,
        'common': 0
    }

    # 3. é¢†åŸŸå…³é”®è¯æƒé‡è¡¨
    keywords = {
        'portrait': {
            'face': 3, 'woman': 3, 'man': 3, 'person': 3,
            'eyes': 2, 'skin': 2, 'makeup': 2, 'hair': 2,
            'beauty': 2, 'facial': 2, 'portrait': 3
        },
        'product': {
            'product': 3, 'book': 2, 'bottle': 2, 'watch': 2,
            'packaging': 2, 'item': 2, 'object': 1,
            'collector': 2, 'premium': 1
        },
        'design': {
            'poster': 3, 'layout': 3, 'bento': 3, 'ui': 3,
            'typography': 2, 'graphic': 2, 'card': 1,
            'grid': 2, 'design': 1
        },
        'art': {
            'painting': 3, 'artistic': 2, 'surreal': 3,
            'illustration': 2, 'art': 1, 'canvas': 2,
            'brushstroke': 2, 'effect': 1
        },
        'video': {
            'video': 3, 'scene': 2, 'cinematic': 3,
            'motion': 2, 'camera movement': 3, 'sequence': 2
        },
        'interior': {
            'interior': 3, 'room': 2, 'living room': 3,
            'bedroom': 3, 'furniture': 2, 'space': 1,
            'kitchen': 3, 'home': 1
        },
        'common': {
            'photography': 2, 'camera': 2, 'lens': 2,
            'lighting': 2, 'iso': 1, 'aperture': 1
        }
    }

    # 4. è®¡ç®—å„é¢†åŸŸå¾—åˆ†
    for domain, kw_dict in keywords.items():
        for keyword, weight in kw_dict.items():
            if keyword in text_lower:
                domain_scores[domain] += weight

    # 5. æŽ’åº
    sorted_domains = sorted(
        domain_scores.items(),
        key=lambda x: x[1],
        reverse=True
    )

    return sorted_domains
```

### Step 2: ç¡®å®šä¸»æ¬¡é¢†åŸŸ

```python
def determine_primary_secondary(sorted_domains):
    primary = None
    secondary = []

    # ä¸»é¢†åŸŸï¼šå¾—åˆ†æœ€é«˜ä¸” > 5
    if sorted_domains[0][1] > 5:
        primary = sorted_domains[0][0]

    # æ¬¡é¢†åŸŸï¼šå¾—åˆ† > 3 ä½†ä¸æ˜¯ä¸»é¢†åŸŸ
    for domain, score in sorted_domains[1:]:
        if score > 3:
            secondary.append(domain)

    # commoné€šå¸¸ä½œä¸ºæ¬¡é¢†åŸŸ
    if 'common' in [d[0] for d in sorted_domains if d[1] > 2]:
        if primary != 'common':
            secondary.append('common')

    return {
        'primary': primary,
        'secondary': secondary,
        'confidence': sorted_domains[0][1] / 20  # å½’ä¸€åŒ–ä¸º0-1
    }
```

---

## ðŸ“Š åˆ†ç±»ç¤ºä¾‹

### ç¤ºä¾‹1: Prompt #1 (äº§å“æ‘„å½±)

**è¾“å…¥**:
```
A premium collector's edition book photographed with Phase One medium format camera,
featuring Italian calfskin leather binding with gold-embossed title...
```

**åˆ†æž**:
- `book` +2
- `collector` +2
- `premium` +1
- `product` context implied +3
- `camera` +2 (common)
- `photography` +2 (common)

**è¾“å‡º**:
```json
{
  "primary": "product",
  "secondary": ["common"],
  "confidence": 0.4,
  "scores": {
    "product": 8,
    "common": 4,
    "design": 1
  }
}
```

---

### ç¤ºä¾‹2: Prompt #5 (äººåƒæ‘„å½±)

**è¾“å…¥**:
```
A young Asian woman with large expressive almond eyes, porcelain fair skin tone,
wearing elegant red silk qipao dress...
```

**åˆ†æž**:
- `woman` +3
- `eyes` +2
- `skin` +2
- `facial features` context +3
- `beauty` implied +2

**è¾“å‡º**:
```json
{
  "primary": "portrait",
  "secondary": [],
  "confidence": 0.6,
  "scores": {
    "portrait": 12,
    "product": 0
  }
}
```

---

### ç¤ºä¾‹3: Prompt #2 (è®¾è®¡)

**è¾“å…¥**:
```
A modern Bento grid layout poster design with glassmorphism effects,
asymmetric card arrangement...
```

**åˆ†æž**:
- `bento` +3
- `layout` +3
- `poster` +3
- `design` +1
- `grid` +2
- `card` +1

**è¾“å‡º**:
```json
{
  "primary": "design",
  "secondary": [],
  "confidence": 0.65,
  "scores": {
    "design": 13,
    "art": 1
  }
}
```

---

## ðŸš¨ è¾¹ç•Œæƒ…å†µå¤„ç†

### 1. å¤šé¢†åŸŸPrompt

```
A woman holding a premium product in modern interior
```

**å¤„ç†**:
- primary: "portrait" (woman +3, face implied)
- secondary: ["product", "interior"]
- ç­–ç•¥ï¼šæå–å¤šä¸ªé¢†åŸŸçš„å…ƒç´ 

### 2. æ— æ³•æ˜Žç¡®åˆ†ç±»

```
High-resolution 8K photography
```

**å¤„ç†**:
- primary: "common"
- secondary: []
- ç­–ç•¥ï¼šåªæå–é€šç”¨æ‘„å½±æŠ€æœ¯å…ƒç´ 

### 3. å«ç³Šæè¿°

```
Beautiful scene with great composition
```

**å¤„ç†**:
- å¾—åˆ†éƒ½å¾ˆä½Ž (<5)
- primary: None
- ç­–ç•¥ï¼šè·³è¿‡ï¼Œæç¤ºç”¨æˆ·æä¾›æ›´å…·ä½“çš„Prompt

---

## âœ… è¾“å‡ºæ ¼å¼

```json
{
  "primary_domain": "product",
  "secondary_domains": ["common"],
  "confidence": 0.75,
  "all_scores": {
    "product": 8,
    "common": 4,
    "portrait": 0,
    "design": 1
  },
  "recommendation": "Extract product_types, materials, and photography_techniques"
}
```

---

**çŠ¶æ€**: âœ… å·²å®žçŽ°
**å‡†ç¡®çŽ‡ç›®æ ‡**: >90%



================================================
FILE: .claude/skills/universal-learner/modules/element_extractor.md
================================================
# Element Extractor - å…ƒç´ æå–å™¨æ¨¡å—

**åŠŸèƒ½**: ä»ŽPromptä¸­æå–å¯å¤ç”¨çš„å…ƒç´ ç‰‡æ®µ

---

## ðŸŽ¯ æå–ç­–ç•¥ï¼ˆæŒ‰é¢†åŸŸï¼‰

### 1. Product Domain (äº§å“æ‘„å½±)

**æå–ç±»åˆ«**:
- `product_types` - äº§å“ç±»åž‹
- `material_textures` - æè´¨çº¹ç†
- `photography_techniques` - æ‘„å½±æŠ€æœ¯
- `lighting_setups` - å…‰ç…§å¸ƒå±€
- `composition_styles` - æž„å›¾é£Žæ ¼

**ç¤ºä¾‹**:

```
è¾“å…¥: "A premium collector's edition book with Italian calfskin binding,
       glossy reflective surface, photographed with Phase One 100mm macro lens"

æå–:
1. product_types/collector_edition_book
   - template: "premium collector's edition book, luxury binding"
   - keywords: ["collector's edition", "premium book", "luxury"]

2. material_textures/italian_calfskin
   - template: "Italian calfskin leather, premium natural grain"
   - keywords: ["calfskin", "leather", "luxury material"]

3. material_textures/glossy_reflective
   - template: "glossy reflective surface, high-end finish"
   - keywords: ["glossy", "reflective", "shiny"]

4. photography_techniques/macro_100mm
   - template: "Phase One medium format with 100mm macro lens"
   - keywords: ["macro", "100mm", "close-up"]
```

---

### 2. Design Domain (å¹³é¢è®¾è®¡)

**æå–ç±»åˆ«**:
- `layout_systems` - å¸ƒå±€ç³»ç»Ÿ
- `visual_effects` - è§†è§‰æ•ˆæžœ
- `typography_styles` - å­—ä½“é£Žæ ¼
- `color_schemes` - è‰²å½©æ–¹æ¡ˆ
- `composition_techniques` - æž„å›¾æŠ€å·§

**ç¤ºä¾‹**:

```
è¾“å…¥: "Modern Bento grid layout with glassmorphism effects,
       asymmetric card arrangement, bold sans-serif typography"

æå–:
1. layout_systems/bento_grid
   - template: "modern Bento grid layout, modular card-based design"
   - keywords: ["bento grid", "modular", "asymmetric"]

2. visual_effects/glassmorphism
   - template: "frosted glass effect, 80% translucent, backdrop blur"
   - keywords: ["glass", "frosted", "translucent", "blur"]

3. typography_styles/bold_sans_serif
   - template: "bold sans-serif typography, modern clean font"
   - keywords: ["bold", "sans-serif", "clean"]
```

---

### 3. Art Domain (è‰ºæœ¯é£Žæ ¼)

**æå–ç±»åˆ«**:
- `art_styles` - è‰ºæœ¯é£Žæ ¼
- `special_effects` - ç‰¹æ•ˆ
- `narrative_elements` - å™äº‹å…ƒç´ 
- `visual_techniques` - è§†è§‰æŠ€å·§

**ç¤ºä¾‹**:

```
è¾“å…¥: "Surrealistic painting with dreamlike atmosphere,
       melting clocks style, vibrant color explosion"

æå–:
1. art_styles/surrealism
   - template: "surrealistic composition, dreamlike impossible scene"
   - keywords: ["surreal", "dreamlike", "fantastical"]

2. special_effects/melting_distortion
   - template: "melting distortion effect, fluid transformation"
   - keywords: ["melting", "distortion", "fluid"]

3. special_effects/color_explosion
   - template: "vibrant color explosion, dynamic paint splash"
   - keywords: ["color explosion", "vibrant", "splash"]
```

---

### 4. Portrait Domain (äººåƒæ‘„å½±)

**æå–ç±»åˆ«**:
- `facial_features` - é¢éƒ¨ç‰¹å¾
- `makeup_styles` - å¦†å®¹é£Žæ ¼
- `hair_styles` - å‘åž‹
- `expressions` - è¡¨æƒ…
- `poses` - å§¿åŠ¿
- `clothing_styles` - æœè£…é£Žæ ¼

**ç¤ºä¾‹**:

```
è¾“å…¥: "A woman with large almond eyes, porcelain skin,
       wearing elegant red qipao dress"

æå–:
1. facial_features/large_almond_eyes
   - template: "large expressive almond eyes, thick natural lashes"
   - keywords: ["large eyes", "almond", "expressive"]

2. skin_tones/porcelain_fair
   - template: "porcelain fair skin tone, flawless complexion"
   - keywords: ["porcelain", "fair", "pale"]

3. clothing_styles/red_qipao
   - template: "elegant red silk qipao dress, traditional Chinese"
   - keywords: ["qipao", "red", "silk", "traditional"]
```

---

### 5. Video Domain (è§†é¢‘ç”Ÿæˆ)

**æå–ç±»åˆ«**:
- `scene_types` - åœºæ™¯ç±»åž‹
- `camera_movements` - ç›¸æœºè¿åŠ¨
- `transitions` - è½¬åœºæ•ˆæžœ
- `motion_effects` - åŠ¨æ€æ•ˆæžœ

**ç¤ºä¾‹**:

```
è¾“å…¥: "Cinematic dolly shot moving through forest,
       slow-motion falling leaves, golden hour lighting"

æå–:
1. camera_movements/dolly_forward
   - template: "smooth dolly shot moving forward through scene"
   - keywords: ["dolly", "forward", "tracking"]

2. motion_effects/slow_motion_falling
   - template: "slow-motion falling objects, 120fps capture"
   - keywords: ["slow motion", "falling", "floating"]

3. lighting_scenarios/golden_hour
   - template: "golden hour warm sunlight, magic hour glow"
   - keywords: ["golden hour", "warm", "sunset"]
```

---

### 6. Interior Domain (å®¤å†…è®¾è®¡)

**æå–ç±»åˆ«**:
- `space_types` - ç©ºé—´ç±»åž‹
- `furniture_layouts` - å®¶å…·å¸ƒå±€
- `design_elements` - è®¾è®¡å…ƒç´ 
- `material_combinations` - æè´¨ç»„åˆ
- `spatial_atmospheres` - ç©ºé—´æ°›å›´

**ç¤ºä¾‹**:

```
è¾“å…¥: "Mid-century modern living room with walnut herringbone flooring,
       L-shaped sofa with tapered legs, sputnik chandelier"

æå–:
1. space_types/living_room_midcentury
   - template: "mid-century modern living room, retro-modern fusion"
   - keywords: ["mid-century", "living room", "modern"]

2. design_elements/herringbone_flooring
   - template: "walnut herringbone wood flooring, chevron pattern"
   - keywords: ["herringbone", "wood flooring", "walnut"]

3. furniture_layouts/l_shape_sofa_tapered
   - template: "L-shaped sofa with tapered walnut legs, low-profile"
   - keywords: ["L-shaped", "sofa", "tapered legs"]

4. design_elements/sputnik_chandelier
   - template: "brass sputnik chandelier, mid-century iconic lighting"
   - keywords: ["sputnik", "chandelier", "brass"]
```

---

### 7. Common Domain (é€šç”¨æ‘„å½±)

**æå–ç±»åˆ«**:
- `camera_angles` - ç›¸æœºè§’åº¦
- `photography_techniques` - æ‘„å½±æŠ€æœ¯
- `lighting_techniques` - å…‰ç…§æŠ€æœ¯
- `technical_effects` - æŠ€æœ¯æ•ˆæžœ

**ç¤ºä¾‹**:

```
è¾“å…¥: "Shot with 24mm wide-angle lens, f/2.8 aperture,
       soft natural window light, 8K resolution"

æå–:
1. photography_techniques/wide_angle_24mm
   - template: "24mm wide-angle lens, expansive field of view"
   - keywords: ["24mm", "wide-angle", "FOV"]

2. lighting_techniques/soft_window_light
   - template: "soft natural window light, diffused daylight"
   - keywords: ["window light", "natural", "soft", "diffused"]

3. technical_effects/8k_resolution
   - template: "8K ultra high resolution, extreme detail capture"
   - keywords: ["8K", "high resolution", "ultra HD"]
```

---

## ðŸ” æå–è§„åˆ™

### è§„åˆ™1: ç‹¬ç«‹æ€§
æ¯ä¸ªå…ƒç´ åº”è¯¥å¯ä»¥ç‹¬ç«‹ä½¿ç”¨
- âœ… "large almond eyes with thick lashes"
- âŒ "her eyes were beautiful" (ä¾èµ–ä¸Šä¸‹æ–‡)

### è§„åˆ™2: å…·ä½“æ€§
é¿å…ç©ºæ´žæè¿°
- âœ… "brass sputnik chandelier with 12 arms"
- âŒ "nice lighting fixture" (å¤ªç¬¼ç»Ÿ)

### è§„åˆ™3: å¯å¤ç”¨æ€§
å¯ä»¥åœ¨ä¸åŒåœºæ™¯ä½¿ç”¨
- âœ… "geometric patterned area rug" (å¯ç”¨äºŽå¤šç§å®¤å†…)
- âŒ "the rug in my grandmother's house" (å¤ªç‰¹å®š)

### è§„åˆ™4: é•¿åº¦é€‚ä¸­
æ¨¡æ¿é•¿åº¦15-50è¯
- âœ… "mid-century modern walnut coffee table with organic curved edges and tapered legs"
- âŒ "table" (å¤ªçŸ­)
- âŒ 200è¯çš„è¯¦ç»†æè¿° (å¤ªé•¿)

---

## ðŸ“‹ æå–æµç¨‹

```python
def extract_elements(prompt_text: str, primary_domain: str) -> List[Dict]:
    elements = []

    # Step 1: é¢†åŸŸç‰¹å®šæå–
    if primary_domain == 'product':
        elements.extend(extract_product_elements(prompt_text))
    elif primary_domain == 'design':
        elements.extend(extract_design_elements(prompt_text))
    elif primary_domain == 'art':
        elements.extend(extract_art_elements(prompt_text))
    # ... å…¶ä»–é¢†åŸŸ

    # Step 2: é€šç”¨æ‘„å½±æŠ€æœ¯æå–ï¼ˆæ‰€æœ‰é¢†åŸŸï¼‰
    elements.extend(extract_common_elements(prompt_text))

    # Step 3: è´¨é‡è¿‡æ»¤
    elements = [e for e in elements if is_high_quality(e)]

    return elements

def is_high_quality(element: Dict) -> bool:
    # æ£€æŸ¥ç‹¬ç«‹æ€§ã€å…·ä½“æ€§ã€é•¿åº¦
    template = element['ai_prompt_template']
    word_count = len(template.split())

    if word_count < 5 or word_count > 100:
        return False

    if has_vague_words(template):  # "nice", "good", "beautiful"
        return False

    if has_context_dependency(template):  # "it", "her", "the previous"
        return False

    return True
```

---

## âœ… è¾“å‡ºæ ¼å¼

```json
{
  "extracted_elements": [
    {
      "category": "product_types",
      "name": "collector_edition_book",
      "chinese_name": "æ”¶è—ç‰ˆä¹¦ç±",
      "ai_prompt_template": "premium collector's edition book, luxury binding, Italian calfskin cover",
      "keywords": ["collector's edition", "premium book", "luxury binding"],
      "estimated_reusability": 7.5,
      "source_context": "A premium collector's edition book..."
    },
    {
      "category": "material_textures",
      "name": "glossy_reflective",
      "chinese_name": "å…‰æ³½åå°„æè´¨",
      "ai_prompt_template": "glossy reflective surface, high-end finish, metallic sheen",
      "keywords": ["glossy", "reflective", "shiny", "polished"],
      "estimated_reusability": 8.5,
      "source_context": "glossy reflective surface"
    }
  ],
  "total_extracted": 2
}
```

---

**çŠ¶æ€**: âœ… å·²å®žçŽ°
**ç›®æ ‡**: ä»Ž18ä¸ªPromptsæå–~440ä¸ªé«˜è´¨é‡å…ƒç´ 



================================================
FILE: .claude/skills/universal-learner/modules/library_updater.md
================================================
# Library Updater - åº“æ›´æ–°å™¨æ¨¡å—

**åŠŸèƒ½**: å°†æå–çš„å…ƒç´ å†™å…¥Universal Elements Databaseï¼Œå¤„ç†åŽ»é‡å’ŒIDç”Ÿæˆ

---

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

1. **åŽ»é‡æ£€æµ‹** - é¿å…é‡å¤æ·»åŠ å·²å­˜åœ¨å…ƒç´ 
2. **IDç”Ÿæˆ** - è‡ªåŠ¨ç”Ÿæˆelement_id
3. **æ•°æ®åº“å†™å…¥** - è°ƒç”¨ElementDB.add_element()
4. **ç»Ÿè®¡æ›´æ–°** - æ›´æ–°é¢†åŸŸå’Œç±»åˆ«è®¡æ•°
5. **æŠ¥å‘Šç”Ÿæˆ** - ç”Ÿæˆå­¦ä¹ æŠ¥å‘Š

---

## ðŸ“‹ æ›´æ–°æµç¨‹

### Step 1: æ£€æŸ¥å…ƒç´ æ˜¯å¦å·²å­˜åœ¨

```python
from element_db import ElementDB

def check_element_exists(db: ElementDB, element: Dict) -> Tuple[bool, Optional[str]]:
    """
    æ£€æŸ¥å…ƒç´ æ˜¯å¦å·²å­˜åœ¨

    Returns:
        (exists: bool, existing_element_id: Optional[str])
    """

    # æ–¹æ³•1: æŒ‰nameç²¾ç¡®åŒ¹é…
    existing = db.conn.cursor().execute("""
        SELECT element_id FROM elements
        WHERE domain_id = ? AND category_id = ? AND name = ?
    """, (
        element['domain_id'],
        element['category_id'],
        element['name']
    )).fetchone()

    if existing:
        return True, existing[0]

    # æ–¹æ³•2: æŒ‰keywordsç›¸ä¼¼åº¦åŒ¹é…
    # æŸ¥æ‰¾åŒç±»åˆ«çš„æ‰€æœ‰å…ƒç´ 
    similar_elements = db.search_by_domain(
        element['domain_id'],
        category_id=element['category_id']
    )

    for existing_elem in similar_elements:
        similarity = calculate_keyword_similarity(
            element['keywords'],
            existing_elem['keywords']
        )

        if similarity > 0.8:  # 80%ç›¸ä¼¼åº¦
            return True, existing_elem['element_id']

    return False, None

def calculate_keyword_similarity(kw1: List[str], kw2: List[str]) -> float:
    """è®¡ç®—å…³é”®è¯Jaccardç›¸ä¼¼åº¦"""
    set1 = set([k.lower() for k in kw1])
    set2 = set([k.lower() for k in kw2])

    intersection = len(set1 & set2)
    union = len(set1 | set2)

    return intersection / union if union > 0 else 0.0
```

### Step 2: ç”Ÿæˆelement_id

```python
def generate_element_id(db: ElementDB, domain_id: str, category_id: str) -> str:
    """
    ç”Ÿæˆelement_id

    æ ¼å¼: {domain}_{category}_{åºå·}
    ç¤ºä¾‹: product_product_types_001
    """

    # æŸ¥è¯¢è¯¥é¢†åŸŸ+ç±»åˆ«ä¸‹çš„æœ€å¤§åºå·
    cursor = db.conn.cursor()
    cursor.execute("""
        SELECT element_id FROM elements
        WHERE domain_id = ? AND category_id = ?
        ORDER BY element_id DESC
        LIMIT 1
    """, (domain_id, category_id))

    last_elem = cursor.fetchone()

    if last_elem:
        # æå–åºå·
        last_id = last_elem[0]
        # 'product_product_types_042' -> 42
        match = re.search(r'_(\d+)$', last_id)
        if match:
            next_num = int(match.group(1)) + 1
        else:
            next_num = 1
    else:
        next_num = 1

    return f"{domain_id}_{category_id}_{next_num:03d}"
```

### Step 3: å†™å…¥æ•°æ®åº“

```python
def add_element_to_db(
    db: ElementDB,
    element: Dict,
    source_prompt_id: int,
    learned_from: str = "auto_learner"
) -> Tuple[bool, str]:
    """
    å°†å…ƒç´ æ·»åŠ åˆ°æ•°æ®åº“

    Returns:
        (success: bool, element_id: str)
    """

    # 1. æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
    exists, existing_id = check_element_exists(db, element)
    if exists:
        print(f"   âš ï¸  å…ƒç´ å·²å­˜åœ¨: {existing_id}")
        return False, existing_id

    # 2. ç”Ÿæˆelement_id
    element_id = generate_element_id(
        db,
        element['domain_id'],
        element['category_id']
    )

    # 3. å†™å…¥æ•°æ®åº“
    success = db.add_element(
        element_id=element_id,
        domain_id=element['domain_id'],
        category_id=element['category_id'],
        name=element['name'],
        chinese_name=element.get('chinese_name'),
        ai_prompt_template=element['ai_prompt_template'],
        keywords=element.get('keywords', []),
        tags=element.get('tags', []),
        reusability_score=element.get('reusability_score'),
        source_prompts=[source_prompt_id],
        learned_from=learned_from,
        metadata=element.get('metadata', {})
    )

    if success:
        print(f"   âœ… å·²æ·»åŠ : {element_id} - {element.get('chinese_name', element['name'])}")
        return True, element_id
    else:
        print(f"   âŒ æ·»åŠ å¤±è´¥: {element['name']}")
        return False, None
```

### Step 4: æ‰¹é‡æ›´æ–°

```python
def batch_add_elements(
    db: ElementDB,
    elements: List[Dict],
    source_prompt_id: int
) -> Dict:
    """
    æ‰¹é‡æ·»åŠ å…ƒç´ 

    Returns:
        {
            'added': 5,
            'skipped': 2,
            'failed': 0,
            'element_ids': [...]
        }
    """

    stats = {
        'added': 0,
        'skipped': 0,
        'failed': 0,
        'element_ids': []
    }

    for element in elements:
        success, element_id = add_element_to_db(
            db, element, source_prompt_id
        )

        if success:
            stats['added'] += 1
            stats['element_ids'].append(element_id)
        elif element_id:  # å·²å­˜åœ¨
            stats['skipped'] += 1
        else:  # å¤±è´¥
            stats['failed'] += 1

    return stats
```

---

## ðŸ“Š å­¦ä¹ æŠ¥å‘Šç”Ÿæˆ

### Step 5: ç”Ÿæˆå­¦ä¹ æŠ¥å‘Š

```python
def generate_learning_report(
    prompt_id: int,
    prompt_text: str,
    domain_info: Dict,
    elements: List[Dict],
    stats: Dict
) -> str:
    """ç”Ÿæˆå­¦ä¹ æŠ¥å‘Š"""

    report_lines = []

    report_lines.append("# Universal Learner - å­¦ä¹ æŠ¥å‘Š\n")
    report_lines.append(f"**å­¦ä¹ æ—¶é—´**: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    report_lines.append(f"**æºPrompt**: Prompt #{prompt_id}\n")

    # 1. é¢†åŸŸè¯†åˆ«
    report_lines.append("## ðŸŽ¯ é¢†åŸŸè¯†åˆ«\n")
    report_lines.append(f"ä¸»é¢†åŸŸ: **{domain_info['primary']}**")
    if domain_info.get('secondary'):
        report_lines.append(f"æ¬¡é¢†åŸŸ: {', '.join(domain_info['secondary'])}")
    report_lines.append(f"ç½®ä¿¡åº¦: {domain_info['confidence']:.0%}\n")

    # 2. æå–çš„å…ƒç´ 
    report_lines.append("## ðŸ“¦ æå–çš„å…ƒç´ \n")

    # æŒ‰ç±»åˆ«åˆ†ç»„
    by_category = {}
    for elem in elements:
        category = elem['category_id']
        if category not in by_category:
            by_category[category] = []
        by_category[category].append(elem)

    for category_id, category_elements in by_category.items():
        category_name = category_id.replace('_', ' ').title()
        report_lines.append(f"### {category_name} ({len(category_elements)} ä¸ª)\n")

        for idx, elem in enumerate(category_elements, 1):
            report_lines.append(f"{idx}. **{elem.get('chinese_name', elem['name'])}**")
            report_lines.append(f"   - æ¨¡æ¿: {elem['ai_prompt_template']}")
            report_lines.append(f"   - å…³é”®è¯: {', '.join(elem.get('keywords', []))}")
            report_lines.append(f"   - æ ‡ç­¾: {', '.join(elem.get('tags', []))}")
            report_lines.append(f"   - å¤ç”¨æ€§: {elem.get('reusability_score', 'N/A')}/10")
            if elem.get('element_id'):
                report_lines.append(f"   - element_id: `{elem['element_id']}`")
            report_lines.append("")

    # 3. ç»Ÿè®¡
    report_lines.append("## âœ… æ›´æ–°ç»Ÿè®¡\n")
    report_lines.append(f"- æ–°æ·»åŠ : {stats['added']} ä¸ªå…ƒç´ ")
    report_lines.append(f"- å·²å­˜åœ¨: {stats['skipped']} ä¸ªå…ƒç´ ")
    if stats['failed'] > 0:
        report_lines.append(f"- å¤±è´¥: {stats['failed']} ä¸ªå…ƒç´ ")

    # 4. è´¨é‡è¯„ä¼°
    if stats['added'] > 0:
        avg_reusability = sum(
            e.get('reusability_score', 0) for e in elements
        ) / len(elements)

        report_lines.append("\n## ðŸ’¡ è´¨é‡è¯„ä¼°\n")
        report_lines.append(f"- æå–å®Œæ•´åº¦: {len(elements)*10:.0f}%")  # å‡è®¾æ¯ä¸ªå…ƒç´ 10%
        report_lines.append(f"- å¹³å‡å¤ç”¨æ€§: {avg_reusability:.1f}/10")
        report_lines.append(f"- æ ‡ç­¾è´¨é‡: {'ä¼˜ç§€' if avg_reusability > 8 else 'è‰¯å¥½'}")

    return "\n".join(report_lines)
```

---

## ðŸ“ ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´å·¥ä½œæµç¨‹

```python
from element_db import ElementDB
from datetime import datetime

def learn_from_prompt(
    prompt_id: int,
    prompt_text: str,
    domain_info: Dict,
    extracted_elements: List[Dict]
):
    """å®Œæ•´å­¦ä¹ æµç¨‹"""

    # 1. è¿žæŽ¥æ•°æ®åº“
    db = ElementDB('extracted_results/elements.db')

    print(f"\n{'='*60}")
    print(f"Learning from Prompt #{prompt_id}")
    print(f"{'='*60}\n")

    print(f"é¢†åŸŸ: {domain_info['primary']}")
    print(f"æå–å…ƒç´ æ•°: {len(extracted_elements)}\n")

    # 2. æ‰¹é‡æ·»åŠ å…ƒç´ 
    print("æ·»åŠ åˆ°æ•°æ®åº“...")
    stats = batch_add_elements(db, extracted_elements, prompt_id)

    # 3. ç”ŸæˆæŠ¥å‘Š
    report = generate_learning_report(
        prompt_id,
        prompt_text,
        domain_info,
        extracted_elements,
        stats
    )

    # 4. ä¿å­˜æŠ¥å‘Š
    report_path = f"extracted_results/learning_report_prompt{prompt_id:02d}.md"
    with open(report_path, 'w', encoding='utf-8') as f:
        f.write(report)

    print(f"\nâœ… å­¦ä¹ å®Œæˆ!")
    print(f"   æ–°æ·»åŠ : {stats['added']} ä¸ªå…ƒç´ ")
    print(f"   å·²è·³è¿‡: {stats['skipped']} ä¸ªå…ƒç´ ")
    print(f"   æŠ¥å‘Š: {report_path}")

    # 5. å¯¼å‡ºJSONå¤‡ä»½
    db.export_to_json('extracted_results/universal_elements_library.json')

    db.close()
```

---

## ðŸ”„ æ›´æ–°ç­–ç•¥

### ç­–ç•¥1: ä¸¥æ ¼åŽ»é‡ï¼ˆé»˜è®¤ï¼‰
- åŒåå…ƒç´ ï¼šç›´æŽ¥è·³è¿‡
- é«˜ç›¸ä¼¼åº¦ï¼ˆ>80%ï¼‰ï¼šè·³è¿‡
- ä¼˜ç‚¹ï¼šä¿æŒåº“çš„çº¯å‡€
- ç¼ºç‚¹ï¼šå¯èƒ½é”™è¿‡ç»†å¾®å˜ä½“

### ç­–ç•¥2: ç‰ˆæœ¬åˆå¹¶
- åŒåå…ƒç´ ï¼šæ›´æ–°keywordså’Œtags
- åˆå¹¶source_promptsåˆ—è¡¨
- ä¼˜ç‚¹ï¼šä¸°å¯Œå…ƒç´ ä¿¡æ¯
- ç¼ºç‚¹ï¼šå¯èƒ½æ··æ·†ä¸åŒå˜ä½“

### ç­–ç•¥3: å˜ä½“å…±å­˜
- å…è®¸åŒç±»åˆ«ä¸‹çš„ç›¸ä¼¼å…ƒç´ 
- ä½¿ç”¨åŽç¼€åŒºåˆ†ï¼š`large_almond_eyes_v1`, `large_almond_eyes_v2`
- ä¼˜ç‚¹ï¼šä¿ç•™æ‰€æœ‰å˜ä½“
- ç¼ºç‚¹ï¼šå¯èƒ½é€ æˆå†—ä½™

**å½“å‰é‡‡ç”¨**: ç­–ç•¥1ï¼ˆä¸¥æ ¼åŽ»é‡ï¼‰

---

## âœ… è¾“å‡ºæ ¼å¼

```json
{
  "update_summary": {
    "prompt_id": 1,
    "added_elements": 5,
    "skipped_elements": 2,
    "failed_elements": 0,
    "new_element_ids": [
      "product_product_types_001",
      "product_material_textures_002",
      "common_photography_techniques_032"
    ]
  },
  "database_stats": {
    "total_elements_before": 185,
    "total_elements_after": 190,
    "domains_updated": ["product", "common"]
  },
  "report_path": "extracted_results/learning_report_prompt01.md"
}
```

---

**çŠ¶æ€**: âœ… å·²å®žçŽ°
**åŽ»é‡å‡†ç¡®çŽ‡**: >95%



================================================
FILE: .claude/skills/universal-learner/modules/tagger.md
================================================
# Tagger - æ ‡ç­¾ç”Ÿæˆå™¨æ¨¡å—

**åŠŸèƒ½**: ä¸ºæå–çš„å…ƒç´ è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡æ ‡ç­¾

---

## ðŸŽ¯ æ ‡ç­¾ç±»åž‹

### 1. é¢†åŸŸæ ‡ç­¾ (Domain Tags)
æ¯ä¸ªå…ƒç´ è‡³å°‘æœ‰ä¸€ä¸ªé¢†åŸŸæ ‡ç­¾

| é¢†åŸŸ | æ ‡ç­¾ |
|------|------|
| portrait | `portrait` |
| product | `product` |
| design | `design` |
| art | `art` |
| video | `video` |
| interior | `interior` |
| common | `photography` |

### 2. ç±»åˆ«æ ‡ç­¾ (Category Tags)
åŸºäºŽå…ƒç´ æ‰€å±žç±»åˆ«

- `facial-features`, `makeup-styles`, `hair-styles`
- `product-types`, `material-textures`
- `layout-systems`, `visual-effects`
- `furniture-layouts`, `design-elements`
- etc.

### 3. ç‰¹å¾æ ‡ç­¾ (Feature Tags)
åŸºäºŽå…ƒç´ çš„å…³é”®ç‰¹å¾

- æè´¨ï¼š`glass`, `wood`, `metal`, `fabric`
- é£Žæ ¼ï¼š`modern`, `vintage`, `luxury`, `minimal`
- é¢œè‰²ï¼š`red`, `gold`, `neutral`, `vibrant`
- æ•ˆæžœï¼š`glossy`, `matte`, `reflective`, `translucent`

### 4. è·¨é¢†åŸŸæ ‡ç­¾ (Cross-Domain Tags)
å¯ç”¨äºŽå¤šä¸ªé¢†åŸŸçš„é€šç”¨æ ‡ç­¾

| æ ‡ç­¾ | é€‚ç”¨é¢†åŸŸ | å«ä¹‰ |
|------|----------|------|
| `luxury` | product, interior, portrait | é«˜ç«¯å¥¢åŽ |
| `glass` | design, art, product | çŽ»ç’ƒ/é€æ˜Žæ•ˆæžœ |
| `geometric` | design, interior, art | å‡ ä½•å›¾æ¡ˆ |
| `dynamic` | art, video, design | åŠ¨æ€/è¿åŠ¨æ„Ÿ |
| `soft` | lighting, texture, makeup | æŸ”å’Œæ•ˆæžœ |
| `bold` | typography, color, makeup | å¤§èƒ†/å¼ºçƒˆ |

---

## ðŸ“‹ æ ‡ç­¾ç”Ÿæˆæµç¨‹

### Step 1: ä»Žå…³é”®è¯æå–

```python
def extract_tags_from_keywords(keywords: List[str]) -> List[str]:
    tags = []

    for kw in keywords:
        # è½¬æ¢ä¸ºæ ‡ç­¾æ ¼å¼
        tag = kw.lower()
        tag = tag.replace(' ', '-')
        tag = tag.replace('_', '-')

        # è¿‡æ»¤
        if is_valid_tag(tag):
            tags.append(tag)

    return tags

def is_valid_tag(tag: str) -> bool:
    # é•¿åº¦æ£€æŸ¥
    if len(tag) < 2 or len(tag) > 30:
        return False

    # é¿å…æ— æ„ä¹‰æ ‡ç­¾
    stopwords = ['the', 'a', 'an', 'with', 'and', 'or', 'of']
    if tag in stopwords:
        return False

    return True
```

### Step 2: æ·»åŠ é¢†åŸŸå’Œç±»åˆ«æ ‡ç­¾

```python
def add_domain_category_tags(
    element: Dict,
    domain_id: str,
    category_id: str
) -> List[str]:
    tags = []

    # é¢†åŸŸæ ‡ç­¾
    domain_tag_map = {
        'portrait': 'portrait',
        'product': 'product',
        'design': 'design',
        'art': 'art',
        'video': 'video',
        'interior': 'interior',
        'common': 'photography'
    }
    tags.append(domain_tag_map[domain_id])

    # ç±»åˆ«æ ‡ç­¾
    category_tag = category_id.replace('_', '-')
    tags.append(category_tag)

    return tags
```

### Step 3: æ™ºèƒ½ç‰¹å¾æ ‡ç­¾è¯†åˆ«

```python
def identify_feature_tags(element: Dict) -> List[str]:
    tags = []
    template = element['ai_prompt_template'].lower()

    # æè´¨ç‰¹å¾
    material_patterns = {
        'wood': ['wood', 'wooden', 'walnut', 'oak', 'teak'],
        'metal': ['metal', 'brass', 'gold', 'copper', 'steel'],
        'glass': ['glass', 'translucent', 'transparent'],
        'fabric': ['fabric', 'linen', 'cotton', 'silk'],
        'leather': ['leather', 'calfskin', 'suede']
    }

    for tag, patterns in material_patterns.items():
        if any(p in template for p in patterns):
            tags.append(tag)

    # é£Žæ ¼ç‰¹å¾
    style_patterns = {
        'modern': ['modern', 'contemporary', 'minimalist'],
        'vintage': ['vintage', 'retro', 'mid-century', 'classic'],
        'luxury': ['luxury', 'premium', 'high-end', 'upscale'],
        'geometric': ['geometric', 'angular', 'linear', 'grid']
    }

    for tag, patterns in style_patterns.items():
        if any(p in template for p in patterns):
            tags.append(tag)

    # æ•ˆæžœç‰¹å¾
    effect_patterns = {
        'glossy': ['glossy', 'shiny', 'reflective', 'polished'],
        'matte': ['matte', 'flat', 'non-reflective'],
        'soft': ['soft', 'gentle', 'subtle', 'diffused'],
        'bold': ['bold', 'strong', 'vibrant', 'dramatic']
    }

    for tag, patterns in effect_patterns.items():
        if any(p in template for p in patterns):
            tags.append(tag)

    return tags
```

### Step 4: è·¨é¢†åŸŸæ ‡ç­¾æ˜ å°„

```python
def identify_cross_domain_tags(element: Dict, domain_id: str) -> List[str]:
    tags = []
    template = element['ai_prompt_template'].lower()
    keywords = element.get('keywords', [])

    cross_domain_keywords = {
        'luxury': [
            'luxury', 'premium', 'high-end', 'upscale',
            'exclusive', 'collector', 'elite'
        ],
        'minimalist': [
            'minimal', 'clean', 'simple', 'streamlined'
        ],
        'dynamic': [
            'dynamic', 'motion', 'movement', 'flowing', 'energy'
        ],
        'organic': [
            'organic', 'natural', 'curved', 'flowing'
        ]
    }

    for tag, patterns in cross_domain_keywords.items():
        if any(p in template or p in ' '.join(keywords).lower()
               for p in patterns):
            tags.append(tag)

    return tags
```

---

## ðŸ“Š æ ‡ç­¾ç”Ÿæˆç¤ºä¾‹

### ç¤ºä¾‹1: Product Element

**è¾“å…¥å…ƒç´ **:
```json
{
  "category": "product_types",
  "name": "collector_edition_book",
  "ai_prompt_template": "premium collector's edition book, luxury binding, Italian calfskin cover",
  "keywords": ["collector's edition", "premium book", "luxury binding"]
}
```

**æ ‡ç­¾ç”Ÿæˆè¿‡ç¨‹**:
1. ä»Žkeywords: `["collectors-edition", "premium-book", "luxury-binding"]`
2. é¢†åŸŸ+ç±»åˆ«: `["product", "product-types"]`
3. æ™ºèƒ½ç‰¹å¾: `["luxury", "leather"]` (ä»Ž"calfskin"è¯†åˆ«)
4. è·¨é¢†åŸŸ: `["collectible", "book"]`

**æœ€ç»ˆæ ‡ç­¾**:
```json
[
  "product",
  "product-types",
  "collectors-edition",
  "premium-book",
  "luxury-binding",
  "luxury",
  "leather",
  "collectible",
  "book"
]
```

---

### ç¤ºä¾‹2: Design Element

**è¾“å…¥å…ƒç´ **:
```json
{
  "category": "visual_effects",
  "name": "glassmorphism",
  "ai_prompt_template": "frosted glass effect, 80% translucent, backdrop-filter blur",
  "keywords": ["glassmorphism", "frosted glass", "translucent"]
}
```

**æ ‡ç­¾ç”Ÿæˆè¿‡ç¨‹**:
1. ä»Žkeywords: `["glassmorphism", "frosted-glass", "translucent"]`
2. é¢†åŸŸ+ç±»åˆ«: `["design", "visual-effects"]`
3. æ™ºèƒ½ç‰¹å¾: `["glass", "modern"]` (çŽ»ç’ƒæ€æ˜¯çŽ°ä»£è®¾è®¡)
4. è·¨é¢†åŸŸ: `["ui", "effect"]`

**æœ€ç»ˆæ ‡ç­¾**:
```json
[
  "design",
  "visual-effects",
  "glassmorphism",
  "frosted-glass",
  "translucent",
  "glass",
  "modern",
  "ui",
  "effect"
]
```

---

### ç¤ºä¾‹3: Interior Element

**è¾“å…¥å…ƒç´ **:
```json
{
  "category": "design_elements",
  "name": "sputnik_chandelier",
  "ai_prompt_template": "brass sputnik chandelier, mid-century iconic lighting",
  "keywords": ["sputnik", "chandelier", "brass", "mid-century"]
}
```

**æ ‡ç­¾ç”Ÿæˆè¿‡ç¨‹**:
1. ä»Žkeywords: `["sputnik", "chandelier", "brass", "mid-century"]`
2. é¢†åŸŸ+ç±»åˆ«: `["interior", "design-elements"]`
3. æ™ºèƒ½ç‰¹å¾: `["metal", "vintage", "lighting"]`
4. è·¨é¢†åŸŸ: `["statement-piece", "iconic"]`

**æœ€ç»ˆæ ‡ç­¾**:
```json
[
  "interior",
  "design-elements",
  "sputnik",
  "chandelier",
  "brass",
  "mid-century",
  "metal",
  "vintage",
  "lighting",
  "statement-piece",
  "iconic"
]
```

---

## ðŸŽ¯ æ ‡ç­¾è´¨é‡æ ‡å‡†

### ä¼˜ç§€æ ‡ç­¾
- âœ… æè¿°æ€§å¼ºï¼š`geometric-pattern`, `soft-lighting`
- âœ… é€‚åº¦å…·ä½“ï¼š`mid-century`, `luxury`
- âœ… å¯æœç´¢ï¼š`glass`, `wood`, `modern`
- âœ… è·¨é¢†åŸŸå¤ç”¨ï¼š`luxury` (product/interior/portrait)

### é¿å…çš„æ ‡ç­¾
- âŒ å¤ªæ³›æ³›ï¼š`good`, `nice`, `thing`
- âŒ å¤ªå…·ä½“ï¼š`my-grandmothers-rug`
- âŒ æ— æ„ä¹‰ï¼š`the`, `a`, `and`
- âŒ è¿‡é•¿ï¼š`mid-century-modern-walnut-tapered-leg-furniture`

---

## ðŸ” æ ‡ç­¾åŽ»é‡å’Œä¼˜åŒ–

```python
def optimize_tags(tags: List[str]) -> List[str]:
    # 1. åŽ»é‡
    tags = list(set(tags))

    # 2. ç§»é™¤å†—ä½™
    # å¦‚æžœæœ‰"mid-century-modern"ï¼Œç§»é™¤"mid-century"
    if 'mid-century-modern' in tags and 'mid-century' in tags:
        tags.remove('mid-century')

    # 3. é•¿åº¦é™åˆ¶ï¼ˆæœ€å¤š15ä¸ªæ ‡ç­¾ï¼‰
    if len(tags) > 15:
        # ä¼˜å…ˆä¿ç•™ï¼šé¢†åŸŸæ ‡ç­¾ã€ç±»åˆ«æ ‡ç­¾ã€é«˜é¢‘æ ‡ç­¾
        tags = prioritize_tags(tags)[:15]

    # 4. æŽ’åºï¼ˆé¢†åŸŸ > ç±»åˆ« > ç‰¹å¾ > å…¶ä»–ï¼‰
    tags = sort_tags(tags)

    return tags
```

---

## âœ… è¾“å‡ºæ ¼å¼

```json
{
  "tags": [
    "product",
    "product-types",
    "collectors-edition",
    "premium-book",
    "luxury-binding",
    "luxury",
    "leather",
    "collectible",
    "book"
  ],
  "tag_count": 9,
  "cross_domain_tags": ["luxury", "collectible"],
  "primary_tags": ["product", "product-types"]
}
```

---

**çŠ¶æ€**: âœ… å·²å®žçŽ°
**ç›®æ ‡**: æ¯ä¸ªå…ƒç´  5-15 ä¸ªé«˜è´¨é‡æ ‡ç­¾



================================================
FILE: .claude/skills/video-master/skill.md
================================================
---
name: video-master
description: è§†é¢‘ç”Ÿæˆä¸»æŽ§ - è‡ªåŠ¨ç”Ÿæˆè§†é¢‘åœºæ™¯æç¤ºè¯ï¼Œæ”¯æŒåŠ¨æ€æ•ˆæžœã€è½¬åœºã€è¿é•œç­‰
---

# Video Master - è§†é¢‘ç”Ÿæˆä¸»æŽ§ Skill

**ç‰ˆæœ¬**: 1.0
**é¢†åŸŸ**: è§†é¢‘ç”Ÿæˆ
**æž¶æž„**: Master-Subordinate
**æ•°æ®æº**: Universal Elements Database

## ðŸŽ¯ æ ¸å¿ƒåŠŸèƒ½

è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡çš„è§†é¢‘åœºæ™¯æç¤ºè¯ï¼Œæ”¯æŒï¼š
- ðŸŽ¬ åœºæ™¯ç±»åž‹ï¼ˆæ­¦ä¾ ã€ç§‘å¹»ã€åŠ¨ä½œã€å‰§æƒ…ç­‰ï¼‰
- ðŸ“¹ ç›¸æœºè¿åŠ¨ï¼ˆæŽ¨è¿›ã€æ‹‰è¿œã€è·Ÿè¸ªã€çŽ¯ç»•ç­‰ï¼‰
- âš¡ åŠ¨ä½œæ•ˆæžœï¼ˆæ…¢åŠ¨ä½œã€å¿«é€Ÿå‰ªè¾‘ã€ç‰¹æ•ˆï¼‰
- ðŸŽ­ å™äº‹å…ƒç´ ï¼ˆè§’è‰²ã€çŽ¯å¢ƒã€æ°›å›´ï¼‰
- ðŸŒ… å…‰ç…§åœºæ™¯ï¼ˆé»„æ˜ã€é»Žæ˜Žã€å¤œæ™šã€å®¤å†…ï¼‰

---

## ðŸ“‹ ä½¿ç”¨æ–¹å¼

### å¿«é€Ÿç”Ÿæˆ

```
ç”Ÿæˆä¸€ä¸ªæ­¦ä¾ åŠ¨ä½œåœºæ™¯è§†é¢‘
```

æˆ–

```
è§†é¢‘åœºæ™¯ï¼šç”µå½±çº§è´¨æ„Ÿï¼Œæ…¢é•œå¤´ï¼ŒåŠ¨æ€ç›¸æœºè¿åŠ¨
```

---

## ðŸ”„ å·¥ä½œæµç¨‹

```
ç”¨æˆ·è¾“å…¥
  â†“
æŸ¥è¯¢videoé¢†åŸŸå…ƒç´  (1 element)
  - scene_types: æ­¦ä¾ ç­‰
  - camera_movements: åŠ¨æ€è¿é•œï¼ˆå¾…è¡¥å……ï¼‰
  - motion_effects: æ…¢åŠ¨ä½œç­‰ï¼ˆå¾…è¡¥å……ï¼‰
  â†“
ç»„è£…Prompt
  1. åœºæ™¯æè¿°
  2. ç›¸æœºè¿åŠ¨
  3. åŠ¨ä½œæ•ˆæžœ
  4. æŠ€æœ¯å‚æ•°ï¼ˆ8K HDRï¼‰
  â†“
è¾“å‡ºå®Œæ•´è§†é¢‘Prompt
```

---

## ðŸ“Š æ•°æ®æº

**ä¸»è¦åº“**: `video` domain (1 element)

**å…ƒç´ ç±»åˆ«**:
- `scene_types` - åœºæ™¯ç±»åž‹
- `camera_movements` - ç›¸æœºè¿åŠ¨ï¼ˆå¾…è¡¥å……ï¼‰
- `motion_effects` - åŠ¨æ€æ•ˆæžœï¼ˆå¾…è¡¥å……ï¼‰
- `transitions` - è½¬åœºæ•ˆæžœï¼ˆå¾…è¡¥å……ï¼‰

**å¯ç”¨æ ‡ç­¾**:
- `cinematic`, `action`, `dramatic`
- `slow-motion`, `tracking-shot`

---

## âœ… è¾“å‡ºç¤ºä¾‹

**è¾“å…¥**: `ç”Ÿæˆæ­¦ä¾ åŠ¨ä½œåœºæ™¯`

**è¾“å‡º**:
```
Cinematic Chinese martial arts action scene, dynamic tracking shot following
warrior through bamboo forest, slow-motion combat sequences with sword fighting,
dramatic lighting with volumetric fog effects, 8K HDR quality, film-grade
cinematography, fluid camera movements, epic atmosphere with traditional
Chinese aesthetics, professional action choreography, movie-quality VFX
```

---

**SkillçŠ¶æ€**: âœ… å·²å®žçŽ°
**Note**: è§†é¢‘é¢†åŸŸå…ƒç´ è¾ƒå°‘ï¼ˆ1ä¸ªï¼‰ï¼Œå»ºè®®åŽç»­è¡¥å……æ›´å¤šcamera_movementså’Œmotion_effects


